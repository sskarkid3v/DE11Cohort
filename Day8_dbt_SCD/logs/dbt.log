[0m14:48:52.519602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da761caed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da761cad590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da761d831d0>]}


============================== 14:48:52.521804 | 088ce3ce-c84d-4a51-8426-68c26e8b6fec ==============================
[0m14:48:52.521804 [info ] [MainThread]: Running with dbt=1.10.6
[0m14:48:52.522190 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/subhan/.dbt', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:48:52.595924 [error] [MainThread]: Encountered an error:
Runtime Error
  data-paths and seed-paths cannot both be defined. The `data-paths` config has been deprecated in favor of `seed-paths`. Please update your `dbt_project.yml` configuration to reflect this change.

Error encountered in /home/subhan/dbt/modelling_handson/dbt_project.yml
[0m14:48:52.596890 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.11791756, "process_in_blocks": "9800", "process_kernel_time": 0.176753, "process_mem_max_rss": "106312", "process_out_blocks": "16", "process_user_time": 1.043684}
[0m14:48:52.597385 [debug] [MainThread]: Command `dbt seed` failed at 14:48:52.597301 after 0.12 seconds
[0m14:48:52.597691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da7662b8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da761c86ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da761c84f50>]}
[0m14:48:52.597990 [debug] [MainThread]: Flushing usage events
[0m14:48:53.788363 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:49:17.162211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f595ac910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f595f15d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f595f3310>]}


============================== 14:49:17.164614 | daec9db9-2cde-4179-abba-764ac078ed6f ==============================
[0m14:49:17.164614 [info ] [MainThread]: Running with dbt=1.10.6
[0m14:49:17.165043 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/subhan/.dbt', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt seed', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:49:17.200439 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 37, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m14:49:17.200923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'daec9db9-2cde-4179-abba-764ac078ed6f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f59606050>]}
[0m14:49:17.297176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'daec9db9-2cde-4179-abba-764ac078ed6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f594462d0>]}
[0m14:49:17.345634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'daec9db9-2cde-4179-abba-764ac078ed6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f5c224ad0>]}
[0m14:49:17.346631 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:49:17.401241 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m14:49:17.401790 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:49:17.402132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'daec9db9-2cde-4179-abba-764ac078ed6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f58ffeed0>]}
[0m14:49:18.318383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'daec9db9-2cde-4179-abba-764ac078ed6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f5b4178d0>]}
[0m14:49:18.374076 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m14:49:18.376415 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m14:49:18.394490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'daec9db9-2cde-4179-abba-764ac078ed6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f54112a50>]}
[0m14:49:18.394909 [info ] [MainThread]: Found 2 models, 6 seeds, 4 data tests, 434 macros
[0m14:49:18.395240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'daec9db9-2cde-4179-abba-764ac078ed6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f58f3ebd0>]}
[0m14:49:18.396588 [info ] [MainThread]: 
[0m14:49:18.396932 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:49:18.397148 [info ] [MainThread]: 
[0m14:49:18.397485 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:49:18.400640 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb'
[0m14:49:18.428172 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m14:49:18.428504 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m14:49:18.428718 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:18.438011 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m14:49:18.439114 [debug] [ThreadPool]: On list_salesdb: Close
[0m14:49:18.439879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb, now create_salesdb_public_raw_data)
[0m14:49:18.440258 [debug] [ThreadPool]: Creating schema "database: "salesdb"
schema: "public_raw_data"
"
[0m14:49:18.443641 [debug] [ThreadPool]: Using postgres connection "create_salesdb_public_raw_data"
[0m14:49:18.443919 [debug] [ThreadPool]: On create_salesdb_public_raw_data: BEGIN
[0m14:49:18.444116 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:49:18.446998 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m14:49:18.447291 [debug] [ThreadPool]: Using postgres connection "create_salesdb_public_raw_data"
[0m14:49:18.447500 [debug] [ThreadPool]: On create_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "create_salesdb_public_raw_data"} */
create schema if not exists "public_raw_data"
[0m14:49:18.449321 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m14:49:18.449989 [debug] [ThreadPool]: On create_salesdb_public_raw_data: COMMIT
[0m14:49:18.450228 [debug] [ThreadPool]: Using postgres connection "create_salesdb_public_raw_data"
[0m14:49:18.450437 [debug] [ThreadPool]: On create_salesdb_public_raw_data: COMMIT
[0m14:49:18.451264 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m14:49:18.451522 [debug] [ThreadPool]: On create_salesdb_public_raw_data: Close
[0m14:49:18.452832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_salesdb_public_raw_data, now list_salesdb_public_raw_data)
[0m14:49:18.456738 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m14:49:18.457028 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m14:49:18.457233 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:49:18.460754 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m14:49:18.461111 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m14:49:18.461339 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m14:49:18.466841 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m14:49:18.467813 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m14:49:18.468299 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m14:49:18.468771 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now list_salesdb_public)
[0m14:49:18.470396 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public"
[0m14:49:18.470714 [debug] [ThreadPool]: On list_salesdb_public: BEGIN
[0m14:49:18.470908 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:49:18.473978 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m14:49:18.474272 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public"
[0m14:49:18.474498 [debug] [ThreadPool]: On list_salesdb_public: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:49:18.476301 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m14:49:18.477154 [debug] [ThreadPool]: On list_salesdb_public: ROLLBACK
[0m14:49:18.477760 [debug] [ThreadPool]: On list_salesdb_public: Close
[0m14:49:18.481266 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:18.481572 [debug] [MainThread]: On master: BEGIN
[0m14:49:18.481772 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:49:18.485506 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:49:18.485859 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:18.486120 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:49:18.489322 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m14:49:18.490304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'daec9db9-2cde-4179-abba-764ac078ed6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f5775eed0>]}
[0m14:49:18.490831 [debug] [MainThread]: On master: ROLLBACK
[0m14:49:18.491378 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:18.491660 [debug] [MainThread]: On master: BEGIN
[0m14:49:18.492277 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:49:18.492543 [debug] [MainThread]: On master: COMMIT
[0m14:49:18.492741 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:18.492926 [debug] [MainThread]: On master: COMMIT
[0m14:49:18.493267 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:49:18.493488 [debug] [MainThread]: On master: Close
[0m14:49:18.496189 [debug] [Thread-1 (]: Began running node seed.modelling_handson.appointments
[0m14:49:18.496625 [info ] [Thread-1 (]: 1 of 6 START seed file public_raw_data.appointments ............................ [RUN]
[0m14:49:18.497002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_public, now seed.modelling_handson.appointments)
[0m14:49:18.497277 [debug] [Thread-1 (]: Began compiling node seed.modelling_handson.appointments
[0m14:49:18.497516 [debug] [Thread-1 (]: Began executing node seed.modelling_handson.appointments
[0m14:49:18.545778 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.appointments"
[0m14:49:18.546197 [debug] [Thread-1 (]: On seed.modelling_handson.appointments: BEGIN
[0m14:49:18.546487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:18.550700 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:49:18.551063 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.appointments"
[0m14:49:18.551319 [debug] [Thread-1 (]: On seed.modelling_handson.appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "seed.modelling_handson.appointments"} */

    create table "salesdb"."public_raw_data"."appointments" (id integer,patient_id integer,doctor_id integer,appointment_date date,status text,department_id integer)
  
[0m14:49:18.559753 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.008 seconds
[0m14:49:19.209732 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.appointments"
[0m14:49:19.210162 [debug] [Thread-1 (]: On seed.modelling_handson.appointments: 
          insert into "salesdb"."public_raw_data"."appointments" (id, patient_id, doctor_id, appointment_date, status, department_id) values
          (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),...
[0m14:49:19.221952 [debug] [Thread-1 (]: SQL status: INSERT 0 1000 in 0.011 seconds
[0m14:49:19.226150 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.modelling_handson.appointments"
[0m14:49:19.240265 [debug] [Thread-1 (]: On seed.modelling_handson.appointments: COMMIT
[0m14:49:19.240718 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.appointments"
[0m14:49:19.240975 [debug] [Thread-1 (]: On seed.modelling_handson.appointments: COMMIT
[0m14:49:19.243039 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:49:19.244442 [debug] [Thread-1 (]: On seed.modelling_handson.appointments: Close
[0m14:49:19.246025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daec9db9-2cde-4179-abba-764ac078ed6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f4e395990>]}
[0m14:49:19.246499 [info ] [Thread-1 (]: 1 of 6 OK loaded seed file public_raw_data.appointments ........................ [[32mINSERT 1000[0m in 0.75s]
[0m14:49:19.246966 [debug] [Thread-1 (]: Finished running node seed.modelling_handson.appointments
[0m14:49:19.247259 [debug] [Thread-1 (]: Began running node seed.modelling_handson.departments
[0m14:49:19.247701 [info ] [Thread-1 (]: 2 of 6 START seed file public_raw_data.departments ............................. [RUN]
[0m14:49:19.248058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.modelling_handson.appointments, now seed.modelling_handson.departments)
[0m14:49:19.248309 [debug] [Thread-1 (]: Began compiling node seed.modelling_handson.departments
[0m14:49:19.248565 [debug] [Thread-1 (]: Began executing node seed.modelling_handson.departments
[0m14:49:19.251201 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.departments"
[0m14:49:19.251495 [debug] [Thread-1 (]: On seed.modelling_handson.departments: BEGIN
[0m14:49:19.251734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:19.255280 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m14:49:19.255619 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.departments"
[0m14:49:19.255884 [debug] [Thread-1 (]: On seed.modelling_handson.departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "seed.modelling_handson.departments"} */

    create table "salesdb"."public_raw_data"."departments" (id integer,name text)
  
[0m14:49:19.258295 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.002 seconds
[0m14:49:19.261536 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.departments"
[0m14:49:19.261876 [debug] [Thread-1 (]: On seed.modelling_handson.departments: 
          insert into "salesdb"."public_raw_data"."departments" (id, name) values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m14:49:19.262737 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.001 seconds
[0m14:49:19.263315 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.modelling_handson.departments"
[0m14:49:19.264714 [debug] [Thread-1 (]: On seed.modelling_handson.departments: COMMIT
[0m14:49:19.265012 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.departments"
[0m14:49:19.265246 [debug] [Thread-1 (]: On seed.modelling_handson.departments: COMMIT
[0m14:49:19.266582 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:49:19.267198 [debug] [Thread-1 (]: On seed.modelling_handson.departments: Close
[0m14:49:19.267656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daec9db9-2cde-4179-abba-764ac078ed6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f4e3c3c90>]}
[0m14:49:19.268078 [info ] [Thread-1 (]: 2 of 6 OK loaded seed file public_raw_data.departments ......................... [[32mINSERT 10[0m in 0.02s]
[0m14:49:19.268494 [debug] [Thread-1 (]: Finished running node seed.modelling_handson.departments
[0m14:49:19.268803 [debug] [Thread-1 (]: Began running node seed.modelling_handson.diagnoses
[0m14:49:19.269145 [info ] [Thread-1 (]: 3 of 6 START seed file public_raw_data.diagnoses ............................... [RUN]
[0m14:49:19.269647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.modelling_handson.departments, now seed.modelling_handson.diagnoses)
[0m14:49:19.269931 [debug] [Thread-1 (]: Began compiling node seed.modelling_handson.diagnoses
[0m14:49:19.270181 [debug] [Thread-1 (]: Began executing node seed.modelling_handson.diagnoses
[0m14:49:19.279509 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.diagnoses"
[0m14:49:19.279892 [debug] [Thread-1 (]: On seed.modelling_handson.diagnoses: BEGIN
[0m14:49:19.280132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:19.284203 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:49:19.284605 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.diagnoses"
[0m14:49:19.284855 [debug] [Thread-1 (]: On seed.modelling_handson.diagnoses: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "seed.modelling_handson.diagnoses"} */

    create table "salesdb"."public_raw_data"."diagnoses" (appointment_id integer,symptoms text,diagnosis text,notes text)
  
[0m14:49:19.288505 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.003 seconds
[0m14:49:19.717090 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.diagnoses"
[0m14:49:19.717495 [debug] [Thread-1 (]: On seed.modelling_handson.diagnoses: 
          insert into "salesdb"."public_raw_data"."diagnoses" (appointment_id, symptoms, diagnosis, notes) values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s...
[0m14:49:19.724315 [debug] [Thread-1 (]: SQL status: INSERT 0 1000 in 0.006 seconds
[0m14:49:19.725048 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.modelling_handson.diagnoses"
[0m14:49:19.726432 [debug] [Thread-1 (]: On seed.modelling_handson.diagnoses: COMMIT
[0m14:49:19.726796 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.diagnoses"
[0m14:49:19.727036 [debug] [Thread-1 (]: On seed.modelling_handson.diagnoses: COMMIT
[0m14:49:19.729200 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:49:19.729815 [debug] [Thread-1 (]: On seed.modelling_handson.diagnoses: Close
[0m14:49:19.730271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daec9db9-2cde-4179-abba-764ac078ed6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f4e30e190>]}
[0m14:49:19.730710 [info ] [Thread-1 (]: 3 of 6 OK loaded seed file public_raw_data.diagnoses ........................... [[32mINSERT 1000[0m in 0.46s]
[0m14:49:19.731095 [debug] [Thread-1 (]: Finished running node seed.modelling_handson.diagnoses
[0m14:49:19.731357 [debug] [Thread-1 (]: Began running node seed.modelling_handson.doctors
[0m14:49:19.731812 [info ] [Thread-1 (]: 4 of 6 START seed file public_raw_data.doctors ................................. [RUN]
[0m14:49:19.732191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.modelling_handson.diagnoses, now seed.modelling_handson.doctors)
[0m14:49:19.732434 [debug] [Thread-1 (]: Began compiling node seed.modelling_handson.doctors
[0m14:49:19.732661 [debug] [Thread-1 (]: Began executing node seed.modelling_handson.doctors
[0m14:49:19.735844 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.doctors"
[0m14:49:19.736147 [debug] [Thread-1 (]: On seed.modelling_handson.doctors: BEGIN
[0m14:49:19.736375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:19.739599 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m14:49:19.739916 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.doctors"
[0m14:49:19.740158 [debug] [Thread-1 (]: On seed.modelling_handson.doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "seed.modelling_handson.doctors"} */

    create table "salesdb"."public_raw_data"."doctors" (id integer,name text,specialization text,department_id integer)
  
[0m14:49:19.743322 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.003 seconds
[0m14:49:19.765589 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.doctors"
[0m14:49:19.766225 [debug] [Thread-1 (]: On seed.modelling_handson.doctors: 
          insert into "salesdb"."public_raw_data"."doctors" (id, name, specialization, department_id) values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m14:49:19.768101 [debug] [Thread-1 (]: SQL status: INSERT 0 50 in 0.001 seconds
[0m14:49:19.768691 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.modelling_handson.doctors"
[0m14:49:19.769967 [debug] [Thread-1 (]: On seed.modelling_handson.doctors: COMMIT
[0m14:49:19.770260 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.doctors"
[0m14:49:19.770523 [debug] [Thread-1 (]: On seed.modelling_handson.doctors: COMMIT
[0m14:49:19.771687 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:49:19.772270 [debug] [Thread-1 (]: On seed.modelling_handson.doctors: Close
[0m14:49:19.772714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daec9db9-2cde-4179-abba-764ac078ed6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f57bee090>]}
[0m14:49:19.773109 [info ] [Thread-1 (]: 4 of 6 OK loaded seed file public_raw_data.doctors ............................. [[32mINSERT 50[0m in 0.04s]
[0m14:49:19.773524 [debug] [Thread-1 (]: Finished running node seed.modelling_handson.doctors
[0m14:49:19.773816 [debug] [Thread-1 (]: Began running node seed.modelling_handson.patients
[0m14:49:19.774495 [info ] [Thread-1 (]: 5 of 6 START seed file public_raw_data.patients ................................ [RUN]
[0m14:49:19.775020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.modelling_handson.doctors, now seed.modelling_handson.patients)
[0m14:49:19.775317 [debug] [Thread-1 (]: Began compiling node seed.modelling_handson.patients
[0m14:49:19.775568 [debug] [Thread-1 (]: Began executing node seed.modelling_handson.patients
[0m14:49:19.781988 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.patients"
[0m14:49:19.782411 [debug] [Thread-1 (]: On seed.modelling_handson.patients: BEGIN
[0m14:49:19.782746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:19.786828 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:49:19.787294 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.patients"
[0m14:49:19.787552 [debug] [Thread-1 (]: On seed.modelling_handson.patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "seed.modelling_handson.patients"} */

    create table "salesdb"."public_raw_data"."patients" (id integer,name text,gender text,dob date,city text)
  
[0m14:49:19.791674 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.004 seconds
[0m14:49:19.905306 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.patients"
[0m14:49:19.905930 [debug] [Thread-1 (]: On seed.modelling_handson.patients: 
          insert into "salesdb"."public_raw_data"."patients" (id, name, gender, dob, city) values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s...
[0m14:49:19.908692 [debug] [Thread-1 (]: SQL status: INSERT 0 200 in 0.002 seconds
[0m14:49:19.909352 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.modelling_handson.patients"
[0m14:49:19.911487 [debug] [Thread-1 (]: On seed.modelling_handson.patients: COMMIT
[0m14:49:19.911860 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.patients"
[0m14:49:19.912125 [debug] [Thread-1 (]: On seed.modelling_handson.patients: COMMIT
[0m14:49:19.914341 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:49:19.915090 [debug] [Thread-1 (]: On seed.modelling_handson.patients: Close
[0m14:49:19.915616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daec9db9-2cde-4179-abba-764ac078ed6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f57be9c90>]}
[0m14:49:19.916060 [info ] [Thread-1 (]: 5 of 6 OK loaded seed file public_raw_data.patients ............................ [[32mINSERT 200[0m in 0.14s]
[0m14:49:19.916506 [debug] [Thread-1 (]: Finished running node seed.modelling_handson.patients
[0m14:49:19.916887 [debug] [Thread-1 (]: Began running node seed.modelling_handson.treatments
[0m14:49:19.917474 [info ] [Thread-1 (]: 6 of 6 START seed file public_raw_data.treatments .............................. [RUN]
[0m14:49:19.918100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.modelling_handson.patients, now seed.modelling_handson.treatments)
[0m14:49:19.918404 [debug] [Thread-1 (]: Began compiling node seed.modelling_handson.treatments
[0m14:49:19.918701 [debug] [Thread-1 (]: Began executing node seed.modelling_handson.treatments
[0m14:49:19.933586 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.treatments"
[0m14:49:19.934233 [debug] [Thread-1 (]: On seed.modelling_handson.treatments: BEGIN
[0m14:49:19.934563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:19.938429 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:49:19.938933 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.treatments"
[0m14:49:19.939229 [debug] [Thread-1 (]: On seed.modelling_handson.treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "seed.modelling_handson.treatments"} */

    create table "salesdb"."public_raw_data"."treatments" (id integer,appointment_id integer,treatment text,cost float8)
  
[0m14:49:19.942007 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.002 seconds
[0m14:49:20.276442 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.treatments"
[0m14:49:20.276842 [debug] [Thread-1 (]: On seed.modelling_handson.treatments: 
          insert into "salesdb"."public_raw_data"."treatments" (id, appointment_id, treatment, cost) values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(...
[0m14:49:20.283188 [debug] [Thread-1 (]: SQL status: INSERT 0 800 in 0.006 seconds
[0m14:49:20.283835 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.modelling_handson.treatments"
[0m14:49:20.285268 [debug] [Thread-1 (]: On seed.modelling_handson.treatments: COMMIT
[0m14:49:20.285748 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.treatments"
[0m14:49:20.285990 [debug] [Thread-1 (]: On seed.modelling_handson.treatments: COMMIT
[0m14:49:20.287138 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:49:20.287718 [debug] [Thread-1 (]: On seed.modelling_handson.treatments: Close
[0m14:49:20.288222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daec9db9-2cde-4179-abba-764ac078ed6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f5c2060d0>]}
[0m14:49:20.288638 [info ] [Thread-1 (]: 6 of 6 OK loaded seed file public_raw_data.treatments .......................... [[32mINSERT 800[0m in 0.37s]
[0m14:49:20.289036 [debug] [Thread-1 (]: Finished running node seed.modelling_handson.treatments
[0m14:49:20.290486 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:20.290766 [debug] [MainThread]: On master: BEGIN
[0m14:49:20.290970 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:49:20.294435 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m14:49:20.294797 [debug] [MainThread]: On master: COMMIT
[0m14:49:20.295034 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:20.295231 [debug] [MainThread]: On master: COMMIT
[0m14:49:20.295727 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:49:20.296049 [debug] [MainThread]: On master: Close
[0m14:49:20.296385 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:49:20.296588 [debug] [MainThread]: Connection 'seed.modelling_handson.treatments' was properly closed.
[0m14:49:20.296831 [info ] [MainThread]: 
[0m14:49:20.297081 [info ] [MainThread]: Finished running 6 seeds in 0 hours 0 minutes and 1.90 seconds (1.90s).
[0m14:49:20.297960 [debug] [MainThread]: Command end result
[0m14:49:20.313316 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m14:49:20.314862 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m14:49:20.319880 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m14:49:20.320202 [info ] [MainThread]: 
[0m14:49:20.320536 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:49:20.320803 [info ] [MainThread]: 
[0m14:49:20.321055 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m14:49:20.321456 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:49:20.322143 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 3.2032206, "process_in_blocks": "10072", "process_kernel_time": 0.2228, "process_mem_max_rss": "132016", "process_out_blocks": "2848", "process_user_time": 4.250028}
[0m14:49:20.322524 [debug] [MainThread]: Command `dbt seed` succeeded at 14:49:20.322434 after 3.20 seconds
[0m14:49:20.322797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f5dbb8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f5dbb91d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f5dbb9410>]}
[0m14:49:20.323076 [debug] [MainThread]: Flushing usage events
[0m14:49:21.804396 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:10:53.508138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7202503bc150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7202503be650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7202503be710>]}


============================== 15:10:53.511387 | 960714e0-6f3e-45c2-8b1d-0dd2035e4457 ==============================
[0m15:10:53.511387 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:10:53.511789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/subhan/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:10:53.568229 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 39, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:10:53.568665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '960714e0-6f3e-45c2-8b1d-0dd2035e4457', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72025044d710>]}
[0m15:10:53.647035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '960714e0-6f3e-45c2-8b1d-0dd2035e4457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72024fd31990>]}
[0m15:10:53.689092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '960714e0-6f3e-45c2-8b1d-0dd2035e4457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72024f911250>]}
[0m15:10:53.690017 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:10:53.735579 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m15:10:53.804601 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:10:53.804994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '960714e0-6f3e-45c2-8b1d-0dd2035e4457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720250d1c390>]}
[0m15:10:54.402883 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.modelling_handson.stg_departments' (models/staging/stg_departments.sql) depends on a node named 'departments' in package or project 'public_raw_data' which was not found
[0m15:10:54.403342 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:10:54.405604 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9335925, "process_in_blocks": "101544", "process_kernel_time": 0.228341, "process_mem_max_rss": "117644", "process_out_blocks": "16", "process_user_time": 1.892597}
[0m15:10:54.405940 [debug] [MainThread]: Command `dbt run` failed at 15:10:54.405879 after 0.93 seconds
[0m15:10:54.406264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7202549b8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720250580690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72024f1f92d0>]}
[0m15:10:54.406520 [debug] [MainThread]: Flushing usage events
[0m15:10:55.557895 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:15:08.137316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76097d2a9cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76097d46c490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76097d2dd390>]}


============================== 15:15:08.139875 | 4f7158e6-8b4a-4ec0-884f-8c870c56d2a6 ==============================
[0m15:15:08.139875 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:15:08.140299 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'profiles_dir': '/home/subhan/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:15:08.175032 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "modelling_handson", target "dev" invalid: 'schema' is a required property
[0m15:15:08.176897 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.08468074, "process_in_blocks": "0", "process_kernel_time": 0.208219, "process_mem_max_rss": "105808", "process_out_blocks": "8", "process_user_time": 1.116411}
[0m15:15:08.177338 [debug] [MainThread]: Command `dbt seed` failed at 15:15:08.177247 after 0.09 seconds
[0m15:15:08.177639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76097d5744d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76097d2a8d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76097cd800d0>]}
[0m15:15:08.177949 [debug] [MainThread]: Flushing usage events
[0m15:15:09.138092 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:15:31.302875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b72f9499e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b72f9498d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b72f9498d50>]}


============================== 15:15:31.305103 | fb92ad24-e0f4-48a2-8ad3-d760c452e379 ==============================
[0m15:15:31.305103 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:15:31.305487 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'fail_fast': 'False', 'profiles_dir': '/home/subhan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt seed', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:15:31.339120 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 39, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:15:31.339589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fb92ad24-e0f4-48a2-8ad3-d760c452e379', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b72f94f0990>]}
[0m15:15:31.421471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb92ad24-e0f4-48a2-8ad3-d760c452e379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b72f8fdb6d0>]}
[0m15:15:31.465334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb92ad24-e0f4-48a2-8ad3-d760c452e379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b72f8be7290>]}
[0m15:15:31.465978 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:15:31.514258 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m15:15:31.599955 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:15:31.600427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fb92ad24-e0f4-48a2-8ad3-d760c452e379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b72f8b9aed0>]}
[0m15:15:32.399183 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.modelling_handson.stg_departments' (models/staging/stg_departments.sql) depends on a node named 'departments' in package or project 'public_raw_data' which was not found
[0m15:15:32.399773 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:15:32.400555 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 1.1360699, "process_in_blocks": "256", "process_kernel_time": 0.185529, "process_mem_max_rss": "120560", "process_out_blocks": "8", "process_user_time": 2.167319}
[0m15:15:32.400926 [debug] [MainThread]: Command `dbt seed` failed at 15:15:32.400858 after 1.14 seconds
[0m15:15:32.401204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b72f9498ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b72f73af4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b72f94df5d0>]}
[0m15:15:32.401475 [debug] [MainThread]: Flushing usage events
[0m15:15:33.423043 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:17:23.882356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4b675798d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4b675bf150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4b67571590>]}


============================== 15:17:23.884510 | 610bee7b-8503-442f-8d28-f9fb1c8b3439 ==============================
[0m15:17:23.884510 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:17:23.884931 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/subhan/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:17:23.930658 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 39, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:17:23.931147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '610bee7b-8503-442f-8d28-f9fb1c8b3439', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4b675d0950>]}
[0m15:17:24.013619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '610bee7b-8503-442f-8d28-f9fb1c8b3439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4b66ff1e50>]}
[0m15:17:24.064438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '610bee7b-8503-442f-8d28-f9fb1c8b3439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4b6a1b8310>]}
[0m15:17:24.065249 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:17:24.117797 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m15:17:24.203635 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:17:24.204102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '610bee7b-8503-442f-8d28-f9fb1c8b3439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4b67ec0350>]}
[0m15:17:25.043245 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.modelling_handson.stg_departments' (models/staging/stg_departments.sql) depends on a node named 'departments' in package or project 'public_raw_data' which was not found
[0m15:17:25.044081 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:17:25.044962 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.201096, "process_in_blocks": "0", "process_kernel_time": 0.163798, "process_mem_max_rss": "120512", "process_out_blocks": "16", "process_user_time": 2.242774}
[0m15:17:25.045374 [debug] [MainThread]: Command `dbt run` failed at 15:17:25.045295 after 1.20 seconds
[0m15:17:25.045673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4b67579310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4b65306b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4b67578ad0>]}
[0m15:17:25.046127 [debug] [MainThread]: Flushing usage events
[0m15:17:26.226062 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:18:56.076371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8f09b5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8f0a01bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8f0c8b050>]}


============================== 15:18:56.078786 | 0bdb249c-8fbf-4ceb-a754-14767ca1a582 ==============================
[0m15:18:56.078786 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:18:56.079227 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'version_check': 'True', 'profiles_dir': '/home/subhan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:18:56.080110 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 39, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:18:56.080481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0bdb249c-8fbf-4ceb-a754-14767ca1a582', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8f0a16890>]}
[0m15:18:56.179310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bdb249c-8fbf-4ceb-a754-14767ca1a582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8f09be5d0>]}
[0m15:18:56.198720 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:18:56.199427 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.16791858, "process_in_blocks": "1008", "process_kernel_time": 0.199609, "process_mem_max_rss": "104572", "process_out_blocks": "16", "process_user_time": 1.138198}
[0m15:18:56.199786 [debug] [MainThread]: Command `dbt clean` succeeded at 15:18:56.199722 after 0.17 seconds
[0m15:18:56.200060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8f09bc190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8f50b8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8f50b9410>]}
[0m15:18:56.200317 [debug] [MainThread]: Flushing usage events
[0m15:18:57.371390 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:19:01.473604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c87961b4ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8796483250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c87961b4d50>]}


============================== 15:19:01.477345 | 8987e136-b8d1-4973-8f93-9c73be0e1cfb ==============================
[0m15:19:01.477345 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:19:01.477817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'profiles_dir': '/home/subhan/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:19:01.478789 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 39, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:19:01.479174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8987e136-b8d1-4973-8f93-9c73be0e1cfb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c879620e310>]}
[0m15:19:01.570390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8987e136-b8d1-4973-8f93-9c73be0e1cfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c87960eea90>]}
[0m15:19:01.583077 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:19:01.583911 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:19:01.584404 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:19:01.585519 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.15727668, "process_in_blocks": "232", "process_kernel_time": 0.134787, "process_mem_max_rss": "105160", "process_out_blocks": "0", "process_user_time": 1.158327}
[0m15:19:01.585965 [debug] [MainThread]: Command `dbt deps` succeeded at 15:19:01.585879 after 0.16 seconds
[0m15:19:01.586262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c879620c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c879620e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8796096190>]}
[0m15:19:01.586562 [debug] [MainThread]: Flushing usage events
[0m15:19:02.778580 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:19:52.489671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70099a18c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70099a5504d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70099a1e3e10>]}


============================== 15:19:52.492261 | 6767589f-fbe1-4caa-aa8e-3dd85c5a0b26 ==============================
[0m15:19:52.492261 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:19:52.492708 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'fail_fast': 'False', 'profiles_dir': '/home/subhan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:19:52.531740 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 39, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:19:52.532250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6767589f-fbe1-4caa-aa8e-3dd85c5a0b26', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700999facc90>]}
[0m15:19:52.617815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6767589f-fbe1-4caa-aa8e-3dd85c5a0b26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70099a550410>]}
[0m15:19:52.665614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6767589f-fbe1-4caa-aa8e-3dd85c5a0b26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70099ce30b50>]}
[0m15:19:52.666313 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:19:52.715140 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m15:19:52.715684 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:19:52.715996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6767589f-fbe1-4caa-aa8e-3dd85c5a0b26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700999b8f710>]}
[0m15:19:53.524502 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.modelling_handson.stg_departments' (models/staging/stg_departments.sql) depends on a node named 'departments' in package or project 'public_raw_data' which was not found
[0m15:19:53.525204 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:19:53.526007 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0820677, "process_in_blocks": "0", "process_kernel_time": 0.170213, "process_mem_max_rss": "118824", "process_out_blocks": "16", "process_user_time": 2.140429}
[0m15:19:53.526424 [debug] [MainThread]: Command `dbt run` failed at 15:19:53.526351 after 1.08 seconds
[0m15:19:53.526710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70099e7b8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70099a203b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70099a53ffd0>]}
[0m15:19:53.526999 [debug] [MainThread]: Flushing usage events
[0m15:19:54.524319 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:20:58.581640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e1a9694610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e1a9a58910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e1aa5bfc90>]}


============================== 15:20:58.584865 | c02bcd41-826a-48c3-ab3e-5e7bc83e2625 ==============================
[0m15:20:58.584865 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:20:58.585302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'version_check': 'True', 'profiles_dir': '/home/subhan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:20:58.624578 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 39, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:20:58.625062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c02bcd41-826a-48c3-ab3e-5e7bc83e2625', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e1a9696cd0>]}
[0m15:20:58.710914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c02bcd41-826a-48c3-ab3e-5e7bc83e2625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e1a91779d0>]}
[0m15:20:58.758796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c02bcd41-826a-48c3-ab3e-5e7bc83e2625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e1a8dfcad0>]}
[0m15:20:58.759479 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:20:58.808014 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m15:20:58.808522 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:20:58.808896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c02bcd41-826a-48c3-ab3e-5e7bc83e2625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e1a8de5450>]}
[0m15:20:59.697558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c02bcd41-826a-48c3-ab3e-5e7bc83e2625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e1a7d3d150>]}
[0m15:20:59.753387 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:20:59.755359 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:20:59.766663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c02bcd41-826a-48c3-ab3e-5e7bc83e2625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e1a814de10>]}
[0m15:20:59.767133 [info ] [MainThread]: Found 6 models, 6 seeds, 3 sources, 435 macros
[0m15:20:59.767426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c02bcd41-826a-48c3-ab3e-5e7bc83e2625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e1abe6f190>]}
[0m15:20:59.769014 [info ] [MainThread]: 
[0m15:20:59.769369 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:20:59.769617 [info ] [MainThread]: 
[0m15:20:59.769985 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:20:59.773779 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb'
[0m15:20:59.803184 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m15:20:59.803622 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m15:20:59.803873 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:59.813681 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m15:20:59.814818 [debug] [ThreadPool]: On list_salesdb: Close
[0m15:20:59.817368 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb, now list_salesdb_public_raw_data)
[0m15:20:59.822066 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:20:59.822454 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m15:20:59.822709 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:59.826809 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:20:59.827205 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:20:59.827460 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m15:20:59.830095 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m15:20:59.831237 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m15:20:59.831796 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m15:20:59.832376 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now list_salesdb_public)
[0m15:20:59.834500 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public"
[0m15:20:59.834810 [debug] [ThreadPool]: On list_salesdb_public: BEGIN
[0m15:20:59.835040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:59.838235 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:20:59.838514 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public"
[0m15:20:59.838750 [debug] [ThreadPool]: On list_salesdb_public: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:20:59.840818 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m15:20:59.841746 [debug] [ThreadPool]: On list_salesdb_public: ROLLBACK
[0m15:20:59.842275 [debug] [ThreadPool]: On list_salesdb_public: Close
[0m15:20:59.846092 [debug] [MainThread]: Using postgres connection "master"
[0m15:20:59.846423 [debug] [MainThread]: On master: BEGIN
[0m15:20:59.846652 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:20:59.849976 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:20:59.850291 [debug] [MainThread]: Using postgres connection "master"
[0m15:20:59.850579 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:20:59.857590 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m15:20:59.858649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c02bcd41-826a-48c3-ab3e-5e7bc83e2625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e1a89e76d0>]}
[0m15:20:59.859074 [debug] [MainThread]: On master: ROLLBACK
[0m15:20:59.859757 [debug] [MainThread]: Using postgres connection "master"
[0m15:20:59.860082 [debug] [MainThread]: On master: BEGIN
[0m15:20:59.860742 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:20:59.861056 [debug] [MainThread]: On master: COMMIT
[0m15:20:59.861320 [debug] [MainThread]: Using postgres connection "master"
[0m15:20:59.861548 [debug] [MainThread]: On master: COMMIT
[0m15:20:59.862217 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:20:59.862487 [debug] [MainThread]: On master: Close
[0m15:20:59.865856 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_departments
[0m15:20:59.866402 [info ] [Thread-1 (]: 1 of 5 START sql view model public.stg_departments ............................. [RUN]
[0m15:20:59.866857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_public, now model.modelling_handson.stg_departments)
[0m15:20:59.867174 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_departments
[0m15:20:59.873011 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_departments"
[0m15:20:59.874176 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_departments
[0m15:20:59.910060 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_departments"
[0m15:20:59.911772 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:20:59.912221 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: BEGIN
[0m15:20:59.912511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:59.917312 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m15:20:59.917736 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:20:59.918027 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */

  create view "salesdb"."public"."stg_departments__dbt_tmp"
    
    
  as (
    select
    id as department_id,
    name as department_name
FROM "salesdb"."public_raw_data"."departments"
  );
[0m15:20:59.922715 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m15:20:59.928440 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:20:59.928907 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */
alter table "salesdb"."public"."stg_departments__dbt_tmp" rename to "stg_departments"
[0m15:20:59.929790 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:20:59.942374 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: COMMIT
[0m15:20:59.942896 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:20:59.943195 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: COMMIT
[0m15:20:59.944709 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:20:59.949612 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."public"."stg_departments__dbt_backup"
[0m15:20:59.954068 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:20:59.954451 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */
drop view if exists "salesdb"."public"."stg_departments__dbt_backup" cascade
[0m15:20:59.955325 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:20:59.957374 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: Close
[0m15:20:59.959209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c02bcd41-826a-48c3-ab3e-5e7bc83e2625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e19e5a4b10>]}
[0m15:20:59.959870 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.stg_departments ........................ [[32mCREATE VIEW[0m in 0.09s]
[0m15:20:59.960506 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_departments
[0m15:20:59.960879 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_doctors
[0m15:20:59.961641 [info ] [Thread-1 (]: 2 of 5 START sql view model public.stg_doctors ................................. [RUN]
[0m15:20:59.962140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_departments, now model.modelling_handson.stg_doctors)
[0m15:20:59.962444 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_doctors
[0m15:20:59.964720 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_doctors"
[0m15:20:59.965306 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_doctors
[0m15:20:59.967923 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_doctors"
[0m15:20:59.968537 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:20:59.968854 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: BEGIN
[0m15:20:59.969122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:59.974667 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m15:20:59.975151 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:20:59.975470 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */

  create view "salesdb"."public"."stg_doctors__dbt_tmp"
    
    
  as (
    select
    id as doctor_id,
    name,
    specialization,
    department_id
FROM "salesdb"."public_raw_data"."doctors"
  );
[0m15:20:59.977340 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:20:59.979891 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:20:59.980338 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */
alter table "salesdb"."public"."stg_doctors__dbt_tmp" rename to "stg_doctors"
[0m15:20:59.981382 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:20:59.982505 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: COMMIT
[0m15:20:59.982910 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:20:59.983213 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: COMMIT
[0m15:20:59.984815 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:20:59.986808 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."public"."stg_doctors__dbt_backup"
[0m15:20:59.987381 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:20:59.987700 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */
drop view if exists "salesdb"."public"."stg_doctors__dbt_backup" cascade
[0m15:20:59.988666 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:20:59.989846 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: Close
[0m15:20:59.990412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c02bcd41-826a-48c3-ab3e-5e7bc83e2625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e19e4e9850>]}
[0m15:20:59.991012 [info ] [Thread-1 (]: 2 of 5 OK created sql view model public.stg_doctors ............................ [[32mCREATE VIEW[0m in 0.03s]
[0m15:20:59.991502 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_doctors
[0m15:20:59.991865 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_patients
[0m15:20:59.992316 [info ] [Thread-1 (]: 3 of 5 START sql view model public.stg_patients ................................ [RUN]
[0m15:20:59.993134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_doctors, now model.modelling_handson.stg_patients)
[0m15:20:59.993493 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_patients
[0m15:20:59.995648 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_patients"
[0m15:20:59.996187 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_patients
[0m15:20:59.998689 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_patients"
[0m15:20:59.999217 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:20:59.999511 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: BEGIN
[0m15:20:59.999774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:00.003644 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:21:00.004119 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:21:00.004435 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */

  create view "salesdb"."public"."stg_patients__dbt_tmp"
    
    
  as (
    select
id as patient_id,
name,
gender,
dob,
city
FROM "salesdb"."public_raw_data"."patients"
  );
[0m15:21:00.005899 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:21:00.008332 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:21:00.008687 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */
alter table "salesdb"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m15:21:00.009478 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:21:00.010527 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: COMMIT
[0m15:21:00.010853 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:21:00.011140 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: COMMIT
[0m15:21:00.012708 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:21:00.014602 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."public"."stg_patients__dbt_backup"
[0m15:21:00.015122 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:21:00.015633 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */
drop view if exists "salesdb"."public"."stg_patients__dbt_backup" cascade
[0m15:21:00.016699 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:21:00.017799 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: Close
[0m15:21:00.018332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c02bcd41-826a-48c3-ab3e-5e7bc83e2625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e19e57d1d0>]}
[0m15:21:00.018889 [info ] [Thread-1 (]: 3 of 5 OK created sql view model public.stg_patients ........................... [[32mCREATE VIEW[0m in 0.03s]
[0m15:21:00.019501 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_patients
[0m15:21:00.020042 [debug] [Thread-1 (]: Began running node model.modelling_handson.dim_doctors
[0m15:21:00.021296 [info ] [Thread-1 (]: 4 of 5 START sql table model public.dim_doctors ................................ [RUN]
[0m15:21:00.022090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_patients, now model.modelling_handson.dim_doctors)
[0m15:21:00.022479 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.dim_doctors
[0m15:21:00.024981 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.dim_doctors"
[0m15:21:00.025753 [debug] [Thread-1 (]: Began executing node model.modelling_handson.dim_doctors
[0m15:21:00.046065 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.dim_doctors"
[0m15:21:00.046995 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:21:00.047331 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: BEGIN
[0m15:21:00.047585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:00.051566 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:21:00.052024 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:21:00.052320 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */

  
    

  create  table "salesdb"."public"."dim_doctors__dbt_tmp"
  
  
    as
  
  (
    select d.*, dep.department_name
from "salesdb"."public"."stg_doctors" d
left join "salesdb"."public"."stg_departments" dep
on d.department_id = dep.department_id
  );
  
[0m15:21:00.055934 [debug] [Thread-1 (]: SQL status: SELECT 50 in 0.003 seconds
[0m15:21:00.061465 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:21:00.061862 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */
alter table "salesdb"."public"."dim_doctors__dbt_tmp" rename to "dim_doctors"
[0m15:21:00.062751 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:21:00.063872 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: COMMIT
[0m15:21:00.064264 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:21:00.064546 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: COMMIT
[0m15:21:00.065691 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:21:00.067470 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."public"."dim_doctors__dbt_backup"
[0m15:21:00.070260 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:21:00.070697 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */
drop table if exists "salesdb"."public"."dim_doctors__dbt_backup" cascade
[0m15:21:00.071560 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:21:00.072772 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: Close
[0m15:21:00.073498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c02bcd41-826a-48c3-ab3e-5e7bc83e2625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e19cb5a7d0>]}
[0m15:21:00.074553 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.dim_doctors ........................... [[32mSELECT 50[0m in 0.05s]
[0m15:21:00.075529 [debug] [Thread-1 (]: Finished running node model.modelling_handson.dim_doctors
[0m15:21:00.076136 [debug] [Thread-1 (]: Began running node model.modelling_handson.dim_patients
[0m15:21:00.076566 [info ] [Thread-1 (]: 5 of 5 START sql table model public.dim_patients ............................... [RUN]
[0m15:21:00.077297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.dim_doctors, now model.modelling_handson.dim_patients)
[0m15:21:00.078054 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.dim_patients
[0m15:21:00.081008 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.dim_patients"
[0m15:21:00.082367 [debug] [Thread-1 (]: Began executing node model.modelling_handson.dim_patients
[0m15:21:00.085079 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.dim_patients"
[0m15:21:00.085729 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:21:00.086061 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: BEGIN
[0m15:21:00.086331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:00.091294 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m15:21:00.091731 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:21:00.092048 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */

  
    

  create  table "salesdb"."public"."dim_patients__dbt_tmp"
  
  
    as
  
  (
    select * from "salesdb"."public"."stg_patients"
  );
  
[0m15:21:00.096984 [debug] [Thread-1 (]: SQL status: SELECT 200 in 0.005 seconds
[0m15:21:00.099744 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:21:00.100344 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */
alter table "salesdb"."public"."dim_patients__dbt_tmp" rename to "dim_patients"
[0m15:21:00.101376 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:21:00.102509 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: COMMIT
[0m15:21:00.102952 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:21:00.103273 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: COMMIT
[0m15:21:00.104634 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:21:00.106824 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."public"."dim_patients__dbt_backup"
[0m15:21:00.107518 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:21:00.107853 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */
drop table if exists "salesdb"."public"."dim_patients__dbt_backup" cascade
[0m15:21:00.108824 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:21:00.110301 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: Close
[0m15:21:00.110879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c02bcd41-826a-48c3-ab3e-5e7bc83e2625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e1a8d212d0>]}
[0m15:21:00.111453 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.dim_patients .......................... [[32mSELECT 200[0m in 0.03s]
[0m15:21:00.112001 [debug] [Thread-1 (]: Finished running node model.modelling_handson.dim_patients
[0m15:21:00.114129 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:00.114632 [debug] [MainThread]: On master: BEGIN
[0m15:21:00.114945 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:21:00.118994 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:21:00.119399 [debug] [MainThread]: On master: COMMIT
[0m15:21:00.119673 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:00.119999 [debug] [MainThread]: On master: COMMIT
[0m15:21:00.120891 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:21:00.121385 [debug] [MainThread]: On master: Close
[0m15:21:00.121812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:00.122064 [debug] [MainThread]: Connection 'model.modelling_handson.dim_patients' was properly closed.
[0m15:21:00.122414 [info ] [MainThread]: 
[0m15:21:00.122724 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m15:21:00.123602 [debug] [MainThread]: Command end result
[0m15:21:00.142837 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:21:00.144600 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:21:00.149879 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m15:21:00.150250 [info ] [MainThread]: 
[0m15:21:00.150611 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:21:00.150890 [info ] [MainThread]: 
[0m15:21:00.151178 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m15:21:00.151627 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:21:00.152567 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6122767, "process_in_blocks": "5448", "process_kernel_time": 0.230618, "process_mem_max_rss": "130000", "process_out_blocks": "2824", "process_user_time": 2.570974}
[0m15:21:00.152981 [debug] [MainThread]: Command `dbt run` succeeded at 15:21:00.152900 after 1.61 seconds
[0m15:21:00.153291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e1a96ef490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e1a96ecdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e1addbc610>]}
[0m15:21:00.153616 [debug] [MainThread]: Flushing usage events
[0m15:21:03.240146 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:24:10.566057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7021b68a8f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7021b69d8210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7021b69d8b90>]}


============================== 15:24:10.568253 | 815a97ec-521f-4f0b-a070-fabab8b0af4a ==============================
[0m15:24:10.568253 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:24:10.568642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'version_check': 'True', 'profiles_dir': '/home/subhan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:24:10.569493 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 39, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:24:10.569838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '815a97ec-521f-4f0b-a070-fabab8b0af4a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7021b68a1cd0>]}
[0m15:24:10.646730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '815a97ec-521f-4f0b-a070-fabab8b0af4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7021b6903010>]}
[0m15:24:10.653578 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:24:10.654151 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.124539845, "process_in_blocks": "0", "process_kernel_time": 0.158974, "process_mem_max_rss": "104780", "process_out_blocks": "16", "process_user_time": 1.161395}
[0m15:24:10.654421 [debug] [MainThread]: Command `dbt clean` succeeded at 15:24:10.654370 after 0.12 seconds
[0m15:24:10.654652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7021b69006d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7021b6a6c210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7021baf9d050>]}
[0m15:24:10.654868 [debug] [MainThread]: Flushing usage events
[0m15:24:11.765710 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:24:14.956701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aa8a8b4a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aa8a8b4510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aa8a8b5110>]}


============================== 15:24:14.958962 | acdaf038-15bb-4663-93eb-3aa6f30d7139 ==============================
[0m15:24:14.958962 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:24:14.959368 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/subhan/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:24:14.960177 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 39, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:24:14.960529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'acdaf038-15bb-4663-93eb-3aa6f30d7139', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aa8a92bbd0>]}
[0m15:24:15.046256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acdaf038-15bb-4663-93eb-3aa6f30d7139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aa8a90d710>]}
[0m15:24:15.054347 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:24:15.055166 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:24:15.055630 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:24:15.056380 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.14138333, "process_in_blocks": "0", "process_kernel_time": 0.134085, "process_mem_max_rss": "104368", "process_out_blocks": "8", "process_user_time": 1.231911}
[0m15:24:15.056754 [debug] [MainThread]: Command `dbt deps` succeeded at 15:24:15.056678 after 0.14 seconds
[0m15:24:15.057016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aa8a92b990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aa8a8b6990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aa8ef5d050>]}
[0m15:24:15.057321 [debug] [MainThread]: Flushing usage events
[0m15:24:16.108324 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:24:19.532033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737cdd707590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737cdaa91110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737cdaaf1050>]}


============================== 15:24:19.534532 | 48032407-dae5-4a3f-a509-d6b3538bbf27 ==============================
[0m15:24:19.534532 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:24:19.534968 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/subhan/.dbt', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:24:19.572840 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 39, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:24:19.573363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '48032407-dae5-4a3f-a509-d6b3538bbf27', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737cda576910>]}
[0m15:24:19.662452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48032407-dae5-4a3f-a509-d6b3538bbf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737cda1625d0>]}
[0m15:24:19.715254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48032407-dae5-4a3f-a509-d6b3538bbf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737cdd740f90>]}
[0m15:24:19.716003 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:24:19.769382 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m15:24:19.769942 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:24:19.770249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '48032407-dae5-4a3f-a509-d6b3538bbf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737cdaaf1e90>]}
[0m15:24:20.679882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48032407-dae5-4a3f-a509-d6b3538bbf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737cd8d595d0>]}
[0m15:24:20.739248 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:24:20.740659 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:24:20.749728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48032407-dae5-4a3f-a509-d6b3538bbf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737cd46e7fd0>]}
[0m15:24:20.750226 [info ] [MainThread]: Found 6 models, 6 seeds, 3 sources, 435 macros
[0m15:24:20.750525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48032407-dae5-4a3f-a509-d6b3538bbf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737cda127150>]}
[0m15:24:20.752262 [info ] [MainThread]: 
[0m15:24:20.752767 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:24:20.753219 [info ] [MainThread]: 
[0m15:24:20.753672 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:24:20.757696 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb'
[0m15:24:20.782580 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m15:24:20.782953 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m15:24:20.783163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:20.788046 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m15:24:20.789127 [debug] [ThreadPool]: On list_salesdb: Close
[0m15:24:20.790793 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb, now list_salesdb_public)
[0m15:24:20.795038 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public"
[0m15:24:20.795608 [debug] [ThreadPool]: On list_salesdb_public: BEGIN
[0m15:24:20.795982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:24:20.799658 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:24:20.800012 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public"
[0m15:24:20.800248 [debug] [ThreadPool]: On list_salesdb_public: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:24:20.802259 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m15:24:20.803338 [debug] [ThreadPool]: On list_salesdb_public: ROLLBACK
[0m15:24:20.803954 [debug] [ThreadPool]: On list_salesdb_public: Close
[0m15:24:20.804516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_public, now list_salesdb_public_raw_data)
[0m15:24:20.806807 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:24:20.807144 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m15:24:20.807367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:24:20.810797 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:24:20.811233 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:24:20.811597 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m15:24:20.813879 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m15:24:20.815017 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m15:24:20.815701 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m15:24:20.820917 [debug] [MainThread]: Using postgres connection "master"
[0m15:24:20.821361 [debug] [MainThread]: On master: BEGIN
[0m15:24:20.821600 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:24:20.824982 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:24:20.825386 [debug] [MainThread]: Using postgres connection "master"
[0m15:24:20.825663 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:24:20.833716 [debug] [MainThread]: SQL status: SELECT 3 in 0.008 seconds
[0m15:24:20.835134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48032407-dae5-4a3f-a509-d6b3538bbf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737cda1f8750>]}
[0m15:24:20.835534 [debug] [MainThread]: On master: ROLLBACK
[0m15:24:20.836156 [debug] [MainThread]: Using postgres connection "master"
[0m15:24:20.836455 [debug] [MainThread]: On master: BEGIN
[0m15:24:20.837041 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:24:20.837330 [debug] [MainThread]: On master: COMMIT
[0m15:24:20.837556 [debug] [MainThread]: Using postgres connection "master"
[0m15:24:20.837765 [debug] [MainThread]: On master: COMMIT
[0m15:24:20.838279 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:24:20.838576 [debug] [MainThread]: On master: Close
[0m15:24:20.840728 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_departments
[0m15:24:20.841164 [info ] [Thread-1 (]: 1 of 5 START sql view model public.stg_departments ............................. [RUN]
[0m15:24:20.841661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now model.modelling_handson.stg_departments)
[0m15:24:20.841932 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_departments
[0m15:24:20.847437 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_departments"
[0m15:24:20.848484 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_departments
[0m15:24:20.878234 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_departments"
[0m15:24:20.879540 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:24:20.879875 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: BEGIN
[0m15:24:20.880119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:20.884055 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:24:20.884478 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:24:20.884757 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */

  create view "salesdb"."public"."stg_departments__dbt_tmp"
    
    
  as (
    select
    id as department_id,
    name as department_name
FROM "salesdb"."public_raw_data"."departments"
  );
[0m15:24:20.886468 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:24:20.891716 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:24:20.892139 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */
alter table "salesdb"."public"."stg_departments" rename to "stg_departments__dbt_backup"
[0m15:24:20.893174 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:24:20.896288 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:24:20.896634 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */
alter table "salesdb"."public"."stg_departments__dbt_tmp" rename to "stg_departments"
[0m15:24:20.897442 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:24:20.910365 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: COMMIT
[0m15:24:20.910837 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:24:20.911174 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: COMMIT
[0m15:24:20.913275 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:24:20.919784 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."public"."stg_departments__dbt_backup"
[0m15:24:20.924323 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:24:20.924703 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */
drop view if exists "salesdb"."public"."stg_departments__dbt_backup" cascade
[0m15:24:20.926411 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:24:20.928320 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: Close
[0m15:24:20.929830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48032407-dae5-4a3f-a509-d6b3538bbf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737cd4302e50>]}
[0m15:24:20.930391 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.stg_departments ........................ [[32mCREATE VIEW[0m in 0.09s]
[0m15:24:20.930878 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_departments
[0m15:24:20.931212 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_doctors
[0m15:24:20.931717 [info ] [Thread-1 (]: 2 of 5 START sql view model public.stg_doctors ................................. [RUN]
[0m15:24:20.932111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_departments, now model.modelling_handson.stg_doctors)
[0m15:24:20.932510 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_doctors
[0m15:24:20.934895 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_doctors"
[0m15:24:20.935818 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_doctors
[0m15:24:20.938626 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_doctors"
[0m15:24:20.939252 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:24:20.939581 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: BEGIN
[0m15:24:20.939854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:20.943594 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:24:20.944026 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:24:20.944321 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */

  create view "salesdb"."public"."stg_doctors__dbt_tmp"
    
    
  as (
    select
    id as doctor_id,
    name,
    specialization,
    department_id
FROM "salesdb"."public_raw_data"."doctors"
  );
[0m15:24:20.946488 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:24:20.949332 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:24:20.949725 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */
alter table "salesdb"."public"."stg_doctors" rename to "stg_doctors__dbt_backup"
[0m15:24:20.950713 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:24:20.953074 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:24:20.953463 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */
alter table "salesdb"."public"."stg_doctors__dbt_tmp" rename to "stg_doctors"
[0m15:24:20.954333 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:24:20.955427 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: COMMIT
[0m15:24:20.955755 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:24:20.956043 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: COMMIT
[0m15:24:20.957199 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:24:20.959352 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."public"."stg_doctors__dbt_backup"
[0m15:24:20.959902 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:24:20.960204 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */
drop view if exists "salesdb"."public"."stg_doctors__dbt_backup" cascade
[0m15:24:20.961753 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:24:20.962849 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: Close
[0m15:24:20.963390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48032407-dae5-4a3f-a509-d6b3538bbf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737cd4328710>]}
[0m15:24:20.963941 [info ] [Thread-1 (]: 2 of 5 OK created sql view model public.stg_doctors ............................ [[32mCREATE VIEW[0m in 0.03s]
[0m15:24:20.964429 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_doctors
[0m15:24:20.964757 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_patients
[0m15:24:20.965419 [info ] [Thread-1 (]: 3 of 5 START sql view model public.stg_patients ................................ [RUN]
[0m15:24:20.966094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_doctors, now model.modelling_handson.stg_patients)
[0m15:24:20.966416 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_patients
[0m15:24:20.968577 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_patients"
[0m15:24:20.969303 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_patients
[0m15:24:20.971823 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_patients"
[0m15:24:20.972368 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:24:20.972654 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: BEGIN
[0m15:24:20.972898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:20.977353 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:24:20.977786 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:24:20.978035 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */

  create view "salesdb"."public"."stg_patients__dbt_tmp"
    
    
  as (
    select
id as patient_id,
name,
gender,
dob,
city
FROM "salesdb"."public_raw_data"."patients"
  );
[0m15:24:20.979722 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:24:20.983687 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:24:20.984122 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */
alter table "salesdb"."public"."stg_patients" rename to "stg_patients__dbt_backup"
[0m15:24:20.985112 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:24:20.988085 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:24:20.988479 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */
alter table "salesdb"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m15:24:20.989529 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:24:20.991263 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: COMMIT
[0m15:24:20.991631 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:24:20.991922 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: COMMIT
[0m15:24:20.993348 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:24:20.995196 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."public"."stg_patients__dbt_backup"
[0m15:24:20.996020 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:24:20.996343 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */
drop view if exists "salesdb"."public"."stg_patients__dbt_backup" cascade
[0m15:24:20.998296 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:24:20.999428 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: Close
[0m15:24:21.000236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48032407-dae5-4a3f-a509-d6b3538bbf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737cd4266f90>]}
[0m15:24:21.000804 [info ] [Thread-1 (]: 3 of 5 OK created sql view model public.stg_patients ........................... [[32mCREATE VIEW[0m in 0.03s]
[0m15:24:21.001305 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_patients
[0m15:24:21.001671 [debug] [Thread-1 (]: Began running node model.modelling_handson.dim_doctors
[0m15:24:21.002383 [info ] [Thread-1 (]: 4 of 5 START sql table model public.dim_doctors ................................ [RUN]
[0m15:24:21.002894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_patients, now model.modelling_handson.dim_doctors)
[0m15:24:21.003222 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.dim_doctors
[0m15:24:21.005666 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.dim_doctors"
[0m15:24:21.006448 [debug] [Thread-1 (]: Began executing node model.modelling_handson.dim_doctors
[0m15:24:21.024120 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.dim_doctors"
[0m15:24:21.025107 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:24:21.025499 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: BEGIN
[0m15:24:21.025750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:21.029676 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:24:21.030093 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:24:21.030361 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */

  
    

  create  table "salesdb"."public"."dim_doctors__dbt_tmp"
  
  
    as
  
  (
    select d.*, dep.department_name
from "salesdb"."public"."stg_doctors" d
left join "salesdb"."public"."stg_departments" dep
on d.department_id = dep.department_id
  );
  
[0m15:24:21.033622 [debug] [Thread-1 (]: SQL status: SELECT 50 in 0.003 seconds
[0m15:24:21.039693 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:24:21.040125 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */
alter table "salesdb"."public"."dim_doctors" rename to "dim_doctors__dbt_backup"
[0m15:24:21.041074 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:24:21.043400 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:24:21.043728 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */
alter table "salesdb"."public"."dim_doctors__dbt_tmp" rename to "dim_doctors"
[0m15:24:21.044401 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:24:21.045500 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: COMMIT
[0m15:24:21.045830 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:24:21.046121 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: COMMIT
[0m15:24:21.047266 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:24:21.049083 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."public"."dim_doctors__dbt_backup"
[0m15:24:21.052144 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:24:21.052521 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */
drop table if exists "salesdb"."public"."dim_doctors__dbt_backup" cascade
[0m15:24:21.054720 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:24:21.055839 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: Close
[0m15:24:21.056565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48032407-dae5-4a3f-a509-d6b3538bbf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737cd42e63d0>]}
[0m15:24:21.057317 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.dim_doctors ........................... [[32mSELECT 50[0m in 0.05s]
[0m15:24:21.057812 [debug] [Thread-1 (]: Finished running node model.modelling_handson.dim_doctors
[0m15:24:21.058145 [debug] [Thread-1 (]: Began running node model.modelling_handson.dim_patients
[0m15:24:21.058701 [info ] [Thread-1 (]: 5 of 5 START sql table model public.dim_patients ............................... [RUN]
[0m15:24:21.059163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.dim_doctors, now model.modelling_handson.dim_patients)
[0m15:24:21.059457 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.dim_patients
[0m15:24:21.061794 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.dim_patients"
[0m15:24:21.062399 [debug] [Thread-1 (]: Began executing node model.modelling_handson.dim_patients
[0m15:24:21.064920 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.dim_patients"
[0m15:24:21.065517 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:24:21.065834 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: BEGIN
[0m15:24:21.066093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:21.069808 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:24:21.070225 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:24:21.070502 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */

  
    

  create  table "salesdb"."public"."dim_patients__dbt_tmp"
  
  
    as
  
  (
    select * from "salesdb"."public"."stg_patients"
  );
  
[0m15:24:21.073817 [debug] [Thread-1 (]: SQL status: SELECT 200 in 0.003 seconds
[0m15:24:21.077911 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:24:21.078349 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */
alter table "salesdb"."public"."dim_patients" rename to "dim_patients__dbt_backup"
[0m15:24:21.079272 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:24:21.081480 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:24:21.081813 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */
alter table "salesdb"."public"."dim_patients__dbt_tmp" rename to "dim_patients"
[0m15:24:21.082493 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:24:21.083623 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: COMMIT
[0m15:24:21.083940 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:24:21.084229 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: COMMIT
[0m15:24:21.085500 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:24:21.087154 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."public"."dim_patients__dbt_backup"
[0m15:24:21.087602 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:24:21.087883 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */
drop table if exists "salesdb"."public"."dim_patients__dbt_backup" cascade
[0m15:24:21.089385 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:24:21.090407 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: Close
[0m15:24:21.090923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48032407-dae5-4a3f-a509-d6b3538bbf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737cd44c3210>]}
[0m15:24:21.091403 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.dim_patients .......................... [[32mSELECT 200[0m in 0.03s]
[0m15:24:21.091839 [debug] [Thread-1 (]: Finished running node model.modelling_handson.dim_patients
[0m15:24:21.093201 [debug] [MainThread]: Using postgres connection "master"
[0m15:24:21.093514 [debug] [MainThread]: On master: BEGIN
[0m15:24:21.093737 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:24:21.096947 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:24:21.097309 [debug] [MainThread]: On master: COMMIT
[0m15:24:21.097569 [debug] [MainThread]: Using postgres connection "master"
[0m15:24:21.097790 [debug] [MainThread]: On master: COMMIT
[0m15:24:21.098255 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:24:21.098571 [debug] [MainThread]: On master: Close
[0m15:24:21.098951 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:24:21.099176 [debug] [MainThread]: Connection 'model.modelling_handson.dim_patients' was properly closed.
[0m15:24:21.099499 [info ] [MainThread]: 
[0m15:24:21.099781 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m15:24:21.100585 [debug] [MainThread]: Command end result
[0m15:24:21.118459 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:24:21.119997 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:24:21.124944 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m15:24:21.125394 [info ] [MainThread]: 
[0m15:24:21.125769 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:24:21.126133 [info ] [MainThread]: 
[0m15:24:21.126674 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m15:24:21.127155 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:24:21.128097 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6396942, "process_in_blocks": "0", "process_kernel_time": 0.19184, "process_mem_max_rss": "130540", "process_out_blocks": "2824", "process_user_time": 2.690034}
[0m15:24:21.128964 [debug] [MainThread]: Command `dbt run` succeeded at 15:24:21.128829 after 1.64 seconds
[0m15:24:21.129374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737cdad66e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737cdf19cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737cdf19cdd0>]}
[0m15:24:21.129723 [debug] [MainThread]: Flushing usage events
[0m15:24:22.444312 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:29:01.859400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97ecfa15d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97ed164490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97ed353d50>]}


============================== 15:29:01.862933 | 1834e0f8-15a4-48af-894c-e288afdbb6aa ==============================
[0m15:29:01.862933 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:29:01.863426 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/subhan/.dbt', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:29:01.864333 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 39, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:29:01.864704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1834e0f8-15a4-48af-894c-e288afdbb6aa', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97ecff7dd0>]}
[0m15:29:01.956477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1834e0f8-15a4-48af-894c-e288afdbb6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97ed1641d0>]}
[0m15:29:01.970053 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:29:01.971780 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1567199, "process_in_blocks": "88712", "process_kernel_time": 0.278901, "process_mem_max_rss": "104360", "process_out_blocks": "16", "process_user_time": 1.30154}
[0m15:29:01.972347 [debug] [MainThread]: Command `dbt clean` succeeded at 15:29:01.972261 after 0.16 seconds
[0m15:29:01.972588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97ecfa0f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97ed0cbb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97ed26ef10>]}
[0m15:29:01.972829 [debug] [MainThread]: Flushing usage events
[0m15:29:02.980111 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:29:07.827171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f566b1a1c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f566b198910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f566b1a0310>]}


============================== 15:29:07.830062 | 78964467-4e50-498d-a909-4d93f2ca2db0 ==============================
[0m15:29:07.830062 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:29:07.830545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/subhan/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:29:07.897002 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 39, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:29:07.897496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '78964467-4e50-498d-a909-4d93f2ca2db0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f566b1f9a50>]}
[0m15:29:07.982816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78964467-4e50-498d-a909-4d93f2ca2db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f566ab6e710>]}
[0m15:29:08.030195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78964467-4e50-498d-a909-4d93f2ca2db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f566ddd5850>]}
[0m15:29:08.031412 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:29:08.089792 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m15:29:08.090375 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:29:08.090743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '78964467-4e50-498d-a909-4d93f2ca2db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f566b1f9a10>]}
[0m15:29:08.961029 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.modelling_handson.dim_patients' (models/marts/dim_patients.sql) depends on a source named 'public_raw_data.stg_patients' which was not found
[0m15:29:08.961608 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:29:08.962466 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1778492, "process_in_blocks": "13016", "process_kernel_time": 0.197106, "process_mem_max_rss": "118660", "process_out_blocks": "8", "process_user_time": 2.226884}
[0m15:29:08.962901 [debug] [MainThread]: Command `dbt run` failed at 15:29:08.962813 after 1.18 seconds
[0m15:29:08.963324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f566b1a1e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f566b1a0850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56697b7cd0>]}
[0m15:29:08.963660 [debug] [MainThread]: Flushing usage events
[0m15:29:10.003982 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:31:44.191984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a1a90659d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a1a905ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a1a941c190>]}


============================== 15:31:44.195839 | 4c10455e-1478-489e-8a12-fafe997804d7 ==============================
[0m15:31:44.195839 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:31:44.196341 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/subhan/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m15:31:44.197374 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 39, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:31:44.197763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4c10455e-1478-489e-8a12-fafe997804d7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a1a90e3f90>]}
[0m15:31:44.300079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c10455e-1478-489e-8a12-fafe997804d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a1a8f42e10>]}
[0m15:31:44.315386 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:31:44.316758 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17286065, "process_in_blocks": "88752", "process_kernel_time": 0.234387, "process_mem_max_rss": "103896", "process_out_blocks": "16", "process_user_time": 1.352868}
[0m15:31:44.317163 [debug] [MainThread]: Command `dbt clean` succeeded at 15:31:44.317072 after 0.17 seconds
[0m15:31:44.317426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a1a9066990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a1a9065b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a1ad6b9090>]}
[0m15:31:44.317687 [debug] [MainThread]: Flushing usage events
[0m15:31:45.537312 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:31:48.617189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d54715a8510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d54715a80d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d54715a81d0>]}


============================== 15:31:48.619760 | b4b73875-a284-4675-b1e3-399a2522586b ==============================
[0m15:31:48.619760 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:31:48.620215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/subhan/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:31:48.689244 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 39, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:31:48.689764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b4b73875-a284-4675-b1e3-399a2522586b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5471600690>]}
[0m15:31:48.777559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4b73875-a284-4675-b1e3-399a2522586b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d54713df490>]}
[0m15:31:48.825481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4b73875-a284-4675-b1e3-399a2522586b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5470ff9250>]}
[0m15:31:48.827094 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:31:48.880758 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m15:31:48.881464 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:31:48.881877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b4b73875-a284-4675-b1e3-399a2522586b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5470b166d0>]}
[0m15:31:49.777460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4b73875-a284-4675-b1e3-399a2522586b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d546ff7a590>]}
[0m15:31:49.831424 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:31:49.833895 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:31:49.844781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4b73875-a284-4675-b1e3-399a2522586b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d546f30bfd0>]}
[0m15:31:49.845236 [info ] [MainThread]: Found 6 models, 6 seeds, 3 sources, 435 macros
[0m15:31:49.845526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4b73875-a284-4675-b1e3-399a2522586b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d546fb27b10>]}
[0m15:31:49.846865 [info ] [MainThread]: 
[0m15:31:49.847220 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:31:49.847457 [info ] [MainThread]: 
[0m15:31:49.847860 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:31:49.852040 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb'
[0m15:31:49.880561 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m15:31:49.880938 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m15:31:49.881269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:49.892521 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m15:31:49.893708 [debug] [ThreadPool]: On list_salesdb: Close
[0m15:31:49.895420 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb, now list_salesdb_public)
[0m15:31:49.899669 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public"
[0m15:31:49.899989 [debug] [ThreadPool]: On list_salesdb_public: BEGIN
[0m15:31:49.900215 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:31:49.903655 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:31:49.903986 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public"
[0m15:31:49.904219 [debug] [ThreadPool]: On list_salesdb_public: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:31:49.906170 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m15:31:49.907199 [debug] [ThreadPool]: On list_salesdb_public: ROLLBACK
[0m15:31:49.907713 [debug] [ThreadPool]: On list_salesdb_public: Close
[0m15:31:49.908231 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_public, now list_salesdb_public_raw_data)
[0m15:31:49.910226 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:31:49.910510 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m15:31:49.910743 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:31:49.913664 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:31:49.913949 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:31:49.914175 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m15:31:49.916165 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m15:31:49.917163 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m15:31:49.917937 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m15:31:49.922070 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:49.922373 [debug] [MainThread]: On master: BEGIN
[0m15:31:49.922585 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:31:49.925757 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:31:49.926049 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:49.926321 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:31:49.933886 [debug] [MainThread]: SQL status: SELECT 3 in 0.007 seconds
[0m15:31:49.935278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4b73875-a284-4675-b1e3-399a2522586b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d546634d610>]}
[0m15:31:49.935639 [debug] [MainThread]: On master: ROLLBACK
[0m15:31:49.936292 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:49.936662 [debug] [MainThread]: On master: BEGIN
[0m15:31:49.937479 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:31:49.937752 [debug] [MainThread]: On master: COMMIT
[0m15:31:49.937970 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:49.938165 [debug] [MainThread]: On master: COMMIT
[0m15:31:49.938744 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:31:49.939027 [debug] [MainThread]: On master: Close
[0m15:31:49.942023 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_departments
[0m15:31:49.942527 [info ] [Thread-1 (]: 1 of 5 START sql view model public.stg_departments ............................. [RUN]
[0m15:31:49.942926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now model.modelling_handson.stg_departments)
[0m15:31:49.943183 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_departments
[0m15:31:49.948494 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_departments"
[0m15:31:49.950899 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_departments
[0m15:31:49.975475 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_departments"
[0m15:31:49.976935 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:31:49.977324 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: BEGIN
[0m15:31:49.977576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:49.981575 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:31:49.982291 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:31:49.982971 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */

  create view "salesdb"."public"."stg_departments__dbt_tmp"
    
    
  as (
    select
    id as department_id,
    name as department_name
FROM "salesdb"."public_raw_data"."departments"
  );
[0m15:31:49.985898 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:31:49.990788 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:31:49.991211 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */
alter table "salesdb"."public"."stg_departments" rename to "stg_departments__dbt_backup"
[0m15:31:49.992517 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:31:49.995688 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:31:49.996113 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */
alter table "salesdb"."public"."stg_departments__dbt_tmp" rename to "stg_departments"
[0m15:31:49.997004 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:31:50.013787 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: COMMIT
[0m15:31:50.014264 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:31:50.014545 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: COMMIT
[0m15:31:50.016040 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:31:50.021695 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."public"."stg_departments__dbt_backup"
[0m15:31:50.026466 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:31:50.026862 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */
drop view if exists "salesdb"."public"."stg_departments__dbt_backup" cascade
[0m15:31:50.028494 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:31:50.030397 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: Close
[0m15:31:50.032153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4b73875-a284-4675-b1e3-399a2522586b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d54664f2b50>]}
[0m15:31:50.032913 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.stg_departments ........................ [[32mCREATE VIEW[0m in 0.09s]
[0m15:31:50.033430 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_departments
[0m15:31:50.033759 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_doctors
[0m15:31:50.034367 [info ] [Thread-1 (]: 2 of 5 START sql view model public.stg_doctors ................................. [RUN]
[0m15:31:50.034798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_departments, now model.modelling_handson.stg_doctors)
[0m15:31:50.035084 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_doctors
[0m15:31:50.037394 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_doctors"
[0m15:31:50.037950 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_doctors
[0m15:31:50.040331 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_doctors"
[0m15:31:50.040816 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:31:50.041107 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: BEGIN
[0m15:31:50.041455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:50.045616 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:31:50.046007 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:31:50.046282 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */

  create view "salesdb"."public"."stg_doctors__dbt_tmp"
    
    
  as (
    select
    id as doctor_id,
    name,
    specialization,
    department_id
FROM "salesdb"."public_raw_data"."doctors"
  );
[0m15:31:50.048145 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:31:50.050812 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:31:50.051193 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */
alter table "salesdb"."public"."stg_doctors" rename to "stg_doctors__dbt_backup"
[0m15:31:50.051956 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:31:50.054364 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:31:50.054764 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */
alter table "salesdb"."public"."stg_doctors__dbt_tmp" rename to "stg_doctors"
[0m15:31:50.055530 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:31:50.056528 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: COMMIT
[0m15:31:50.056869 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:31:50.057212 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: COMMIT
[0m15:31:50.058795 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:31:50.060827 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."public"."stg_doctors__dbt_backup"
[0m15:31:50.061526 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:31:50.061835 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */
drop view if exists "salesdb"."public"."stg_doctors__dbt_backup" cascade
[0m15:31:50.063470 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:31:50.064897 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: Close
[0m15:31:50.065841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4b73875-a284-4675-b1e3-399a2522586b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d54664e2010>]}
[0m15:31:50.066441 [info ] [Thread-1 (]: 2 of 5 OK created sql view model public.stg_doctors ............................ [[32mCREATE VIEW[0m in 0.03s]
[0m15:31:50.066910 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_doctors
[0m15:31:50.067255 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_patients
[0m15:31:50.067781 [info ] [Thread-1 (]: 3 of 5 START sql view model public.stg_patients ................................ [RUN]
[0m15:31:50.068367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_doctors, now model.modelling_handson.stg_patients)
[0m15:31:50.068732 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_patients
[0m15:31:50.071003 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_patients"
[0m15:31:50.071560 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_patients
[0m15:31:50.074262 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_patients"
[0m15:31:50.074850 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:31:50.075136 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: BEGIN
[0m15:31:50.075381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:50.079179 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:31:50.079591 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:31:50.079862 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */

  create view "salesdb"."public"."stg_patients__dbt_tmp"
    
    
  as (
    select
id as patient_id,
name,
gender,
dob,
city
FROM "salesdb"."public_raw_data"."patients"
  );
[0m15:31:50.081640 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:31:50.085687 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:31:50.086080 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */
alter table "salesdb"."public"."stg_patients" rename to "stg_patients__dbt_backup"
[0m15:31:50.087301 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:31:50.089465 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:31:50.089834 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */
alter table "salesdb"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m15:31:50.090594 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:31:50.091843 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: COMMIT
[0m15:31:50.092201 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:31:50.092508 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: COMMIT
[0m15:31:50.094272 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:31:50.096342 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."public"."stg_patients__dbt_backup"
[0m15:31:50.097009 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:31:50.097379 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */
drop view if exists "salesdb"."public"."stg_patients__dbt_backup" cascade
[0m15:31:50.099354 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:31:50.100477 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: Close
[0m15:31:50.101102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4b73875-a284-4675-b1e3-399a2522586b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5464a86590>]}
[0m15:31:50.101652 [info ] [Thread-1 (]: 3 of 5 OK created sql view model public.stg_patients ........................... [[32mCREATE VIEW[0m in 0.03s]
[0m15:31:50.102139 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_patients
[0m15:31:50.102456 [debug] [Thread-1 (]: Began running node model.modelling_handson.dim_doctors
[0m15:31:50.102855 [info ] [Thread-1 (]: 4 of 5 START sql table model public.dim_doctors ................................ [RUN]
[0m15:31:50.103422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_patients, now model.modelling_handson.dim_doctors)
[0m15:31:50.104109 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.dim_doctors
[0m15:31:50.106548 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.dim_doctors"
[0m15:31:50.107208 [debug] [Thread-1 (]: Began executing node model.modelling_handson.dim_doctors
[0m15:31:50.127126 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.dim_doctors"
[0m15:31:50.128613 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:31:50.128990 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: BEGIN
[0m15:31:50.129338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:50.134026 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m15:31:50.134969 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:31:50.135613 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */

  
    

  create  table "salesdb"."public"."dim_doctors__dbt_tmp"
  
  
    as
  
  (
    select d.*, dep.department_name
from "salesdb"."public"."stg_doctors" d
left join "salesdb"."public"."stg_departments" dep
on d.department_id = dep.department_id
  );
  
[0m15:31:50.141307 [debug] [Thread-1 (]: SQL status: SELECT 50 in 0.005 seconds
[0m15:31:50.146962 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:31:50.147394 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */
alter table "salesdb"."public"."dim_doctors" rename to "dim_doctors__dbt_backup"
[0m15:31:50.148480 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:31:50.151136 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:31:50.151527 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */
alter table "salesdb"."public"."dim_doctors__dbt_tmp" rename to "dim_doctors"
[0m15:31:50.152408 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:31:50.153815 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: COMMIT
[0m15:31:50.154313 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:31:50.154612 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: COMMIT
[0m15:31:50.156049 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:31:50.158365 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."public"."dim_doctors__dbt_backup"
[0m15:31:50.163648 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:31:50.164915 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */
drop table if exists "salesdb"."public"."dim_doctors__dbt_backup" cascade
[0m15:31:50.167431 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:31:50.168629 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: Close
[0m15:31:50.169291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4b73875-a284-4675-b1e3-399a2522586b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d54664e84d0>]}
[0m15:31:50.169865 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.dim_doctors ........................... [[32mSELECT 50[0m in 0.07s]
[0m15:31:50.170423 [debug] [Thread-1 (]: Finished running node model.modelling_handson.dim_doctors
[0m15:31:50.170798 [debug] [Thread-1 (]: Began running node model.modelling_handson.dim_patients
[0m15:31:50.171311 [info ] [Thread-1 (]: 5 of 5 START sql table model public.dim_patients ............................... [RUN]
[0m15:31:50.171925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.dim_doctors, now model.modelling_handson.dim_patients)
[0m15:31:50.172466 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.dim_patients
[0m15:31:50.175008 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.dim_patients"
[0m15:31:50.175596 [debug] [Thread-1 (]: Began executing node model.modelling_handson.dim_patients
[0m15:31:50.179376 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.dim_patients"
[0m15:31:50.180275 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:31:50.180865 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: BEGIN
[0m15:31:50.181498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:50.186462 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m15:31:50.187156 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:31:50.187767 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */

  
    

  create  table "salesdb"."public"."dim_patients__dbt_tmp"
  
  
    as
  
  (
    select * from "salesdb"."public"."stg_patients"
  );
  
[0m15:31:50.191961 [debug] [Thread-1 (]: SQL status: SELECT 200 in 0.004 seconds
[0m15:31:50.197012 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:31:50.197623 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */
alter table "salesdb"."public"."dim_patients" rename to "dim_patients__dbt_backup"
[0m15:31:50.198882 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:31:50.201419 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:31:50.201819 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */
alter table "salesdb"."public"."dim_patients__dbt_tmp" rename to "dim_patients"
[0m15:31:50.202685 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:31:50.203973 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: COMMIT
[0m15:31:50.204366 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:31:50.204655 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: COMMIT
[0m15:31:50.209884 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m15:31:50.212017 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."public"."dim_patients__dbt_backup"
[0m15:31:50.212605 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:31:50.212921 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */
drop table if exists "salesdb"."public"."dim_patients__dbt_backup" cascade
[0m15:31:50.215162 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:31:50.216380 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: Close
[0m15:31:50.216950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4b73875-a284-4675-b1e3-399a2522586b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5464ac0210>]}
[0m15:31:50.217542 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.dim_patients .......................... [[32mSELECT 200[0m in 0.05s]
[0m15:31:50.218058 [debug] [Thread-1 (]: Finished running node model.modelling_handson.dim_patients
[0m15:31:50.220095 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:50.220447 [debug] [MainThread]: On master: BEGIN
[0m15:31:50.220707 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:31:50.224585 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:31:50.224962 [debug] [MainThread]: On master: COMMIT
[0m15:31:50.225279 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:50.225523 [debug] [MainThread]: On master: COMMIT
[0m15:31:50.226181 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:31:50.226470 [debug] [MainThread]: On master: Close
[0m15:31:50.226857 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:31:50.227100 [debug] [MainThread]: Connection 'model.modelling_handson.dim_patients' was properly closed.
[0m15:31:50.227465 [info ] [MainThread]: 
[0m15:31:50.227899 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m15:31:50.228791 [debug] [MainThread]: Command end result
[0m15:31:50.245640 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:31:50.247711 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:31:50.252796 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m15:31:50.253163 [info ] [MainThread]: 
[0m15:31:50.253523 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:31:50.253792 [info ] [MainThread]: 
[0m15:31:50.254193 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m15:31:50.254705 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:31:50.255850 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6824507, "process_in_blocks": "19560", "process_kernel_time": 0.136463, "process_mem_max_rss": "131528", "process_out_blocks": "2824", "process_user_time": 2.618397}
[0m15:31:50.256563 [debug] [MainThread]: Command `dbt run` succeeded at 15:31:50.256412 after 1.68 seconds
[0m15:31:50.257536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d54715d8f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d54715d9110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5471876f90>]}
[0m15:31:50.257877 [debug] [MainThread]: Flushing usage events
[0m15:31:51.539078 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:33:44.382435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e316c3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e31884490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e3198f290>]}


============================== 15:33:44.385816 | ac3ac5fe-3c85-4066-bd33-99b2734d8fbf ==============================
[0m15:33:44.385816 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:33:44.386255 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/subhan/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:33:44.387210 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:33:44.387589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ac3ac5fe-3c85-4066-bd33-99b2734d8fbf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e3198f190>]}
[0m15:33:44.480154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac3ac5fe-3c85-4066-bd33-99b2734d8fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e3160fbd0>]}
[0m15:33:44.493184 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:33:44.494449 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.15421161, "process_in_blocks": "89096", "process_kernel_time": 0.264351, "process_mem_max_rss": "104344", "process_out_blocks": "16", "process_user_time": 1.187546}
[0m15:33:44.494820 [debug] [MainThread]: Command `dbt clean` succeeded at 15:33:44.494753 after 0.15 seconds
[0m15:33:44.495095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e31884210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e35d7cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e35d7c610>]}
[0m15:33:44.495365 [debug] [MainThread]: Flushing usage events
[0m15:33:45.822383 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:33:53.286055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef98edb6610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef98ee0be10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef98edb63d0>]}


============================== 15:33:53.288612 | 98dd10bd-92a8-462b-a1fd-2973205873d6 ==============================
[0m15:33:53.288612 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:33:53.289158 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/subhan/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:33:53.357647 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:33:53.358150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '98dd10bd-92a8-462b-a1fd-2973205873d6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef98ec69bd0>]}
[0m15:33:53.447554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98dd10bd-92a8-462b-a1fd-2973205873d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef98ee2be90>]}
[0m15:33:53.495694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98dd10bd-92a8-462b-a1fd-2973205873d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef98e303c90>]}
[0m15:33:53.497443 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:33:53.549758 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m15:33:53.550285 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:33:53.550594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '98dd10bd-92a8-462b-a1fd-2973205873d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef98e7b7750>]}
[0m15:33:54.515630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98dd10bd-92a8-462b-a1fd-2973205873d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef98d7aad50>]}
[0m15:33:54.573253 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:33:54.575785 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:33:54.587848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98dd10bd-92a8-462b-a1fd-2973205873d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef98cb64d50>]}
[0m15:33:54.588356 [info ] [MainThread]: Found 6 models, 6 seeds, 3 sources, 435 macros
[0m15:33:54.588703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98dd10bd-92a8-462b-a1fd-2973205873d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef98d347150>]}
[0m15:33:54.590322 [info ] [MainThread]: 
[0m15:33:54.590680 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:33:54.590948 [info ] [MainThread]: 
[0m15:33:54.591352 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:33:54.595354 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb'
[0m15:33:54.626917 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m15:33:54.627334 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m15:33:54.628010 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:54.639337 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m15:33:54.640536 [debug] [ThreadPool]: On list_salesdb: Close
[0m15:33:54.642318 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb, now list_salesdb_public_raw_data)
[0m15:33:54.647006 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:33:54.647422 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m15:33:54.647683 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:54.650891 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:33:54.651290 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:33:54.651551 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m15:33:54.653890 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m15:33:54.655147 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m15:33:54.655710 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m15:33:54.660266 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:54.660661 [debug] [MainThread]: On master: BEGIN
[0m15:33:54.660905 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:33:54.664576 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:33:54.664898 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:54.665190 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:33:54.673224 [debug] [MainThread]: SQL status: SELECT 3 in 0.008 seconds
[0m15:33:54.675010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98dd10bd-92a8-462b-a1fd-2973205873d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef98d7dd350>]}
[0m15:33:54.675364 [debug] [MainThread]: On master: ROLLBACK
[0m15:33:54.675963 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:54.676234 [debug] [MainThread]: On master: BEGIN
[0m15:33:54.676878 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:33:54.677137 [debug] [MainThread]: On master: COMMIT
[0m15:33:54.677353 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:54.677553 [debug] [MainThread]: On master: COMMIT
[0m15:33:54.678043 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:33:54.678338 [debug] [MainThread]: On master: Close
[0m15:33:54.681402 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_departments
[0m15:33:54.681840 [info ] [Thread-1 (]: 1 of 5 START sql view model public_raw_data.stg_departments .................... [RUN]
[0m15:33:54.682234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now model.modelling_handson.stg_departments)
[0m15:33:54.682528 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_departments
[0m15:33:54.688020 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_departments"
[0m15:33:54.689194 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_departments
[0m15:33:54.717297 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_departments"
[0m15:33:54.718451 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:33:54.718784 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: BEGIN
[0m15:33:54.719037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:54.722654 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:33:54.723030 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:33:54.723326 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */

  create view "salesdb"."public_raw_data"."stg_departments__dbt_tmp"
    
    
  as (
    select
    id as department_id,
    name as department_name
FROM "salesdb"."public_raw_data"."departments"
  );
[0m15:33:54.725501 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:33:54.730091 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:33:54.730454 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */
alter table "salesdb"."public_raw_data"."stg_departments__dbt_tmp" rename to "stg_departments"
[0m15:33:54.731222 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:33:54.741703 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: COMMIT
[0m15:33:54.742188 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:33:54.742464 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: COMMIT
[0m15:33:54.743766 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:33:54.749543 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."public_raw_data"."stg_departments__dbt_backup"
[0m15:33:54.753812 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:33:54.754167 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */
drop view if exists "salesdb"."public_raw_data"."stg_departments__dbt_backup" cascade
[0m15:33:54.754985 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:33:54.757069 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: Close
[0m15:33:54.759537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98dd10bd-92a8-462b-a1fd-2973205873d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef98e72db90>]}
[0m15:33:54.760306 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public_raw_data.stg_departments ............... [[32mCREATE VIEW[0m in 0.08s]
[0m15:33:54.760830 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_departments
[0m15:33:54.761154 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_doctors
[0m15:33:54.761550 [info ] [Thread-1 (]: 2 of 5 START sql view model public_raw_data.stg_doctors ........................ [RUN]
[0m15:33:54.762160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_departments, now model.modelling_handson.stg_doctors)
[0m15:33:54.762459 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_doctors
[0m15:33:54.764586 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_doctors"
[0m15:33:54.765064 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_doctors
[0m15:33:54.767742 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_doctors"
[0m15:33:54.768323 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:33:54.768645 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: BEGIN
[0m15:33:54.768886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:54.772791 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:33:54.773203 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:33:54.773482 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */

  create view "salesdb"."public_raw_data"."stg_doctors__dbt_tmp"
    
    
  as (
    select
    id as doctor_id,
    name,
    specialization,
    department_id
FROM "salesdb"."public_raw_data"."doctors"
  );
[0m15:33:54.774945 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:33:54.777350 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:33:54.777722 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */
alter table "salesdb"."public_raw_data"."stg_doctors__dbt_tmp" rename to "stg_doctors"
[0m15:33:54.778453 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:33:54.779390 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: COMMIT
[0m15:33:54.779693 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:33:54.779936 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: COMMIT
[0m15:33:54.781202 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:33:54.782926 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."public_raw_data"."stg_doctors__dbt_backup"
[0m15:33:54.783398 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:33:54.783666 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */
drop view if exists "salesdb"."public_raw_data"."stg_doctors__dbt_backup" cascade
[0m15:33:54.784335 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:33:54.785523 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: Close
[0m15:33:54.786286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98dd10bd-92a8-462b-a1fd-2973205873d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef9846c0990>]}
[0m15:33:54.787084 [info ] [Thread-1 (]: 2 of 5 OK created sql view model public_raw_data.stg_doctors ................... [[32mCREATE VIEW[0m in 0.02s]
[0m15:33:54.787582 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_doctors
[0m15:33:54.787899 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_patients
[0m15:33:54.788379 [info ] [Thread-1 (]: 3 of 5 START sql view model public_raw_data.stg_patients ....................... [RUN]
[0m15:33:54.789039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_doctors, now model.modelling_handson.stg_patients)
[0m15:33:54.789347 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_patients
[0m15:33:54.791438 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_patients"
[0m15:33:54.791891 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_patients
[0m15:33:54.794384 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_patients"
[0m15:33:54.794889 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:33:54.795172 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: BEGIN
[0m15:33:54.795401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:54.798915 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m15:33:54.799280 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:33:54.799587 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */

  create view "salesdb"."public_raw_data"."stg_patients__dbt_tmp"
    
    
  as (
    select
id as patient_id,
name,
gender,
dob,
city
FROM "salesdb"."public_raw_data"."patients"
  );
[0m15:33:54.800971 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:33:54.803174 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:33:54.803496 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */
alter table "salesdb"."public_raw_data"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m15:33:54.804230 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:33:54.805289 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: COMMIT
[0m15:33:54.805681 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:33:54.805941 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: COMMIT
[0m15:33:54.808976 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:33:54.811438 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."public_raw_data"."stg_patients__dbt_backup"
[0m15:33:54.811979 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:33:54.812256 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */
drop view if exists "salesdb"."public_raw_data"."stg_patients__dbt_backup" cascade
[0m15:33:54.813066 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:33:54.814204 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: Close
[0m15:33:54.815083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98dd10bd-92a8-462b-a1fd-2973205873d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef9843f5090>]}
[0m15:33:54.815593 [info ] [Thread-1 (]: 3 of 5 OK created sql view model public_raw_data.stg_patients .................. [[32mCREATE VIEW[0m in 0.03s]
[0m15:33:54.816024 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_patients
[0m15:33:54.816347 [debug] [Thread-1 (]: Began running node model.modelling_handson.dim_doctors
[0m15:33:54.817030 [info ] [Thread-1 (]: 4 of 5 START sql table model public_raw_data.dim_doctors ....................... [RUN]
[0m15:33:54.817516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_patients, now model.modelling_handson.dim_doctors)
[0m15:33:54.817794 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.dim_doctors
[0m15:33:54.820108 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.dim_doctors"
[0m15:33:54.820853 [debug] [Thread-1 (]: Began executing node model.modelling_handson.dim_doctors
[0m15:33:54.842664 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.dim_doctors"
[0m15:33:54.843548 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:33:54.843882 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: BEGIN
[0m15:33:54.844140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:54.847868 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:33:54.848300 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:33:54.848622 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */

  
    

  create  table "salesdb"."public_raw_data"."dim_doctors__dbt_tmp"
  
  
    as
  
  (
    select d.*, dep.department_name
from "salesdb"."public_raw_data"."stg_doctors" d
left join "salesdb"."public_raw_data"."stg_departments" dep
on d.department_id = dep.department_id
  );
  
[0m15:33:54.852351 [debug] [Thread-1 (]: SQL status: SELECT 50 in 0.003 seconds
[0m15:33:54.857358 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:33:54.857726 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */
alter table "salesdb"."public_raw_data"."dim_doctors__dbt_tmp" rename to "dim_doctors"
[0m15:33:54.858533 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:33:54.859519 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: COMMIT
[0m15:33:54.859870 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:33:54.860172 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: COMMIT
[0m15:33:54.861845 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:33:54.863647 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."public_raw_data"."dim_doctors__dbt_backup"
[0m15:33:54.866329 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:33:54.866676 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */
drop table if exists "salesdb"."public_raw_data"."dim_doctors__dbt_backup" cascade
[0m15:33:54.867428 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m15:33:54.868885 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: Close
[0m15:33:54.869659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98dd10bd-92a8-462b-a1fd-2973205873d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef98d73da90>]}
[0m15:33:54.870220 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_raw_data.dim_doctors .................. [[32mSELECT 50[0m in 0.05s]
[0m15:33:54.870697 [debug] [Thread-1 (]: Finished running node model.modelling_handson.dim_doctors
[0m15:33:54.871034 [debug] [Thread-1 (]: Began running node model.modelling_handson.dim_patients
[0m15:33:54.871414 [info ] [Thread-1 (]: 5 of 5 START sql table model public_raw_data.dim_patients ...................... [RUN]
[0m15:33:54.871852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.dim_doctors, now model.modelling_handson.dim_patients)
[0m15:33:54.872155 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.dim_patients
[0m15:33:54.874951 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.dim_patients"
[0m15:33:54.875648 [debug] [Thread-1 (]: Began executing node model.modelling_handson.dim_patients
[0m15:33:54.878243 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.dim_patients"
[0m15:33:54.878759 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:33:54.879096 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: BEGIN
[0m15:33:54.879372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:54.884412 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m15:33:54.884943 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:33:54.885250 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */

  
    

  create  table "salesdb"."public_raw_data"."dim_patients__dbt_tmp"
  
  
    as
  
  (
    select * from "salesdb"."public_raw_data"."stg_patients"
  );
  
[0m15:33:54.890017 [debug] [Thread-1 (]: SQL status: SELECT 200 in 0.004 seconds
[0m15:33:54.893142 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:33:54.893525 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */
alter table "salesdb"."public_raw_data"."dim_patients__dbt_tmp" rename to "dim_patients"
[0m15:33:54.894425 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:33:54.895440 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: COMMIT
[0m15:33:54.895783 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:33:54.896080 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: COMMIT
[0m15:33:54.897249 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:33:54.899117 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."public_raw_data"."dim_patients__dbt_backup"
[0m15:33:54.899712 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:33:54.900018 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */
drop table if exists "salesdb"."public_raw_data"."dim_patients__dbt_backup" cascade
[0m15:33:54.900701 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m15:33:54.901781 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: Close
[0m15:33:54.902337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98dd10bd-92a8-462b-a1fd-2973205873d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef984627ad0>]}
[0m15:33:54.902875 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public_raw_data.dim_patients ................. [[32mSELECT 200[0m in 0.03s]
[0m15:33:54.903353 [debug] [Thread-1 (]: Finished running node model.modelling_handson.dim_patients
[0m15:33:54.905149 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:54.905479 [debug] [MainThread]: On master: BEGIN
[0m15:33:54.905732 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:33:54.909484 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:33:54.909825 [debug] [MainThread]: On master: COMMIT
[0m15:33:54.910077 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:54.910305 [debug] [MainThread]: On master: COMMIT
[0m15:33:54.910794 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:33:54.911120 [debug] [MainThread]: On master: Close
[0m15:33:54.911510 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:54.911777 [debug] [MainThread]: Connection 'model.modelling_handson.dim_patients' was properly closed.
[0m15:33:54.912126 [info ] [MainThread]: 
[0m15:33:54.912448 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m15:33:54.913420 [debug] [MainThread]: Command end result
[0m15:33:54.930930 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:33:54.933062 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:33:54.938389 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m15:33:54.938793 [info ] [MainThread]: 
[0m15:33:54.939306 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:33:54.939642 [info ] [MainThread]: 
[0m15:33:54.939936 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m15:33:54.940397 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:33:54.941358 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7002007, "process_in_blocks": "18512", "process_kernel_time": 0.228878, "process_mem_max_rss": "130748", "process_out_blocks": "2816", "process_user_time": 2.640581}
[0m15:33:54.941773 [debug] [MainThread]: Command `dbt run` succeeded at 15:33:54.941687 after 1.70 seconds
[0m15:33:54.942104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef98ede4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef9934b8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef9934b8750>]}
[0m15:33:54.942421 [debug] [MainThread]: Flushing usage events
[0m15:33:56.631793 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:36:49.163584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c23346bd550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c233555b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c23355e7c90>]}


============================== 15:36:49.165686 | aba0bc68-fba3-45f0-83c9-f940a804ce22 ==============================
[0m15:36:49.165686 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:36:49.166082 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/subhan/.dbt', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:36:49.166875 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:36:49.167230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'aba0bc68-fba3-45f0-83c9-f940a804ce22', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2334716890>]}
[0m15:36:49.246508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aba0bc68-fba3-45f0-83c9-f940a804ce22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c233459ec50>]}
[0m15:36:49.254548 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:36:49.255200 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1314662, "process_in_blocks": "0", "process_kernel_time": 0.148443, "process_mem_max_rss": "105048", "process_out_blocks": "16", "process_user_time": 1.200271}
[0m15:36:49.255553 [debug] [MainThread]: Command `dbt clean` succeeded at 15:36:49.255487 after 0.13 seconds
[0m15:36:49.255779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2338d7cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2338d7c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c23346b4290>]}
[0m15:36:49.256008 [debug] [MainThread]: Flushing usage events
[0m15:36:50.427008 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:36:53.368402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d00858cc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d00858ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d00858ca50>]}


============================== 15:36:53.370640 | 0cfb6bc5-9d68-48c4-8480-6a896a2a9b6e ==============================
[0m15:36:53.370640 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:36:53.371047 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'profiles_dir': '/home/subhan/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:36:53.409152 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:36:53.409611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0cfb6bc5-9d68-48c4-8480-6a896a2a9b6e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d0085e4110>]}
[0m15:36:53.502281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cfb6bc5-9d68-48c4-8480-6a896a2a9b6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d007f5b090>]}
[0m15:36:53.554315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cfb6bc5-9d68-48c4-8480-6a896a2a9b6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d00b231590>]}
[0m15:36:53.555082 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:36:53.609680 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m15:36:53.610294 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:36:53.610634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0cfb6bc5-9d68-48c4-8480-6a896a2a9b6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d0083b5a90>]}
[0m15:36:54.764476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cfb6bc5-9d68-48c4-8480-6a896a2a9b6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d006f70f50>]}
[0m15:36:54.845415 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:36:54.847521 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:36:54.866384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cfb6bc5-9d68-48c4-8480-6a896a2a9b6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d0063c0e50>]}
[0m15:36:54.867102 [info ] [MainThread]: Found 6 models, 6 seeds, 3 sources, 435 macros
[0m15:36:54.867590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cfb6bc5-9d68-48c4-8480-6a896a2a9b6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d00634af90>]}
[0m15:36:54.869787 [info ] [MainThread]: 
[0m15:36:54.870613 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:36:54.870987 [info ] [MainThread]: 
[0m15:36:54.871577 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:36:54.880288 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb'
[0m15:36:54.913771 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m15:36:54.914335 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m15:36:54.914670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:54.921910 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.007 seconds
[0m15:36:54.923414 [debug] [ThreadPool]: On list_salesdb: Close
[0m15:36:54.926051 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m15:36:54.926748 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m15:36:54.927082 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:36:54.933765 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.007 seconds
[0m15:36:54.935225 [debug] [ThreadPool]: On list_salesdb: Close
[0m15:36:54.936296 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb, now create_salesdb_marts)
[0m15:36:54.936864 [debug] [ThreadPool]: Creating schema "database: "salesdb"
schema: "marts"
"
[0m15:36:54.942073 [debug] [ThreadPool]: Using postgres connection "create_salesdb_marts"
[0m15:36:54.942656 [debug] [ThreadPool]: On create_salesdb_marts: BEGIN
[0m15:36:54.942967 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:36:54.948762 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m15:36:54.949236 [debug] [ThreadPool]: Using postgres connection "create_salesdb_marts"
[0m15:36:54.949537 [debug] [ThreadPool]: On create_salesdb_marts: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "create_salesdb_marts"} */
create schema if not exists "marts"
[0m15:36:54.950712 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m15:36:54.951854 [debug] [ThreadPool]: On create_salesdb_marts: COMMIT
[0m15:36:54.952269 [debug] [ThreadPool]: Using postgres connection "create_salesdb_marts"
[0m15:36:54.952568 [debug] [ThreadPool]: On create_salesdb_marts: COMMIT
[0m15:36:54.954655 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m15:36:54.955110 [debug] [ThreadPool]: On create_salesdb_marts: Close
[0m15:36:54.955957 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_salesdb_marts, now create_salesdb_staging)
[0m15:36:54.956887 [debug] [ThreadPool]: Creating schema "database: "salesdb"
schema: "staging"
"
[0m15:36:54.959136 [debug] [ThreadPool]: Using postgres connection "create_salesdb_staging"
[0m15:36:54.959660 [debug] [ThreadPool]: On create_salesdb_staging: BEGIN
[0m15:36:54.959956 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:36:54.966434 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m15:36:54.967187 [debug] [ThreadPool]: Using postgres connection "create_salesdb_staging"
[0m15:36:54.967803 [debug] [ThreadPool]: On create_salesdb_staging: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "create_salesdb_staging"} */
create schema if not exists "staging"
[0m15:36:54.969434 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m15:36:54.970445 [debug] [ThreadPool]: On create_salesdb_staging: COMMIT
[0m15:36:54.970896 [debug] [ThreadPool]: Using postgres connection "create_salesdb_staging"
[0m15:36:54.971207 [debug] [ThreadPool]: On create_salesdb_staging: COMMIT
[0m15:36:54.972991 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m15:36:54.973505 [debug] [ThreadPool]: On create_salesdb_staging: Close
[0m15:36:54.976075 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_salesdb_staging, now list_salesdb_marts)
[0m15:36:54.981908 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m15:36:54.982350 [debug] [ThreadPool]: On list_salesdb_marts: BEGIN
[0m15:36:54.982638 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:36:54.987587 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m15:36:54.988085 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m15:36:54.988406 [debug] [ThreadPool]: On list_salesdb_marts: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_marts"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m15:36:54.991833 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m15:36:54.993132 [debug] [ThreadPool]: On list_salesdb_marts: ROLLBACK
[0m15:36:54.994655 [debug] [ThreadPool]: On list_salesdb_marts: Close
[0m15:36:54.995396 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_marts, now list_salesdb_public_raw_data)
[0m15:36:54.997405 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:36:54.997784 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m15:36:54.998043 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:36:55.002781 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m15:36:55.003234 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:36:55.003576 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m15:36:55.006312 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.002 seconds
[0m15:36:55.007722 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m15:36:55.008426 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m15:36:55.009097 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now list_salesdb_staging)
[0m15:36:55.012267 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m15:36:55.012734 [debug] [ThreadPool]: On list_salesdb_staging: BEGIN
[0m15:36:55.013011 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:36:55.016899 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:36:55.017307 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m15:36:55.017639 [debug] [ThreadPool]: On list_salesdb_staging: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_staging"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m15:36:55.020192 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m15:36:55.021318 [debug] [ThreadPool]: On list_salesdb_staging: ROLLBACK
[0m15:36:55.021978 [debug] [ThreadPool]: On list_salesdb_staging: Close
[0m15:36:55.026925 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:55.027420 [debug] [MainThread]: On master: BEGIN
[0m15:36:55.027736 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:36:55.032249 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:36:55.032717 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:55.033052 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:36:55.046060 [debug] [MainThread]: SQL status: SELECT 6 in 0.012 seconds
[0m15:36:55.048784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cfb6bc5-9d68-48c4-8480-6a896a2a9b6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cfdd418f50>]}
[0m15:36:55.049284 [debug] [MainThread]: On master: ROLLBACK
[0m15:36:55.050105 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:55.050497 [debug] [MainThread]: On master: BEGIN
[0m15:36:55.051411 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:36:55.051794 [debug] [MainThread]: On master: COMMIT
[0m15:36:55.052074 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:55.052323 [debug] [MainThread]: On master: COMMIT
[0m15:36:55.052901 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:36:55.053285 [debug] [MainThread]: On master: Close
[0m15:36:55.056185 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_departments
[0m15:36:55.057125 [info ] [Thread-1 (]: 1 of 5 START sql view model staging.stg_departments ............................ [RUN]
[0m15:36:55.058260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_staging, now model.modelling_handson.stg_departments)
[0m15:36:55.058609 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_departments
[0m15:36:55.065797 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_departments"
[0m15:36:55.067106 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_departments
[0m15:36:55.098775 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_departments"
[0m15:36:55.100125 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:36:55.100713 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: BEGIN
[0m15:36:55.101113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:36:55.105517 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:36:55.105965 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:36:55.106711 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */

  create view "salesdb"."staging"."stg_departments__dbt_tmp"
    
    
  as (
    select
    id as department_id,
    name as department_name
FROM "salesdb"."public_raw_data"."departments"
  );
[0m15:36:55.108513 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:36:55.113917 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:36:55.114372 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */
alter table "salesdb"."staging"."stg_departments__dbt_tmp" rename to "stg_departments"
[0m15:36:55.115294 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:36:55.126911 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: COMMIT
[0m15:36:55.127424 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:36:55.127799 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: COMMIT
[0m15:36:55.130385 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:36:55.135917 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_departments__dbt_backup"
[0m15:36:55.141038 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:36:55.141482 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */
drop view if exists "salesdb"."staging"."stg_departments__dbt_backup" cascade
[0m15:36:55.142574 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:36:55.145552 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: Close
[0m15:36:55.147277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cfb6bc5-9d68-48c4-8480-6a896a2a9b6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cfdd4d2b50>]}
[0m15:36:55.147953 [info ] [Thread-1 (]: 1 of 5 OK created sql view model staging.stg_departments ....................... [[32mCREATE VIEW[0m in 0.09s]
[0m15:36:55.148462 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_departments
[0m15:36:55.148807 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_doctors
[0m15:36:55.149227 [info ] [Thread-1 (]: 2 of 5 START sql view model staging.stg_doctors ................................ [RUN]
[0m15:36:55.149761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_departments, now model.modelling_handson.stg_doctors)
[0m15:36:55.150061 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_doctors
[0m15:36:55.152399 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_doctors"
[0m15:36:55.152933 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_doctors
[0m15:36:55.155838 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_doctors"
[0m15:36:55.156465 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:36:55.156795 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: BEGIN
[0m15:36:55.157092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:36:55.162763 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m15:36:55.163237 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:36:55.163659 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */

  create view "salesdb"."staging"."stg_doctors__dbt_tmp"
    
    
  as (
    select
    id as doctor_id,
    name,
    specialization,
    department_id
FROM "salesdb"."public_raw_data"."doctors"
  );
[0m15:36:55.165637 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:36:55.168984 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:36:55.169405 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */
alter table "salesdb"."staging"."stg_doctors__dbt_tmp" rename to "stg_doctors"
[0m15:36:55.170319 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:36:55.171504 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: COMMIT
[0m15:36:55.171901 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:36:55.172190 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: COMMIT
[0m15:36:55.173400 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:36:55.175589 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_doctors__dbt_backup"
[0m15:36:55.176209 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:36:55.176535 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */
drop view if exists "salesdb"."staging"."stg_doctors__dbt_backup" cascade
[0m15:36:55.177360 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:36:55.178522 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: Close
[0m15:36:55.179099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cfb6bc5-9d68-48c4-8480-6a896a2a9b6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cfdd3c36d0>]}
[0m15:36:55.179701 [info ] [Thread-1 (]: 2 of 5 OK created sql view model staging.stg_doctors ........................... [[32mCREATE VIEW[0m in 0.03s]
[0m15:36:55.180222 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_doctors
[0m15:36:55.180574 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_patients
[0m15:36:55.181235 [info ] [Thread-1 (]: 3 of 5 START sql view model staging.stg_patients ............................... [RUN]
[0m15:36:55.181985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_doctors, now model.modelling_handson.stg_patients)
[0m15:36:55.182360 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_patients
[0m15:36:55.184786 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_patients"
[0m15:36:55.185313 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_patients
[0m15:36:55.189647 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_patients"
[0m15:36:55.190273 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:36:55.190602 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: BEGIN
[0m15:36:55.190912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:36:55.195088 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:36:55.195591 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:36:55.195921 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */

  create view "salesdb"."staging"."stg_patients__dbt_tmp"
    
    
  as (
    select
id as patient_id,
name,
gender,
dob,
city
FROM "salesdb"."public_raw_data"."patients"
  );
[0m15:36:55.197928 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:36:55.200778 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:36:55.201183 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */
alter table "salesdb"."staging"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m15:36:55.202252 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:36:55.203848 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: COMMIT
[0m15:36:55.204237 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:36:55.204613 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: COMMIT
[0m15:36:55.206041 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:36:55.208114 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_patients__dbt_backup"
[0m15:36:55.208680 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:36:55.209012 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */
drop view if exists "salesdb"."staging"."stg_patients__dbt_backup" cascade
[0m15:36:55.209757 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:36:55.210887 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: Close
[0m15:36:55.211508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cfb6bc5-9d68-48c4-8480-6a896a2a9b6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cfdd2535d0>]}
[0m15:36:55.212088 [info ] [Thread-1 (]: 3 of 5 OK created sql view model staging.stg_patients .......................... [[32mCREATE VIEW[0m in 0.03s]
[0m15:36:55.212590 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_patients
[0m15:36:55.212939 [debug] [Thread-1 (]: Began running node model.modelling_handson.dim_doctors
[0m15:36:55.213698 [info ] [Thread-1 (]: 4 of 5 START sql table model marts.dim_doctors ................................. [RUN]
[0m15:36:55.214315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_patients, now model.modelling_handson.dim_doctors)
[0m15:36:55.214659 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.dim_doctors
[0m15:36:55.217285 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.dim_doctors"
[0m15:36:55.218554 [debug] [Thread-1 (]: Began executing node model.modelling_handson.dim_doctors
[0m15:36:55.238431 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.dim_doctors"
[0m15:36:55.239425 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:36:55.239904 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: BEGIN
[0m15:36:55.240788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:36:55.246182 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m15:36:55.246691 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:36:55.247010 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */

  
    

  create  table "salesdb"."marts"."dim_doctors__dbt_tmp"
  
  
    as
  
  (
    select d.*, dep.department_name
from "salesdb"."staging"."stg_doctors" d
left join "salesdb"."staging"."stg_departments" dep
on d.department_id = dep.department_id
  );
  
[0m15:36:55.251575 [debug] [Thread-1 (]: SQL status: SELECT 50 in 0.004 seconds
[0m15:36:55.257308 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:36:55.257720 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */
alter table "salesdb"."marts"."dim_doctors__dbt_tmp" rename to "dim_doctors"
[0m15:36:55.258709 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:36:55.259879 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: COMMIT
[0m15:36:55.260261 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:36:55.260552 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: COMMIT
[0m15:36:55.262446 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:36:55.264546 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."marts"."dim_doctors__dbt_backup"
[0m15:36:55.267441 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:36:55.267937 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */
drop table if exists "salesdb"."marts"."dim_doctors__dbt_backup" cascade
[0m15:36:55.268856 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:36:55.270096 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: Close
[0m15:36:55.270740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cfb6bc5-9d68-48c4-8480-6a896a2a9b6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cfdd347f90>]}
[0m15:36:55.271336 [info ] [Thread-1 (]: 4 of 5 OK created sql table model marts.dim_doctors ............................ [[32mSELECT 50[0m in 0.06s]
[0m15:36:55.271981 [debug] [Thread-1 (]: Finished running node model.modelling_handson.dim_doctors
[0m15:36:55.272366 [debug] [Thread-1 (]: Began running node model.modelling_handson.dim_patients
[0m15:36:55.272809 [info ] [Thread-1 (]: 5 of 5 START sql table model marts.dim_patients ................................ [RUN]
[0m15:36:55.273400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.dim_doctors, now model.modelling_handson.dim_patients)
[0m15:36:55.273715 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.dim_patients
[0m15:36:55.276455 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.dim_patients"
[0m15:36:55.277110 [debug] [Thread-1 (]: Began executing node model.modelling_handson.dim_patients
[0m15:36:55.279981 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.dim_patients"
[0m15:36:55.280904 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:36:55.281322 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: BEGIN
[0m15:36:55.281724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:36:55.287022 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m15:36:55.287673 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:36:55.288262 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */

  
    

  create  table "salesdb"."marts"."dim_patients__dbt_tmp"
  
  
    as
  
  (
    select * from "salesdb"."staging"."stg_patients"
  );
  
[0m15:36:55.292555 [debug] [Thread-1 (]: SQL status: SELECT 200 in 0.004 seconds
[0m15:36:55.296052 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:36:55.296601 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */
alter table "salesdb"."marts"."dim_patients__dbt_tmp" rename to "dim_patients"
[0m15:36:55.297719 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:36:55.300674 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: COMMIT
[0m15:36:55.301178 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:36:55.301471 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: COMMIT
[0m15:36:55.303038 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:36:55.305200 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."marts"."dim_patients__dbt_backup"
[0m15:36:55.305991 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:36:55.306520 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */
drop table if exists "salesdb"."marts"."dim_patients__dbt_backup" cascade
[0m15:36:55.307709 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:36:55.309180 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: Close
[0m15:36:55.310193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cfb6bc5-9d68-48c4-8480-6a896a2a9b6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cfdd27f1d0>]}
[0m15:36:55.310945 [info ] [Thread-1 (]: 5 of 5 OK created sql table model marts.dim_patients ........................... [[32mSELECT 200[0m in 0.04s]
[0m15:36:55.311614 [debug] [Thread-1 (]: Finished running node model.modelling_handson.dim_patients
[0m15:36:55.313223 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:55.313547 [debug] [MainThread]: On master: BEGIN
[0m15:36:55.313849 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:36:55.318001 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:36:55.318410 [debug] [MainThread]: On master: COMMIT
[0m15:36:55.318689 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:55.318929 [debug] [MainThread]: On master: COMMIT
[0m15:36:55.319523 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:36:55.319910 [debug] [MainThread]: On master: Close
[0m15:36:55.320447 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:36:55.320723 [debug] [MainThread]: Connection 'model.modelling_handson.dim_patients' was properly closed.
[0m15:36:55.321110 [info ] [MainThread]: 
[0m15:36:55.321451 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m15:36:55.322453 [debug] [MainThread]: Command end result
[0m15:36:55.340707 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:36:55.342348 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:36:55.347444 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m15:36:55.348032 [info ] [MainThread]: 
[0m15:36:55.348620 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:36:55.349109 [info ] [MainThread]: 
[0m15:36:55.349436 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m15:36:55.349922 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:36:55.350945 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.023219, "process_in_blocks": "0", "process_kernel_time": 0.301959, "process_mem_max_rss": "130716", "process_out_blocks": "2824", "process_user_time": 2.972809}
[0m15:36:55.351520 [debug] [MainThread]: Command `dbt run` succeeded at 15:36:55.351391 after 2.02 seconds
[0m15:36:55.351940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d00893d290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d00cbb8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d00cbb91d0>]}
[0m15:36:55.352326 [debug] [MainThread]: Flushing usage events
[0m15:36:57.089961 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:46:47.759794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2d399890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2d398f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2d398f90>]}


============================== 15:46:47.763144 | eae27451-98e7-4e3f-8f43-58bd62e07693 ==============================
[0m15:46:47.763144 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:46:47.763593 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/subhan/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:46:47.764409 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:46:47.764758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'eae27451-98e7-4e3f-8f43-58bd62e07693', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2d399a50>]}
[0m15:46:47.868476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eae27451-98e7-4e3f-8f43-58bd62e07693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2d667150>]}
[0m15:46:47.887092 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:46:47.888383 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17305532, "process_in_blocks": "90296", "process_kernel_time": 0.267142, "process_mem_max_rss": "104140", "process_out_blocks": "16", "process_user_time": 1.272106}
[0m15:46:47.888900 [debug] [MainThread]: Command `dbt clean` succeeded at 15:46:47.888741 after 0.17 seconds
[0m15:46:47.889191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2d75c690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2d75c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee31ab8790>]}
[0m15:46:47.889488 [debug] [MainThread]: Flushing usage events
[0m15:46:49.165756 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:46:53.202442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e1685b6510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e1685b6610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e1685b6710>]}


============================== 15:46:53.204529 | 07bebb5f-57ed-475f-a880-961b14871452 ==============================
[0m15:46:53.204529 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:46:53.204899 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/subhan/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:46:53.264702 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:46:53.265168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '07bebb5f-57ed-475f-a880-961b14871452', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e168657f90>]}
[0m15:46:53.347108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07bebb5f-57ed-475f-a880-961b14871452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e16855b410>]}
[0m15:46:53.395632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07bebb5f-57ed-475f-a880-961b14871452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e16b1d9610>]}
[0m15:46:53.397555 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:46:53.449735 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m15:46:53.450244 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:46:53.450531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '07bebb5f-57ed-475f-a880-961b14871452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e167fafa50>]}
[0m15:46:54.298888 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.modelling_handson.stg_treatments' (models/staging/stg_treatments.sql) depends on a source named 'public_raw_data.treatments' which was not found
[0m15:46:54.299455 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:46:54.300220 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1338828, "process_in_blocks": "13056", "process_kernel_time": 0.122719, "process_mem_max_rss": "118728", "process_out_blocks": "8", "process_user_time": 2.069307}
[0m15:46:54.300553 [debug] [MainThread]: Command `dbt run` failed at 15:46:54.300486 after 1.13 seconds
[0m15:46:54.300823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e1685fa990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e166730850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e166b57cd0>]}
[0m15:46:54.301089 [debug] [MainThread]: Flushing usage events
[0m15:46:55.558746 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:47:26.247872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec5157b1b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec5157b19d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec5157b1390>]}


============================== 15:47:26.249996 | 6a1881a2-bd8e-433c-a0c0-50b14c897168 ==============================
[0m15:47:26.249996 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:47:26.250411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'debug': 'False', 'profiles_dir': '/home/subhan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m15:47:26.251298 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:47:26.251664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6a1881a2-bd8e-433c-a0c0-50b14c897168', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec5157aaf10>]}
[0m15:47:26.336696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a1881a2-bd8e-433c-a0c0-50b14c897168', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec515690990>]}
[0m15:47:26.349303 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:47:26.350072 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.14278673, "process_in_blocks": "0", "process_kernel_time": 0.131471, "process_mem_max_rss": "105144", "process_out_blocks": "16", "process_user_time": 1.229899}
[0m15:47:26.350461 [debug] [MainThread]: Command `dbt clean` succeeded at 15:47:26.350387 after 0.14 seconds
[0m15:47:26.350738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec5158278d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec5158279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec519eb8790>]}
[0m15:47:26.351070 [debug] [MainThread]: Flushing usage events
[0m15:47:27.763090 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:47:30.924207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74613f199110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74613f55c990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74613f55c150>]}


============================== 15:47:30.926517 | ba53af7d-040b-47d7-9328-c7448f2700fa ==============================
[0m15:47:30.926517 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:47:30.926948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/subhan/.dbt', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:47:30.964856 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:47:30.965387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ba53af7d-040b-47d7-9328-c7448f2700fa', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74613ecf4c90>]}
[0m15:47:31.050404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba53af7d-040b-47d7-9328-c7448f2700fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74613e963010>]}
[0m15:47:31.094895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba53af7d-040b-47d7-9328-c7448f2700fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746141e9cf90>]}
[0m15:47:31.095579 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:47:31.142431 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m15:47:31.142932 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:47:31.143258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ba53af7d-040b-47d7-9328-c7448f2700fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74613e5f34d0>]}
[0m15:47:32.123727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba53af7d-040b-47d7-9328-c7448f2700fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74613e1f5150>]}
[0m15:47:32.181986 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:47:32.184560 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:47:32.196491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba53af7d-040b-47d7-9328-c7448f2700fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74613d170510>]}
[0m15:47:32.196946 [info ] [MainThread]: Found 13 models, 6 seeds, 5 sources, 435 macros
[0m15:47:32.197306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba53af7d-040b-47d7-9328-c7448f2700fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74613d55f350>]}
[0m15:47:32.199323 [info ] [MainThread]: 
[0m15:47:32.199663 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:47:32.199911 [info ] [MainThread]: 
[0m15:47:32.200264 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:47:32.205553 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb'
[0m15:47:32.233036 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m15:47:32.233366 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m15:47:32.233580 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:32.242536 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m15:47:32.243634 [debug] [ThreadPool]: On list_salesdb: Close
[0m15:47:32.245336 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m15:47:32.245681 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m15:47:32.245913 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:32.249369 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m15:47:32.250391 [debug] [ThreadPool]: On list_salesdb: Close
[0m15:47:32.252035 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m15:47:32.252385 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m15:47:32.252602 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:32.256316 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m15:47:32.257269 [debug] [ThreadPool]: On list_salesdb: Close
[0m15:47:32.259153 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb, now list_salesdb_public_raw_data)
[0m15:47:32.263176 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:47:32.263509 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m15:47:32.263727 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:32.267043 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:47:32.267363 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:47:32.267594 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m15:47:32.269846 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.002 seconds
[0m15:47:32.271189 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m15:47:32.271856 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m15:47:32.272386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now list_salesdb_staging)
[0m15:47:32.274941 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m15:47:32.275233 [debug] [ThreadPool]: On list_salesdb_staging: BEGIN
[0m15:47:32.275446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:32.278512 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:47:32.278781 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m15:47:32.279074 [debug] [ThreadPool]: On list_salesdb_staging: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_staging"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m15:47:32.280960 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m15:47:32.281861 [debug] [ThreadPool]: On list_salesdb_staging: ROLLBACK
[0m15:47:32.282402 [debug] [ThreadPool]: On list_salesdb_staging: Close
[0m15:47:32.282889 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_staging, now list_salesdb_public)
[0m15:47:32.285216 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public"
[0m15:47:32.285478 [debug] [ThreadPool]: On list_salesdb_public: BEGIN
[0m15:47:32.285672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:32.288640 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:47:32.288931 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public"
[0m15:47:32.289155 [debug] [ThreadPool]: On list_salesdb_public: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:47:32.291037 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m15:47:32.291967 [debug] [ThreadPool]: On list_salesdb_public: ROLLBACK
[0m15:47:32.292458 [debug] [ThreadPool]: On list_salesdb_public: Close
[0m15:47:32.292937 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_public, now list_salesdb_marts)
[0m15:47:32.294785 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m15:47:32.295054 [debug] [ThreadPool]: On list_salesdb_marts: BEGIN
[0m15:47:32.295244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:32.298201 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:47:32.298488 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m15:47:32.298742 [debug] [ThreadPool]: On list_salesdb_marts: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_marts"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m15:47:32.300599 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m15:47:32.301455 [debug] [ThreadPool]: On list_salesdb_marts: ROLLBACK
[0m15:47:32.301895 [debug] [ThreadPool]: On list_salesdb_marts: Close
[0m15:47:32.305708 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:32.306029 [debug] [MainThread]: On master: BEGIN
[0m15:47:32.306242 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:47:32.309151 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:47:32.309456 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:32.309715 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:47:32.321711 [debug] [MainThread]: SQL status: SELECT 9 in 0.012 seconds
[0m15:47:32.323724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba53af7d-040b-47d7-9328-c7448f2700fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74613d9d1810>]}
[0m15:47:32.324063 [debug] [MainThread]: On master: ROLLBACK
[0m15:47:32.324577 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:32.324869 [debug] [MainThread]: On master: BEGIN
[0m15:47:32.325501 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:47:32.325756 [debug] [MainThread]: On master: COMMIT
[0m15:47:32.325967 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:32.326159 [debug] [MainThread]: On master: COMMIT
[0m15:47:32.326590 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:47:32.326916 [debug] [MainThread]: On master: Close
[0m15:47:32.331155 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_appointments
[0m15:47:32.331645 [info ] [Thread-1 (]: 1 of 12 START sql view model staging.stg_appointments .......................... [RUN]
[0m15:47:32.332091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_marts, now model.modelling_handson.stg_appointments)
[0m15:47:32.332371 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_appointments
[0m15:47:32.337612 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_appointments"
[0m15:47:32.338637 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_appointments
[0m15:47:32.363194 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_appointments"
[0m15:47:32.364282 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_appointments"
[0m15:47:32.364596 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: BEGIN
[0m15:47:32.364830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:32.368838 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:47:32.369238 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_appointments"
[0m15:47:32.369509 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_appointments"} */

  create view "salesdb"."staging"."stg_appointments__dbt_tmp"
    
    
  as (
    select
id as appointment_id,
patient_id,
doctor_id,
appointment_date,
status,
department_id
from "salesdb"."public_raw_data"."appointments"
  );
[0m15:47:32.372232 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:47:32.376899 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_appointments"
[0m15:47:32.377244 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_appointments"} */
alter table "salesdb"."staging"."stg_appointments__dbt_tmp" rename to "stg_appointments"
[0m15:47:32.377984 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:47:32.388894 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: COMMIT
[0m15:47:32.389395 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_appointments"
[0m15:47:32.389688 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: COMMIT
[0m15:47:32.391020 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:47:32.396130 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_appointments__dbt_backup"
[0m15:47:32.400561 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_appointments"
[0m15:47:32.400931 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_appointments"} */
drop view if exists "salesdb"."staging"."stg_appointments__dbt_backup" cascade
[0m15:47:32.401710 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:47:32.403654 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: Close
[0m15:47:32.405337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba53af7d-040b-47d7-9328-c7448f2700fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7460e3f597d0>]}
[0m15:47:32.405849 [info ] [Thread-1 (]: 1 of 12 OK created sql view model staging.stg_appointments ..................... [[32mCREATE VIEW[0m in 0.07s]
[0m15:47:32.406282 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_appointments
[0m15:47:32.406582 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_departments
[0m15:47:32.406990 [info ] [Thread-1 (]: 2 of 12 START sql view model staging.stg_departments ........................... [RUN]
[0m15:47:32.407616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_appointments, now model.modelling_handson.stg_departments)
[0m15:47:32.407877 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_departments
[0m15:47:32.409799 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_departments"
[0m15:47:32.410210 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_departments
[0m15:47:32.413426 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_departments"
[0m15:47:32.413851 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:47:32.414110 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: BEGIN
[0m15:47:32.414341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:32.417570 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m15:47:32.417881 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:47:32.418140 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */

  create view "salesdb"."staging"."stg_departments__dbt_tmp"
    
    
  as (
    select
    id as department_id,
    name as department_name
FROM "salesdb"."public_raw_data"."departments"
  );
[0m15:47:32.419461 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:47:32.421821 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:47:32.422127 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */
alter table "salesdb"."staging"."stg_departments" rename to "stg_departments__dbt_backup"
[0m15:47:32.423020 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:47:32.425125 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:47:32.425415 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */
alter table "salesdb"."staging"."stg_departments__dbt_tmp" rename to "stg_departments"
[0m15:47:32.426143 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:47:32.428678 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: COMMIT
[0m15:47:32.429027 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:47:32.429313 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: COMMIT
[0m15:47:32.430565 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:47:32.432568 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_departments__dbt_backup"
[0m15:47:32.433058 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:47:32.433336 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */
drop view if exists "salesdb"."staging"."stg_departments__dbt_backup" cascade
[0m15:47:32.435002 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:47:32.436056 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: Close
[0m15:47:32.436532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba53af7d-040b-47d7-9328-c7448f2700fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7460e2604850>]}
[0m15:47:32.436999 [info ] [Thread-1 (]: 2 of 12 OK created sql view model staging.stg_departments ...................... [[32mCREATE VIEW[0m in 0.03s]
[0m15:47:32.437462 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_departments
[0m15:47:32.437753 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_doctors
[0m15:47:32.438257 [info ] [Thread-1 (]: 3 of 12 START sql view model staging.stg_doctors ............................... [RUN]
[0m15:47:32.438647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_departments, now model.modelling_handson.stg_doctors)
[0m15:47:32.438933 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_doctors
[0m15:47:32.441210 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_doctors"
[0m15:47:32.441664 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_doctors
[0m15:47:32.444188 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_doctors"
[0m15:47:32.444724 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:47:32.445010 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: BEGIN
[0m15:47:32.445257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:32.449886 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m15:47:32.450321 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:47:32.450598 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */

  create view "salesdb"."staging"."stg_doctors__dbt_tmp"
    
    
  as (
    select
    id as doctor_id,
    name,
    specialization,
    department_id
FROM "salesdb"."public_raw_data"."doctors"
  );
[0m15:47:32.452133 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:47:32.454796 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:47:32.455200 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */
alter table "salesdb"."staging"."stg_doctors" rename to "stg_doctors__dbt_backup"
[0m15:47:32.456070 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:47:32.458113 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:47:32.458431 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */
alter table "salesdb"."staging"."stg_doctors__dbt_tmp" rename to "stg_doctors"
[0m15:47:32.459199 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:47:32.460327 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: COMMIT
[0m15:47:32.460711 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:47:32.460960 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: COMMIT
[0m15:47:32.461988 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:47:32.463909 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_doctors__dbt_backup"
[0m15:47:32.464408 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:47:32.464686 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */
drop view if exists "salesdb"."staging"."stg_doctors__dbt_backup" cascade
[0m15:47:32.466128 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:47:32.467254 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: Close
[0m15:47:32.467733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba53af7d-040b-47d7-9328-c7448f2700fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7460e3f39e10>]}
[0m15:47:32.468209 [info ] [Thread-1 (]: 3 of 12 OK created sql view model staging.stg_doctors .......................... [[32mCREATE VIEW[0m in 0.03s]
[0m15:47:32.468683 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_doctors
[0m15:47:32.468980 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_patients
[0m15:47:32.469321 [info ] [Thread-1 (]: 4 of 12 START sql view model staging.stg_patients .............................. [RUN]
[0m15:47:32.469977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_doctors, now model.modelling_handson.stg_patients)
[0m15:47:32.470329 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_patients
[0m15:47:32.472386 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_patients"
[0m15:47:32.472821 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_patients
[0m15:47:32.475166 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_patients"
[0m15:47:32.475589 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:47:32.475871 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: BEGIN
[0m15:47:32.476103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:32.479821 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:47:32.480199 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:47:32.480471 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */

  create view "salesdb"."staging"."stg_patients__dbt_tmp"
    
    
  as (
    select
id as patient_id,
name,
gender,
dob,
city
FROM "salesdb"."public_raw_data"."patients"
  );
[0m15:47:32.481811 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:47:32.485653 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:47:32.486007 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */
alter table "salesdb"."staging"."stg_patients" rename to "stg_patients__dbt_backup"
[0m15:47:32.486833 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:47:32.489912 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:47:32.490249 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */
alter table "salesdb"."staging"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m15:47:32.491181 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:47:32.492191 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: COMMIT
[0m15:47:32.492590 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:47:32.492889 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: COMMIT
[0m15:47:32.493922 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:47:32.495744 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_patients__dbt_backup"
[0m15:47:32.496181 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:47:32.496449 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */
drop view if exists "salesdb"."staging"."stg_patients__dbt_backup" cascade
[0m15:47:32.497812 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:47:32.498789 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: Close
[0m15:47:32.499280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba53af7d-040b-47d7-9328-c7448f2700fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7460e268c6d0>]}
[0m15:47:32.499763 [info ] [Thread-1 (]: 4 of 12 OK created sql view model staging.stg_patients ......................... [[32mCREATE VIEW[0m in 0.03s]
[0m15:47:32.500176 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_patients
[0m15:47:32.500462 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_treatments
[0m15:47:32.500929 [info ] [Thread-1 (]: 5 of 12 START sql view model staging.stg_treatments ............................ [RUN]
[0m15:47:32.501639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_patients, now model.modelling_handson.stg_treatments)
[0m15:47:32.501955 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_treatments
[0m15:47:32.504049 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_treatments"
[0m15:47:32.504513 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_treatments
[0m15:47:32.506852 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_treatments"
[0m15:47:32.507362 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_treatments"
[0m15:47:32.507631 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: BEGIN
[0m15:47:32.507866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:32.511355 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m15:47:32.511752 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_treatments"
[0m15:47:32.512030 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_treatments"} */

  create view "salesdb"."staging"."stg_treatments__dbt_tmp"
    
    
  as (
    select
id as treatment_id,
appointment_id,
treatment,
cost
from "salesdb"."public_raw_data"."treatments"
  );
[0m15:47:32.513496 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:47:32.515829 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_treatments"
[0m15:47:32.516166 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_treatments"} */
alter table "salesdb"."staging"."stg_treatments__dbt_tmp" rename to "stg_treatments"
[0m15:47:32.517102 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:47:32.518074 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: COMMIT
[0m15:47:32.518381 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_treatments"
[0m15:47:32.518641 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: COMMIT
[0m15:47:32.519775 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:47:32.521613 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_treatments__dbt_backup"
[0m15:47:32.522082 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_treatments"
[0m15:47:32.522350 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_treatments"} */
drop view if exists "salesdb"."staging"."stg_treatments__dbt_backup" cascade
[0m15:47:32.523065 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:47:32.524098 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: Close
[0m15:47:32.524635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba53af7d-040b-47d7-9328-c7448f2700fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74613d97d210>]}
[0m15:47:32.525121 [info ] [Thread-1 (]: 5 of 12 OK created sql view model staging.stg_treatments ....................... [[32mCREATE VIEW[0m in 0.02s]
[0m15:47:32.525555 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_treatments
[0m15:47:32.525873 [debug] [Thread-1 (]: Began running node model.modelling_handson.bronze_appointments
[0m15:47:32.526256 [info ] [Thread-1 (]: 6 of 12 START sql view model public.bronze_appointments ........................ [RUN]
[0m15:47:32.527060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_treatments, now model.modelling_handson.bronze_appointments)
[0m15:47:32.527503 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.bronze_appointments
[0m15:47:32.529591 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.bronze_appointments"
[0m15:47:32.530209 [debug] [Thread-1 (]: Began executing node model.modelling_handson.bronze_appointments
[0m15:47:32.532642 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.bronze_appointments"
[0m15:47:32.533276 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_appointments"
[0m15:47:32.533560 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: BEGIN
[0m15:47:32.533795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:32.537315 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m15:47:32.537690 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_appointments"
[0m15:47:32.537953 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.bronze_appointments"} */

  create view "salesdb"."public"."bronze_appointments__dbt_tmp"
    
    
  as (
    select * from "salesdb"."staging"."stg_appointments"
  );
[0m15:47:32.539360 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:47:32.541625 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_appointments"
[0m15:47:32.541989 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.bronze_appointments"} */
alter table "salesdb"."public"."bronze_appointments__dbt_tmp" rename to "bronze_appointments"
[0m15:47:32.542702 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:47:32.543708 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: COMMIT
[0m15:47:32.544031 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_appointments"
[0m15:47:32.544301 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: COMMIT
[0m15:47:32.545388 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:47:32.547237 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."public"."bronze_appointments__dbt_backup"
[0m15:47:32.547728 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_appointments"
[0m15:47:32.548004 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.bronze_appointments"} */
drop view if exists "salesdb"."public"."bronze_appointments__dbt_backup" cascade
[0m15:47:32.549357 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:47:32.551234 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: Close
[0m15:47:32.551842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba53af7d-040b-47d7-9328-c7448f2700fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7460e2687d50>]}
[0m15:47:32.552687 [info ] [Thread-1 (]: 6 of 12 OK created sql view model public.bronze_appointments ................... [[32mCREATE VIEW[0m in 0.02s]
[0m15:47:32.553279 [debug] [Thread-1 (]: Finished running node model.modelling_handson.bronze_appointments
[0m15:47:32.553770 [debug] [Thread-1 (]: Began running node model.modelling_handson.dim_doctors
[0m15:47:32.554410 [info ] [Thread-1 (]: 7 of 12 START sql table model marts.dim_doctors ................................ [RUN]
[0m15:47:32.554883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.bronze_appointments, now model.modelling_handson.dim_doctors)
[0m15:47:32.555266 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.dim_doctors
[0m15:47:32.558628 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.dim_doctors"
[0m15:47:32.559290 [debug] [Thread-1 (]: Began executing node model.modelling_handson.dim_doctors
[0m15:47:32.576902 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.dim_doctors"
[0m15:47:32.577712 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:47:32.578040 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: BEGIN
[0m15:47:32.578311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:32.582242 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:47:32.582685 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:47:32.583016 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */

  
    

  create  table "salesdb"."marts"."dim_doctors__dbt_tmp"
  
  
    as
  
  (
    select d.*, dep.department_name
from "salesdb"."staging"."stg_doctors" d
left join "salesdb"."staging"."stg_departments" dep
on d.department_id = dep.department_id
  );
  
[0m15:47:32.586286 [debug] [Thread-1 (]: SQL status: SELECT 50 in 0.003 seconds
[0m15:47:32.591147 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:47:32.591544 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */
alter table "salesdb"."marts"."dim_doctors" rename to "dim_doctors__dbt_backup"
[0m15:47:32.592297 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:47:32.594478 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:47:32.594853 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */
alter table "salesdb"."marts"."dim_doctors__dbt_tmp" rename to "dim_doctors"
[0m15:47:32.595598 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:47:32.596627 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: COMMIT
[0m15:47:32.596931 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:47:32.597211 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: COMMIT
[0m15:47:32.598281 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:47:32.600043 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."marts"."dim_doctors__dbt_backup"
[0m15:47:32.602644 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:47:32.603015 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */
drop table if exists "salesdb"."marts"."dim_doctors__dbt_backup" cascade
[0m15:47:32.604603 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:47:32.605580 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: Close
[0m15:47:32.606081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba53af7d-040b-47d7-9328-c7448f2700fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7460e3f33110>]}
[0m15:47:32.606561 [info ] [Thread-1 (]: 7 of 12 OK created sql table model marts.dim_doctors ........................... [[32mSELECT 50[0m in 0.05s]
[0m15:47:32.607012 [debug] [Thread-1 (]: Finished running node model.modelling_handson.dim_doctors
[0m15:47:32.607415 [debug] [Thread-1 (]: Began running node model.modelling_handson.dim_patients
[0m15:47:32.607911 [info ] [Thread-1 (]: 8 of 12 START sql table model marts.dim_patients ............................... [RUN]
[0m15:47:32.608460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.dim_doctors, now model.modelling_handson.dim_patients)
[0m15:47:32.608746 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.dim_patients
[0m15:47:32.611037 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.dim_patients"
[0m15:47:32.611543 [debug] [Thread-1 (]: Began executing node model.modelling_handson.dim_patients
[0m15:47:32.614906 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.dim_patients"
[0m15:47:32.615506 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:47:32.615802 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: BEGIN
[0m15:47:32.616059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:32.621450 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m15:47:32.621972 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:47:32.622231 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */

  
    

  create  table "salesdb"."marts"."dim_patients__dbt_tmp"
  
  
    as
  
  (
    select * from "salesdb"."staging"."stg_patients"
  );
  
[0m15:47:32.627168 [debug] [Thread-1 (]: SQL status: SELECT 200 in 0.004 seconds
[0m15:47:32.631356 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:47:32.631906 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */
alter table "salesdb"."marts"."dim_patients" rename to "dim_patients__dbt_backup"
[0m15:47:32.633059 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:47:32.635478 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:47:32.635844 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */
alter table "salesdb"."marts"."dim_patients__dbt_tmp" rename to "dim_patients"
[0m15:47:32.636660 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:47:32.637734 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: COMMIT
[0m15:47:32.638117 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:47:32.638431 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: COMMIT
[0m15:47:32.639854 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:47:32.641755 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."marts"."dim_patients__dbt_backup"
[0m15:47:32.644273 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:47:32.644694 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */
drop table if exists "salesdb"."marts"."dim_patients__dbt_backup" cascade
[0m15:47:32.646562 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:47:32.647862 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: Close
[0m15:47:32.648406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba53af7d-040b-47d7-9328-c7448f2700fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7460e26e7fd0>]}
[0m15:47:32.648962 [info ] [Thread-1 (]: 8 of 12 OK created sql table model marts.dim_patients .......................... [[32mSELECT 200[0m in 0.04s]
[0m15:47:32.649577 [debug] [Thread-1 (]: Finished running node model.modelling_handson.dim_patients
[0m15:47:32.649954 [debug] [Thread-1 (]: Began running node model.modelling_handson.bronze_treatments
[0m15:47:32.650515 [info ] [Thread-1 (]: 9 of 12 START sql view model public.bronze_treatments .......................... [RUN]
[0m15:47:32.650997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.dim_patients, now model.modelling_handson.bronze_treatments)
[0m15:47:32.651298 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.bronze_treatments
[0m15:47:32.653501 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.bronze_treatments"
[0m15:47:32.654036 [debug] [Thread-1 (]: Began executing node model.modelling_handson.bronze_treatments
[0m15:47:32.656716 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.bronze_treatments"
[0m15:47:32.657262 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_treatments"
[0m15:47:32.657563 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: BEGIN
[0m15:47:32.657822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:32.661822 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:47:32.662222 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_treatments"
[0m15:47:32.662511 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.bronze_treatments"} */

  create view "salesdb"."public"."bronze_treatments__dbt_tmp"
    
    
  as (
    select * from "salesdb"."staging"."stg_treatments"
  );
[0m15:47:32.664095 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:47:32.666765 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_treatments"
[0m15:47:32.667228 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.bronze_treatments"} */
alter table "salesdb"."public"."bronze_treatments__dbt_tmp" rename to "bronze_treatments"
[0m15:47:32.668090 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:47:32.669321 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: COMMIT
[0m15:47:32.669695 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_treatments"
[0m15:47:32.669983 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: COMMIT
[0m15:47:32.671350 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:47:32.673297 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."public"."bronze_treatments__dbt_backup"
[0m15:47:32.673781 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_treatments"
[0m15:47:32.674064 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.bronze_treatments"} */
drop view if exists "salesdb"."public"."bronze_treatments__dbt_backup" cascade
[0m15:47:32.674728 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:47:32.675830 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: Close
[0m15:47:32.676377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba53af7d-040b-47d7-9328-c7448f2700fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7460e26e7410>]}
[0m15:47:32.676908 [info ] [Thread-1 (]: 9 of 12 OK created sql view model public.bronze_treatments ..................... [[32mCREATE VIEW[0m in 0.03s]
[0m15:47:32.677395 [debug] [Thread-1 (]: Finished running node model.modelling_handson.bronze_treatments
[0m15:47:32.677753 [debug] [Thread-1 (]: Began running node model.modelling_handson.silver_appointments
[0m15:47:32.678469 [info ] [Thread-1 (]: 10 of 12 START sql view model public.silver_appointments ....................... [RUN]
[0m15:47:32.678992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.bronze_treatments, now model.modelling_handson.silver_appointments)
[0m15:47:32.679348 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.silver_appointments
[0m15:47:32.681584 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.silver_appointments"
[0m15:47:32.682306 [debug] [Thread-1 (]: Began executing node model.modelling_handson.silver_appointments
[0m15:47:32.685465 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.silver_appointments"
[0m15:47:32.686314 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_appointments"
[0m15:47:32.686669 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: BEGIN
[0m15:47:32.686956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:32.691715 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m15:47:32.692275 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_appointments"
[0m15:47:32.692608 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_appointments"} */

  create view "salesdb"."public"."silver_appointments__dbt_tmp"
    
    
  as (
    select * from "salesdb"."public"."bronze_appointments"
where appointment_date is not null and status != 'cancelled'
  );
[0m15:47:32.695178 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:47:32.697871 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_appointments"
[0m15:47:32.698310 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_appointments"} */
alter table "salesdb"."public"."silver_appointments__dbt_tmp" rename to "silver_appointments"
[0m15:47:32.699582 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:47:32.700770 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: COMMIT
[0m15:47:32.701146 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_appointments"
[0m15:47:32.701506 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: COMMIT
[0m15:47:32.703709 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:47:32.706189 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."public"."silver_appointments__dbt_backup"
[0m15:47:32.707302 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_appointments"
[0m15:47:32.708178 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_appointments"} */
drop view if exists "salesdb"."public"."silver_appointments__dbt_backup" cascade
[0m15:47:32.709232 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:47:32.710518 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: Close
[0m15:47:32.711573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba53af7d-040b-47d7-9328-c7448f2700fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746141e2f610>]}
[0m15:47:32.712606 [info ] [Thread-1 (]: 10 of 12 OK created sql view model public.silver_appointments .................. [[32mCREATE VIEW[0m in 0.03s]
[0m15:47:32.713762 [debug] [Thread-1 (]: Finished running node model.modelling_handson.silver_appointments
[0m15:47:32.714524 [debug] [Thread-1 (]: Began running node model.modelling_handson.silver_treatments
[0m15:47:32.715488 [info ] [Thread-1 (]: 11 of 12 START sql view model public.silver_treatments ......................... [RUN]
[0m15:47:32.716039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.silver_appointments, now model.modelling_handson.silver_treatments)
[0m15:47:32.716396 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.silver_treatments
[0m15:47:32.718908 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.silver_treatments"
[0m15:47:32.719592 [debug] [Thread-1 (]: Began executing node model.modelling_handson.silver_treatments
[0m15:47:32.722687 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.silver_treatments"
[0m15:47:32.723563 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_treatments"
[0m15:47:32.723903 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: BEGIN
[0m15:47:32.724180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:32.729532 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m15:47:32.730035 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_treatments"
[0m15:47:32.730352 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_treatments"} */

  create view "salesdb"."public"."silver_treatments__dbt_tmp"
    
    
  as (
    select * from "salesdb"."public"."bronze_treatments"
where cost > 0
  );
[0m15:47:32.732764 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:47:32.736625 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_treatments"
[0m15:47:32.737236 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_treatments"} */
alter table "salesdb"."public"."silver_treatments__dbt_tmp" rename to "silver_treatments"
[0m15:47:32.738492 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:47:32.739881 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: COMMIT
[0m15:47:32.740276 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_treatments"
[0m15:47:32.740591 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: COMMIT
[0m15:47:32.742295 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:47:32.746463 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."public"."silver_treatments__dbt_backup"
[0m15:47:32.747523 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_treatments"
[0m15:47:32.747894 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_treatments"} */
drop view if exists "salesdb"."public"."silver_treatments__dbt_backup" cascade
[0m15:47:32.748835 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:47:32.750265 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: Close
[0m15:47:32.751062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba53af7d-040b-47d7-9328-c7448f2700fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74612c1d1f50>]}
[0m15:47:32.751678 [info ] [Thread-1 (]: 11 of 12 OK created sql view model public.silver_treatments .................... [[32mCREATE VIEW[0m in 0.04s]
[0m15:47:32.752356 [debug] [Thread-1 (]: Finished running node model.modelling_handson.silver_treatments
[0m15:47:32.753497 [debug] [Thread-1 (]: Began running node model.modelling_handson.gold_daily_metrics
[0m15:47:32.753954 [info ] [Thread-1 (]: 12 of 12 START sql view model public.gold_daily_metrics ........................ [RUN]
[0m15:47:32.754394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.silver_treatments, now model.modelling_handson.gold_daily_metrics)
[0m15:47:32.754718 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.gold_daily_metrics
[0m15:47:32.757347 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.gold_daily_metrics"
[0m15:47:32.758544 [debug] [Thread-1 (]: Began executing node model.modelling_handson.gold_daily_metrics
[0m15:47:32.762081 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.gold_daily_metrics"
[0m15:47:32.762922 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.gold_daily_metrics"
[0m15:47:32.763384 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: BEGIN
[0m15:47:32.763692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:32.768435 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m15:47:32.768936 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.gold_daily_metrics"
[0m15:47:32.769257 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.gold_daily_metrics"} */

  create view "salesdb"."public"."gold_daily_metrics__dbt_tmp"
    
    
  as (
    select
a.appointment_date,
count(distinct a.appointment_id) as total_appointments,
count(distinct t.treatment_id) as total_treatments,
sum(t.cost) as revenue
from "salesdb"."public"."silver_appointments" a
left join "salesdb"."public"."silver_treatments" t
on a.appointment_id = t.appointment_id
  );
[0m15:47:32.771501 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "a.appointment_date" must appear in the GROUP BY clause or be used in an aggregate function
LINE 8: a.appointment_date,
        ^

[0m15:47:32.772014 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: ROLLBACK
[0m15:47:32.772964 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: Close
[0m15:47:32.783642 [debug] [Thread-1 (]: Database Error in model gold_daily_metrics (models/gold/gold_daily_metrics.sql)
  column "a.appointment_date" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 8: a.appointment_date,
          ^
  compiled code at target/run/modelling_handson/models/gold/gold_daily_metrics.sql
[0m15:47:32.784302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba53af7d-040b-47d7-9328-c7448f2700fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74612c183610>]}
[0m15:47:32.784896 [error] [Thread-1 (]: 12 of 12 ERROR creating sql view model public.gold_daily_metrics ............... [[31mERROR[0m in 0.03s]
[0m15:47:32.785412 [debug] [Thread-1 (]: Finished running node model.modelling_handson.gold_daily_metrics
[0m15:47:32.785954 [debug] [Thread-4 (]: Marking all children of 'model.modelling_handson.gold_daily_metrics' to be skipped because of status 'error'.  Reason: Database Error in model gold_daily_metrics (models/gold/gold_daily_metrics.sql)
  column "a.appointment_date" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 8: a.appointment_date,
          ^
  compiled code at target/run/modelling_handson/models/gold/gold_daily_metrics.sql.
[0m15:47:32.787909 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:32.788251 [debug] [MainThread]: On master: BEGIN
[0m15:47:32.788508 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:47:32.792950 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:47:32.793571 [debug] [MainThread]: On master: COMMIT
[0m15:47:32.794229 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:32.794522 [debug] [MainThread]: On master: COMMIT
[0m15:47:32.795631 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:47:32.796319 [debug] [MainThread]: On master: Close
[0m15:47:32.796830 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:32.797168 [debug] [MainThread]: Connection 'model.modelling_handson.gold_daily_metrics' was properly closed.
[0m15:47:32.797840 [info ] [MainThread]: 
[0m15:47:32.798288 [info ] [MainThread]: Finished running 2 table models, 10 view models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m15:47:32.799909 [debug] [MainThread]: Command end result
[0m15:47:32.887626 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:47:32.889309 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:47:32.894663 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m15:47:32.895067 [info ] [MainThread]: 
[0m15:47:32.895431 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:47:32.895723 [info ] [MainThread]: 
[0m15:47:32.896179 [error] [MainThread]: [31mFailure in model gold_daily_metrics (models/gold/gold_daily_metrics.sql)[0m
[0m15:47:32.896693 [error] [MainThread]:   Database Error in model gold_daily_metrics (models/gold/gold_daily_metrics.sql)
  column "a.appointment_date" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 8: a.appointment_date,
          ^
  compiled code at target/run/modelling_handson/models/gold/gold_daily_metrics.sql
[0m15:47:32.896995 [info ] [MainThread]: 
[0m15:47:32.897348 [info ] [MainThread]:   compiled code at target/compiled/modelling_handson/models/gold/gold_daily_metrics.sql
[0m15:47:32.897655 [info ] [MainThread]: 
[0m15:47:32.897968 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=12
[0m15:47:32.898451 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:47:32.899370 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.018743, "process_in_blocks": "6736", "process_kernel_time": 0.291235, "process_mem_max_rss": "130972", "process_out_blocks": "3128", "process_user_time": 2.912351}
[0m15:47:32.899824 [debug] [MainThread]: Command `dbt run` failed at 15:47:32.899737 after 2.02 seconds
[0m15:47:32.900206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74613d1b4290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7461438b8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7461438b9410>]}
[0m15:47:32.900554 [debug] [MainThread]: Flushing usage events
[0m15:47:34.613131 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:48:00.740427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7120943bda10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712094580690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712094413dd0>]}


============================== 15:48:00.742818 | 3eed45eb-7133-47da-b4a6-cb857652fa5c ==============================
[0m15:48:00.742818 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:48:00.743272 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'fail_fast': 'False', 'profiles_dir': '/home/subhan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:48:00.744244 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:48:00.744725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3eed45eb-7133-47da-b4a6-cb857652fa5c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712094416250>]}
[0m15:48:00.830433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3eed45eb-7133-47da-b4a6-cb857652fa5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712094312d50>]}
[0m15:48:00.838744 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:48:00.839537 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.14018142, "process_in_blocks": "0", "process_kernel_time": 0.153191, "process_mem_max_rss": "104772", "process_out_blocks": "8", "process_user_time": 1.127659}
[0m15:48:00.839890 [debug] [MainThread]: Command `dbt clean` succeeded at 15:48:00.839821 after 0.14 seconds
[0m15:48:00.840131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712094415790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712094416750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712098ab91d0>]}
[0m15:48:00.840382 [debug] [MainThread]: Flushing usage events
[0m15:48:02.133958 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:48:04.953715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d08cb9b2050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d08cb9a9590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d08cb9b1950>]}


============================== 15:48:04.956076 | 30db7c1f-3f78-4dfe-b673-697512acb676 ==============================
[0m15:48:04.956076 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:48:04.956502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'profiles_dir': '/home/subhan/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:48:04.997781 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:48:04.998307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '30db7c1f-3f78-4dfe-b673-697512acb676', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d08cba09ad0>]}
[0m15:48:05.088231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30db7c1f-3f78-4dfe-b673-697512acb676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d08cb37f590>]}
[0m15:48:05.141169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30db7c1f-3f78-4dfe-b673-697512acb676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d08ce5e5750>]}
[0m15:48:05.141926 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:48:05.194493 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m15:48:05.195044 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:48:05.195363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '30db7c1f-3f78-4dfe-b673-697512acb676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d08caf15e50>]}
[0m15:48:06.064918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30db7c1f-3f78-4dfe-b673-697512acb676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d08c9f7af90>]}
[0m15:48:06.119765 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:48:06.121098 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:48:06.129881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30db7c1f-3f78-4dfe-b673-697512acb676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d08c97effd0>]}
[0m15:48:06.130278 [info ] [MainThread]: Found 13 models, 6 seeds, 5 sources, 435 macros
[0m15:48:06.130550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30db7c1f-3f78-4dfe-b673-697512acb676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d08cb35d3d0>]}
[0m15:48:06.131973 [info ] [MainThread]: 
[0m15:48:06.132277 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:48:06.132497 [info ] [MainThread]: 
[0m15:48:06.132808 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:48:06.136056 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb'
[0m15:48:06.157656 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m15:48:06.158021 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m15:48:06.158247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:06.162636 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m15:48:06.163556 [debug] [ThreadPool]: On list_salesdb: Close
[0m15:48:06.165117 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m15:48:06.165481 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m15:48:06.165732 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:06.169159 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m15:48:06.170299 [debug] [ThreadPool]: On list_salesdb: Close
[0m15:48:06.171814 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m15:48:06.172088 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m15:48:06.172416 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:06.175704 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m15:48:06.176513 [debug] [ThreadPool]: On list_salesdb: Close
[0m15:48:06.178294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb, now list_salesdb_staging)
[0m15:48:06.182439 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m15:48:06.182770 [debug] [ThreadPool]: On list_salesdb_staging: BEGIN
[0m15:48:06.182980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:06.186631 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:48:06.186982 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m15:48:06.187210 [debug] [ThreadPool]: On list_salesdb_staging: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_staging"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m15:48:06.189474 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m15:48:06.190618 [debug] [ThreadPool]: On list_salesdb_staging: ROLLBACK
[0m15:48:06.191251 [debug] [ThreadPool]: On list_salesdb_staging: Close
[0m15:48:06.191776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_staging, now list_salesdb_marts)
[0m15:48:06.193717 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m15:48:06.194050 [debug] [ThreadPool]: On list_salesdb_marts: BEGIN
[0m15:48:06.194291 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:06.197497 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:48:06.197849 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m15:48:06.198087 [debug] [ThreadPool]: On list_salesdb_marts: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_marts"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m15:48:06.200081 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m15:48:06.201034 [debug] [ThreadPool]: On list_salesdb_marts: ROLLBACK
[0m15:48:06.201606 [debug] [ThreadPool]: On list_salesdb_marts: Close
[0m15:48:06.202101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_marts, now list_salesdb_public)
[0m15:48:06.204406 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public"
[0m15:48:06.204674 [debug] [ThreadPool]: On list_salesdb_public: BEGIN
[0m15:48:06.204889 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:06.208192 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:48:06.208486 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public"
[0m15:48:06.208711 [debug] [ThreadPool]: On list_salesdb_public: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:48:06.210964 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.002 seconds
[0m15:48:06.211937 [debug] [ThreadPool]: On list_salesdb_public: ROLLBACK
[0m15:48:06.212459 [debug] [ThreadPool]: On list_salesdb_public: Close
[0m15:48:06.212956 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_public, now list_salesdb_public_raw_data)
[0m15:48:06.215235 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:48:06.215501 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m15:48:06.215720 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:06.218725 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:48:06.219021 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:48:06.219246 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m15:48:06.221048 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.002 seconds
[0m15:48:06.222012 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m15:48:06.222507 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m15:48:06.227346 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:06.227708 [debug] [MainThread]: On master: BEGIN
[0m15:48:06.227918 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:48:06.231345 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:48:06.231691 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:06.231963 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:48:06.247413 [debug] [MainThread]: SQL status: SELECT 15 in 0.015 seconds
[0m15:48:06.250248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30db7c1f-3f78-4dfe-b673-697512acb676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d08b87018d0>]}
[0m15:48:06.250642 [debug] [MainThread]: On master: ROLLBACK
[0m15:48:06.251280 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:06.251557 [debug] [MainThread]: On master: BEGIN
[0m15:48:06.252143 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:48:06.252423 [debug] [MainThread]: On master: COMMIT
[0m15:48:06.252638 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:06.252829 [debug] [MainThread]: On master: COMMIT
[0m15:48:06.253221 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:48:06.253465 [debug] [MainThread]: On master: Close
[0m15:48:06.256563 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_appointments
[0m15:48:06.257280 [info ] [Thread-1 (]: 1 of 12 START sql view model staging.stg_appointments .......................... [RUN]
[0m15:48:06.257772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now model.modelling_handson.stg_appointments)
[0m15:48:06.258091 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_appointments
[0m15:48:06.263304 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_appointments"
[0m15:48:06.265414 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_appointments
[0m15:48:06.290544 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_appointments"
[0m15:48:06.291941 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_appointments"
[0m15:48:06.292275 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: BEGIN
[0m15:48:06.292521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:06.296291 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:48:06.296670 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_appointments"
[0m15:48:06.296929 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_appointments"} */

  create view "salesdb"."staging"."stg_appointments__dbt_tmp"
    
    
  as (
    select
id as appointment_id,
patient_id,
doctor_id,
appointment_date,
status,
department_id
from "salesdb"."public_raw_data"."appointments"
  );
[0m15:48:06.298400 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:48:06.303715 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_appointments"
[0m15:48:06.304144 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_appointments"} */
alter table "salesdb"."staging"."stg_appointments" rename to "stg_appointments__dbt_backup"
[0m15:48:06.305011 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:48:06.307216 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_appointments"
[0m15:48:06.307532 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_appointments"} */
alter table "salesdb"."staging"."stg_appointments__dbt_tmp" rename to "stg_appointments"
[0m15:48:06.308237 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:48:06.320150 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: COMMIT
[0m15:48:06.320566 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_appointments"
[0m15:48:06.320826 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: COMMIT
[0m15:48:06.322156 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:48:06.326915 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_appointments__dbt_backup"
[0m15:48:06.331175 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_appointments"
[0m15:48:06.331521 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_appointments"} */
drop view if exists "salesdb"."staging"."stg_appointments__dbt_backup" cascade
[0m15:48:06.334039 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:48:06.336008 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: Close
[0m15:48:06.337360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30db7c1f-3f78-4dfe-b673-697512acb676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d08b86eb110>]}
[0m15:48:06.337901 [info ] [Thread-1 (]: 1 of 12 OK created sql view model staging.stg_appointments ..................... [[32mCREATE VIEW[0m in 0.08s]
[0m15:48:06.338379 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_appointments
[0m15:48:06.338684 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_departments
[0m15:48:06.339273 [info ] [Thread-1 (]: 2 of 12 START sql view model staging.stg_departments ........................... [RUN]
[0m15:48:06.339658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_appointments, now model.modelling_handson.stg_departments)
[0m15:48:06.339933 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_departments
[0m15:48:06.343035 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_departments"
[0m15:48:06.343606 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_departments
[0m15:48:06.345905 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_departments"
[0m15:48:06.346364 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:48:06.346629 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: BEGIN
[0m15:48:06.346875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:06.351144 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:48:06.351560 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:48:06.351824 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */

  create view "salesdb"."staging"."stg_departments__dbt_tmp"
    
    
  as (
    select
    id as department_id,
    name as department_name
FROM "salesdb"."public_raw_data"."departments"
  );
[0m15:48:06.353248 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:48:06.355861 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:48:06.356210 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */
alter table "salesdb"."staging"."stg_departments" rename to "stg_departments__dbt_backup"
[0m15:48:06.357288 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:48:06.359812 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:48:06.360281 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */
alter table "salesdb"."staging"."stg_departments__dbt_tmp" rename to "stg_departments"
[0m15:48:06.361389 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:48:06.362570 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: COMMIT
[0m15:48:06.362921 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:48:06.363183 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: COMMIT
[0m15:48:06.365114 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:48:06.367067 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_departments__dbt_backup"
[0m15:48:06.367602 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:48:06.367899 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */
drop view if exists "salesdb"."staging"."stg_departments__dbt_backup" cascade
[0m15:48:06.369622 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:48:06.370822 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: Close
[0m15:48:06.371347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30db7c1f-3f78-4dfe-b673-697512acb676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d08b85ff790>]}
[0m15:48:06.371864 [info ] [Thread-1 (]: 2 of 12 OK created sql view model staging.stg_departments ...................... [[32mCREATE VIEW[0m in 0.03s]
[0m15:48:06.372309 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_departments
[0m15:48:06.372609 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_doctors
[0m15:48:06.373137 [info ] [Thread-1 (]: 3 of 12 START sql view model staging.stg_doctors ............................... [RUN]
[0m15:48:06.374121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_departments, now model.modelling_handson.stg_doctors)
[0m15:48:06.374457 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_doctors
[0m15:48:06.376559 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_doctors"
[0m15:48:06.377048 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_doctors
[0m15:48:06.379620 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_doctors"
[0m15:48:06.380262 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:48:06.380562 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: BEGIN
[0m15:48:06.380808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:06.384656 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:48:06.385059 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:48:06.385340 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */

  create view "salesdb"."staging"."stg_doctors__dbt_tmp"
    
    
  as (
    select
    id as doctor_id,
    name,
    specialization,
    department_id
FROM "salesdb"."public_raw_data"."doctors"
  );
[0m15:48:06.387210 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:48:06.390448 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:48:06.390992 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */
alter table "salesdb"."staging"."stg_doctors" rename to "stg_doctors__dbt_backup"
[0m15:48:06.391831 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:48:06.394167 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:48:06.394549 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */
alter table "salesdb"."staging"."stg_doctors__dbt_tmp" rename to "stg_doctors"
[0m15:48:06.395481 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:48:06.396521 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: COMMIT
[0m15:48:06.396842 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:48:06.397114 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: COMMIT
[0m15:48:06.398799 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:48:06.400690 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_doctors__dbt_backup"
[0m15:48:06.401197 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:48:06.401495 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */
drop view if exists "salesdb"."staging"."stg_doctors__dbt_backup" cascade
[0m15:48:06.403193 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:48:06.404281 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: Close
[0m15:48:06.404803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30db7c1f-3f78-4dfe-b673-697512acb676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d08b85fc150>]}
[0m15:48:06.405276 [info ] [Thread-1 (]: 3 of 12 OK created sql view model staging.stg_doctors .......................... [[32mCREATE VIEW[0m in 0.03s]
[0m15:48:06.405749 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_doctors
[0m15:48:06.406087 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_patients
[0m15:48:06.406629 [info ] [Thread-1 (]: 4 of 12 START sql view model staging.stg_patients .............................. [RUN]
[0m15:48:06.407278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_doctors, now model.modelling_handson.stg_patients)
[0m15:48:06.407835 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_patients
[0m15:48:06.410453 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_patients"
[0m15:48:06.410993 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_patients
[0m15:48:06.414756 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_patients"
[0m15:48:06.415368 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:48:06.415666 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: BEGIN
[0m15:48:06.416034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:06.420650 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:48:06.421522 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:48:06.422067 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */

  create view "salesdb"."staging"."stg_patients__dbt_tmp"
    
    
  as (
    select
id as patient_id,
name,
gender,
dob,
city
FROM "salesdb"."public_raw_data"."patients"
  );
[0m15:48:06.424097 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:48:06.427338 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:48:06.427746 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */
alter table "salesdb"."staging"."stg_patients" rename to "stg_patients__dbt_backup"
[0m15:48:06.428696 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:48:06.431005 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:48:06.431371 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */
alter table "salesdb"."staging"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m15:48:06.432332 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:48:06.433400 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: COMMIT
[0m15:48:06.433859 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:48:06.434134 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: COMMIT
[0m15:48:06.435250 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:48:06.437088 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_patients__dbt_backup"
[0m15:48:06.437564 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:48:06.437899 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */
drop view if exists "salesdb"."staging"."stg_patients__dbt_backup" cascade
[0m15:48:06.439228 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:48:06.440341 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: Close
[0m15:48:06.440851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30db7c1f-3f78-4dfe-b673-697512acb676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d08b86ffe50>]}
[0m15:48:06.441352 [info ] [Thread-1 (]: 4 of 12 OK created sql view model staging.stg_patients ......................... [[32mCREATE VIEW[0m in 0.03s]
[0m15:48:06.441841 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_patients
[0m15:48:06.442167 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_treatments
[0m15:48:06.442527 [info ] [Thread-1 (]: 5 of 12 START sql view model staging.stg_treatments ............................ [RUN]
[0m15:48:06.443239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_patients, now model.modelling_handson.stg_treatments)
[0m15:48:06.443557 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_treatments
[0m15:48:06.445692 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_treatments"
[0m15:48:06.446228 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_treatments
[0m15:48:06.448696 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_treatments"
[0m15:48:06.449209 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_treatments"
[0m15:48:06.449492 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: BEGIN
[0m15:48:06.449755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:06.453622 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:48:06.454047 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_treatments"
[0m15:48:06.454328 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_treatments"} */

  create view "salesdb"."staging"."stg_treatments__dbt_tmp"
    
    
  as (
    select
id as treatment_id,
appointment_id,
treatment,
cost
from "salesdb"."public_raw_data"."treatments"
  );
[0m15:48:06.456136 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:48:06.458837 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_treatments"
[0m15:48:06.459239 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_treatments"} */
alter table "salesdb"."staging"."stg_treatments" rename to "stg_treatments__dbt_backup"
[0m15:48:06.460153 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:48:06.462639 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_treatments"
[0m15:48:06.463023 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_treatments"} */
alter table "salesdb"."staging"."stg_treatments__dbt_tmp" rename to "stg_treatments"
[0m15:48:06.463969 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:48:06.465222 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: COMMIT
[0m15:48:06.465605 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_treatments"
[0m15:48:06.465920 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: COMMIT
[0m15:48:06.467150 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:48:06.469263 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_treatments__dbt_backup"
[0m15:48:06.469921 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_treatments"
[0m15:48:06.470272 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_treatments"} */
drop view if exists "salesdb"."staging"."stg_treatments__dbt_backup" cascade
[0m15:48:06.472140 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:48:06.473230 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: Close
[0m15:48:06.473765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30db7c1f-3f78-4dfe-b673-697512acb676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d08b8699a90>]}
[0m15:48:06.474297 [info ] [Thread-1 (]: 5 of 12 OK created sql view model staging.stg_treatments ....................... [[32mCREATE VIEW[0m in 0.03s]
[0m15:48:06.475007 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_treatments
[0m15:48:06.475362 [debug] [Thread-1 (]: Began running node model.modelling_handson.bronze_appointments
[0m15:48:06.476096 [info ] [Thread-1 (]: 6 of 12 START sql view model public.bronze_appointments ........................ [RUN]
[0m15:48:06.476597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_treatments, now model.modelling_handson.bronze_appointments)
[0m15:48:06.476904 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.bronze_appointments
[0m15:48:06.479146 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.bronze_appointments"
[0m15:48:06.479885 [debug] [Thread-1 (]: Began executing node model.modelling_handson.bronze_appointments
[0m15:48:06.482486 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.bronze_appointments"
[0m15:48:06.483321 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_appointments"
[0m15:48:06.483636 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: BEGIN
[0m15:48:06.483936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:06.488296 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:48:06.489004 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_appointments"
[0m15:48:06.489432 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.bronze_appointments"} */

  create view "salesdb"."public"."bronze_appointments__dbt_tmp"
    
    
  as (
    select * from "salesdb"."staging"."stg_appointments"
  );
[0m15:48:06.491677 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:48:06.496002 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_appointments"
[0m15:48:06.496497 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.bronze_appointments"} */
alter table "salesdb"."public"."bronze_appointments__dbt_tmp" rename to "bronze_appointments"
[0m15:48:06.497333 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:48:06.498411 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: COMMIT
[0m15:48:06.498744 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_appointments"
[0m15:48:06.499028 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: COMMIT
[0m15:48:06.500257 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:48:06.502084 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."public"."bronze_appointments__dbt_backup"
[0m15:48:06.502584 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_appointments"
[0m15:48:06.502859 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.bronze_appointments"} */
drop view if exists "salesdb"."public"."bronze_appointments__dbt_backup" cascade
[0m15:48:06.503475 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:48:06.504637 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: Close
[0m15:48:06.505442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30db7c1f-3f78-4dfe-b673-697512acb676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d08b86b8ed0>]}
[0m15:48:06.506031 [info ] [Thread-1 (]: 6 of 12 OK created sql view model public.bronze_appointments ................... [[32mCREATE VIEW[0m in 0.03s]
[0m15:48:06.506515 [debug] [Thread-1 (]: Finished running node model.modelling_handson.bronze_appointments
[0m15:48:06.506852 [debug] [Thread-1 (]: Began running node model.modelling_handson.dim_doctors
[0m15:48:06.507263 [info ] [Thread-1 (]: 7 of 12 START sql table model marts.dim_doctors ................................ [RUN]
[0m15:48:06.507969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.bronze_appointments, now model.modelling_handson.dim_doctors)
[0m15:48:06.508368 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.dim_doctors
[0m15:48:06.510701 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.dim_doctors"
[0m15:48:06.511381 [debug] [Thread-1 (]: Began executing node model.modelling_handson.dim_doctors
[0m15:48:06.527807 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.dim_doctors"
[0m15:48:06.528635 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:48:06.528977 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: BEGIN
[0m15:48:06.529229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:06.532837 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:48:06.533258 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:48:06.533545 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */

  
    

  create  table "salesdb"."marts"."dim_doctors__dbt_tmp"
  
  
    as
  
  (
    select d.*, dep.department_name
from "salesdb"."staging"."stg_doctors" d
left join "salesdb"."staging"."stg_departments" dep
on d.department_id = dep.department_id
  );
  
[0m15:48:06.536740 [debug] [Thread-1 (]: SQL status: SELECT 50 in 0.003 seconds
[0m15:48:06.541623 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:48:06.542040 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */
alter table "salesdb"."marts"."dim_doctors" rename to "dim_doctors__dbt_backup"
[0m15:48:06.542924 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:48:06.545464 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:48:06.545892 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */
alter table "salesdb"."marts"."dim_doctors__dbt_tmp" rename to "dim_doctors"
[0m15:48:06.546614 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:48:06.547594 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: COMMIT
[0m15:48:06.547930 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:48:06.548193 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: COMMIT
[0m15:48:06.549312 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:48:06.551271 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."marts"."dim_doctors__dbt_backup"
[0m15:48:06.553842 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:48:06.554199 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */
drop table if exists "salesdb"."marts"."dim_doctors__dbt_backup" cascade
[0m15:48:06.556524 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:48:06.557697 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: Close
[0m15:48:06.558275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30db7c1f-3f78-4dfe-b673-697512acb676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d08cb3eb110>]}
[0m15:48:06.558792 [info ] [Thread-1 (]: 7 of 12 OK created sql table model marts.dim_doctors ........................... [[32mSELECT 50[0m in 0.05s]
[0m15:48:06.559247 [debug] [Thread-1 (]: Finished running node model.modelling_handson.dim_doctors
[0m15:48:06.559563 [debug] [Thread-1 (]: Began running node model.modelling_handson.dim_patients
[0m15:48:06.560165 [info ] [Thread-1 (]: 8 of 12 START sql table model marts.dim_patients ............................... [RUN]
[0m15:48:06.560654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.dim_doctors, now model.modelling_handson.dim_patients)
[0m15:48:06.560932 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.dim_patients
[0m15:48:06.563109 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.dim_patients"
[0m15:48:06.563621 [debug] [Thread-1 (]: Began executing node model.modelling_handson.dim_patients
[0m15:48:06.566362 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.dim_patients"
[0m15:48:06.566940 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:48:06.567374 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: BEGIN
[0m15:48:06.567647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:06.571677 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:48:06.572081 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:48:06.572350 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */

  
    

  create  table "salesdb"."marts"."dim_patients__dbt_tmp"
  
  
    as
  
  (
    select * from "salesdb"."staging"."stg_patients"
  );
  
[0m15:48:06.575551 [debug] [Thread-1 (]: SQL status: SELECT 200 in 0.003 seconds
[0m15:48:06.578140 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:48:06.578481 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */
alter table "salesdb"."marts"."dim_patients" rename to "dim_patients__dbt_backup"
[0m15:48:06.579212 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:48:06.583252 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:48:06.583649 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */
alter table "salesdb"."marts"."dim_patients__dbt_tmp" rename to "dim_patients"
[0m15:48:06.584573 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:48:06.585769 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: COMMIT
[0m15:48:06.586154 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:48:06.586429 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: COMMIT
[0m15:48:06.587653 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:48:06.589737 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."marts"."dim_patients__dbt_backup"
[0m15:48:06.590558 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:48:06.590857 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */
drop table if exists "salesdb"."marts"."dim_patients__dbt_backup" cascade
[0m15:48:06.596006 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m15:48:06.597155 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: Close
[0m15:48:06.597681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30db7c1f-3f78-4dfe-b673-697512acb676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d08b86dea90>]}
[0m15:48:06.598218 [info ] [Thread-1 (]: 8 of 12 OK created sql table model marts.dim_patients .......................... [[32mSELECT 200[0m in 0.04s]
[0m15:48:06.598647 [debug] [Thread-1 (]: Finished running node model.modelling_handson.dim_patients
[0m15:48:06.598940 [debug] [Thread-1 (]: Began running node model.modelling_handson.bronze_treatments
[0m15:48:06.599286 [info ] [Thread-1 (]: 9 of 12 START sql view model public.bronze_treatments .......................... [RUN]
[0m15:48:06.599689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.dim_patients, now model.modelling_handson.bronze_treatments)
[0m15:48:06.600156 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.bronze_treatments
[0m15:48:06.602256 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.bronze_treatments"
[0m15:48:06.602700 [debug] [Thread-1 (]: Began executing node model.modelling_handson.bronze_treatments
[0m15:48:06.605666 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.bronze_treatments"
[0m15:48:06.606302 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_treatments"
[0m15:48:06.606625 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: BEGIN
[0m15:48:06.606877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:06.610900 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:48:06.611320 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_treatments"
[0m15:48:06.611641 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.bronze_treatments"} */

  create view "salesdb"."public"."bronze_treatments__dbt_tmp"
    
    
  as (
    select * from "salesdb"."staging"."stg_treatments"
  );
[0m15:48:06.613039 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:48:06.615620 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_treatments"
[0m15:48:06.616046 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.bronze_treatments"} */
alter table "salesdb"."public"."bronze_treatments__dbt_tmp" rename to "bronze_treatments"
[0m15:48:06.617360 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:48:06.618556 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: COMMIT
[0m15:48:06.618957 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_treatments"
[0m15:48:06.619242 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: COMMIT
[0m15:48:06.620560 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:48:06.622981 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."public"."bronze_treatments__dbt_backup"
[0m15:48:06.623582 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_treatments"
[0m15:48:06.624029 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.bronze_treatments"} */
drop view if exists "salesdb"."public"."bronze_treatments__dbt_backup" cascade
[0m15:48:06.625251 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:48:06.627155 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: Close
[0m15:48:06.628159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30db7c1f-3f78-4dfe-b673-697512acb676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d08b86c4910>]}
[0m15:48:06.629155 [info ] [Thread-1 (]: 9 of 12 OK created sql view model public.bronze_treatments ..................... [[32mCREATE VIEW[0m in 0.03s]
[0m15:48:06.630162 [debug] [Thread-1 (]: Finished running node model.modelling_handson.bronze_treatments
[0m15:48:06.630871 [debug] [Thread-1 (]: Began running node model.modelling_handson.silver_appointments
[0m15:48:06.631956 [info ] [Thread-1 (]: 10 of 12 START sql view model public.silver_appointments ....................... [RUN]
[0m15:48:06.632520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.bronze_treatments, now model.modelling_handson.silver_appointments)
[0m15:48:06.632831 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.silver_appointments
[0m15:48:06.635068 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.silver_appointments"
[0m15:48:06.635797 [debug] [Thread-1 (]: Began executing node model.modelling_handson.silver_appointments
[0m15:48:06.638464 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.silver_appointments"
[0m15:48:06.639216 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_appointments"
[0m15:48:06.639546 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: BEGIN
[0m15:48:06.639819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:06.643973 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:48:06.644390 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_appointments"
[0m15:48:06.644734 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_appointments"} */

  create view "salesdb"."public"."silver_appointments__dbt_tmp"
    
    
  as (
    select * from "salesdb"."public"."bronze_appointments"
where appointment_date is not null and status != 'cancelled'
  );
[0m15:48:06.646688 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:48:06.649255 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_appointments"
[0m15:48:06.649651 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_appointments"} */
alter table "salesdb"."public"."silver_appointments__dbt_tmp" rename to "silver_appointments"
[0m15:48:06.651172 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:48:06.653114 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: COMMIT
[0m15:48:06.653571 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_appointments"
[0m15:48:06.653913 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: COMMIT
[0m15:48:06.655857 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:48:06.657942 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."public"."silver_appointments__dbt_backup"
[0m15:48:06.658595 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_appointments"
[0m15:48:06.658944 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_appointments"} */
drop view if exists "salesdb"."public"."silver_appointments__dbt_backup" cascade
[0m15:48:06.660339 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:48:06.661498 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: Close
[0m15:48:06.662202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30db7c1f-3f78-4dfe-b673-697512acb676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d08b88e3410>]}
[0m15:48:06.662789 [info ] [Thread-1 (]: 10 of 12 OK created sql view model public.silver_appointments .................. [[32mCREATE VIEW[0m in 0.03s]
[0m15:48:06.663270 [debug] [Thread-1 (]: Finished running node model.modelling_handson.silver_appointments
[0m15:48:06.663593 [debug] [Thread-1 (]: Began running node model.modelling_handson.silver_treatments
[0m15:48:06.664617 [info ] [Thread-1 (]: 11 of 12 START sql view model public.silver_treatments ......................... [RUN]
[0m15:48:06.665471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.silver_appointments, now model.modelling_handson.silver_treatments)
[0m15:48:06.666142 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.silver_treatments
[0m15:48:06.668688 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.silver_treatments"
[0m15:48:06.669368 [debug] [Thread-1 (]: Began executing node model.modelling_handson.silver_treatments
[0m15:48:06.673730 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.silver_treatments"
[0m15:48:06.674499 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_treatments"
[0m15:48:06.674845 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: BEGIN
[0m15:48:06.675160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:06.680838 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m15:48:06.681357 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_treatments"
[0m15:48:06.681667 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_treatments"} */

  create view "salesdb"."public"."silver_treatments__dbt_tmp"
    
    
  as (
    select * from "salesdb"."public"."bronze_treatments"
where cost > 0
  );
[0m15:48:06.685008 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m15:48:06.687752 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_treatments"
[0m15:48:06.688161 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_treatments"} */
alter table "salesdb"."public"."silver_treatments__dbt_tmp" rename to "silver_treatments"
[0m15:48:06.689125 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:48:06.690434 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: COMMIT
[0m15:48:06.690826 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_treatments"
[0m15:48:06.691136 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: COMMIT
[0m15:48:06.692568 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:48:06.694833 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."public"."silver_treatments__dbt_backup"
[0m15:48:06.695487 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_treatments"
[0m15:48:06.695822 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_treatments"} */
drop view if exists "salesdb"."public"."silver_treatments__dbt_backup" cascade
[0m15:48:06.696803 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:48:06.698121 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: Close
[0m15:48:06.698722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30db7c1f-3f78-4dfe-b673-697512acb676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d08b8649dd0>]}
[0m15:48:06.699264 [info ] [Thread-1 (]: 11 of 12 OK created sql view model public.silver_treatments .................... [[32mCREATE VIEW[0m in 0.03s]
[0m15:48:06.699772 [debug] [Thread-1 (]: Finished running node model.modelling_handson.silver_treatments
[0m15:48:06.700908 [debug] [Thread-1 (]: Began running node model.modelling_handson.gold_daily_metrics
[0m15:48:06.701364 [info ] [Thread-1 (]: 12 of 12 START sql view model public.gold_daily_metrics ........................ [RUN]
[0m15:48:06.701853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.silver_treatments, now model.modelling_handson.gold_daily_metrics)
[0m15:48:06.702204 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.gold_daily_metrics
[0m15:48:06.704709 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.gold_daily_metrics"
[0m15:48:06.705464 [debug] [Thread-1 (]: Began executing node model.modelling_handson.gold_daily_metrics
[0m15:48:06.708183 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.gold_daily_metrics"
[0m15:48:06.708958 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.gold_daily_metrics"
[0m15:48:06.709288 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: BEGIN
[0m15:48:06.709569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:06.713988 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:48:06.714448 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.gold_daily_metrics"
[0m15:48:06.714821 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.gold_daily_metrics"} */

  create view "salesdb"."public"."gold_daily_metrics__dbt_tmp"
    
    
  as (
    select
a.appointment_date,
count(distinct a.appointment_id) as total_appointments,
count(distinct t.treatment_id) as total_treatments,
sum(t.cost) as revenue
from "salesdb"."public"."silver_appointments" a
left join "salesdb"."public"."silver_treatments" t
on a.appointment_id = t.appointment_id
group by a.appointment_date
  );
[0m15:48:06.717659 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:48:06.720479 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.gold_daily_metrics"
[0m15:48:06.720908 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.gold_daily_metrics"} */
alter table "salesdb"."public"."gold_daily_metrics__dbt_tmp" rename to "gold_daily_metrics"
[0m15:48:06.722198 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:48:06.723321 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: COMMIT
[0m15:48:06.723712 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.gold_daily_metrics"
[0m15:48:06.724010 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: COMMIT
[0m15:48:06.725566 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:48:06.727658 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."public"."gold_daily_metrics__dbt_backup"
[0m15:48:06.728430 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.gold_daily_metrics"
[0m15:48:06.728753 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.gold_daily_metrics"} */
drop view if exists "salesdb"."public"."gold_daily_metrics__dbt_backup" cascade
[0m15:48:06.729631 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:48:06.731276 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: Close
[0m15:48:06.731925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30db7c1f-3f78-4dfe-b673-697512acb676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d08b85f9950>]}
[0m15:48:06.732761 [info ] [Thread-1 (]: 12 of 12 OK created sql view model public.gold_daily_metrics ................... [[32mCREATE VIEW[0m in 0.03s]
[0m15:48:06.733282 [debug] [Thread-1 (]: Finished running node model.modelling_handson.gold_daily_metrics
[0m15:48:06.734651 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:06.734978 [debug] [MainThread]: On master: BEGIN
[0m15:48:06.735225 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:48:06.739522 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:48:06.739973 [debug] [MainThread]: On master: COMMIT
[0m15:48:06.740255 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:06.740494 [debug] [MainThread]: On master: COMMIT
[0m15:48:06.741273 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:48:06.741656 [debug] [MainThread]: On master: Close
[0m15:48:06.742138 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:48:06.742434 [debug] [MainThread]: Connection 'model.modelling_handson.gold_daily_metrics' was properly closed.
[0m15:48:06.742903 [info ] [MainThread]: 
[0m15:48:06.743292 [info ] [MainThread]: Finished running 2 table models, 10 view models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m15:48:06.744838 [debug] [MainThread]: Command end result
[0m15:48:06.824306 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:48:06.825753 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:48:06.830756 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m15:48:06.831072 [info ] [MainThread]: 
[0m15:48:06.831421 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:48:06.831698 [info ] [MainThread]: 
[0m15:48:06.831963 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m15:48:06.832405 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:48:06.833143 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9210305, "process_in_blocks": "16", "process_kernel_time": 0.165551, "process_mem_max_rss": "129792", "process_out_blocks": "3128", "process_user_time": 2.848335}
[0m15:48:06.833641 [debug] [MainThread]: Command `dbt run` succeeded at 15:48:06.833557 after 1.92 seconds
[0m15:48:06.834045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d08cffb8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d08cffb91d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d08cffb9410>]}
[0m15:48:06.834356 [debug] [MainThread]: Flushing usage events
[0m15:48:08.609023 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:49:53.257597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7940a5fbb410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7940a5fbbed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7940a5fbb910>]}


============================== 15:49:53.260917 | b5f13409-faa5-4b45-858a-84b44c339ca4 ==============================
[0m15:49:53.260917 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:49:53.261359 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/subhan/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:49:53.262323 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 50, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:49:53.262693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b5f13409-faa5-4b45-858a-84b44c339ca4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7940a6012b90>]}
[0m15:49:53.355942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5f13409-faa5-4b45-858a-84b44c339ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7940a5fb0810>]}
[0m15:49:53.374043 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:49:53.375555 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.16055778, "process_in_blocks": "89816", "process_kernel_time": 0.236365, "process_mem_max_rss": "104528", "process_out_blocks": "16", "process_user_time": 1.211371}
[0m15:49:53.375929 [debug] [MainThread]: Command `dbt clean` succeeded at 15:49:53.375864 after 0.16 seconds
[0m15:49:53.376155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7940a5fb8a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7940a5fb9810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7940aa5b8790>]}
[0m15:49:53.376437 [debug] [MainThread]: Flushing usage events
[0m15:49:54.790456 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:50:00.013644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700e177e8e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700e17788f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700e177eb290>]}


============================== 15:50:00.015860 | 6974a3c8-d9c3-4563-8e02-b2fb8f1b9cb8 ==============================
[0m15:50:00.015860 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:50:00.016584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/subhan/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:50:00.017848 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 50, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:50:00.018228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6974a3c8-d9c3-4563-8e02-b2fb8f1b9cb8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700e17793890>]}
[0m15:50:00.102773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6974a3c8-d9c3-4563-8e02-b2fb8f1b9cb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700e176c54d0>]}
[0m15:50:00.109882 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:50:00.110561 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.13640313, "process_in_blocks": "0", "process_kernel_time": 0.134939, "process_mem_max_rss": "105108", "process_out_blocks": "8", "process_user_time": 1.134337}
[0m15:50:00.110985 [debug] [MainThread]: Command `dbt clean` succeeded at 15:50:00.110913 after 0.14 seconds
[0m15:50:00.111274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700e177e7dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700e1bdb8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700e17672310>]}
[0m15:50:00.111658 [debug] [MainThread]: Flushing usage events
[0m15:50:01.398116 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:50:08.753318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7b07b6010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7b0a83050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7b0a83290>]}


============================== 15:50:08.756098 | 2657949e-26e2-4ab1-be21-0e0b61cfacb1 ==============================
[0m15:50:08.756098 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:50:08.756574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'fail_fast': 'False', 'profiles_dir': '/home/subhan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:50:08.830481 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 50, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:50:08.831251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2657949e-26e2-4ab1-be21-0e0b61cfacb1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7b0309c10>]}
[0m15:50:08.931626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2657949e-26e2-4ab1-be21-0e0b61cfacb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7b07b4b90>]}
[0m15:50:08.985580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2657949e-26e2-4ab1-be21-0e0b61cfacb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7b348d310>]}
[0m15:50:08.987253 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:50:09.045614 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m15:50:09.046147 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:50:09.046482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2657949e-26e2-4ab1-be21-0e0b61cfacb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7b038ba50>]}
[0m15:50:09.938305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2657949e-26e2-4ab1-be21-0e0b61cfacb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7ae727a90>]}
[0m15:50:09.997053 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:50:09.999620 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:50:10.010506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2657949e-26e2-4ab1-be21-0e0b61cfacb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7ac16f8d0>]}
[0m15:50:10.010958 [info ] [MainThread]: Found 13 models, 6 seeds, 5 sources, 435 macros
[0m15:50:10.011286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2657949e-26e2-4ab1-be21-0e0b61cfacb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7affda2d0>]}
[0m15:50:10.012830 [info ] [MainThread]: 
[0m15:50:10.013177 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:50:10.013436 [info ] [MainThread]: 
[0m15:50:10.013791 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:50:10.017360 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb'
[0m15:50:10.044570 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m15:50:10.044943 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m15:50:10.045171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:10.055188 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m15:50:10.056473 [debug] [ThreadPool]: On list_salesdb: Close
[0m15:50:10.058274 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m15:50:10.058617 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m15:50:10.058972 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:10.062705 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m15:50:10.063778 [debug] [ThreadPool]: On list_salesdb: Close
[0m15:50:10.065464 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m15:50:10.065920 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m15:50:10.066220 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:10.069932 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m15:50:10.070872 [debug] [ThreadPool]: On list_salesdb: Close
[0m15:50:10.073819 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m15:50:10.074432 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m15:50:10.074717 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:10.078165 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m15:50:10.079154 [debug] [ThreadPool]: On list_salesdb: Close
[0m15:50:10.081321 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m15:50:10.081774 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m15:50:10.082097 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:10.085688 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m15:50:10.086590 [debug] [ThreadPool]: On list_salesdb: Close
[0m15:50:10.087304 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb, now create_salesdb_silver)
[0m15:50:10.087692 [debug] [ThreadPool]: Creating schema "database: "salesdb"
schema: "silver"
"
[0m15:50:10.091725 [debug] [ThreadPool]: Using postgres connection "create_salesdb_silver"
[0m15:50:10.092039 [debug] [ThreadPool]: On create_salesdb_silver: BEGIN
[0m15:50:10.092253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:10.095484 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:50:10.095784 [debug] [ThreadPool]: Using postgres connection "create_salesdb_silver"
[0m15:50:10.096000 [debug] [ThreadPool]: On create_salesdb_silver: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "create_salesdb_silver"} */
create schema if not exists "silver"
[0m15:50:10.097106 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m15:50:10.097824 [debug] [ThreadPool]: On create_salesdb_silver: COMMIT
[0m15:50:10.098105 [debug] [ThreadPool]: Using postgres connection "create_salesdb_silver"
[0m15:50:10.098319 [debug] [ThreadPool]: On create_salesdb_silver: COMMIT
[0m15:50:10.099486 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m15:50:10.099788 [debug] [ThreadPool]: On create_salesdb_silver: Close
[0m15:50:10.100287 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_salesdb_silver, now create_salesdb_bronze)
[0m15:50:10.100674 [debug] [ThreadPool]: Creating schema "database: "salesdb"
schema: "bronze"
"
[0m15:50:10.102081 [debug] [ThreadPool]: Using postgres connection "create_salesdb_bronze"
[0m15:50:10.102328 [debug] [ThreadPool]: On create_salesdb_bronze: BEGIN
[0m15:50:10.102531 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:10.105671 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:50:10.105968 [debug] [ThreadPool]: Using postgres connection "create_salesdb_bronze"
[0m15:50:10.106181 [debug] [ThreadPool]: On create_salesdb_bronze: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "create_salesdb_bronze"} */
create schema if not exists "bronze"
[0m15:50:10.106830 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m15:50:10.107587 [debug] [ThreadPool]: On create_salesdb_bronze: COMMIT
[0m15:50:10.107846 [debug] [ThreadPool]: Using postgres connection "create_salesdb_bronze"
[0m15:50:10.108049 [debug] [ThreadPool]: On create_salesdb_bronze: COMMIT
[0m15:50:10.109191 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m15:50:10.109688 [debug] [ThreadPool]: On create_salesdb_bronze: Close
[0m15:50:10.110269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_salesdb_bronze, now create_salesdb_gold)
[0m15:50:10.110691 [debug] [ThreadPool]: Creating schema "database: "salesdb"
schema: "gold"
"
[0m15:50:10.112227 [debug] [ThreadPool]: Using postgres connection "create_salesdb_gold"
[0m15:50:10.112510 [debug] [ThreadPool]: On create_salesdb_gold: BEGIN
[0m15:50:10.112720 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:10.116323 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:50:10.116788 [debug] [ThreadPool]: Using postgres connection "create_salesdb_gold"
[0m15:50:10.117048 [debug] [ThreadPool]: On create_salesdb_gold: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "create_salesdb_gold"} */
create schema if not exists "gold"
[0m15:50:10.117900 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m15:50:10.118944 [debug] [ThreadPool]: On create_salesdb_gold: COMMIT
[0m15:50:10.119308 [debug] [ThreadPool]: Using postgres connection "create_salesdb_gold"
[0m15:50:10.119678 [debug] [ThreadPool]: On create_salesdb_gold: COMMIT
[0m15:50:10.120783 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m15:50:10.121103 [debug] [ThreadPool]: On create_salesdb_gold: Close
[0m15:50:10.123114 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_salesdb_gold, now list_salesdb_public_raw_data)
[0m15:50:10.127669 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:50:10.128048 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m15:50:10.128272 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:10.131865 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:50:10.132225 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:50:10.132468 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m15:50:10.134959 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.002 seconds
[0m15:50:10.136134 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m15:50:10.136750 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m15:50:10.137302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now list_salesdb_silver)
[0m15:50:10.140001 [debug] [ThreadPool]: Using postgres connection "list_salesdb_silver"
[0m15:50:10.140307 [debug] [ThreadPool]: On list_salesdb_silver: BEGIN
[0m15:50:10.140518 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:10.143955 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:50:10.144261 [debug] [ThreadPool]: Using postgres connection "list_salesdb_silver"
[0m15:50:10.144502 [debug] [ThreadPool]: On list_salesdb_silver: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_silver"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m15:50:10.146656 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m15:50:10.147648 [debug] [ThreadPool]: On list_salesdb_silver: ROLLBACK
[0m15:50:10.148221 [debug] [ThreadPool]: On list_salesdb_silver: Close
[0m15:50:10.148705 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_silver, now list_salesdb_marts)
[0m15:50:10.150138 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m15:50:10.150465 [debug] [ThreadPool]: On list_salesdb_marts: BEGIN
[0m15:50:10.150680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:10.154098 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:50:10.154569 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m15:50:10.154823 [debug] [ThreadPool]: On list_salesdb_marts: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_marts"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m15:50:10.157141 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m15:50:10.158168 [debug] [ThreadPool]: On list_salesdb_marts: ROLLBACK
[0m15:50:10.158754 [debug] [ThreadPool]: On list_salesdb_marts: Close
[0m15:50:10.159323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_marts, now list_salesdb_bronze)
[0m15:50:10.161432 [debug] [ThreadPool]: Using postgres connection "list_salesdb_bronze"
[0m15:50:10.161770 [debug] [ThreadPool]: On list_salesdb_bronze: BEGIN
[0m15:50:10.161986 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:10.165925 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:50:10.166327 [debug] [ThreadPool]: Using postgres connection "list_salesdb_bronze"
[0m15:50:10.166597 [debug] [ThreadPool]: On list_salesdb_bronze: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_bronze"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m15:50:10.169223 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m15:50:10.171028 [debug] [ThreadPool]: On list_salesdb_bronze: ROLLBACK
[0m15:50:10.171767 [debug] [ThreadPool]: On list_salesdb_bronze: Close
[0m15:50:10.172334 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_bronze, now list_salesdb_staging)
[0m15:50:10.174142 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m15:50:10.174525 [debug] [ThreadPool]: On list_salesdb_staging: BEGIN
[0m15:50:10.174759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:10.178264 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:50:10.178644 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m15:50:10.178918 [debug] [ThreadPool]: On list_salesdb_staging: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_staging"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m15:50:10.181269 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m15:50:10.182472 [debug] [ThreadPool]: On list_salesdb_staging: ROLLBACK
[0m15:50:10.183170 [debug] [ThreadPool]: On list_salesdb_staging: Close
[0m15:50:10.183771 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_staging, now list_salesdb_gold)
[0m15:50:10.186162 [debug] [ThreadPool]: Using postgres connection "list_salesdb_gold"
[0m15:50:10.186480 [debug] [ThreadPool]: On list_salesdb_gold: BEGIN
[0m15:50:10.186713 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:10.190694 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:50:10.191031 [debug] [ThreadPool]: Using postgres connection "list_salesdb_gold"
[0m15:50:10.191305 [debug] [ThreadPool]: On list_salesdb_gold: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_gold"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m15:50:10.193688 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m15:50:10.194768 [debug] [ThreadPool]: On list_salesdb_gold: ROLLBACK
[0m15:50:10.195587 [debug] [ThreadPool]: On list_salesdb_gold: Close
[0m15:50:10.199812 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:10.200157 [debug] [MainThread]: On master: BEGIN
[0m15:50:10.200394 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:50:10.203778 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:50:10.204100 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:10.204403 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:50:10.221400 [debug] [MainThread]: SQL status: SELECT 17 in 0.017 seconds
[0m15:50:10.225145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2657949e-26e2-4ab1-be21-0e0b61cfacb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7a6115e10>]}
[0m15:50:10.225604 [debug] [MainThread]: On master: ROLLBACK
[0m15:50:10.226230 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:10.226542 [debug] [MainThread]: On master: BEGIN
[0m15:50:10.227332 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:50:10.227637 [debug] [MainThread]: On master: COMMIT
[0m15:50:10.227895 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:10.228115 [debug] [MainThread]: On master: COMMIT
[0m15:50:10.228665 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:50:10.229032 [debug] [MainThread]: On master: Close
[0m15:50:10.233470 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_appointments
[0m15:50:10.234134 [info ] [Thread-1 (]: 1 of 12 START sql view model staging.stg_appointments .......................... [RUN]
[0m15:50:10.234650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_gold, now model.modelling_handson.stg_appointments)
[0m15:50:10.235028 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_appointments
[0m15:50:10.241899 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_appointments"
[0m15:50:10.243974 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_appointments
[0m15:50:10.270803 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_appointments"
[0m15:50:10.271975 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_appointments"
[0m15:50:10.272322 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: BEGIN
[0m15:50:10.272575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:10.276431 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:50:10.276794 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_appointments"
[0m15:50:10.277135 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_appointments"} */

  create view "salesdb"."staging"."stg_appointments__dbt_tmp"
    
    
  as (
    select
id as appointment_id,
patient_id,
doctor_id,
appointment_date,
status,
department_id
from "salesdb"."public_raw_data"."appointments"
  );
[0m15:50:10.278614 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:50:10.283670 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_appointments"
[0m15:50:10.284065 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_appointments"} */
alter table "salesdb"."staging"."stg_appointments" rename to "stg_appointments__dbt_backup"
[0m15:50:10.284875 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:50:10.287117 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_appointments"
[0m15:50:10.287449 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_appointments"} */
alter table "salesdb"."staging"."stg_appointments__dbt_tmp" rename to "stg_appointments"
[0m15:50:10.288347 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:50:10.302977 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: COMMIT
[0m15:50:10.303456 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_appointments"
[0m15:50:10.303815 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: COMMIT
[0m15:50:10.306174 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:50:10.311309 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_appointments__dbt_backup"
[0m15:50:10.315827 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_appointments"
[0m15:50:10.316217 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_appointments"} */
drop view if exists "salesdb"."staging"."stg_appointments__dbt_backup" cascade
[0m15:50:10.318183 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:50:10.320129 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: Close
[0m15:50:10.321726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2657949e-26e2-4ab1-be21-0e0b61cfacb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7a5662010>]}
[0m15:50:10.322302 [info ] [Thread-1 (]: 1 of 12 OK created sql view model staging.stg_appointments ..................... [[32mCREATE VIEW[0m in 0.09s]
[0m15:50:10.322804 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_appointments
[0m15:50:10.323166 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_departments
[0m15:50:10.323746 [info ] [Thread-1 (]: 2 of 12 START sql view model staging.stg_departments ........................... [RUN]
[0m15:50:10.324239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_appointments, now model.modelling_handson.stg_departments)
[0m15:50:10.324680 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_departments
[0m15:50:10.326764 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_departments"
[0m15:50:10.327302 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_departments
[0m15:50:10.329712 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_departments"
[0m15:50:10.330215 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:50:10.330497 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: BEGIN
[0m15:50:10.330762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:10.334290 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m15:50:10.334662 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:50:10.334965 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */

  create view "salesdb"."staging"."stg_departments__dbt_tmp"
    
    
  as (
    select
    id as department_id,
    name as department_name
FROM "salesdb"."public_raw_data"."departments"
  );
[0m15:50:10.336407 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:50:10.338999 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:50:10.339401 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */
alter table "salesdb"."staging"."stg_departments" rename to "stg_departments__dbt_backup"
[0m15:50:10.340216 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:50:10.342435 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:50:10.344316 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */
alter table "salesdb"."staging"."stg_departments__dbt_tmp" rename to "stg_departments"
[0m15:50:10.345213 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:50:10.346291 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: COMMIT
[0m15:50:10.346610 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:50:10.346888 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: COMMIT
[0m15:50:10.348278 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:50:10.401193 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_departments__dbt_backup"
[0m15:50:10.401900 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m15:50:10.402205 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */
drop view if exists "salesdb"."staging"."stg_departments__dbt_backup" cascade
[0m15:50:10.405003 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:50:10.406215 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: Close
[0m15:50:10.406750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2657949e-26e2-4ab1-be21-0e0b61cfacb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7a55a22d0>]}
[0m15:50:10.407317 [info ] [Thread-1 (]: 2 of 12 OK created sql view model staging.stg_departments ...................... [[32mCREATE VIEW[0m in 0.08s]
[0m15:50:10.407761 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_departments
[0m15:50:10.408057 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_doctors
[0m15:50:10.408407 [info ] [Thread-1 (]: 3 of 12 START sql view model staging.stg_doctors ............................... [RUN]
[0m15:50:10.408855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_departments, now model.modelling_handson.stg_doctors)
[0m15:50:10.409127 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_doctors
[0m15:50:10.411188 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_doctors"
[0m15:50:10.411644 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_doctors
[0m15:50:10.413945 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_doctors"
[0m15:50:10.414408 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:50:10.414679 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: BEGIN
[0m15:50:10.414936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:10.419463 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:50:10.420019 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:50:10.420376 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */

  create view "salesdb"."staging"."stg_doctors__dbt_tmp"
    
    
  as (
    select
    id as doctor_id,
    name,
    specialization,
    department_id
FROM "salesdb"."public_raw_data"."doctors"
  );
[0m15:50:10.422915 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:50:10.425614 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:50:10.426222 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */
alter table "salesdb"."staging"."stg_doctors" rename to "stg_doctors__dbt_backup"
[0m15:50:10.427193 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:50:10.429422 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:50:10.429930 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */
alter table "salesdb"."staging"."stg_doctors__dbt_tmp" rename to "stg_doctors"
[0m15:50:10.430940 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:50:10.432252 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: COMMIT
[0m15:50:10.432626 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:50:10.432932 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: COMMIT
[0m15:50:10.434504 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:50:10.436423 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_doctors__dbt_backup"
[0m15:50:10.436965 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m15:50:10.437262 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */
drop view if exists "salesdb"."staging"."stg_doctors__dbt_backup" cascade
[0m15:50:10.439658 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:50:10.440860 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: Close
[0m15:50:10.441465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2657949e-26e2-4ab1-be21-0e0b61cfacb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7a55a0890>]}
[0m15:50:10.442013 [info ] [Thread-1 (]: 3 of 12 OK created sql view model staging.stg_doctors .......................... [[32mCREATE VIEW[0m in 0.03s]
[0m15:50:10.442484 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_doctors
[0m15:50:10.442863 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_patients
[0m15:50:10.443442 [info ] [Thread-1 (]: 4 of 12 START sql view model staging.stg_patients .............................. [RUN]
[0m15:50:10.444118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_doctors, now model.modelling_handson.stg_patients)
[0m15:50:10.444432 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_patients
[0m15:50:10.446542 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_patients"
[0m15:50:10.447079 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_patients
[0m15:50:10.451233 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_patients"
[0m15:50:10.451811 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:50:10.452116 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: BEGIN
[0m15:50:10.452363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:10.456646 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:50:10.457167 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:50:10.457499 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */

  create view "salesdb"."staging"."stg_patients__dbt_tmp"
    
    
  as (
    select
id as patient_id,
name,
gender,
dob,
city
FROM "salesdb"."public_raw_data"."patients"
  );
[0m15:50:10.459000 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:50:10.461722 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:50:10.462203 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */
alter table "salesdb"."staging"."stg_patients" rename to "stg_patients__dbt_backup"
[0m15:50:10.463272 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:50:10.465666 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:50:10.466021 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */
alter table "salesdb"."staging"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m15:50:10.466709 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:50:10.467736 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: COMMIT
[0m15:50:10.468262 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:50:10.468571 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: COMMIT
[0m15:50:10.469637 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:50:10.472604 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_patients__dbt_backup"
[0m15:50:10.473171 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m15:50:10.473467 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */
drop view if exists "salesdb"."staging"."stg_patients__dbt_backup" cascade
[0m15:50:10.474994 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:50:10.476049 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: Close
[0m15:50:10.476553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2657949e-26e2-4ab1-be21-0e0b61cfacb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7b1640c90>]}
[0m15:50:10.477065 [info ] [Thread-1 (]: 4 of 12 OK created sql view model staging.stg_patients ......................... [[32mCREATE VIEW[0m in 0.03s]
[0m15:50:10.477579 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_patients
[0m15:50:10.477922 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_treatments
[0m15:50:10.478850 [info ] [Thread-1 (]: 5 of 12 START sql view model staging.stg_treatments ............................ [RUN]
[0m15:50:10.479344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_patients, now model.modelling_handson.stg_treatments)
[0m15:50:10.479628 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_treatments
[0m15:50:10.483291 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_treatments"
[0m15:50:10.484143 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_treatments
[0m15:50:10.487625 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_treatments"
[0m15:50:10.488391 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_treatments"
[0m15:50:10.488718 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: BEGIN
[0m15:50:10.488976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:10.493057 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:50:10.493495 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_treatments"
[0m15:50:10.493782 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_treatments"} */

  create view "salesdb"."staging"."stg_treatments__dbt_tmp"
    
    
  as (
    select
id as treatment_id,
appointment_id,
treatment,
cost
from "salesdb"."public_raw_data"."treatments"
  );
[0m15:50:10.495494 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:50:10.498808 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_treatments"
[0m15:50:10.499686 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_treatments"} */
alter table "salesdb"."staging"."stg_treatments" rename to "stg_treatments__dbt_backup"
[0m15:50:10.500876 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:50:10.503803 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_treatments"
[0m15:50:10.504256 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_treatments"} */
alter table "salesdb"."staging"."stg_treatments__dbt_tmp" rename to "stg_treatments"
[0m15:50:10.505221 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:50:10.506454 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: COMMIT
[0m15:50:10.506815 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_treatments"
[0m15:50:10.507179 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: COMMIT
[0m15:50:10.508358 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:50:10.510356 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_treatments__dbt_backup"
[0m15:50:10.510915 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_treatments"
[0m15:50:10.511261 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_treatments"} */
drop view if exists "salesdb"."staging"."stg_treatments__dbt_backup" cascade
[0m15:50:10.513108 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:50:10.514262 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: Close
[0m15:50:10.514818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2657949e-26e2-4ab1-be21-0e0b61cfacb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7affbdb10>]}
[0m15:50:10.515642 [info ] [Thread-1 (]: 5 of 12 OK created sql view model staging.stg_treatments ....................... [[32mCREATE VIEW[0m in 0.04s]
[0m15:50:10.516133 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_treatments
[0m15:50:10.516457 [debug] [Thread-1 (]: Began running node model.modelling_handson.bronze_appointments
[0m15:50:10.517012 [info ] [Thread-1 (]: 6 of 12 START sql view model bronze.bronze_appointments ........................ [RUN]
[0m15:50:10.517642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_treatments, now model.modelling_handson.bronze_appointments)
[0m15:50:10.518027 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.bronze_appointments
[0m15:50:10.520352 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.bronze_appointments"
[0m15:50:10.521095 [debug] [Thread-1 (]: Began executing node model.modelling_handson.bronze_appointments
[0m15:50:10.523610 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.bronze_appointments"
[0m15:50:10.524424 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_appointments"
[0m15:50:10.524798 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: BEGIN
[0m15:50:10.525065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:10.528891 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:50:10.529366 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_appointments"
[0m15:50:10.529687 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.bronze_appointments"} */

  create view "salesdb"."bronze"."bronze_appointments__dbt_tmp"
    
    
  as (
    select * from "salesdb"."staging"."stg_appointments"
  );
[0m15:50:10.531611 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:50:10.534490 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_appointments"
[0m15:50:10.535202 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.bronze_appointments"} */
alter table "salesdb"."bronze"."bronze_appointments__dbt_tmp" rename to "bronze_appointments"
[0m15:50:10.536305 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:50:10.537430 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: COMMIT
[0m15:50:10.537792 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_appointments"
[0m15:50:10.538070 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: COMMIT
[0m15:50:10.539698 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:50:10.541718 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."bronze"."bronze_appointments__dbt_backup"
[0m15:50:10.542352 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_appointments"
[0m15:50:10.542662 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.bronze_appointments"} */
drop view if exists "salesdb"."bronze"."bronze_appointments__dbt_backup" cascade
[0m15:50:10.543609 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:50:10.544778 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: Close
[0m15:50:10.545349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2657949e-26e2-4ab1-be21-0e0b61cfacb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7af3caa50>]}
[0m15:50:10.545918 [info ] [Thread-1 (]: 6 of 12 OK created sql view model bronze.bronze_appointments ................... [[32mCREATE VIEW[0m in 0.03s]
[0m15:50:10.546418 [debug] [Thread-1 (]: Finished running node model.modelling_handson.bronze_appointments
[0m15:50:10.546790 [debug] [Thread-1 (]: Began running node model.modelling_handson.dim_doctors
[0m15:50:10.547566 [info ] [Thread-1 (]: 7 of 12 START sql table model marts.dim_doctors ................................ [RUN]
[0m15:50:10.548103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.bronze_appointments, now model.modelling_handson.dim_doctors)
[0m15:50:10.548418 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.dim_doctors
[0m15:50:10.551054 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.dim_doctors"
[0m15:50:10.551866 [debug] [Thread-1 (]: Began executing node model.modelling_handson.dim_doctors
[0m15:50:10.577492 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.dim_doctors"
[0m15:50:10.578657 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:50:10.579027 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: BEGIN
[0m15:50:10.579333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:10.583419 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:50:10.583854 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:50:10.584151 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */

  
    

  create  table "salesdb"."marts"."dim_doctors__dbt_tmp"
  
  
    as
  
  (
    select d.*, dep.department_name
from "salesdb"."staging"."stg_doctors" d
left join "salesdb"."staging"."stg_departments" dep
on d.department_id = dep.department_id
  );
  
[0m15:50:10.588537 [debug] [Thread-1 (]: SQL status: SELECT 50 in 0.004 seconds
[0m15:50:10.593946 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:50:10.594468 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */
alter table "salesdb"."marts"."dim_doctors" rename to "dim_doctors__dbt_backup"
[0m15:50:10.595484 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:50:10.597852 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:50:10.598186 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */
alter table "salesdb"."marts"."dim_doctors__dbt_tmp" rename to "dim_doctors"
[0m15:50:10.599038 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:50:10.600212 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: COMMIT
[0m15:50:10.600597 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:50:10.600872 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: COMMIT
[0m15:50:10.602135 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:50:10.604146 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."marts"."dim_doctors__dbt_backup"
[0m15:50:10.607072 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m15:50:10.607703 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */
drop table if exists "salesdb"."marts"."dim_doctors__dbt_backup" cascade
[0m15:50:10.610235 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:50:10.611648 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: Close
[0m15:50:10.612435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2657949e-26e2-4ab1-be21-0e0b61cfacb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7a55f3e10>]}
[0m15:50:10.613191 [info ] [Thread-1 (]: 7 of 12 OK created sql table model marts.dim_doctors ........................... [[32mSELECT 50[0m in 0.06s]
[0m15:50:10.613734 [debug] [Thread-1 (]: Finished running node model.modelling_handson.dim_doctors
[0m15:50:10.614081 [debug] [Thread-1 (]: Began running node model.modelling_handson.dim_patients
[0m15:50:10.614630 [info ] [Thread-1 (]: 8 of 12 START sql table model marts.dim_patients ............................... [RUN]
[0m15:50:10.615132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.dim_doctors, now model.modelling_handson.dim_patients)
[0m15:50:10.615441 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.dim_patients
[0m15:50:10.617636 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.dim_patients"
[0m15:50:10.618217 [debug] [Thread-1 (]: Began executing node model.modelling_handson.dim_patients
[0m15:50:10.621066 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.dim_patients"
[0m15:50:10.621816 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:50:10.622154 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: BEGIN
[0m15:50:10.622412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:10.629402 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m15:50:10.629894 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:50:10.630185 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */

  
    

  create  table "salesdb"."marts"."dim_patients__dbt_tmp"
  
  
    as
  
  (
    select * from "salesdb"."staging"."stg_patients"
  );
  
[0m15:50:10.635131 [debug] [Thread-1 (]: SQL status: SELECT 200 in 0.004 seconds
[0m15:50:10.638454 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:50:10.638818 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */
alter table "salesdb"."marts"."dim_patients" rename to "dim_patients__dbt_backup"
[0m15:50:10.639709 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:50:10.642082 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:50:10.642507 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */
alter table "salesdb"."marts"."dim_patients__dbt_tmp" rename to "dim_patients"
[0m15:50:10.643575 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:50:10.644677 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: COMMIT
[0m15:50:10.645031 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:50:10.645323 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: COMMIT
[0m15:50:10.646845 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:50:10.648806 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."marts"."dim_patients__dbt_backup"
[0m15:50:10.649383 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m15:50:10.649702 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */
drop table if exists "salesdb"."marts"."dim_patients__dbt_backup" cascade
[0m15:50:10.651424 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:50:10.652666 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: Close
[0m15:50:10.653239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2657949e-26e2-4ab1-be21-0e0b61cfacb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7a55a0090>]}
[0m15:50:10.653795 [info ] [Thread-1 (]: 8 of 12 OK created sql table model marts.dim_patients .......................... [[32mSELECT 200[0m in 0.04s]
[0m15:50:10.654286 [debug] [Thread-1 (]: Finished running node model.modelling_handson.dim_patients
[0m15:50:10.654616 [debug] [Thread-1 (]: Began running node model.modelling_handson.bronze_treatments
[0m15:50:10.655049 [info ] [Thread-1 (]: 9 of 12 START sql view model bronze.bronze_treatments .......................... [RUN]
[0m15:50:10.655713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.dim_patients, now model.modelling_handson.bronze_treatments)
[0m15:50:10.656053 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.bronze_treatments
[0m15:50:10.658176 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.bronze_treatments"
[0m15:50:10.658662 [debug] [Thread-1 (]: Began executing node model.modelling_handson.bronze_treatments
[0m15:50:10.663221 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.bronze_treatments"
[0m15:50:10.664046 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_treatments"
[0m15:50:10.664911 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: BEGIN
[0m15:50:10.665477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:10.670306 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m15:50:10.670757 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_treatments"
[0m15:50:10.671104 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.bronze_treatments"} */

  create view "salesdb"."bronze"."bronze_treatments__dbt_tmp"
    
    
  as (
    select * from "salesdb"."staging"."stg_treatments"
  );
[0m15:50:10.673016 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:50:10.675794 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_treatments"
[0m15:50:10.676196 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.bronze_treatments"} */
alter table "salesdb"."bronze"."bronze_treatments__dbt_tmp" rename to "bronze_treatments"
[0m15:50:10.677193 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:50:10.678319 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: COMMIT
[0m15:50:10.678741 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_treatments"
[0m15:50:10.679133 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: COMMIT
[0m15:50:10.680622 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:50:10.683495 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."bronze"."bronze_treatments__dbt_backup"
[0m15:50:10.684093 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_treatments"
[0m15:50:10.684407 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.bronze_treatments"} */
drop view if exists "salesdb"."bronze"."bronze_treatments__dbt_backup" cascade
[0m15:50:10.685194 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:50:10.686314 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: Close
[0m15:50:10.687101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2657949e-26e2-4ab1-be21-0e0b61cfacb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7afb03250>]}
[0m15:50:10.687680 [info ] [Thread-1 (]: 9 of 12 OK created sql view model bronze.bronze_treatments ..................... [[32mCREATE VIEW[0m in 0.03s]
[0m15:50:10.688157 [debug] [Thread-1 (]: Finished running node model.modelling_handson.bronze_treatments
[0m15:50:10.688491 [debug] [Thread-1 (]: Began running node model.modelling_handson.silver_appointments
[0m15:50:10.689097 [info ] [Thread-1 (]: 10 of 12 START sql table model silver.silver_appointments ...................... [RUN]
[0m15:50:10.689721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.bronze_treatments, now model.modelling_handson.silver_appointments)
[0m15:50:10.690036 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.silver_appointments
[0m15:50:10.692428 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.silver_appointments"
[0m15:50:10.693188 [debug] [Thread-1 (]: Began executing node model.modelling_handson.silver_appointments
[0m15:50:10.695766 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.silver_appointments"
[0m15:50:10.696525 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_appointments"
[0m15:50:10.696865 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: BEGIN
[0m15:50:10.697129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:10.701434 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:50:10.701842 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_appointments"
[0m15:50:10.702139 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_appointments"} */

  
    

  create  table "salesdb"."silver"."silver_appointments__dbt_tmp"
  
  
    as
  
  (
    select * from "salesdb"."bronze"."bronze_appointments"
where appointment_date is not null and status != 'cancelled'
  );
  
[0m15:50:10.705822 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.003 seconds
[0m15:50:10.708598 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_appointments"
[0m15:50:10.708992 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_appointments"} */
alter table "salesdb"."silver"."silver_appointments__dbt_tmp" rename to "silver_appointments"
[0m15:50:10.709884 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:50:10.711046 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: COMMIT
[0m15:50:10.711416 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_appointments"
[0m15:50:10.711729 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: COMMIT
[0m15:50:10.713250 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:50:10.715287 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."silver"."silver_appointments__dbt_backup"
[0m15:50:10.715894 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_appointments"
[0m15:50:10.716198 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_appointments"} */
drop table if exists "salesdb"."silver"."silver_appointments__dbt_backup" cascade
[0m15:50:10.717020 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m15:50:10.718118 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: Close
[0m15:50:10.718613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2657949e-26e2-4ab1-be21-0e0b61cfacb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7af35ad10>]}
[0m15:50:10.719182 [info ] [Thread-1 (]: 10 of 12 OK created sql table model silver.silver_appointments ................. [[32mSELECT 1000[0m in 0.03s]
[0m15:50:10.719640 [debug] [Thread-1 (]: Finished running node model.modelling_handson.silver_appointments
[0m15:50:10.720206 [debug] [Thread-1 (]: Began running node model.modelling_handson.silver_treatments
[0m15:50:10.720836 [info ] [Thread-1 (]: 11 of 12 START sql table model silver.silver_treatments ........................ [RUN]
[0m15:50:10.721299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.silver_appointments, now model.modelling_handson.silver_treatments)
[0m15:50:10.721607 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.silver_treatments
[0m15:50:10.723653 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.silver_treatments"
[0m15:50:10.724361 [debug] [Thread-1 (]: Began executing node model.modelling_handson.silver_treatments
[0m15:50:10.727500 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.silver_treatments"
[0m15:50:10.728125 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_treatments"
[0m15:50:10.728445 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: BEGIN
[0m15:50:10.728719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:10.733386 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m15:50:10.733845 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_treatments"
[0m15:50:10.734163 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_treatments"} */

  
    

  create  table "salesdb"."silver"."silver_treatments__dbt_tmp"
  
  
    as
  
  (
    select * from "salesdb"."bronze"."bronze_treatments"
where cost > 0
  );
  
[0m15:50:10.738456 [debug] [Thread-1 (]: SQL status: SELECT 800 in 0.004 seconds
[0m15:50:10.741150 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_treatments"
[0m15:50:10.741530 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_treatments"} */
alter table "salesdb"."silver"."silver_treatments__dbt_tmp" rename to "silver_treatments"
[0m15:50:10.742384 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:50:10.743439 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: COMMIT
[0m15:50:10.743774 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_treatments"
[0m15:50:10.744062 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: COMMIT
[0m15:50:10.745417 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:50:10.747273 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."silver"."silver_treatments__dbt_backup"
[0m15:50:10.747752 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_treatments"
[0m15:50:10.748036 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_treatments"} */
drop table if exists "salesdb"."silver"."silver_treatments__dbt_backup" cascade
[0m15:50:10.748702 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m15:50:10.749762 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: Close
[0m15:50:10.750272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2657949e-26e2-4ab1-be21-0e0b61cfacb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7aeb36fd0>]}
[0m15:50:10.750766 [info ] [Thread-1 (]: 11 of 12 OK created sql table model silver.silver_treatments ................... [[32mSELECT 800[0m in 0.03s]
[0m15:50:10.751255 [debug] [Thread-1 (]: Finished running node model.modelling_handson.silver_treatments
[0m15:50:10.752145 [debug] [Thread-1 (]: Began running node model.modelling_handson.gold_daily_metrics
[0m15:50:10.752534 [info ] [Thread-1 (]: 12 of 12 START sql table model gold.gold_daily_metrics ......................... [RUN]
[0m15:50:10.752897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.silver_treatments, now model.modelling_handson.gold_daily_metrics)
[0m15:50:10.753178 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.gold_daily_metrics
[0m15:50:10.756990 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.gold_daily_metrics"
[0m15:50:10.757680 [debug] [Thread-1 (]: Began executing node model.modelling_handson.gold_daily_metrics
[0m15:50:10.760123 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.gold_daily_metrics"
[0m15:50:10.761237 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.gold_daily_metrics"
[0m15:50:10.761550 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: BEGIN
[0m15:50:10.761986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:10.765802 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:50:10.766182 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.gold_daily_metrics"
[0m15:50:10.766466 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.gold_daily_metrics"} */

  
    

  create  table "salesdb"."gold"."gold_daily_metrics__dbt_tmp"
  
  
    as
  
  (
    select
a.appointment_date,
count(distinct a.appointment_id) as total_appointments,
count(distinct t.treatment_id) as total_treatments,
sum(t.cost) as revenue
from "salesdb"."silver"."silver_appointments" a
left join "salesdb"."silver"."silver_treatments" t
on a.appointment_id = t.appointment_id
group by a.appointment_date
  );
  
[0m15:50:10.769585 [debug] [Thread-1 (]: SQL status: SELECT 349 in 0.003 seconds
[0m15:50:10.772087 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.gold_daily_metrics"
[0m15:50:10.772451 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.gold_daily_metrics"} */
alter table "salesdb"."gold"."gold_daily_metrics__dbt_tmp" rename to "gold_daily_metrics"
[0m15:50:10.773170 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:50:10.774134 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: COMMIT
[0m15:50:10.774441 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.gold_daily_metrics"
[0m15:50:10.774712 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: COMMIT
[0m15:50:10.775720 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:50:10.777417 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."gold"."gold_daily_metrics__dbt_backup"
[0m15:50:10.777886 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.gold_daily_metrics"
[0m15:50:10.778165 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.gold_daily_metrics"} */
drop table if exists "salesdb"."gold"."gold_daily_metrics__dbt_backup" cascade
[0m15:50:10.778718 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m15:50:10.779714 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: Close
[0m15:50:10.780187 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2657949e-26e2-4ab1-be21-0e0b61cfacb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7af32b490>]}
[0m15:50:10.780694 [info ] [Thread-1 (]: 12 of 12 OK created sql table model gold.gold_daily_metrics .................... [[32mSELECT 349[0m in 0.03s]
[0m15:50:10.781131 [debug] [Thread-1 (]: Finished running node model.modelling_handson.gold_daily_metrics
[0m15:50:10.782504 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:10.782800 [debug] [MainThread]: On master: BEGIN
[0m15:50:10.783059 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:50:10.786325 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:50:10.786632 [debug] [MainThread]: On master: COMMIT
[0m15:50:10.786888 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:10.787119 [debug] [MainThread]: On master: COMMIT
[0m15:50:10.787646 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:50:10.787944 [debug] [MainThread]: On master: Close
[0m15:50:10.788329 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:10.788634 [debug] [MainThread]: Connection 'model.modelling_handson.gold_daily_metrics' was properly closed.
[0m15:50:10.788964 [info ] [MainThread]: 
[0m15:50:10.789249 [info ] [MainThread]: Finished running 5 table models, 7 view models in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m15:50:10.790682 [debug] [MainThread]: Command end result
[0m15:50:10.809324 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:50:10.810807 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:50:10.816438 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m15:50:10.816844 [info ] [MainThread]: 
[0m15:50:10.817200 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:50:10.817495 [info ] [MainThread]: 
[0m15:50:10.817796 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m15:50:10.818238 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:50:10.819236 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1146832, "process_in_blocks": "18568", "process_kernel_time": 0.305741, "process_mem_max_rss": "129352", "process_out_blocks": "3144", "process_user_time": 2.853591}
[0m15:50:10.819684 [debug] [MainThread]: Command `dbt run` succeeded at 15:50:10.819597 after 2.12 seconds
[0m15:50:10.819979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7b4eb8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7b4eb91d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7b4eb9410>]}
[0m15:50:10.820265 [debug] [MainThread]: Flushing usage events
[0m15:50:12.551291 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:58:35.505945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c447d12310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c44796c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c44796c710>]}


============================== 15:58:35.510001 | eb6c9b33-b37c-478f-8b06-39e79ee56f10 ==============================
[0m15:58:35.510001 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:58:35.510455 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/subhan/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:58:35.577762 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 50, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:58:35.578302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'eb6c9b33-b37c-478f-8b06-39e79ee56f10', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c4479e3590>]}
[0m15:58:35.677491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb6c9b33-b37c-478f-8b06-39e79ee56f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c4473bc6d0>]}
[0m15:58:35.725228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb6c9b33-b37c-478f-8b06-39e79ee56f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c44a5e9ad0>]}
[0m15:58:35.726484 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:58:35.782245 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m15:58:35.871029 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading modelling_handson: marts/schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | models:
    4  |   -name:dim_patients
    5  |     description: "Dimension table for patients"
    6  |     columns:
    7  |       - name: patient_id
    8  |         description: "Unique identifier for each patient"
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 16
[0m15:58:35.871569 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:58:35.872768 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 0.41253495, "process_in_blocks": "100424", "process_kernel_time": 0.242064, "process_mem_max_rss": "113840", "process_out_blocks": "8", "process_user_time": 1.430776}
[0m15:58:35.873201 [debug] [MainThread]: Command `dbt docs generate` failed at 15:58:35.873122 after 0.41 seconds
[0m15:58:35.873497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c446752d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c446753410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c446752850>]}
[0m15:58:35.873809 [debug] [MainThread]: Flushing usage events
[0m15:58:37.027870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:59:21.768567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73df2fe64ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73df2febd150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73df30323250>]}


============================== 15:59:21.771034 | dd09af60-851d-4e8b-b81d-65f7d2cd139d ==============================
[0m15:59:21.771034 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:59:21.771484 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/subhan/.dbt', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:59:21.810036 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 50, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:59:21.810553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dd09af60-851d-4e8b-b81d-65f7d2cd139d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73df2febdfd0>]}
[0m15:59:21.899740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd09af60-851d-4e8b-b81d-65f7d2cd139d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73df2f5b2a90>]}
[0m15:59:21.947394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd09af60-851d-4e8b-b81d-65f7d2cd139d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73df32ad14d0>]}
[0m15:59:21.948148 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:59:21.995146 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m15:59:22.072003 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading modelling_handson: marts/schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | models:
    4  |   -name:dim_patients
    5  |     description: "Dimension table for patients"
    6  |     columns:
    7  |       - name: patient_id
    8  |         description: "Unique identifier for each patient"
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 16
[0m15:59:22.072729 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:59:22.073512 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 0.34674484, "process_in_blocks": "0", "process_kernel_time": 0.17309, "process_mem_max_rss": "113804", "process_out_blocks": "16", "process_user_time": 1.3214}
[0m15:59:22.073923 [debug] [MainThread]: Command `dbt docs generate` failed at 15:59:22.073851 after 0.35 seconds
[0m15:59:22.074198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73df2fec82d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73df2fe95a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73df2fe5fe90>]}
[0m15:59:22.074466 [debug] [MainThread]: Flushing usage events
[0m15:59:23.498276 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:00:28.429295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a05560d690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a055778a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a0555ad0d0>]}


============================== 16:00:28.432098 | bed2473c-d352-414f-94e3-6821d9d373a6 ==============================
[0m16:00:28.432098 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:00:28.432698 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'fail_fast': 'False', 'profiles_dir': '/home/subhan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:00:28.486177 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 50, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m16:00:28.486756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bed2473c-d352-414f-94e3-6821d9d373a6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a055647910>]}
[0m16:00:28.594473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bed2473c-d352-414f-94e3-6821d9d373a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a054fcadd0>]}
[0m16:00:28.655743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bed2473c-d352-414f-94e3-6821d9d373a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a0581fd5d0>]}
[0m16:00:28.656636 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:00:28.714880 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:00:28.801700 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading modelling_handson: marts/schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | models:
    4  |   -name:dim_patients
    5  |     description: "Dimension table for patients"
    6  |     columns:
    7  |       - name: patient_id
    8  |         description: "Unique identifier for each patient"
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 16
[0m16:00:28.802320 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:00:28.803137 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 0.4384933, "process_in_blocks": "0", "process_kernel_time": 0.231821, "process_mem_max_rss": "113532", "process_out_blocks": "16", "process_user_time": 1.500518}
[0m16:00:28.803618 [debug] [MainThread]: Command `dbt docs generate` failed at 16:00:28.803512 after 0.44 seconds
[0m16:00:28.803952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a0555acfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a05436c490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a0555afe90>]}
[0m16:00:28.804278 [debug] [MainThread]: Flushing usage events
[0m16:00:30.274285 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:00:45.543223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e6aaaa95d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e6aad77310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e6aaaaa650>]}


============================== 16:00:45.546527 | 2a9d92c4-b47e-4d71-8854-09d667b6e1b9 ==============================
[0m16:00:45.546527 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:00:45.547138 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/subhan/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m16:00:45.599142 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 50, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m16:00:45.599804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2a9d92c4-b47e-4d71-8854-09d667b6e1b9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e6aa587f50>]}
[0m16:00:45.723281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a9d92c4-b47e-4d71-8854-09d667b6e1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e6aa1be6d0>]}
[0m16:00:45.792773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a9d92c4-b47e-4d71-8854-09d667b6e1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e6ad7394d0>]}
[0m16:00:45.794363 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:00:45.870936 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:00:45.986808 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading modelling_handson: marts/schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | models:
    4  |   -name:dim_patients
    5  |     description: "Dimension table for patients"
    6  |     columns:
    7  |       - name: patient_id
    8  |         description: "Unique identifier for each patient"
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 16
[0m16:00:45.987624 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:00:45.988686 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 0.49487516, "process_in_blocks": "0", "process_kernel_time": 0.215768, "process_mem_max_rss": "113880", "process_out_blocks": "8", "process_user_time": 1.704567}
[0m16:00:45.989226 [debug] [MainThread]: Command `dbt docs generate` failed at 16:00:45.989123 after 0.50 seconds
[0m16:00:45.989605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e6aaaa9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e6aaaddb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e6aaaa0490>]}
[0m16:00:45.989981 [debug] [MainThread]: Flushing usage events
[0m16:00:47.228107 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:01:38.604916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abf3a9a8650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abf3ac77490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abf3a9a8250>]}


============================== 16:01:38.607834 | 2699557a-1158-4e9e-962e-5c09e1311d6f ==============================
[0m16:01:38.607834 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:01:38.608327 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/subhan/.dbt', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m16:01:38.646872 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 50, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m16:01:38.647396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2699557a-1158-4e9e-962e-5c09e1311d6f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abf3aa27290>]}
[0m16:01:38.741687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2699557a-1158-4e9e-962e-5c09e1311d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abf3d5848d0>]}
[0m16:01:38.794572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2699557a-1158-4e9e-962e-5c09e1311d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abf3d5fdbd0>]}
[0m16:01:38.795400 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:01:38.857647 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:01:38.986508 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:01:38.987391 [debug] [MainThread]: Partial parsing: added file: modelling_handson://models/marts/schema.yml
[0m16:01:39.132724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2699557a-1158-4e9e-962e-5c09e1311d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abf3afc2ad0>]}
[0m16:01:39.156864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2699557a-1158-4e9e-962e-5c09e1311d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abf38fdbf90>]}
[0m16:01:39.157323 [info ] [MainThread]: Found 13 models, 6 seeds, 5 sources, 435 macros
[0m16:01:39.157624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2699557a-1158-4e9e-962e-5c09e1311d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abf3a30ad90>]}
[0m16:01:39.159922 [info ] [MainThread]: 
[0m16:01:39.160251 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:01:39.160654 [info ] [MainThread]: 
[0m16:01:39.161065 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:01:39.165406 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb_staging'
[0m16:01:39.246983 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m16:01:39.247441 [debug] [ThreadPool]: On list_salesdb_staging: BEGIN
[0m16:01:39.247726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:39.257274 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m16:01:39.257680 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m16:01:39.257937 [debug] [ThreadPool]: On list_salesdb_staging: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_staging"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m16:01:39.260489 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m16:01:39.261683 [debug] [ThreadPool]: On list_salesdb_staging: ROLLBACK
[0m16:01:39.262368 [debug] [ThreadPool]: On list_salesdb_staging: Close
[0m16:01:39.262990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_staging, now list_salesdb_bronze)
[0m16:01:39.265424 [debug] [ThreadPool]: Using postgres connection "list_salesdb_bronze"
[0m16:01:39.265723 [debug] [ThreadPool]: On list_salesdb_bronze: BEGIN
[0m16:01:39.266120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:39.269321 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:01:39.269624 [debug] [ThreadPool]: Using postgres connection "list_salesdb_bronze"
[0m16:01:39.269870 [debug] [ThreadPool]: On list_salesdb_bronze: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_bronze"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m16:01:39.272338 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m16:01:39.273494 [debug] [ThreadPool]: On list_salesdb_bronze: ROLLBACK
[0m16:01:39.274039 [debug] [ThreadPool]: On list_salesdb_bronze: Close
[0m16:01:39.274554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_bronze, now list_salesdb_silver)
[0m16:01:39.276563 [debug] [ThreadPool]: Using postgres connection "list_salesdb_silver"
[0m16:01:39.276855 [debug] [ThreadPool]: On list_salesdb_silver: BEGIN
[0m16:01:39.277063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:39.280544 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:01:39.280856 [debug] [ThreadPool]: Using postgres connection "list_salesdb_silver"
[0m16:01:39.281089 [debug] [ThreadPool]: On list_salesdb_silver: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_silver"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m16:01:39.283179 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m16:01:39.284171 [debug] [ThreadPool]: On list_salesdb_silver: ROLLBACK
[0m16:01:39.285295 [debug] [ThreadPool]: On list_salesdb_silver: Close
[0m16:01:39.285814 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_silver, now list_salesdb_public_raw_data)
[0m16:01:39.287697 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m16:01:39.287991 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m16:01:39.288227 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:39.291411 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:01:39.291908 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m16:01:39.292391 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m16:01:39.294889 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.002 seconds
[0m16:01:39.296119 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m16:01:39.296846 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m16:01:39.297460 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now list_salesdb_marts)
[0m16:01:39.299117 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m16:01:39.302106 [debug] [ThreadPool]: On list_salesdb_marts: BEGIN
[0m16:01:39.302418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:39.306506 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m16:01:39.306961 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m16:01:39.307290 [debug] [ThreadPool]: On list_salesdb_marts: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_marts"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m16:01:39.309911 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m16:01:39.311016 [debug] [ThreadPool]: On list_salesdb_marts: ROLLBACK
[0m16:01:39.311736 [debug] [ThreadPool]: On list_salesdb_marts: Close
[0m16:01:39.312328 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_marts, now list_salesdb_gold)
[0m16:01:39.314121 [debug] [ThreadPool]: Using postgres connection "list_salesdb_gold"
[0m16:01:39.314842 [debug] [ThreadPool]: On list_salesdb_gold: BEGIN
[0m16:01:39.315114 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:39.318952 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m16:01:39.319300 [debug] [ThreadPool]: Using postgres connection "list_salesdb_gold"
[0m16:01:39.319595 [debug] [ThreadPool]: On list_salesdb_gold: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_gold"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m16:01:39.322087 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m16:01:39.323428 [debug] [ThreadPool]: On list_salesdb_gold: ROLLBACK
[0m16:01:39.323987 [debug] [ThreadPool]: On list_salesdb_gold: Close
[0m16:01:39.328957 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:39.329338 [debug] [MainThread]: On master: BEGIN
[0m16:01:39.329633 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:01:39.333269 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m16:01:39.333650 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:39.333947 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:01:39.351602 [debug] [MainThread]: SQL status: SELECT 13 in 0.017 seconds
[0m16:01:39.354782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2699557a-1158-4e9e-962e-5c09e1311d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abf38f49590>]}
[0m16:01:39.355216 [debug] [MainThread]: On master: ROLLBACK
[0m16:01:39.355997 [debug] [MainThread]: On master: Close
[0m16:01:39.360799 [debug] [Thread-1 (]: Began running node model.modelling_handson.fact_appointments
[0m16:01:39.361229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_gold, now model.modelling_handson.fact_appointments)
[0m16:01:39.361533 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.fact_appointments
[0m16:01:39.366788 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.fact_appointments"
[0m16:01:39.367384 [debug] [Thread-1 (]: Began executing node model.modelling_handson.fact_appointments
[0m16:01:39.368115 [debug] [Thread-1 (]: Finished running node model.modelling_handson.fact_appointments
[0m16:01:39.368459 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_appointments
[0m16:01:39.368945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.fact_appointments, now model.modelling_handson.stg_appointments)
[0m16:01:39.369269 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_appointments
[0m16:01:39.371471 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_appointments"
[0m16:01:39.371932 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_appointments
[0m16:01:39.372425 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_appointments
[0m16:01:39.372718 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_departments
[0m16:01:39.373170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_appointments, now model.modelling_handson.stg_departments)
[0m16:01:39.373815 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_departments
[0m16:01:39.375717 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_departments"
[0m16:01:39.376164 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_departments
[0m16:01:39.376627 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_departments
[0m16:01:39.376915 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_doctors
[0m16:01:39.377429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_departments, now model.modelling_handson.stg_doctors)
[0m16:01:39.377751 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_doctors
[0m16:01:39.380868 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_doctors"
[0m16:01:39.381336 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_doctors
[0m16:01:39.381804 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_doctors
[0m16:01:39.382088 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_patients
[0m16:01:39.382633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_doctors, now model.modelling_handson.stg_patients)
[0m16:01:39.382958 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_patients
[0m16:01:39.384825 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_patients"
[0m16:01:39.385252 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_patients
[0m16:01:39.385713 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_patients
[0m16:01:39.386013 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_treatments
[0m16:01:39.386411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_patients, now model.modelling_handson.stg_treatments)
[0m16:01:39.386855 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_treatments
[0m16:01:39.388730 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_treatments"
[0m16:01:39.389139 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_treatments
[0m16:01:39.389588 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_treatments
[0m16:01:39.389874 [debug] [Thread-1 (]: Began running node seed.modelling_handson.appointments
[0m16:01:39.390325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_treatments, now seed.modelling_handson.appointments)
[0m16:01:39.390688 [debug] [Thread-1 (]: Began compiling node seed.modelling_handson.appointments
[0m16:01:39.392001 [debug] [Thread-1 (]: Began executing node seed.modelling_handson.appointments
[0m16:01:39.392492 [debug] [Thread-1 (]: Finished running node seed.modelling_handson.appointments
[0m16:01:39.392774 [debug] [Thread-1 (]: Began running node seed.modelling_handson.departments
[0m16:01:39.393199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.modelling_handson.appointments, now seed.modelling_handson.departments)
[0m16:01:39.393465 [debug] [Thread-1 (]: Began compiling node seed.modelling_handson.departments
[0m16:01:39.394750 [debug] [Thread-1 (]: Began executing node seed.modelling_handson.departments
[0m16:01:39.395246 [debug] [Thread-1 (]: Finished running node seed.modelling_handson.departments
[0m16:01:39.395572 [debug] [Thread-1 (]: Began running node seed.modelling_handson.diagnoses
[0m16:01:39.395916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.modelling_handson.departments, now seed.modelling_handson.diagnoses)
[0m16:01:39.396159 [debug] [Thread-1 (]: Began compiling node seed.modelling_handson.diagnoses
[0m16:01:39.397321 [debug] [Thread-1 (]: Began executing node seed.modelling_handson.diagnoses
[0m16:01:39.397796 [debug] [Thread-1 (]: Finished running node seed.modelling_handson.diagnoses
[0m16:01:39.398308 [debug] [Thread-1 (]: Began running node seed.modelling_handson.doctors
[0m16:01:39.398732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.modelling_handson.diagnoses, now seed.modelling_handson.doctors)
[0m16:01:39.399035 [debug] [Thread-1 (]: Began compiling node seed.modelling_handson.doctors
[0m16:01:39.400311 [debug] [Thread-1 (]: Began executing node seed.modelling_handson.doctors
[0m16:01:39.400783 [debug] [Thread-1 (]: Finished running node seed.modelling_handson.doctors
[0m16:01:39.401064 [debug] [Thread-1 (]: Began running node seed.modelling_handson.patients
[0m16:01:39.401445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.modelling_handson.doctors, now seed.modelling_handson.patients)
[0m16:01:39.401741 [debug] [Thread-1 (]: Began compiling node seed.modelling_handson.patients
[0m16:01:39.402904 [debug] [Thread-1 (]: Began executing node seed.modelling_handson.patients
[0m16:01:39.403489 [debug] [Thread-1 (]: Finished running node seed.modelling_handson.patients
[0m16:01:39.403796 [debug] [Thread-1 (]: Began running node seed.modelling_handson.treatments
[0m16:01:39.404081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.modelling_handson.patients, now seed.modelling_handson.treatments)
[0m16:01:39.404514 [debug] [Thread-1 (]: Began compiling node seed.modelling_handson.treatments
[0m16:01:39.405864 [debug] [Thread-1 (]: Began executing node seed.modelling_handson.treatments
[0m16:01:39.406379 [debug] [Thread-1 (]: Finished running node seed.modelling_handson.treatments
[0m16:01:39.406779 [debug] [Thread-1 (]: Began running node model.modelling_handson.bronze_appointments
[0m16:01:39.407258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.modelling_handson.treatments, now model.modelling_handson.bronze_appointments)
[0m16:01:39.407625 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.bronze_appointments
[0m16:01:39.409624 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.bronze_appointments"
[0m16:01:39.410182 [debug] [Thread-1 (]: Began executing node model.modelling_handson.bronze_appointments
[0m16:01:39.410690 [debug] [Thread-1 (]: Finished running node model.modelling_handson.bronze_appointments
[0m16:01:39.410986 [debug] [Thread-1 (]: Began running node model.modelling_handson.dim_doctors
[0m16:01:39.411278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.bronze_appointments, now model.modelling_handson.dim_doctors)
[0m16:01:39.411648 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.dim_doctors
[0m16:01:39.414032 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.dim_doctors"
[0m16:01:39.414872 [debug] [Thread-1 (]: Began executing node model.modelling_handson.dim_doctors
[0m16:01:39.415390 [debug] [Thread-1 (]: Finished running node model.modelling_handson.dim_doctors
[0m16:01:39.415680 [debug] [Thread-1 (]: Began running node model.modelling_handson.dim_patients
[0m16:01:39.416047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.dim_doctors, now model.modelling_handson.dim_patients)
[0m16:01:39.416304 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.dim_patients
[0m16:01:39.418444 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.dim_patients"
[0m16:01:39.418917 [debug] [Thread-1 (]: Began executing node model.modelling_handson.dim_patients
[0m16:01:39.419474 [debug] [Thread-1 (]: Finished running node model.modelling_handson.dim_patients
[0m16:01:39.419806 [debug] [Thread-1 (]: Began running node model.modelling_handson.bronze_treatments
[0m16:01:39.420226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.dim_patients, now model.modelling_handson.bronze_treatments)
[0m16:01:39.420525 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.bronze_treatments
[0m16:01:39.423908 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.bronze_treatments"
[0m16:01:39.424422 [debug] [Thread-1 (]: Began executing node model.modelling_handson.bronze_treatments
[0m16:01:39.424890 [debug] [Thread-1 (]: Finished running node model.modelling_handson.bronze_treatments
[0m16:01:39.425169 [debug] [Thread-1 (]: Began running node model.modelling_handson.silver_appointments
[0m16:01:39.425588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.bronze_treatments, now model.modelling_handson.silver_appointments)
[0m16:01:39.426329 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.silver_appointments
[0m16:01:39.429370 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.silver_appointments"
[0m16:01:39.429876 [debug] [Thread-1 (]: Began executing node model.modelling_handson.silver_appointments
[0m16:01:39.430420 [debug] [Thread-1 (]: Finished running node model.modelling_handson.silver_appointments
[0m16:01:39.430830 [debug] [Thread-1 (]: Began running node model.modelling_handson.silver_treatments
[0m16:01:39.431129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.silver_appointments, now model.modelling_handson.silver_treatments)
[0m16:01:39.431538 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.silver_treatments
[0m16:01:39.433439 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.silver_treatments"
[0m16:01:39.433889 [debug] [Thread-1 (]: Began executing node model.modelling_handson.silver_treatments
[0m16:01:39.434372 [debug] [Thread-1 (]: Finished running node model.modelling_handson.silver_treatments
[0m16:01:39.435229 [debug] [Thread-1 (]: Began running node model.modelling_handson.gold_daily_metrics
[0m16:01:39.435620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.silver_treatments, now model.modelling_handson.gold_daily_metrics)
[0m16:01:39.435896 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.gold_daily_metrics
[0m16:01:39.437974 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.gold_daily_metrics"
[0m16:01:39.438427 [debug] [Thread-1 (]: Began executing node model.modelling_handson.gold_daily_metrics
[0m16:01:39.438905 [debug] [Thread-1 (]: Finished running node model.modelling_handson.gold_daily_metrics
[0m16:01:39.440101 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:01:39.440368 [debug] [MainThread]: Connection 'model.modelling_handson.gold_daily_metrics' was properly closed.
[0m16:01:39.441897 [debug] [MainThread]: Command end result
[0m16:01:39.505722 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m16:01:39.507622 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m16:01:39.512721 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m16:01:39.516907 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m16:01:39.517176 [info ] [MainThread]: Building catalog
[0m16:01:39.524835 [debug] [ThreadPool]: Acquiring new postgres connection 'salesdb.information_schema'
[0m16:01:39.530043 [debug] [ThreadPool]: Using postgres connection "salesdb.information_schema"
[0m16:01:39.530648 [debug] [ThreadPool]: On salesdb.information_schema: BEGIN
[0m16:01:39.530886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:39.534665 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m16:01:39.535113 [debug] [ThreadPool]: Using postgres connection "salesdb.information_schema"
[0m16:01:39.535478 [debug] [ThreadPool]: On salesdb.information_schema: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "salesdb.information_schema"} */

    
    

    select
        'salesdb' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('marts') and
           upper(tbl.relname) = upper('dim_doctors')) or (upper(sch.nspname) = upper('public_raw_data') and
           upper(tbl.relname) = upper('doctors')) or (upper(sch.nspname) = upper('silver') and
           upper(tbl.relname) = upper('silver_treatments')) or (upper(sch.nspname) = upper('public_raw_data') and
           upper(tbl.relname) = upper('patients')) or (upper(sch.nspname) = upper('public_raw_data') and
           upper(tbl.relname) = upper('departments')) or (upper(sch.nspname) = upper('public_raw_data') and
           upper(tbl.relname) = upper('treatments')) or (upper(sch.nspname) = upper('silver') and
           upper(tbl.relname) = upper('silver_appointments')) or (upper(sch.nspname) = upper('staging') and
           upper(tbl.relname) = upper('stg_doctors')) or (upper(sch.nspname) = upper('bronze') and
           upper(tbl.relname) = upper('bronze_appointments')) or (upper(sch.nspname) = upper('marts') and
           upper(tbl.relname) = upper('fact_appointments')) or (upper(sch.nspname) = upper('staging') and
           upper(tbl.relname) = upper('stg_departments')) or (upper(sch.nspname) = upper('bronze') and
           upper(tbl.relname) = upper('bronze_treatments')) or (upper(sch.nspname) = upper('public_raw_data') and
           upper(tbl.relname) = upper('appointments')) or (upper(sch.nspname) = upper('public_raw_data') and
           upper(tbl.relname) = upper('diagnoses')) or (upper(sch.nspname) = upper('gold') and
           upper(tbl.relname) = upper('gold_daily_metrics')) or (upper(sch.nspname) = upper('staging') and
           upper(tbl.relname) = upper('stg_patients')) or (upper(sch.nspname) = upper('staging') and
           upper(tbl.relname) = upper('stg_treatments')) or (upper(sch.nspname) = upper('marts') and
           upper(tbl.relname) = upper('dim_patients')) or (upper(sch.nspname) = upper('staging') and
           upper(tbl.relname) = upper('stg_appointments')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m16:01:39.540925 [debug] [ThreadPool]: SQL status: SELECT 80 in 0.005 seconds
[0m16:01:39.543942 [debug] [ThreadPool]: On salesdb.information_schema: ROLLBACK
[0m16:01:39.544611 [debug] [ThreadPool]: On salesdb.information_schema: Close
[0m16:01:39.556705 [debug] [MainThread]: Wrote artifact CatalogArtifact to /home/subhan/dbt/modelling_handson/target/catalog.json
[0m16:01:39.573782 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m16:01:39.575333 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m16:01:39.575663 [info ] [MainThread]: Catalog written to /home/subhan/dbt/modelling_handson/target/catalog.json
[0m16:01:39.576200 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:01:39.577047 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.0151321, "process_in_blocks": "11024", "process_kernel_time": 0.216988, "process_mem_max_rss": "124728", "process_out_blocks": "6416", "process_user_time": 1.935875}
[0m16:01:39.577431 [debug] [MainThread]: Command `dbt docs generate` succeeded at 16:01:39.577360 after 1.02 seconds
[0m16:01:39.577684 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m16:01:39.577890 [debug] [MainThread]: Connection 'salesdb.information_schema' was properly closed.
[0m16:01:39.578127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abf3aa0d350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abf3efb8f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abf3bcbd010>]}
[0m16:01:39.578435 [debug] [MainThread]: Flushing usage events
[0m16:01:40.858336 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:02:04.540962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a206a8bfd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a206a8bf750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a206a8bc090>]}


============================== 16:02:04.543420 | fbb88f4b-66b3-4fc0-951e-6672e20b0d24 ==============================
[0m16:02:04.543420 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:02:04.543874 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/subhan/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:02:04.585456 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 50, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m16:02:04.585987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fbb88f4b-66b3-4fc0-951e-6672e20b0d24', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a206a914cd0>]}
[0m16:02:04.682448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbb88f4b-66b3-4fc0-951e-6672e20b0d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a206a5db450>]}
[0m16:02:04.733163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbb88f4b-66b3-4fc0-951e-6672e20b0d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a206d50ccd0>]}
[0m16:08:02.940285 [error] [MainThread]: Encountered an error:

[0m16:08:02.943779 [error] [MainThread]: Traceback (most recent call last):
  File "/home/subhan/dbt/env/lib/python3.11/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/subhan/dbt/env/lib/python3.11/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/subhan/dbt/env/lib/python3.11/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/subhan/dbt/env/lib/python3.11/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/subhan/dbt/env/lib/python3.11/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/subhan/dbt/env/lib/python3.11/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/subhan/dbt/env/lib/python3.11/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/home/subhan/.pyenv/versions/3.11.8/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/subhan/.pyenv/versions/3.11.8/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m16:08:02.944528 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:08:02.945802 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 336.01505, "process_in_blocks": "1928", "process_kernel_time": 0.244284, "process_mem_max_rss": "110576", "process_out_blocks": "3360", "process_user_time": 1.319994}
[0m16:08:02.946424 [debug] [MainThread]: Command `dbt docs serve` failed at 16:08:02.946339 after 336.02 seconds
[0m16:08:02.946987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a206a90cc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a206a8bdf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a206a8bd210>]}
[0m16:08:02.947508 [debug] [MainThread]: Flushing usage events
[0m16:08:04.332987 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:16:37.035097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a91ac653d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a91ac65390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a91ac64d50>]}


============================== 16:16:37.037534 | 85a6e303-9296-4fea-8490-0cf8ac525339 ==============================
[0m16:16:37.037534 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:16:37.037957 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/subhan/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:16:37.077033 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 50, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m16:16:37.077505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '85a6e303-9296-4fea-8490-0cf8ac525339', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a91a765a50>]}
[0m16:16:37.164122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85a6e303-9296-4fea-8490-0cf8ac525339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a91a3a7290>]}
[0m16:16:37.218068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85a6e303-9296-4fea-8490-0cf8ac525339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a91d8c5850>]}
[0m16:16:37.219025 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:16:37.275927 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:16:37.374150 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading modelling_handson: marts/schema.yml - Runtime Error
    Syntax error near line 14
    ------------------------------
    11 |         tests:[
    12 |           not_null,
    13 |           unique
    14 |         ]
    15 |       - name: patient_name
    16 |         description: "Name of the patient"
    17 |       - name: gender
    
    Raw Error:
    ------------------------------
    while scanning a simple key
      in "<unicode string>", line 11, column 9
    could not find expected ':'
      in "<unicode string>", line 14, column 9
[0m16:16:37.375330 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:16:37.376545 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.38160077, "process_in_blocks": "0", "process_kernel_time": 0.203482, "process_mem_max_rss": "114472", "process_out_blocks": "16", "process_user_time": 1.34383}
[0m16:16:37.377011 [debug] [MainThread]: Command `dbt test` failed at 16:16:37.376922 after 0.38 seconds
[0m16:16:37.377402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a91f2b8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a91f2b9410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a91ac5fbd0>]}
[0m16:16:37.377905 [debug] [MainThread]: Flushing usage events
[0m16:16:38.459099 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:17:12.086322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c684f3b4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c684f683050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c684f683290>]}


============================== 16:17:12.088752 | a7995e1b-c1f6-4c6b-b210-6a27c9afc775 ==============================
[0m16:17:12.088752 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:17:12.089184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'profiles_dir': '/home/subhan/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m16:17:12.127293 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 50, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m16:17:12.127771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a7995e1b-c1f6-4c6b-b210-6a27c9afc775', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6851a63d50>]}
[0m16:17:12.212010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7995e1b-c1f6-4c6b-b210-6a27c9afc775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c684f357790>]}
[0m16:17:12.259111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7995e1b-c1f6-4c6b-b210-6a27c9afc775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6851ff9610>]}
[0m16:17:12.259866 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:17:12.303856 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:17:12.388974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:17:12.389433 [debug] [MainThread]: Partial parsing: added file: modelling_handson://tests/test_ages.sql
[0m16:17:12.389821 [debug] [MainThread]: Partial parsing: updated file: modelling_handson://models/marts/schema.yml
[0m16:17:12.618761 [error] [MainThread]: Encountered an error:
Compilation Error in test test_ages (tests/test_ages.sql)
  The name argument to ref() must be a string, got <class 'dbt_common.clients.jinja.create_undefined.<locals>.Undefined'>
[0m16:17:12.619711 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:17:12.620550 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.57709044, "process_in_blocks": "664", "process_kernel_time": 0.187594, "process_mem_max_rss": "119468", "process_out_blocks": "8", "process_user_time": 1.594554}
[0m16:17:12.620913 [debug] [MainThread]: Command `dbt test` failed at 16:17:12.620842 after 0.58 seconds
[0m16:17:12.621211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c684f3e59d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c68539b8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c684ddee390>]}
[0m16:17:12.621501 [debug] [MainThread]: Flushing usage events
[0m16:17:13.771275 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:17:49.426907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38e5dbc550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38e5dbfbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38e5dbf990>]}


============================== 16:17:49.429248 | f9b41605-5275-4a2f-8d81-0c68d11579b7 ==============================
[0m16:17:49.429248 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:17:49.429673 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'debug': 'False', 'profiles_dir': '/home/subhan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m16:17:49.466094 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 50, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m16:17:49.466542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f9b41605-5275-4a2f-8d81-0c68d11579b7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38e5e49c50>]}
[0m16:17:49.550054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9b41605-5275-4a2f-8d81-0c68d11579b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38e5756c50>]}
[0m16:17:49.596826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9b41605-5275-4a2f-8d81-0c68d11579b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38e8a05c90>]}
[0m16:17:49.597509 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:17:49.648331 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:17:49.753798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:17:49.754491 [debug] [MainThread]: Partial parsing: added file: modelling_handson://tests/test_ages.sql
[0m16:17:49.754993 [debug] [MainThread]: Partial parsing: updated file: modelling_handson://models/marts/schema.yml
[0m16:17:50.067433 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models/marts/schema.yml @ models: {'name': 'dim_patients', 'description': 'Dimension table for patients', 'tests': ['test_ages'], 'columns': [{'name': 'patient_id', 'description': 'Unique identifier for each patient', 'tests': ['not_null', 'unique']}, {'name': 'patient_name', 'description': 'Name of the patient'}, {'name': 'gender', 'description': 'Gender of the patient', 'tests': {'-accepted_values': "values :['M','F','Other']"}}, {'name': 'dob', 'description': 'Date of birth of the patient'}, {'name': 'city', 'description': 'City where the patient resides'}], 'original_file_path': 'models/marts/schema.yml', 'yaml_key': 'models', 'package_name': 'modelling_handson'} - at path ['columns'][2]['tests']: {'-accepted_values': "values :['M','F','Other']"} is not of type 'array'
[0m16:17:50.068126 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:17:50.068948 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.68396676, "process_in_blocks": "0", "process_kernel_time": 0.155044, "process_mem_max_rss": "120196", "process_out_blocks": "16", "process_user_time": 1.713871}
[0m16:17:50.069352 [debug] [MainThread]: Command `dbt test` failed at 16:17:50.069274 after 0.68 seconds
[0m16:17:50.069660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38ea3b8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38e5df1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38e43bec10>]}
[0m16:17:50.069977 [debug] [MainThread]: Flushing usage events
[0m16:17:51.192200 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:19:21.771188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7668fd5abe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7668fd76c490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7668fd5ab910>]}


============================== 16:19:21.773360 | 4a0ae26c-73aa-4056-853c-040fe23516cb ==============================
[0m16:19:21.773360 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:19:21.773749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/subhan/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:19:21.809561 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 50, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m16:19:21.810058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4a0ae26c-73aa-4056-853c-040fe23516cb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7668fd3c6910>]}
[0m16:19:21.903707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a0ae26c-73aa-4056-853c-040fe23516cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7668fd4454d0>]}
[0m16:19:21.953355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a0ae26c-73aa-4056-853c-040fe23516cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766900201510>]}
[0m16:19:21.954063 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:19:22.003422 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:19:22.090817 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:19:22.091311 [debug] [MainThread]: Partial parsing: added file: modelling_handson://tests/test_ages.sql
[0m16:19:22.091729 [debug] [MainThread]: Partial parsing: updated file: modelling_handson://models/marts/schema.yml
[0m16:19:22.348373 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models/marts/schema.yml @ models: {'name': 'dim_patients', 'description': 'Dimension table for patients', 'tests': ['test_ages'], 'columns': [{'name': 'patient_id', 'description': 'Unique identifier for each patient', 'tests': ['not_null', 'unique']}, {'name': 'patient_name', 'description': 'Name of the patient'}, {'name': 'gender', 'description': 'Gender of the patient', 'tests': {'-accepted_values': {'values': ['M', 'F', 'Other']}}}, {'name': 'dob', 'description': 'Date of birth of the patient'}, {'name': 'city', 'description': 'City where the patient resides'}], 'original_file_path': 'models/marts/schema.yml', 'yaml_key': 'models', 'package_name': 'modelling_handson'} - at path ['columns'][2]['tests']: {'-accepted_values': {'values': ['M', 'F', 'Other']}} is not of type 'array'
[0m16:19:22.348945 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:19:22.349634 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.6164098, "process_in_blocks": "0", "process_kernel_time": 0.19206, "process_mem_max_rss": "120244", "process_out_blocks": "16", "process_user_time": 1.685866}
[0m16:19:22.349966 [debug] [MainThread]: Command `dbt test` failed at 16:19:22.349898 after 0.62 seconds
[0m16:19:22.350223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7668fd5dd8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766901bb90d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766901bb8f50>]}
[0m16:19:22.350476 [debug] [MainThread]: Flushing usage events
[0m16:19:23.541623 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:19:47.147636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e143e894110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e143e88ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e143f7bfc90>]}


============================== 16:19:47.150303 | 1d6fcdb9-a770-4bee-a4e5-af74daf11447 ==============================
[0m16:19:47.150303 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:19:47.150726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'profiles_dir': '/home/subhan/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m16:19:47.187120 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 50, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m16:19:47.187707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1d6fcdb9-a770-4bee-a4e5-af74daf11447', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e143e921f90>]}
[0m16:19:47.273357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d6fcdb9-a770-4bee-a4e5-af74daf11447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e143dfab750>]}
[0m16:19:47.318400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d6fcdb9-a770-4bee-a4e5-af74daf11447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1441541790>]}
[0m16:19:47.319190 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:19:47.366882 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:19:47.457689 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:19:47.458223 [debug] [MainThread]: Partial parsing: added file: modelling_handson://tests/test_ages.sql
[0m16:19:47.458642 [debug] [MainThread]: Partial parsing: updated file: modelling_handson://models/marts/schema.yml
[0m16:19:47.931424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d6fcdb9-a770-4bee-a4e5-af74daf11447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e143d347e90>]}
[0m16:19:48.014177 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m16:19:48.016269 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m16:19:48.037752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d6fcdb9-a770-4bee-a4e5-af74daf11447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e143842fc90>]}
[0m16:19:48.038229 [info ] [MainThread]: Found 13 models, 6 seeds, 5 data tests, 5 sources, 435 macros
[0m16:19:48.038577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d6fcdb9-a770-4bee-a4e5-af74daf11447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e143cf37190>]}
[0m16:19:48.040140 [info ] [MainThread]: 
[0m16:19:48.040470 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:19:48.040702 [info ] [MainThread]: 
[0m16:19:48.041048 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:19:48.045114 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb_silver'
[0m16:19:48.069787 [debug] [ThreadPool]: Using postgres connection "list_salesdb_silver"
[0m16:19:48.070186 [debug] [ThreadPool]: On list_salesdb_silver: BEGIN
[0m16:19:48.070409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:48.074803 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m16:19:48.075222 [debug] [ThreadPool]: Using postgres connection "list_salesdb_silver"
[0m16:19:48.075463 [debug] [ThreadPool]: On list_salesdb_silver: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_silver"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m16:19:48.078120 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m16:19:48.079247 [debug] [ThreadPool]: On list_salesdb_silver: ROLLBACK
[0m16:19:48.079981 [debug] [ThreadPool]: On list_salesdb_silver: Close
[0m16:19:48.080513 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_silver, now list_salesdb_staging)
[0m16:19:48.082384 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m16:19:48.082683 [debug] [ThreadPool]: On list_salesdb_staging: BEGIN
[0m16:19:48.082911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:48.086366 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:19:48.086674 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m16:19:48.086894 [debug] [ThreadPool]: On list_salesdb_staging: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_staging"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m16:19:48.088979 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m16:19:48.090017 [debug] [ThreadPool]: On list_salesdb_staging: ROLLBACK
[0m16:19:48.090536 [debug] [ThreadPool]: On list_salesdb_staging: Close
[0m16:19:48.091065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_staging, now list_salesdb_marts)
[0m16:19:48.092934 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m16:19:48.093193 [debug] [ThreadPool]: On list_salesdb_marts: BEGIN
[0m16:19:48.093391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:48.096470 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:19:48.096738 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m16:19:48.096973 [debug] [ThreadPool]: On list_salesdb_marts: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_marts"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m16:19:48.099107 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m16:19:48.100011 [debug] [ThreadPool]: On list_salesdb_marts: ROLLBACK
[0m16:19:48.100528 [debug] [ThreadPool]: On list_salesdb_marts: Close
[0m16:19:48.100988 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_marts, now list_salesdb_bronze)
[0m16:19:48.102579 [debug] [ThreadPool]: Using postgres connection "list_salesdb_bronze"
[0m16:19:48.102826 [debug] [ThreadPool]: On list_salesdb_bronze: BEGIN
[0m16:19:48.103028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:48.106081 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:19:48.106350 [debug] [ThreadPool]: Using postgres connection "list_salesdb_bronze"
[0m16:19:48.106573 [debug] [ThreadPool]: On list_salesdb_bronze: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_bronze"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m16:19:48.108456 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m16:19:48.109369 [debug] [ThreadPool]: On list_salesdb_bronze: ROLLBACK
[0m16:19:48.109842 [debug] [ThreadPool]: On list_salesdb_bronze: Close
[0m16:19:48.110323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_bronze, now list_salesdb_gold)
[0m16:19:48.111994 [debug] [ThreadPool]: Using postgres connection "list_salesdb_gold"
[0m16:19:48.112250 [debug] [ThreadPool]: On list_salesdb_gold: BEGIN
[0m16:19:48.112447 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:48.115412 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:19:48.115676 [debug] [ThreadPool]: Using postgres connection "list_salesdb_gold"
[0m16:19:48.115894 [debug] [ThreadPool]: On list_salesdb_gold: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_gold"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m16:19:48.117647 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m16:19:48.118539 [debug] [ThreadPool]: On list_salesdb_gold: ROLLBACK
[0m16:19:48.119211 [debug] [ThreadPool]: On list_salesdb_gold: Close
[0m16:19:48.119685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_gold, now list_salesdb_public_raw_data)
[0m16:19:48.121234 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m16:19:48.121494 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m16:19:48.121696 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:48.124829 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:19:48.125150 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m16:19:48.125377 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m16:19:48.127446 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.002 seconds
[0m16:19:48.128428 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m16:19:48.129160 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m16:19:48.134191 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:48.134517 [debug] [MainThread]: On master: BEGIN
[0m16:19:48.134722 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:19:48.138204 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m16:19:48.138510 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:48.138772 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:19:48.154340 [debug] [MainThread]: SQL status: SELECT 13 in 0.015 seconds
[0m16:19:48.157232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d6fcdb9-a770-4bee-a4e5-af74daf11447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e143f1d6310>]}
[0m16:19:48.157606 [debug] [MainThread]: On master: ROLLBACK
[0m16:19:48.158271 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:48.158574 [debug] [MainThread]: On master: BEGIN
[0m16:19:48.159553 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:19:48.159825 [debug] [MainThread]: On master: COMMIT
[0m16:19:48.160037 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:48.160225 [debug] [MainThread]: On master: COMMIT
[0m16:19:48.160669 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:19:48.160923 [debug] [MainThread]: On master: Close
[0m16:19:48.163758 [debug] [Thread-1 (]: Began running node test.modelling_handson.accepted_values_dim_patients_gender__M__F__Other.dcad44a48b
[0m16:19:48.164088 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_dim_patients_gender__M__F__Other ............. [RUN]
[0m16:19:48.164468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now test.modelling_handson.accepted_values_dim_patients_gender__M__F__Other.dcad44a48b)
[0m16:19:48.164718 [debug] [Thread-1 (]: Began compiling node test.modelling_handson.accepted_values_dim_patients_gender__M__F__Other.dcad44a48b
[0m16:19:48.170295 [debug] [Thread-1 (]: Writing injected SQL for node "test.modelling_handson.accepted_values_dim_patients_gender__M__F__Other.dcad44a48b"
[0m16:19:48.171012 [debug] [Thread-1 (]: Began executing node test.modelling_handson.accepted_values_dim_patients_gender__M__F__Other.dcad44a48b
[0m16:19:48.184331 [debug] [Thread-1 (]: Writing runtime sql for node "test.modelling_handson.accepted_values_dim_patients_gender__M__F__Other.dcad44a48b"
[0m16:19:48.185205 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.accepted_values_dim_patients_gender__M__F__Other.dcad44a48b"
[0m16:19:48.185519 [debug] [Thread-1 (]: On test.modelling_handson.accepted_values_dim_patients_gender__M__F__Other.dcad44a48b: BEGIN
[0m16:19:48.185752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:48.189040 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m16:19:48.189370 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.accepted_values_dim_patients_gender__M__F__Other.dcad44a48b"
[0m16:19:48.189636 [debug] [Thread-1 (]: On test.modelling_handson.accepted_values_dim_patients_gender__M__F__Other.dcad44a48b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "test.modelling_handson.accepted_values_dim_patients_gender__M__F__Other.dcad44a48b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        gender as value_field,
        count(*) as n_records

    from "salesdb"."marts"."dim_patients"
    group by gender

)

select *
from all_values
where value_field not in (
    'M','F','Other'
)



  
  
      
    ) dbt_internal_test
[0m16:19:48.191148 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:19:48.194502 [debug] [Thread-1 (]: On test.modelling_handson.accepted_values_dim_patients_gender__M__F__Other.dcad44a48b: ROLLBACK
[0m16:19:48.195475 [debug] [Thread-1 (]: On test.modelling_handson.accepted_values_dim_patients_gender__M__F__Other.dcad44a48b: Close
[0m16:19:48.196103 [error] [Thread-1 (]: 1 of 5 FAIL 2 accepted_values_dim_patients_gender__M__F__Other ................. [[31mFAIL 2[0m in 0.03s]
[0m16:19:48.196606 [debug] [Thread-1 (]: Finished running node test.modelling_handson.accepted_values_dim_patients_gender__M__F__Other.dcad44a48b
[0m16:19:48.196912 [debug] [Thread-1 (]: Began running node test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7
[0m16:19:48.197483 [info ] [Thread-1 (]: 2 of 5 START test not_null_dim_patients_patient_id ............................. [RUN]
[0m16:19:48.197903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.modelling_handson.accepted_values_dim_patients_gender__M__F__Other.dcad44a48b, now test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7)
[0m16:19:48.198164 [debug] [Thread-1 (]: Began compiling node test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7
[0m16:19:48.203549 [debug] [Thread-1 (]: Writing injected SQL for node "test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7"
[0m16:19:48.204130 [debug] [Thread-1 (]: Began executing node test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7
[0m16:19:48.205866 [debug] [Thread-1 (]: Writing runtime sql for node "test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7"
[0m16:19:48.206372 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7"
[0m16:19:48.206644 [debug] [Thread-1 (]: On test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7: BEGIN
[0m16:19:48.206867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:48.210904 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:19:48.211356 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7"
[0m16:19:48.211623 [debug] [Thread-1 (]: On test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "salesdb"."marts"."dim_patients"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m16:19:48.212731 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:19:48.214469 [debug] [Thread-1 (]: On test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7: ROLLBACK
[0m16:19:48.215186 [debug] [Thread-1 (]: On test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7: Close
[0m16:19:48.215756 [info ] [Thread-1 (]: 2 of 5 PASS not_null_dim_patients_patient_id ................................... [[32mPASS[0m in 0.02s]
[0m16:19:48.216193 [debug] [Thread-1 (]: Finished running node test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7
[0m16:19:48.216507 [debug] [Thread-1 (]: Began running node test.modelling_handson.test_ages
[0m16:19:48.216955 [info ] [Thread-1 (]: 3 of 5 START test test_ages .................................................... [RUN]
[0m16:19:48.217418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7, now test.modelling_handson.test_ages)
[0m16:19:48.217691 [debug] [Thread-1 (]: Began compiling node test.modelling_handson.test_ages
[0m16:19:48.219968 [debug] [Thread-1 (]: Writing injected SQL for node "test.modelling_handson.test_ages"
[0m16:19:48.220635 [debug] [Thread-1 (]: Began executing node test.modelling_handson.test_ages
[0m16:19:48.222582 [debug] [Thread-1 (]: Writing runtime sql for node "test.modelling_handson.test_ages"
[0m16:19:48.223463 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.test_ages"
[0m16:19:48.223793 [debug] [Thread-1 (]: On test.modelling_handson.test_ages: BEGIN
[0m16:19:48.224046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:48.227621 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:19:48.227970 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.test_ages"
[0m16:19:48.228224 [debug] [Thread-1 (]: On test.modelling_handson.test_ages: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "test.modelling_handson.test_ages"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select *
from "salesdb"."marts"."dim_patients"
where age < 0
  
  
      
    ) dbt_internal_test
[0m16:19:48.229078 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "age" does not exist
LINE 12: where age < 0
               ^

[0m16:19:48.229394 [debug] [Thread-1 (]: On test.modelling_handson.test_ages: ROLLBACK
[0m16:19:48.229929 [debug] [Thread-1 (]: On test.modelling_handson.test_ages: Close
[0m16:19:48.237423 [debug] [Thread-1 (]: Database Error in test test_ages (tests/test_ages.sql)
  column "age" does not exist
  LINE 12: where age < 0
                 ^
  compiled code at target/run/modelling_handson/tests/test_ages.sql
[0m16:19:48.238077 [error] [Thread-1 (]: 3 of 5 ERROR test_ages ......................................................... [[31mERROR[0m in 0.02s]
[0m16:19:48.238526 [debug] [Thread-1 (]: Finished running node test.modelling_handson.test_ages
[0m16:19:48.238915 [debug] [Thread-1 (]: Began running node test.modelling_handson.test_ages_dim_patients_.2b960afd7a
[0m16:19:48.240033 [debug] [Thread-4 (]: Marking all children of 'test.modelling_handson.test_ages' to be skipped because of status 'error'.  Reason: Database Error in test test_ages (tests/test_ages.sql)
  column "age" does not exist
  LINE 12: where age < 0
                 ^
  compiled code at target/run/modelling_handson/tests/test_ages.sql.
[0m16:19:48.239654 [info ] [Thread-1 (]: 4 of 5 START test test_ages_dim_patients_ ...................................... [RUN]
[0m16:19:48.241231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.modelling_handson.test_ages, now test.modelling_handson.test_ages_dim_patients_.2b960afd7a)
[0m16:19:48.241552 [debug] [Thread-1 (]: Began compiling node test.modelling_handson.test_ages_dim_patients_.2b960afd7a
[0m16:19:48.249557 [debug] [Thread-1 (]: Compilation Error in test test_ages_dim_patients_ (models/marts/schema.yml)
  'test_test_ages' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:19:48.250072 [error] [Thread-1 (]: 4 of 5 ERROR test_ages_dim_patients_ ........................................... [[31mERROR[0m in 0.01s]
[0m16:19:48.250485 [debug] [Thread-1 (]: Finished running node test.modelling_handson.test_ages_dim_patients_.2b960afd7a
[0m16:19:48.250811 [debug] [Thread-1 (]: Began running node test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2
[0m16:19:48.251163 [info ] [Thread-1 (]: 5 of 5 START test unique_dim_patients_patient_id ............................... [RUN]
[0m16:19:48.251647 [debug] [Thread-4 (]: Marking all children of 'test.modelling_handson.test_ages_dim_patients_.2b960afd7a' to be skipped because of status 'error'.  Reason: Compilation Error in test test_ages_dim_patients_ (models/marts/schema.yml)
  'test_test_ages' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m16:19:48.252025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.modelling_handson.test_ages_dim_patients_.2b960afd7a, now test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2)
[0m16:19:48.252559 [debug] [Thread-1 (]: Began compiling node test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2
[0m16:19:48.257411 [debug] [Thread-1 (]: Writing injected SQL for node "test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2"
[0m16:19:48.258065 [debug] [Thread-1 (]: Began executing node test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2
[0m16:19:48.260436 [debug] [Thread-1 (]: Writing runtime sql for node "test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2"
[0m16:19:48.261149 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2"
[0m16:19:48.261554 [debug] [Thread-1 (]: On test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2: BEGIN
[0m16:19:48.261821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:48.266431 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m16:19:48.267446 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2"
[0m16:19:48.267915 [debug] [Thread-1 (]: On test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "salesdb"."marts"."dim_patients"
where patient_id is not null
group by patient_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:19:48.269574 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:19:48.270844 [debug] [Thread-1 (]: On test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2: ROLLBACK
[0m16:19:48.271585 [debug] [Thread-1 (]: On test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2: Close
[0m16:19:48.272208 [info ] [Thread-1 (]: 5 of 5 PASS unique_dim_patients_patient_id ..................................... [[32mPASS[0m in 0.02s]
[0m16:19:48.272665 [debug] [Thread-1 (]: Finished running node test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2
[0m16:19:48.274035 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:48.274336 [debug] [MainThread]: On master: BEGIN
[0m16:19:48.274616 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:19:48.278673 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m16:19:48.279111 [debug] [MainThread]: On master: COMMIT
[0m16:19:48.279410 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:48.279639 [debug] [MainThread]: On master: COMMIT
[0m16:19:48.280117 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:19:48.280448 [debug] [MainThread]: On master: Close
[0m16:19:48.280830 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:48.281067 [debug] [MainThread]: Connection 'test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2' was properly closed.
[0m16:19:48.281336 [info ] [MainThread]: 
[0m16:19:48.281608 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m16:19:48.282398 [debug] [MainThread]: Command end result
[0m16:19:48.300617 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m16:19:48.302105 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m16:19:48.307233 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m16:19:48.307545 [info ] [MainThread]: 
[0m16:19:48.307897 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m16:19:48.308181 [info ] [MainThread]: 
[0m16:19:48.308482 [error] [MainThread]: [31mFailure in test accepted_values_dim_patients_gender__M__F__Other (models/marts/schema.yml)[0m
[0m16:19:48.308763 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m16:19:48.308986 [info ] [MainThread]: 
[0m16:19:48.309252 [info ] [MainThread]:   compiled code at target/compiled/modelling_handson/models/marts/schema.yml/accepted_values_dim_patients_gender__M__F__Other.sql
[0m16:19:48.309494 [info ] [MainThread]: 
[0m16:19:48.309771 [error] [MainThread]: [31mFailure in test test_ages (tests/test_ages.sql)[0m
[0m16:19:48.310059 [error] [MainThread]:   Database Error in test test_ages (tests/test_ages.sql)
  column "age" does not exist
  LINE 12: where age < 0
                 ^
  compiled code at target/run/modelling_handson/tests/test_ages.sql
[0m16:19:48.310282 [info ] [MainThread]: 
[0m16:19:48.310539 [info ] [MainThread]:   compiled code at target/compiled/modelling_handson/tests/test_ages.sql
[0m16:19:48.310764 [info ] [MainThread]: 
[0m16:19:48.311035 [error] [MainThread]: [31mFailure in test test_ages_dim_patients_ (models/marts/schema.yml)[0m
[0m16:19:48.311318 [error] [MainThread]:   Compilation Error in test test_ages_dim_patients_ (models/marts/schema.yml)
  'test_test_ages' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:19:48.311549 [info ] [MainThread]: 
[0m16:19:48.311794 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=5
[0m16:19:48.312267 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:19:48.313143 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.203678, "process_in_blocks": "2472", "process_kernel_time": 0.256814, "process_mem_max_rss": "131040", "process_out_blocks": "3016", "process_user_time": 2.105038}
[0m16:19:48.313549 [debug] [MainThread]: Command `dbt test` failed at 16:19:48.313471 after 1.20 seconds
[0m16:19:48.313869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e143ec461d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e143df5ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1442fbd290>]}
[0m16:19:48.314161 [debug] [MainThread]: Flushing usage events
[0m16:19:49.368240 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:21:46.151188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7489d36abb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7489d36aa190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7489d3a5bf50>]}


============================== 16:21:46.153897 | 8900f515-69ad-4494-a4e4-b83048c95273 ==============================
[0m16:21:46.153897 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:21:46.154438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/subhan/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:21:46.199007 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 50, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m16:21:46.199467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8900f515-69ad-4494-a4e4-b83048c95273', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7489d3744790>]}
[0m16:21:46.287858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8900f515-69ad-4494-a4e4-b83048c95273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7489d2d1bc90>]}
[0m16:21:46.335742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8900f515-69ad-4494-a4e4-b83048c95273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7489d6339bd0>]}
[0m16:21:46.336406 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:21:46.384537 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:21:46.491691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:21:46.492435 [debug] [MainThread]: Partial parsing: updated file: modelling_handson://models/marts/dim_patients.sql
[0m16:21:46.936698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8900f515-69ad-4494-a4e4-b83048c95273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7489d19766d0>]}
[0m16:21:47.020118 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m16:21:47.021707 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m16:21:47.032437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8900f515-69ad-4494-a4e4-b83048c95273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7489d2d1a010>]}
[0m16:21:47.032901 [info ] [MainThread]: Found 13 models, 6 seeds, 5 data tests, 5 sources, 435 macros
[0m16:21:47.033199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8900f515-69ad-4494-a4e4-b83048c95273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7489d3ca1c90>]}
[0m16:21:47.035117 [info ] [MainThread]: 
[0m16:21:47.035503 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:21:47.035742 [info ] [MainThread]: 
[0m16:21:47.036100 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:21:47.039645 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb'
[0m16:21:47.064761 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m16:21:47.065191 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m16:21:47.065461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:47.070739 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.005 seconds
[0m16:21:47.071805 [debug] [ThreadPool]: On list_salesdb: Close
[0m16:21:47.073580 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m16:21:47.073908 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m16:21:47.074278 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:47.079271 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.005 seconds
[0m16:21:47.080358 [debug] [ThreadPool]: On list_salesdb: Close
[0m16:21:47.082179 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m16:21:47.082529 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m16:21:47.082853 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:47.087712 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.005 seconds
[0m16:21:47.088773 [debug] [ThreadPool]: On list_salesdb: Close
[0m16:21:47.090674 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m16:21:47.091103 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m16:21:47.091389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:47.095647 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m16:21:47.096649 [debug] [ThreadPool]: On list_salesdb: Close
[0m16:21:47.098433 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m16:21:47.098837 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m16:21:47.099070 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:47.102622 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m16:21:47.103706 [debug] [ThreadPool]: On list_salesdb: Close
[0m16:21:47.105771 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb, now list_salesdb_marts)
[0m16:21:47.109885 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m16:21:47.110363 [debug] [ThreadPool]: On list_salesdb_marts: BEGIN
[0m16:21:47.110631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:47.114253 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m16:21:47.114594 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m16:21:47.114841 [debug] [ThreadPool]: On list_salesdb_marts: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_marts"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m16:21:47.116935 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m16:21:47.117875 [debug] [ThreadPool]: On list_salesdb_marts: ROLLBACK
[0m16:21:47.118449 [debug] [ThreadPool]: On list_salesdb_marts: Close
[0m16:21:47.119028 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_marts, now list_salesdb_gold)
[0m16:21:47.120951 [debug] [ThreadPool]: Using postgres connection "list_salesdb_gold"
[0m16:21:47.121239 [debug] [ThreadPool]: On list_salesdb_gold: BEGIN
[0m16:21:47.121472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:47.125001 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:21:47.125332 [debug] [ThreadPool]: Using postgres connection "list_salesdb_gold"
[0m16:21:47.125575 [debug] [ThreadPool]: On list_salesdb_gold: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_gold"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m16:21:47.127773 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m16:21:47.128852 [debug] [ThreadPool]: On list_salesdb_gold: ROLLBACK
[0m16:21:47.130387 [debug] [ThreadPool]: On list_salesdb_gold: Close
[0m16:21:47.130981 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_gold, now list_salesdb_public_raw_data)
[0m16:21:47.132691 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m16:21:47.132984 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m16:21:47.133227 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:47.136862 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m16:21:47.137202 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m16:21:47.137508 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m16:21:47.139918 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.002 seconds
[0m16:21:47.141032 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m16:21:47.141628 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m16:21:47.142264 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now list_salesdb_bronze)
[0m16:21:47.145867 [debug] [ThreadPool]: Using postgres connection "list_salesdb_bronze"
[0m16:21:47.146183 [debug] [ThreadPool]: On list_salesdb_bronze: BEGIN
[0m16:21:47.146433 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:47.149947 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:21:47.150290 [debug] [ThreadPool]: Using postgres connection "list_salesdb_bronze"
[0m16:21:47.150596 [debug] [ThreadPool]: On list_salesdb_bronze: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_bronze"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m16:21:47.152738 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m16:21:47.153853 [debug] [ThreadPool]: On list_salesdb_bronze: ROLLBACK
[0m16:21:47.154475 [debug] [ThreadPool]: On list_salesdb_bronze: Close
[0m16:21:47.154997 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_bronze, now list_salesdb_staging)
[0m16:21:47.156636 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m16:21:47.156899 [debug] [ThreadPool]: On list_salesdb_staging: BEGIN
[0m16:21:47.157247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:47.160325 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:21:47.160623 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m16:21:47.160863 [debug] [ThreadPool]: On list_salesdb_staging: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_staging"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m16:21:47.163059 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m16:21:47.164002 [debug] [ThreadPool]: On list_salesdb_staging: ROLLBACK
[0m16:21:47.164455 [debug] [ThreadPool]: On list_salesdb_staging: Close
[0m16:21:47.164914 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_staging, now list_salesdb_silver)
[0m16:21:47.166262 [debug] [ThreadPool]: Using postgres connection "list_salesdb_silver"
[0m16:21:47.167162 [debug] [ThreadPool]: On list_salesdb_silver: BEGIN
[0m16:21:47.167435 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:47.170731 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:21:47.171016 [debug] [ThreadPool]: Using postgres connection "list_salesdb_silver"
[0m16:21:47.171265 [debug] [ThreadPool]: On list_salesdb_silver: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_silver"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m16:21:47.173278 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m16:21:47.174239 [debug] [ThreadPool]: On list_salesdb_silver: ROLLBACK
[0m16:21:47.174748 [debug] [ThreadPool]: On list_salesdb_silver: Close
[0m16:21:47.178875 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:47.179176 [debug] [MainThread]: On master: BEGIN
[0m16:21:47.179404 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:21:47.182253 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m16:21:47.182531 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:47.182827 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:21:47.199003 [debug] [MainThread]: SQL status: SELECT 13 in 0.016 seconds
[0m16:21:47.201730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8900f515-69ad-4494-a4e4-b83048c95273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7489d6437f50>]}
[0m16:21:47.202129 [debug] [MainThread]: On master: ROLLBACK
[0m16:21:47.202821 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:47.203110 [debug] [MainThread]: On master: BEGIN
[0m16:21:47.203878 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:21:47.204193 [debug] [MainThread]: On master: COMMIT
[0m16:21:47.204427 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:47.204642 [debug] [MainThread]: On master: COMMIT
[0m16:21:47.205375 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:21:47.206017 [debug] [MainThread]: On master: Close
[0m16:21:47.208290 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_appointments
[0m16:21:47.208738 [info ] [Thread-1 (]: 1 of 12 START sql view model staging.stg_appointments .......................... [RUN]
[0m16:21:47.209124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_silver, now model.modelling_handson.stg_appointments)
[0m16:21:47.209399 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_appointments
[0m16:21:47.214834 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_appointments"
[0m16:21:47.215524 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_appointments
[0m16:21:47.242256 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_appointments"
[0m16:21:47.242962 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_appointments"
[0m16:21:47.243267 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: BEGIN
[0m16:21:47.243527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:47.247241 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:21:47.247587 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_appointments"
[0m16:21:47.247914 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_appointments"} */

  create view "salesdb"."staging"."stg_appointments__dbt_tmp"
    
    
  as (
    select
id as appointment_id,
patient_id,
doctor_id,
appointment_date,
status,
department_id
from "salesdb"."public_raw_data"."appointments"
  );
[0m16:21:47.250006 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:21:47.255170 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_appointments"
[0m16:21:47.255652 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_appointments"} */
alter table "salesdb"."staging"."stg_appointments" rename to "stg_appointments__dbt_backup"
[0m16:21:47.256941 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:21:47.259414 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_appointments"
[0m16:21:47.259773 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_appointments"} */
alter table "salesdb"."staging"."stg_appointments__dbt_tmp" rename to "stg_appointments"
[0m16:21:47.260518 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:21:47.273235 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: COMMIT
[0m16:21:47.273700 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_appointments"
[0m16:21:47.273981 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: COMMIT
[0m16:21:47.276299 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:21:47.281333 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_appointments__dbt_backup"
[0m16:21:47.287919 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_appointments"
[0m16:21:47.288358 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_appointments"} */
drop view if exists "salesdb"."staging"."stg_appointments__dbt_backup" cascade
[0m16:21:47.290564 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:21:47.292641 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: Close
[0m16:21:47.294459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8900f515-69ad-4494-a4e4-b83048c95273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7489d15cdf50>]}
[0m16:21:47.295066 [info ] [Thread-1 (]: 1 of 12 OK created sql view model staging.stg_appointments ..................... [[32mCREATE VIEW[0m in 0.08s]
[0m16:21:47.295534 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_appointments
[0m16:21:47.295852 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_departments
[0m16:21:47.296605 [info ] [Thread-1 (]: 2 of 12 START sql view model staging.stg_departments ........................... [RUN]
[0m16:21:47.297028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_appointments, now model.modelling_handson.stg_departments)
[0m16:21:47.297303 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_departments
[0m16:21:47.299474 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_departments"
[0m16:21:47.300003 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_departments
[0m16:21:47.302644 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_departments"
[0m16:21:47.303208 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m16:21:47.303518 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: BEGIN
[0m16:21:47.303804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:47.307363 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m16:21:47.307753 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m16:21:47.308112 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */

  create view "salesdb"."staging"."stg_departments__dbt_tmp"
    
    
  as (
    select
    id as department_id,
    name as department_name
FROM "salesdb"."public_raw_data"."departments"
  );
[0m16:21:47.309729 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m16:21:47.312430 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m16:21:47.312830 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */
alter table "salesdb"."staging"."stg_departments" rename to "stg_departments__dbt_backup"
[0m16:21:47.314056 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:21:47.316654 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m16:21:47.317135 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */
alter table "salesdb"."staging"."stg_departments__dbt_tmp" rename to "stg_departments"
[0m16:21:47.318147 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:21:47.319464 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: COMMIT
[0m16:21:47.319850 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m16:21:47.320131 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: COMMIT
[0m16:21:47.321404 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:21:47.323339 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_departments__dbt_backup"
[0m16:21:47.323828 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m16:21:47.324116 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */
drop view if exists "salesdb"."staging"."stg_departments__dbt_backup" cascade
[0m16:21:47.325733 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:21:47.326918 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: Close
[0m16:21:47.327513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8900f515-69ad-4494-a4e4-b83048c95273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7489c8449510>]}
[0m16:21:47.328087 [info ] [Thread-1 (]: 2 of 12 OK created sql view model staging.stg_departments ...................... [[32mCREATE VIEW[0m in 0.03s]
[0m16:21:47.328577 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_departments
[0m16:21:47.328907 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_doctors
[0m16:21:47.329299 [info ] [Thread-1 (]: 3 of 12 START sql view model staging.stg_doctors ............................... [RUN]
[0m16:21:47.329906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_departments, now model.modelling_handson.stg_doctors)
[0m16:21:47.330245 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_doctors
[0m16:21:47.332562 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_doctors"
[0m16:21:47.333182 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_doctors
[0m16:21:47.336029 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_doctors"
[0m16:21:47.336726 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m16:21:47.337060 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: BEGIN
[0m16:21:47.337333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:47.341844 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:21:47.342366 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m16:21:47.342895 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */

  create view "salesdb"."staging"."stg_doctors__dbt_tmp"
    
    
  as (
    select
    id as doctor_id,
    name,
    specialization,
    department_id
FROM "salesdb"."public_raw_data"."doctors"
  );
[0m16:21:47.344636 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m16:21:47.347478 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m16:21:47.347977 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */
alter table "salesdb"."staging"."stg_doctors" rename to "stg_doctors__dbt_backup"
[0m16:21:47.349105 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:21:47.351505 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m16:21:47.351871 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */
alter table "salesdb"."staging"."stg_doctors__dbt_tmp" rename to "stg_doctors"
[0m16:21:47.352779 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:21:47.353949 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: COMMIT
[0m16:21:47.354367 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m16:21:47.354754 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: COMMIT
[0m16:21:47.355936 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:21:47.358016 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_doctors__dbt_backup"
[0m16:21:47.358574 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m16:21:47.358895 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */
drop view if exists "salesdb"."staging"."stg_doctors__dbt_backup" cascade
[0m16:21:47.360424 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:21:47.361503 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: Close
[0m16:21:47.362100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8900f515-69ad-4494-a4e4-b83048c95273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7489c8567010>]}
[0m16:21:47.362679 [info ] [Thread-1 (]: 3 of 12 OK created sql view model staging.stg_doctors .......................... [[32mCREATE VIEW[0m in 0.03s]
[0m16:21:47.363166 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_doctors
[0m16:21:47.363487 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_patients
[0m16:21:47.364145 [info ] [Thread-1 (]: 4 of 12 START sql view model staging.stg_patients .............................. [RUN]
[0m16:21:47.364549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_doctors, now model.modelling_handson.stg_patients)
[0m16:21:47.364836 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_patients
[0m16:21:47.368359 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_patients"
[0m16:21:47.368888 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_patients
[0m16:21:47.371277 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_patients"
[0m16:21:47.371848 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m16:21:47.372188 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: BEGIN
[0m16:21:47.372445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:47.376420 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:21:47.376856 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m16:21:47.377143 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */

  create view "salesdb"."staging"."stg_patients__dbt_tmp"
    
    
  as (
    select
id as patient_id,
name,
gender,
dob,
city
FROM "salesdb"."public_raw_data"."patients"
  );
[0m16:21:47.378995 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m16:21:47.381726 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m16:21:47.382123 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */
alter table "salesdb"."staging"."stg_patients" rename to "stg_patients__dbt_backup"
[0m16:21:47.383207 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:21:47.385910 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m16:21:47.386323 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */
alter table "salesdb"."staging"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m16:21:47.387251 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:21:47.388335 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: COMMIT
[0m16:21:47.388670 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m16:21:47.389021 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: COMMIT
[0m16:21:47.390533 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:21:47.392515 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_patients__dbt_backup"
[0m16:21:47.393004 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m16:21:47.393283 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */
drop view if exists "salesdb"."staging"."stg_patients__dbt_backup" cascade
[0m16:21:47.394907 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:21:47.396059 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: Close
[0m16:21:47.396820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8900f515-69ad-4494-a4e4-b83048c95273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7489d158de50>]}
[0m16:21:47.397408 [info ] [Thread-1 (]: 4 of 12 OK created sql view model staging.stg_patients ......................... [[32mCREATE VIEW[0m in 0.03s]
[0m16:21:47.397891 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_patients
[0m16:21:47.398251 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_treatments
[0m16:21:47.398929 [info ] [Thread-1 (]: 5 of 12 START sql view model staging.stg_treatments ............................ [RUN]
[0m16:21:47.399586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_patients, now model.modelling_handson.stg_treatments)
[0m16:21:47.399995 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_treatments
[0m16:21:47.402309 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_treatments"
[0m16:21:47.402896 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_treatments
[0m16:21:47.405523 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_treatments"
[0m16:21:47.406204 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_treatments"
[0m16:21:47.406525 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: BEGIN
[0m16:21:47.406839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:47.410751 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:21:47.411153 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_treatments"
[0m16:21:47.411442 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_treatments"} */

  create view "salesdb"."staging"."stg_treatments__dbt_tmp"
    
    
  as (
    select
id as treatment_id,
appointment_id,
treatment,
cost
from "salesdb"."public_raw_data"."treatments"
  );
[0m16:21:47.412971 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m16:21:47.415935 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_treatments"
[0m16:21:47.416400 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_treatments"} */
alter table "salesdb"."staging"."stg_treatments" rename to "stg_treatments__dbt_backup"
[0m16:21:47.417356 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:21:47.419786 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_treatments"
[0m16:21:47.420167 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_treatments"} */
alter table "salesdb"."staging"."stg_treatments__dbt_tmp" rename to "stg_treatments"
[0m16:21:47.421037 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:21:47.422079 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: COMMIT
[0m16:21:47.422411 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_treatments"
[0m16:21:47.422729 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: COMMIT
[0m16:21:47.423778 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:21:47.425514 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_treatments__dbt_backup"
[0m16:21:47.425966 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_treatments"
[0m16:21:47.426243 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_treatments"} */
drop view if exists "salesdb"."staging"."stg_treatments__dbt_backup" cascade
[0m16:21:47.427832 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:21:47.428883 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: Close
[0m16:21:47.429396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8900f515-69ad-4494-a4e4-b83048c95273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7489d2d70290>]}
[0m16:21:47.430016 [info ] [Thread-1 (]: 5 of 12 OK created sql view model staging.stg_treatments ....................... [[32mCREATE VIEW[0m in 0.03s]
[0m16:21:47.430543 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_treatments
[0m16:21:47.430907 [debug] [Thread-1 (]: Began running node model.modelling_handson.bronze_appointments
[0m16:21:47.431431 [info ] [Thread-1 (]: 6 of 12 START sql view model bronze.bronze_appointments ........................ [RUN]
[0m16:21:47.432022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_treatments, now model.modelling_handson.bronze_appointments)
[0m16:21:47.432337 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.bronze_appointments
[0m16:21:47.434429 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.bronze_appointments"
[0m16:21:47.434961 [debug] [Thread-1 (]: Began executing node model.modelling_handson.bronze_appointments
[0m16:21:47.438655 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.bronze_appointments"
[0m16:21:47.439324 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_appointments"
[0m16:21:47.439640 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: BEGIN
[0m16:21:47.439889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:47.443688 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:21:47.444088 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_appointments"
[0m16:21:47.444361 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.bronze_appointments"} */

  create view "salesdb"."bronze"."bronze_appointments__dbt_tmp"
    
    
  as (
    select * from "salesdb"."staging"."stg_appointments"
  );
[0m16:21:47.445984 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m16:21:47.448616 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_appointments"
[0m16:21:47.449105 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.bronze_appointments"} */
alter table "salesdb"."bronze"."bronze_appointments__dbt_tmp" rename to "bronze_appointments"
[0m16:21:47.450195 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:21:47.451349 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: COMMIT
[0m16:21:47.451762 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_appointments"
[0m16:21:47.452240 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: COMMIT
[0m16:21:47.453696 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:21:47.455799 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."bronze"."bronze_appointments__dbt_backup"
[0m16:21:47.456387 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_appointments"
[0m16:21:47.456718 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.bronze_appointments"} */
drop view if exists "salesdb"."bronze"."bronze_appointments__dbt_backup" cascade
[0m16:21:47.457853 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m16:21:47.459327 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: Close
[0m16:21:47.459962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8900f515-69ad-4494-a4e4-b83048c95273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7489d36ee0d0>]}
[0m16:21:47.460659 [info ] [Thread-1 (]: 6 of 12 OK created sql view model bronze.bronze_appointments ................... [[32mCREATE VIEW[0m in 0.03s]
[0m16:21:47.461148 [debug] [Thread-1 (]: Finished running node model.modelling_handson.bronze_appointments
[0m16:21:47.461501 [debug] [Thread-1 (]: Began running node model.modelling_handson.dim_doctors
[0m16:21:47.462119 [info ] [Thread-1 (]: 7 of 12 START sql table model marts.dim_doctors ................................ [RUN]
[0m16:21:47.462971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.bronze_appointments, now model.modelling_handson.dim_doctors)
[0m16:21:47.463357 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.dim_doctors
[0m16:21:47.466137 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.dim_doctors"
[0m16:21:47.466849 [debug] [Thread-1 (]: Began executing node model.modelling_handson.dim_doctors
[0m16:21:48.196135 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.dim_doctors"
[0m16:21:48.196942 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m16:21:48.197289 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: BEGIN
[0m16:21:48.197605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:48.202509 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m16:21:48.202959 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m16:21:48.203275 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */

  
    

  create  table "salesdb"."marts"."dim_doctors__dbt_tmp"
  
  
    as
  
  (
    select d.*, dep.department_name
from "salesdb"."staging"."stg_doctors" d
left join "salesdb"."staging"."stg_departments" dep
on d.department_id = dep.department_id
  );
  
[0m16:21:48.208249 [debug] [Thread-1 (]: SQL status: SELECT 50 in 0.005 seconds
[0m16:21:48.214926 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m16:21:48.215397 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */
alter table "salesdb"."marts"."dim_doctors" rename to "dim_doctors__dbt_backup"
[0m16:21:48.216525 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:21:48.219224 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m16:21:48.219687 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */
alter table "salesdb"."marts"."dim_doctors__dbt_tmp" rename to "dim_doctors"
[0m16:21:48.220802 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:21:48.222109 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: COMMIT
[0m16:21:48.222510 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m16:21:48.222792 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: COMMIT
[0m16:21:48.224726 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:21:48.227189 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."marts"."dim_doctors__dbt_backup"
[0m16:21:48.230346 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m16:21:48.230787 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */
drop table if exists "salesdb"."marts"."dim_doctors__dbt_backup" cascade
[0m16:21:48.233587 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:21:48.234931 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: Close
[0m16:21:48.235638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8900f515-69ad-4494-a4e4-b83048c95273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7489d4689790>]}
[0m16:21:48.236232 [info ] [Thread-1 (]: 7 of 12 OK created sql table model marts.dim_doctors ........................... [[32mSELECT 50[0m in 0.77s]
[0m16:21:48.236825 [debug] [Thread-1 (]: Finished running node model.modelling_handson.dim_doctors
[0m16:21:48.237233 [debug] [Thread-1 (]: Began running node model.modelling_handson.dim_patients
[0m16:21:48.237828 [info ] [Thread-1 (]: 8 of 12 START sql table model marts.dim_patients ............................... [RUN]
[0m16:21:48.238311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.dim_doctors, now model.modelling_handson.dim_patients)
[0m16:21:48.238636 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.dim_patients
[0m16:21:48.241278 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.dim_patients"
[0m16:21:48.242079 [debug] [Thread-1 (]: Began executing node model.modelling_handson.dim_patients
[0m16:21:48.245157 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.dim_patients"
[0m16:21:48.245934 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m16:21:48.246319 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: BEGIN
[0m16:21:48.246607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:48.251296 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m16:21:48.251750 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m16:21:48.252056 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */

  
    

  create  table "salesdb"."marts"."dim_patients__dbt_tmp"
  
  
    as
  
  (
    select *,
date_part('year', age(current_date, dob)) as age from "salesdb"."staging"."stg_patients"
  );
  
[0m16:21:48.256276 [debug] [Thread-1 (]: SQL status: SELECT 200 in 0.004 seconds
[0m16:21:48.260876 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m16:21:48.261349 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */
alter table "salesdb"."marts"."dim_patients" rename to "dim_patients__dbt_backup"
[0m16:21:48.262610 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:21:48.265240 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m16:21:48.265605 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */
alter table "salesdb"."marts"."dim_patients__dbt_tmp" rename to "dim_patients"
[0m16:21:48.266441 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:21:48.267778 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: COMMIT
[0m16:21:48.268154 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m16:21:48.268484 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: COMMIT
[0m16:21:48.269662 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:21:48.271787 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."marts"."dim_patients__dbt_backup"
[0m16:21:48.272344 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m16:21:48.272654 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */
drop table if exists "salesdb"."marts"."dim_patients__dbt_backup" cascade
[0m16:21:48.274701 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:21:48.275990 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: Close
[0m16:21:48.276670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8900f515-69ad-4494-a4e4-b83048c95273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7489c8584c50>]}
[0m16:21:48.277238 [info ] [Thread-1 (]: 8 of 12 OK created sql table model marts.dim_patients .......................... [[32mSELECT 200[0m in 0.04s]
[0m16:21:48.277823 [debug] [Thread-1 (]: Finished running node model.modelling_handson.dim_patients
[0m16:21:48.278193 [debug] [Thread-1 (]: Began running node model.modelling_handson.bronze_treatments
[0m16:21:48.278795 [info ] [Thread-1 (]: 9 of 12 START sql view model bronze.bronze_treatments .......................... [RUN]
[0m16:21:48.279243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.dim_patients, now model.modelling_handson.bronze_treatments)
[0m16:21:48.279532 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.bronze_treatments
[0m16:21:48.283634 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.bronze_treatments"
[0m16:21:48.284619 [debug] [Thread-1 (]: Began executing node model.modelling_handson.bronze_treatments
[0m16:21:48.288638 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.bronze_treatments"
[0m16:21:48.289298 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_treatments"
[0m16:21:48.289642 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: BEGIN
[0m16:21:48.290025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:48.295331 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m16:21:48.295871 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_treatments"
[0m16:21:48.296175 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.bronze_treatments"} */

  create view "salesdb"."bronze"."bronze_treatments__dbt_tmp"
    
    
  as (
    select * from "salesdb"."staging"."stg_treatments"
  );
[0m16:21:48.298092 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:21:48.301032 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_treatments"
[0m16:21:48.301536 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.bronze_treatments"} */
alter table "salesdb"."bronze"."bronze_treatments__dbt_tmp" rename to "bronze_treatments"
[0m16:21:48.302987 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:21:48.304268 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: COMMIT
[0m16:21:48.304667 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_treatments"
[0m16:21:48.305011 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: COMMIT
[0m16:21:48.306569 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:21:48.310123 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."bronze"."bronze_treatments__dbt_backup"
[0m16:21:48.311121 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_treatments"
[0m16:21:48.311572 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.bronze_treatments"} */
drop view if exists "salesdb"."bronze"."bronze_treatments__dbt_backup" cascade
[0m16:21:48.312408 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m16:21:48.313664 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: Close
[0m16:21:48.314293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8900f515-69ad-4494-a4e4-b83048c95273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7489c8548650>]}
[0m16:21:48.314874 [info ] [Thread-1 (]: 9 of 12 OK created sql view model bronze.bronze_treatments ..................... [[32mCREATE VIEW[0m in 0.04s]
[0m16:21:48.315408 [debug] [Thread-1 (]: Finished running node model.modelling_handson.bronze_treatments
[0m16:21:48.315791 [debug] [Thread-1 (]: Began running node model.modelling_handson.silver_appointments
[0m16:21:48.316725 [info ] [Thread-1 (]: 10 of 12 START sql table model silver.silver_appointments ...................... [RUN]
[0m16:21:48.317245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.bronze_treatments, now model.modelling_handson.silver_appointments)
[0m16:21:48.317569 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.silver_appointments
[0m16:21:48.320076 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.silver_appointments"
[0m16:21:48.320683 [debug] [Thread-1 (]: Began executing node model.modelling_handson.silver_appointments
[0m16:21:48.323495 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.silver_appointments"
[0m16:21:48.324139 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_appointments"
[0m16:21:48.324472 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: BEGIN
[0m16:21:48.324767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:48.329221 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:21:48.329638 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_appointments"
[0m16:21:48.330155 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_appointments"} */

  
    

  create  table "salesdb"."silver"."silver_appointments__dbt_tmp"
  
  
    as
  
  (
    select * from "salesdb"."bronze"."bronze_appointments"
where appointment_date is not null and status != 'cancelled'
  );
  
[0m16:21:48.335843 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.005 seconds
[0m16:21:48.339052 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_appointments"
[0m16:21:48.339564 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_appointments"} */
alter table "salesdb"."silver"."silver_appointments" rename to "silver_appointments__dbt_backup"
[0m16:21:48.340547 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:21:48.343400 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_appointments"
[0m16:21:48.343854 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_appointments"} */
alter table "salesdb"."silver"."silver_appointments__dbt_tmp" rename to "silver_appointments"
[0m16:21:48.344724 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:21:48.347702 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: COMMIT
[0m16:21:48.348143 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_appointments"
[0m16:21:48.348494 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: COMMIT
[0m16:21:48.350009 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:21:48.352156 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."silver"."silver_appointments__dbt_backup"
[0m16:21:48.352750 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_appointments"
[0m16:21:48.353132 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_appointments"} */
drop table if exists "salesdb"."silver"."silver_appointments__dbt_backup" cascade
[0m16:21:48.356079 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:21:48.357481 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: Close
[0m16:21:48.358206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8900f515-69ad-4494-a4e4-b83048c95273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7489c84d7450>]}
[0m16:21:48.358814 [info ] [Thread-1 (]: 10 of 12 OK created sql table model silver.silver_appointments ................. [[32mSELECT 1000[0m in 0.04s]
[0m16:21:48.359327 [debug] [Thread-1 (]: Finished running node model.modelling_handson.silver_appointments
[0m16:21:48.359712 [debug] [Thread-1 (]: Began running node model.modelling_handson.silver_treatments
[0m16:21:48.360246 [info ] [Thread-1 (]: 11 of 12 START sql table model silver.silver_treatments ........................ [RUN]
[0m16:21:48.360708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.silver_appointments, now model.modelling_handson.silver_treatments)
[0m16:21:48.361091 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.silver_treatments
[0m16:21:48.364099 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.silver_treatments"
[0m16:21:48.364784 [debug] [Thread-1 (]: Began executing node model.modelling_handson.silver_treatments
[0m16:21:48.367910 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.silver_treatments"
[0m16:21:48.368666 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_treatments"
[0m16:21:48.369074 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: BEGIN
[0m16:21:48.369396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:48.373892 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:21:48.374339 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_treatments"
[0m16:21:48.374648 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_treatments"} */

  
    

  create  table "salesdb"."silver"."silver_treatments__dbt_tmp"
  
  
    as
  
  (
    select * from "salesdb"."bronze"."bronze_treatments"
where cost > 0
  );
  
[0m16:21:48.378992 [debug] [Thread-1 (]: SQL status: SELECT 800 in 0.004 seconds
[0m16:21:48.381975 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_treatments"
[0m16:21:48.382390 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_treatments"} */
alter table "salesdb"."silver"."silver_treatments" rename to "silver_treatments__dbt_backup"
[0m16:21:48.383269 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:21:48.385791 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_treatments"
[0m16:21:48.386203 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_treatments"} */
alter table "salesdb"."silver"."silver_treatments__dbt_tmp" rename to "silver_treatments"
[0m16:21:48.387010 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:21:48.388188 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: COMMIT
[0m16:21:48.388560 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_treatments"
[0m16:21:48.388859 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: COMMIT
[0m16:21:48.390144 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:21:48.392321 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."silver"."silver_treatments__dbt_backup"
[0m16:21:48.392883 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_treatments"
[0m16:21:48.393206 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_treatments"} */
drop table if exists "salesdb"."silver"."silver_treatments__dbt_backup" cascade
[0m16:21:48.395097 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:21:48.396350 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: Close
[0m16:21:48.396957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8900f515-69ad-4494-a4e4-b83048c95273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7489c84d4f90>]}
[0m16:21:48.397518 [info ] [Thread-1 (]: 11 of 12 OK created sql table model silver.silver_treatments ................... [[32mSELECT 800[0m in 0.04s]
[0m16:21:48.398033 [debug] [Thread-1 (]: Finished running node model.modelling_handson.silver_treatments
[0m16:21:48.399327 [debug] [Thread-1 (]: Began running node model.modelling_handson.gold_daily_metrics
[0m16:21:48.399777 [info ] [Thread-1 (]: 12 of 12 START sql table model gold.gold_daily_metrics ......................... [RUN]
[0m16:21:48.400189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.silver_treatments, now model.modelling_handson.gold_daily_metrics)
[0m16:21:48.400475 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.gold_daily_metrics
[0m16:21:48.403326 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.gold_daily_metrics"
[0m16:21:48.403911 [debug] [Thread-1 (]: Began executing node model.modelling_handson.gold_daily_metrics
[0m16:21:48.406719 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.gold_daily_metrics"
[0m16:21:48.407352 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.gold_daily_metrics"
[0m16:21:48.407709 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: BEGIN
[0m16:21:48.407999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:48.412145 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:21:48.412635 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.gold_daily_metrics"
[0m16:21:48.413417 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.gold_daily_metrics"} */

  
    

  create  table "salesdb"."gold"."gold_daily_metrics__dbt_tmp"
  
  
    as
  
  (
    select
a.appointment_date,
count(distinct a.appointment_id) as total_appointments,
count(distinct t.treatment_id) as total_treatments,
sum(t.cost) as revenue
from "salesdb"."silver"."silver_appointments" a
left join "salesdb"."silver"."silver_treatments" t
on a.appointment_id = t.appointment_id
group by a.appointment_date
  );
  
[0m16:21:48.418115 [debug] [Thread-1 (]: SQL status: SELECT 349 in 0.004 seconds
[0m16:21:48.421310 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.gold_daily_metrics"
[0m16:21:48.421844 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.gold_daily_metrics"} */
alter table "salesdb"."gold"."gold_daily_metrics" rename to "gold_daily_metrics__dbt_backup"
[0m16:21:48.422817 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:21:48.425740 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.gold_daily_metrics"
[0m16:21:48.426241 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.gold_daily_metrics"} */
alter table "salesdb"."gold"."gold_daily_metrics__dbt_tmp" rename to "gold_daily_metrics"
[0m16:21:48.427143 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:21:48.428372 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: COMMIT
[0m16:21:48.428777 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.gold_daily_metrics"
[0m16:21:48.429056 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: COMMIT
[0m16:21:48.430844 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:21:48.434901 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."gold"."gold_daily_metrics__dbt_backup"
[0m16:21:48.435764 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.gold_daily_metrics"
[0m16:21:48.436126 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.gold_daily_metrics"} */
drop table if exists "salesdb"."gold"."gold_daily_metrics__dbt_backup" cascade
[0m16:21:48.438677 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:21:48.440059 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: Close
[0m16:21:48.440737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8900f515-69ad-4494-a4e4-b83048c95273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7489c82f9450>]}
[0m16:21:48.441331 [info ] [Thread-1 (]: 12 of 12 OK created sql table model gold.gold_daily_metrics .................... [[32mSELECT 349[0m in 0.04s]
[0m16:21:48.441897 [debug] [Thread-1 (]: Finished running node model.modelling_handson.gold_daily_metrics
[0m16:21:48.443685 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:48.444082 [debug] [MainThread]: On master: BEGIN
[0m16:21:48.444384 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:21:48.448427 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m16:21:48.449155 [debug] [MainThread]: On master: COMMIT
[0m16:21:48.449474 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:48.449823 [debug] [MainThread]: On master: COMMIT
[0m16:21:48.450372 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:21:48.450699 [debug] [MainThread]: On master: Close
[0m16:21:48.451123 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:21:48.451406 [debug] [MainThread]: Connection 'model.modelling_handson.gold_daily_metrics' was properly closed.
[0m16:21:48.451876 [info ] [MainThread]: 
[0m16:21:48.452289 [info ] [MainThread]: Finished running 5 table models, 7 view models in 0 hours 0 minutes and 1.42 seconds (1.42s).
[0m16:21:48.454077 [debug] [MainThread]: Command end result
[0m16:21:49.658999 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m16:21:49.663555 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m16:21:49.670019 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m16:21:49.670476 [info ] [MainThread]: 
[0m16:21:49.670870 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:21:49.671208 [info ] [MainThread]: 
[0m16:21:49.671513 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m16:21:49.672096 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:21:49.673260 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.67969, "process_in_blocks": "8", "process_kernel_time": 0.22831, "process_mem_max_rss": "129668", "process_out_blocks": "3240", "process_user_time": 2.553693}
[0m16:21:49.673821 [debug] [MainThread]: Command `dbt run` succeeded at 16:21:49.673732 after 1.68 seconds
[0m16:21:49.674226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7489d45d3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7489d7dbcdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7489d7dbd290>]}
[0m16:21:49.674545 [debug] [MainThread]: Flushing usage events
[0m16:21:51.229112 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:21:55.592378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c59cc1adfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c59cc370ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c59cc47b250>]}


============================== 16:21:55.594878 | 54208326-409f-4c06-9577-111890d8ebb7 ==============================
[0m16:21:55.594878 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:21:55.595367 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'profiles_dir': '/home/subhan/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:21:55.642226 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 50, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m16:21:55.642822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '54208326-409f-4c06-9577-111890d8ebb7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c59cc2076d0>]}
[0m16:21:55.749096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54208326-409f-4c06-9577-111890d8ebb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c59cbb7ba50>]}
[0m16:21:55.809853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54208326-409f-4c06-9577-111890d8ebb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c59cee30b50>]}
[0m16:21:55.810687 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:21:55.867156 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:21:55.997908 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:21:55.998329 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:21:56.062926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54208326-409f-4c06-9577-111890d8ebb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c59cafb89d0>]}
[0m16:21:56.172040 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m16:21:56.174427 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m16:21:56.203202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54208326-409f-4c06-9577-111890d8ebb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c59ca38ffd0>]}
[0m16:21:56.204167 [info ] [MainThread]: Found 13 models, 6 seeds, 5 data tests, 5 sources, 435 macros
[0m16:21:56.204623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54208326-409f-4c06-9577-111890d8ebb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c59cabe4a10>]}
[0m16:21:56.206861 [info ] [MainThread]: 
[0m16:21:56.207398 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:21:56.207733 [info ] [MainThread]: 
[0m16:21:56.208327 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:21:56.214444 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb_bronze'
[0m16:21:56.307895 [debug] [ThreadPool]: Using postgres connection "list_salesdb_bronze"
[0m16:21:56.308374 [debug] [ThreadPool]: On list_salesdb_bronze: BEGIN
[0m16:21:56.308658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:56.315699 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m16:21:56.316381 [debug] [ThreadPool]: Using postgres connection "list_salesdb_bronze"
[0m16:21:56.317237 [debug] [ThreadPool]: On list_salesdb_bronze: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_bronze"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m16:21:56.321804 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m16:21:56.323556 [debug] [ThreadPool]: On list_salesdb_bronze: ROLLBACK
[0m16:21:56.325019 [debug] [ThreadPool]: On list_salesdb_bronze: Close
[0m16:21:56.326014 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_bronze, now list_salesdb_silver)
[0m16:21:56.329440 [debug] [ThreadPool]: Using postgres connection "list_salesdb_silver"
[0m16:21:56.330010 [debug] [ThreadPool]: On list_salesdb_silver: BEGIN
[0m16:21:56.330316 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:56.335743 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m16:21:56.336245 [debug] [ThreadPool]: Using postgres connection "list_salesdb_silver"
[0m16:21:56.336560 [debug] [ThreadPool]: On list_salesdb_silver: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_silver"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m16:21:56.339632 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m16:21:56.341566 [debug] [ThreadPool]: On list_salesdb_silver: ROLLBACK
[0m16:21:56.342669 [debug] [ThreadPool]: On list_salesdb_silver: Close
[0m16:21:56.343616 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_silver, now list_salesdb_staging)
[0m16:21:56.346781 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m16:21:56.347278 [debug] [ThreadPool]: On list_salesdb_staging: BEGIN
[0m16:21:56.347568 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:56.352557 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m16:21:56.353037 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m16:21:56.353490 [debug] [ThreadPool]: On list_salesdb_staging: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_staging"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m16:21:56.356793 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m16:21:56.358208 [debug] [ThreadPool]: On list_salesdb_staging: ROLLBACK
[0m16:21:56.359180 [debug] [ThreadPool]: On list_salesdb_staging: Close
[0m16:21:56.360152 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_staging, now list_salesdb_gold)
[0m16:21:56.363647 [debug] [ThreadPool]: Using postgres connection "list_salesdb_gold"
[0m16:21:56.364240 [debug] [ThreadPool]: On list_salesdb_gold: BEGIN
[0m16:21:56.364529 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:56.370993 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m16:21:56.371597 [debug] [ThreadPool]: Using postgres connection "list_salesdb_gold"
[0m16:21:56.371995 [debug] [ThreadPool]: On list_salesdb_gold: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_gold"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m16:21:56.375357 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m16:21:56.376757 [debug] [ThreadPool]: On list_salesdb_gold: ROLLBACK
[0m16:21:56.377667 [debug] [ThreadPool]: On list_salesdb_gold: Close
[0m16:21:56.378461 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_gold, now list_salesdb_marts)
[0m16:21:56.380628 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m16:21:56.381430 [debug] [ThreadPool]: On list_salesdb_marts: BEGIN
[0m16:21:56.381798 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:56.388168 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m16:21:56.388870 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m16:21:56.389345 [debug] [ThreadPool]: On list_salesdb_marts: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_marts"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m16:21:56.392497 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m16:21:56.393810 [debug] [ThreadPool]: On list_salesdb_marts: ROLLBACK
[0m16:21:56.394845 [debug] [ThreadPool]: On list_salesdb_marts: Close
[0m16:21:56.395800 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_marts, now list_salesdb_public_raw_data)
[0m16:21:56.399315 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m16:21:56.399952 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m16:21:56.400386 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:56.406424 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m16:21:56.407238 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m16:21:56.407948 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m16:21:56.411165 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.003 seconds
[0m16:21:56.414507 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m16:21:56.416075 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m16:21:56.426916 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:56.427811 [debug] [MainThread]: On master: BEGIN
[0m16:21:56.428123 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:21:56.435766 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m16:21:56.436513 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:56.436915 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:21:56.465076 [debug] [MainThread]: SQL status: SELECT 13 in 0.027 seconds
[0m16:21:56.469368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54208326-409f-4c06-9577-111890d8ebb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c59cbfcdbd0>]}
[0m16:21:56.470099 [debug] [MainThread]: On master: ROLLBACK
[0m16:21:56.471174 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:56.471628 [debug] [MainThread]: On master: BEGIN
[0m16:21:56.473044 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:21:56.473481 [debug] [MainThread]: On master: COMMIT
[0m16:21:56.473822 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:56.474120 [debug] [MainThread]: On master: COMMIT
[0m16:21:56.475023 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:21:56.475470 [debug] [MainThread]: On master: Close
[0m16:21:56.479982 [debug] [Thread-1 (]: Began running node test.modelling_handson.accepted_values_dim_patients_gender__M__F__Other.dcad44a48b
[0m16:21:56.480511 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_dim_patients_gender__M__F__Other ............. [RUN]
[0m16:21:56.481040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now test.modelling_handson.accepted_values_dim_patients_gender__M__F__Other.dcad44a48b)
[0m16:21:56.481440 [debug] [Thread-1 (]: Began compiling node test.modelling_handson.accepted_values_dim_patients_gender__M__F__Other.dcad44a48b
[0m16:21:56.501739 [debug] [Thread-1 (]: Writing injected SQL for node "test.modelling_handson.accepted_values_dim_patients_gender__M__F__Other.dcad44a48b"
[0m16:21:56.502757 [debug] [Thread-1 (]: Began executing node test.modelling_handson.accepted_values_dim_patients_gender__M__F__Other.dcad44a48b
[0m16:21:56.525513 [debug] [Thread-1 (]: Writing runtime sql for node "test.modelling_handson.accepted_values_dim_patients_gender__M__F__Other.dcad44a48b"
[0m16:21:56.526459 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.accepted_values_dim_patients_gender__M__F__Other.dcad44a48b"
[0m16:21:56.526976 [debug] [Thread-1 (]: On test.modelling_handson.accepted_values_dim_patients_gender__M__F__Other.dcad44a48b: BEGIN
[0m16:21:56.527375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:56.532851 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m16:21:56.533411 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.accepted_values_dim_patients_gender__M__F__Other.dcad44a48b"
[0m16:21:56.533830 [debug] [Thread-1 (]: On test.modelling_handson.accepted_values_dim_patients_gender__M__F__Other.dcad44a48b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "test.modelling_handson.accepted_values_dim_patients_gender__M__F__Other.dcad44a48b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        gender as value_field,
        count(*) as n_records

    from "salesdb"."marts"."dim_patients"
    group by gender

)

select *
from all_values
where value_field not in (
    'M','F','Other'
)



  
  
      
    ) dbt_internal_test
[0m16:21:56.535810 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:21:56.542558 [debug] [Thread-1 (]: On test.modelling_handson.accepted_values_dim_patients_gender__M__F__Other.dcad44a48b: ROLLBACK
[0m16:21:56.544064 [debug] [Thread-1 (]: On test.modelling_handson.accepted_values_dim_patients_gender__M__F__Other.dcad44a48b: Close
[0m16:21:56.545079 [error] [Thread-1 (]: 1 of 5 FAIL 2 accepted_values_dim_patients_gender__M__F__Other ................. [[31mFAIL 2[0m in 0.06s]
[0m16:21:56.545880 [debug] [Thread-1 (]: Finished running node test.modelling_handson.accepted_values_dim_patients_gender__M__F__Other.dcad44a48b
[0m16:21:56.546330 [debug] [Thread-1 (]: Began running node test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7
[0m16:21:56.547035 [info ] [Thread-1 (]: 2 of 5 START test not_null_dim_patients_patient_id ............................. [RUN]
[0m16:21:56.547649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.modelling_handson.accepted_values_dim_patients_gender__M__F__Other.dcad44a48b, now test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7)
[0m16:21:56.548133 [debug] [Thread-1 (]: Began compiling node test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7
[0m16:21:56.555195 [debug] [Thread-1 (]: Writing injected SQL for node "test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7"
[0m16:21:56.556183 [debug] [Thread-1 (]: Began executing node test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7
[0m16:21:56.558818 [debug] [Thread-1 (]: Writing runtime sql for node "test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7"
[0m16:21:56.560718 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7"
[0m16:21:56.561684 [debug] [Thread-1 (]: On test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7: BEGIN
[0m16:21:56.562119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:56.569140 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m16:21:56.570012 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7"
[0m16:21:56.570470 [debug] [Thread-1 (]: On test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "salesdb"."marts"."dim_patients"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m16:21:56.572320 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:21:56.574897 [debug] [Thread-1 (]: On test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7: ROLLBACK
[0m16:21:56.576230 [debug] [Thread-1 (]: On test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7: Close
[0m16:21:56.577094 [info ] [Thread-1 (]: 2 of 5 PASS not_null_dim_patients_patient_id ................................... [[32mPASS[0m in 0.03s]
[0m16:21:56.577754 [debug] [Thread-1 (]: Finished running node test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7
[0m16:21:56.578445 [debug] [Thread-1 (]: Began running node test.modelling_handson.test_ages
[0m16:21:56.579281 [info ] [Thread-1 (]: 3 of 5 START test test_ages .................................................... [RUN]
[0m16:21:56.579944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7, now test.modelling_handson.test_ages)
[0m16:21:56.580365 [debug] [Thread-1 (]: Began compiling node test.modelling_handson.test_ages
[0m16:21:56.583320 [debug] [Thread-1 (]: Writing injected SQL for node "test.modelling_handson.test_ages"
[0m16:21:56.584195 [debug] [Thread-1 (]: Began executing node test.modelling_handson.test_ages
[0m16:21:56.586646 [debug] [Thread-1 (]: Writing runtime sql for node "test.modelling_handson.test_ages"
[0m16:21:56.587397 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.test_ages"
[0m16:21:56.588059 [debug] [Thread-1 (]: On test.modelling_handson.test_ages: BEGIN
[0m16:21:56.588449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:56.594379 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m16:21:56.594951 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.test_ages"
[0m16:21:56.595326 [debug] [Thread-1 (]: On test.modelling_handson.test_ages: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "test.modelling_handson.test_ages"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select *
from "salesdb"."marts"."dim_patients"
where age < 0
  
  
      
    ) dbt_internal_test
[0m16:21:56.597499 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:21:56.599566 [debug] [Thread-1 (]: On test.modelling_handson.test_ages: ROLLBACK
[0m16:21:56.600747 [debug] [Thread-1 (]: On test.modelling_handson.test_ages: Close
[0m16:21:56.601507 [info ] [Thread-1 (]: 3 of 5 PASS test_ages .......................................................... [[32mPASS[0m in 0.02s]
[0m16:21:56.602128 [debug] [Thread-1 (]: Finished running node test.modelling_handson.test_ages
[0m16:21:56.602608 [debug] [Thread-1 (]: Began running node test.modelling_handson.test_ages_dim_patients_.2b960afd7a
[0m16:21:56.603394 [info ] [Thread-1 (]: 4 of 5 START test test_ages_dim_patients_ ...................................... [RUN]
[0m16:21:56.604106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.modelling_handson.test_ages, now test.modelling_handson.test_ages_dim_patients_.2b960afd7a)
[0m16:21:56.604525 [debug] [Thread-1 (]: Began compiling node test.modelling_handson.test_ages_dim_patients_.2b960afd7a
[0m16:21:56.612297 [debug] [Thread-1 (]: Compilation Error in test test_ages_dim_patients_ (models/marts/schema.yml)
  'test_test_ages' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:21:56.612996 [error] [Thread-1 (]: 4 of 5 ERROR test_ages_dim_patients_ ........................................... [[31mERROR[0m in 0.01s]
[0m16:21:56.613585 [debug] [Thread-1 (]: Finished running node test.modelling_handson.test_ages_dim_patients_.2b960afd7a
[0m16:21:56.614014 [debug] [Thread-1 (]: Began running node test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2
[0m16:21:56.614549 [debug] [Thread-4 (]: Marking all children of 'test.modelling_handson.test_ages_dim_patients_.2b960afd7a' to be skipped because of status 'error'.  Reason: Compilation Error in test test_ages_dim_patients_ (models/marts/schema.yml)
  'test_test_ages' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m16:21:56.615290 [info ] [Thread-1 (]: 5 of 5 START test unique_dim_patients_patient_id ............................... [RUN]
[0m16:21:56.616995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.modelling_handson.test_ages_dim_patients_.2b960afd7a, now test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2)
[0m16:21:56.617564 [debug] [Thread-1 (]: Began compiling node test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2
[0m16:21:56.625679 [debug] [Thread-1 (]: Writing injected SQL for node "test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2"
[0m16:21:56.626588 [debug] [Thread-1 (]: Began executing node test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2
[0m16:21:56.629155 [debug] [Thread-1 (]: Writing runtime sql for node "test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2"
[0m16:21:56.630019 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2"
[0m16:21:56.630431 [debug] [Thread-1 (]: On test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2: BEGIN
[0m16:21:56.630921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:56.636844 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m16:21:56.637361 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2"
[0m16:21:56.637734 [debug] [Thread-1 (]: On test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "salesdb"."marts"."dim_patients"
where patient_id is not null
group by patient_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:21:56.639488 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:21:56.641243 [debug] [Thread-1 (]: On test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2: ROLLBACK
[0m16:21:56.642274 [debug] [Thread-1 (]: On test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2: Close
[0m16:21:56.643066 [info ] [Thread-1 (]: 5 of 5 PASS unique_dim_patients_patient_id ..................................... [[32mPASS[0m in 0.03s]
[0m16:21:56.643794 [debug] [Thread-1 (]: Finished running node test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2
[0m16:21:56.645991 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:56.646697 [debug] [MainThread]: On master: BEGIN
[0m16:21:56.647142 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:21:56.652211 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m16:21:56.652689 [debug] [MainThread]: On master: COMMIT
[0m16:21:56.653070 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:56.653347 [debug] [MainThread]: On master: COMMIT
[0m16:21:56.654021 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:21:56.654431 [debug] [MainThread]: On master: Close
[0m16:21:56.654899 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:21:56.655200 [debug] [MainThread]: Connection 'test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2' was properly closed.
[0m16:21:56.655685 [info ] [MainThread]: 
[0m16:21:56.656087 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m16:21:56.657114 [debug] [MainThread]: Command end result
[0m16:21:56.685253 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m16:21:56.687388 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m16:21:56.696064 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m16:21:56.696561 [info ] [MainThread]: 
[0m16:21:56.697021 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m16:21:56.697410 [info ] [MainThread]: 
[0m16:21:56.697840 [error] [MainThread]: [31mFailure in test accepted_values_dim_patients_gender__M__F__Other (models/marts/schema.yml)[0m
[0m16:21:56.698314 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m16:21:56.698617 [info ] [MainThread]: 
[0m16:21:56.698961 [info ] [MainThread]:   compiled code at target/compiled/modelling_handson/models/marts/schema.yml/accepted_values_dim_patients_gender__M__F__Other.sql
[0m16:21:56.699269 [info ] [MainThread]: 
[0m16:21:56.699639 [error] [MainThread]: [31mFailure in test test_ages_dim_patients_ (models/marts/schema.yml)[0m
[0m16:21:56.700065 [error] [MainThread]:   Compilation Error in test test_ages_dim_patients_ (models/marts/schema.yml)
  'test_test_ages' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:21:56.700404 [info ] [MainThread]: 
[0m16:21:56.700733 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=5
[0m16:21:56.701255 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:21:56.702330 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.16025, "process_in_blocks": "8", "process_kernel_time": 0.234666, "process_mem_max_rss": "125412", "process_out_blocks": "2088", "process_user_time": 2.061709}
[0m16:21:56.702878 [debug] [MainThread]: Command `dbt test` failed at 16:21:56.702777 after 1.16 seconds
[0m16:21:56.703280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c59cc1ac650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c59cc206e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c59cb713590>]}
[0m16:21:56.703682 [debug] [MainThread]: Flushing usage events
[0m16:21:57.759525 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:25:16.005329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706ead98f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706eade5b250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706ead98f8d0>]}


============================== 16:25:16.010290 | a7df243b-666a-476c-a5a5-1746fc7c6a11 ==============================
[0m16:25:16.010290 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:25:16.010984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/subhan/.dbt', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:25:16.012405 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 50, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m16:25:16.013225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a7df243b-666a-476c-a5a5-1746fc7c6a11', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706ead98d950>]}
[0m16:25:16.138779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7df243b-666a-476c-a5a5-1746fc7c6a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706eade5af10>]}
[0m16:25:16.167348 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:25:16.169398 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2234233, "process_in_blocks": "90376", "process_kernel_time": 0.308249, "process_mem_max_rss": "104444", "process_out_blocks": "8", "process_user_time": 1.434218}
[0m16:25:16.170009 [debug] [MainThread]: Command `dbt clean` succeeded at 16:25:16.169906 after 0.22 seconds
[0m16:25:16.170336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706eada0bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706eada0bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706eadd50b50>]}
[0m16:25:16.170691 [debug] [MainThread]: Flushing usage events
[0m16:25:17.198237 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:27:27.789594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7016bc8b1cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7016bc90acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7016bc90a490>]}


============================== 16:27:27.792491 | e08c5621-28b6-4e27-ab3a-6ce89232a2a1 ==============================
[0m16:27:27.792491 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:27:27.793011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'fail_fast': 'False', 'profiles_dir': '/home/subhan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m16:27:27.875748 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 50, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m16:27:27.876445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e08c5621-28b6-4e27-ab3a-6ce89232a2a1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7016bc93e710>]}
[0m16:27:28.000401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e08c5621-28b6-4e27-ab3a-6ce89232a2a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7016bca748d0>]}
[0m16:27:28.071246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e08c5621-28b6-4e27-ab3a-6ce89232a2a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7016bf545bd0>]}
[0m16:27:28.073133 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:27:28.148155 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:27:28.148832 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:27:28.149411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e08c5621-28b6-4e27-ab3a-6ce89232a2a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7016bc37b5d0>]}
[0m16:27:29.464198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e08c5621-28b6-4e27-ab3a-6ce89232a2a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7016b816ae10>]}
[0m16:27:29.600288 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m16:27:29.603883 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m16:27:29.631027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e08c5621-28b6-4e27-ab3a-6ce89232a2a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70167df9e550>]}
[0m16:27:29.631580 [info ] [MainThread]: Found 13 models, 5 data tests, 6 seeds, 5 sources, 435 macros
[0m16:27:29.632002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e08c5621-28b6-4e27-ab3a-6ce89232a2a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7016b81ac590>]}
[0m16:27:29.633995 [info ] [MainThread]: 
[0m16:27:29.634468 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:27:29.634848 [info ] [MainThread]: 
[0m16:27:29.635292 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:27:29.640623 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb_marts'
[0m16:27:29.730728 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m16:27:29.731123 [debug] [ThreadPool]: On list_salesdb_marts: BEGIN
[0m16:27:29.731376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:27:29.741440 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m16:27:29.741834 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m16:27:29.742104 [debug] [ThreadPool]: On list_salesdb_marts: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_marts"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m16:27:29.744794 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m16:27:29.745868 [debug] [ThreadPool]: On list_salesdb_marts: ROLLBACK
[0m16:27:29.746413 [debug] [ThreadPool]: On list_salesdb_marts: Close
[0m16:27:29.746946 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_marts, now list_salesdb_silver)
[0m16:27:29.748998 [debug] [ThreadPool]: Using postgres connection "list_salesdb_silver"
[0m16:27:29.749302 [debug] [ThreadPool]: On list_salesdb_silver: BEGIN
[0m16:27:29.749553 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:27:29.753086 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:27:29.753443 [debug] [ThreadPool]: Using postgres connection "list_salesdb_silver"
[0m16:27:29.753713 [debug] [ThreadPool]: On list_salesdb_silver: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_silver"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m16:27:29.755744 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m16:27:29.756836 [debug] [ThreadPool]: On list_salesdb_silver: ROLLBACK
[0m16:27:29.757552 [debug] [ThreadPool]: On list_salesdb_silver: Close
[0m16:27:29.758097 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_silver, now list_salesdb_bronze)
[0m16:27:29.760111 [debug] [ThreadPool]: Using postgres connection "list_salesdb_bronze"
[0m16:27:29.760456 [debug] [ThreadPool]: On list_salesdb_bronze: BEGIN
[0m16:27:29.760683 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:27:29.764236 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:27:29.764784 [debug] [ThreadPool]: Using postgres connection "list_salesdb_bronze"
[0m16:27:29.765326 [debug] [ThreadPool]: On list_salesdb_bronze: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_bronze"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m16:27:29.767536 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m16:27:29.768597 [debug] [ThreadPool]: On list_salesdb_bronze: ROLLBACK
[0m16:27:29.769287 [debug] [ThreadPool]: On list_salesdb_bronze: Close
[0m16:27:29.769853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_bronze, now list_salesdb_public_raw_data)
[0m16:27:29.771411 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m16:27:29.772218 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m16:27:29.772520 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:27:29.776144 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m16:27:29.776519 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m16:27:29.776784 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m16:27:29.779019 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.002 seconds
[0m16:27:29.780378 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m16:27:29.781207 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m16:27:29.781794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now list_salesdb_gold)
[0m16:27:29.785054 [debug] [ThreadPool]: Using postgres connection "list_salesdb_gold"
[0m16:27:29.785666 [debug] [ThreadPool]: On list_salesdb_gold: BEGIN
[0m16:27:29.785918 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:27:29.789739 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m16:27:29.790113 [debug] [ThreadPool]: Using postgres connection "list_salesdb_gold"
[0m16:27:29.790365 [debug] [ThreadPool]: On list_salesdb_gold: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_gold"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m16:27:29.792697 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m16:27:29.793718 [debug] [ThreadPool]: On list_salesdb_gold: ROLLBACK
[0m16:27:29.794299 [debug] [ThreadPool]: On list_salesdb_gold: Close
[0m16:27:29.794894 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_gold, now list_salesdb_staging)
[0m16:27:29.796761 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m16:27:29.797079 [debug] [ThreadPool]: On list_salesdb_staging: BEGIN
[0m16:27:29.797299 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:27:29.801345 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m16:27:29.801838 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m16:27:29.802096 [debug] [ThreadPool]: On list_salesdb_staging: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_staging"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m16:27:29.804513 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m16:27:29.805630 [debug] [ThreadPool]: On list_salesdb_staging: ROLLBACK
[0m16:27:29.806388 [debug] [ThreadPool]: On list_salesdb_staging: Close
[0m16:27:29.812301 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:29.812676 [debug] [MainThread]: On master: BEGIN
[0m16:27:29.812910 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:27:29.816741 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m16:27:29.817103 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:29.817402 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:27:29.837422 [debug] [MainThread]: SQL status: SELECT 13 in 0.020 seconds
[0m16:27:29.840575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e08c5621-28b6-4e27-ab3a-6ce89232a2a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7016ba759ad0>]}
[0m16:27:29.841022 [debug] [MainThread]: On master: ROLLBACK
[0m16:27:29.841966 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:29.842280 [debug] [MainThread]: On master: BEGIN
[0m16:27:29.843198 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:27:29.843510 [debug] [MainThread]: On master: COMMIT
[0m16:27:29.843774 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:29.844131 [debug] [MainThread]: On master: COMMIT
[0m16:27:29.844646 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:27:29.844931 [debug] [MainThread]: On master: Close
[0m16:27:29.849041 [debug] [Thread-1 (]: Began running node test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33
[0m16:27:29.849529 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_dim_patients_gender__Male__Female__Other ..... [RUN]
[0m16:27:29.849993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_staging, now test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33)
[0m16:27:29.850300 [debug] [Thread-1 (]: Began compiling node test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33
[0m16:27:29.857707 [debug] [Thread-1 (]: Writing injected SQL for node "test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33"
[0m16:27:29.859639 [debug] [Thread-1 (]: Began executing node test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33
[0m16:27:29.883529 [debug] [Thread-1 (]: Writing runtime sql for node "test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33"
[0m16:27:29.886585 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33"
[0m16:27:29.887387 [debug] [Thread-1 (]: On test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33: BEGIN
[0m16:27:29.888090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:27:29.894131 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m16:27:29.894708 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33"
[0m16:27:29.895189 [debug] [Thread-1 (]: On test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        gender as value_field,
        count(*) as n_records

    from "salesdb"."marts"."dim_patients"
    group by gender

)

select *
from all_values
where value_field not in (
    'Male','Female','Other'
)



  
  
      
    ) dbt_internal_test
[0m16:27:29.897558 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:27:29.902717 [debug] [Thread-1 (]: On test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33: ROLLBACK
[0m16:27:29.904364 [debug] [Thread-1 (]: On test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33: Close
[0m16:27:29.905331 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_dim_patients_gender__Male__Female__Other ........... [[32mPASS[0m in 0.06s]
[0m16:27:29.906058 [debug] [Thread-1 (]: Finished running node test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33
[0m16:27:29.906497 [debug] [Thread-1 (]: Began running node test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7
[0m16:27:29.907166 [info ] [Thread-1 (]: 2 of 5 START test not_null_dim_patients_patient_id ............................. [RUN]
[0m16:27:29.907888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33, now test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7)
[0m16:27:29.908419 [debug] [Thread-1 (]: Began compiling node test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7
[0m16:27:29.918970 [debug] [Thread-1 (]: Writing injected SQL for node "test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7"
[0m16:27:29.919765 [debug] [Thread-1 (]: Began executing node test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7
[0m16:27:29.924316 [debug] [Thread-1 (]: Writing runtime sql for node "test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7"
[0m16:27:29.925059 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7"
[0m16:27:29.925590 [debug] [Thread-1 (]: On test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7: BEGIN
[0m16:27:29.925972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:27:29.931666 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m16:27:29.932454 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7"
[0m16:27:29.933434 [debug] [Thread-1 (]: On test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "salesdb"."marts"."dim_patients"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m16:27:29.935472 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:27:29.938162 [debug] [Thread-1 (]: On test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7: ROLLBACK
[0m16:27:29.939350 [debug] [Thread-1 (]: On test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7: Close
[0m16:27:29.940614 [info ] [Thread-1 (]: 2 of 5 PASS not_null_dim_patients_patient_id ................................... [[32mPASS[0m in 0.03s]
[0m16:27:29.941384 [debug] [Thread-1 (]: Finished running node test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7
[0m16:27:29.941847 [debug] [Thread-1 (]: Began running node test.modelling_handson.test_ages
[0m16:27:29.942526 [info ] [Thread-1 (]: 3 of 5 START test test_ages .................................................... [RUN]
[0m16:27:29.943187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7, now test.modelling_handson.test_ages)
[0m16:27:29.943587 [debug] [Thread-1 (]: Began compiling node test.modelling_handson.test_ages
[0m16:27:29.946445 [debug] [Thread-1 (]: Writing injected SQL for node "test.modelling_handson.test_ages"
[0m16:27:29.948765 [debug] [Thread-1 (]: Began executing node test.modelling_handson.test_ages
[0m16:27:29.952036 [debug] [Thread-1 (]: Writing runtime sql for node "test.modelling_handson.test_ages"
[0m16:27:29.953881 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.test_ages"
[0m16:27:29.954591 [debug] [Thread-1 (]: On test.modelling_handson.test_ages: BEGIN
[0m16:27:29.955553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:27:29.962545 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m16:27:29.963418 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.test_ages"
[0m16:27:29.964279 [debug] [Thread-1 (]: On test.modelling_handson.test_ages: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "test.modelling_handson.test_ages"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select *
from "salesdb"."marts"."dim_patients"
where age < 0
  
  
      
    ) dbt_internal_test
[0m16:27:29.966185 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:27:29.968157 [debug] [Thread-1 (]: On test.modelling_handson.test_ages: ROLLBACK
[0m16:27:29.969186 [debug] [Thread-1 (]: On test.modelling_handson.test_ages: Close
[0m16:27:29.970011 [info ] [Thread-1 (]: 3 of 5 PASS test_ages .......................................................... [[32mPASS[0m in 0.03s]
[0m16:27:29.970701 [debug] [Thread-1 (]: Finished running node test.modelling_handson.test_ages
[0m16:27:29.971180 [debug] [Thread-1 (]: Began running node test.modelling_handson.test_ages_dim_patients_.2b960afd7a
[0m16:27:29.971828 [info ] [Thread-1 (]: 4 of 5 START test test_ages_dim_patients_ ...................................... [RUN]
[0m16:27:29.972480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.modelling_handson.test_ages, now test.modelling_handson.test_ages_dim_patients_.2b960afd7a)
[0m16:27:29.972878 [debug] [Thread-1 (]: Began compiling node test.modelling_handson.test_ages_dim_patients_.2b960afd7a
[0m16:27:29.983222 [debug] [Thread-1 (]: Compilation Error in test test_ages_dim_patients_ (models/marts/schema.yml)
  'test_test_ages' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:27:29.983972 [error] [Thread-1 (]: 4 of 5 ERROR test_ages_dim_patients_ ........................................... [[31mERROR[0m in 0.01s]
[0m16:27:29.984887 [debug] [Thread-1 (]: Finished running node test.modelling_handson.test_ages_dim_patients_.2b960afd7a
[0m16:27:29.985688 [debug] [Thread-1 (]: Began running node test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2
[0m16:27:29.986365 [debug] [Thread-4 (]: Marking all children of 'test.modelling_handson.test_ages_dim_patients_.2b960afd7a' to be skipped because of status 'error'.  Reason: Compilation Error in test test_ages_dim_patients_ (models/marts/schema.yml)
  'test_test_ages' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m16:27:29.986852 [info ] [Thread-1 (]: 5 of 5 START test unique_dim_patients_patient_id ............................... [RUN]
[0m16:27:29.988546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.modelling_handson.test_ages_dim_patients_.2b960afd7a, now test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2)
[0m16:27:29.989296 [debug] [Thread-1 (]: Began compiling node test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2
[0m16:27:29.998421 [debug] [Thread-1 (]: Writing injected SQL for node "test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2"
[0m16:27:30.000516 [debug] [Thread-1 (]: Began executing node test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2
[0m16:27:30.003453 [debug] [Thread-1 (]: Writing runtime sql for node "test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2"
[0m16:27:30.004485 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2"
[0m16:27:30.004942 [debug] [Thread-1 (]: On test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2: BEGIN
[0m16:27:30.005276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:27:30.010779 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m16:27:30.011307 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2"
[0m16:27:30.011678 [debug] [Thread-1 (]: On test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "salesdb"."marts"."dim_patients"
where patient_id is not null
group by patient_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:27:30.013405 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:27:30.015098 [debug] [Thread-1 (]: On test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2: ROLLBACK
[0m16:27:30.016215 [debug] [Thread-1 (]: On test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2: Close
[0m16:27:30.017081 [info ] [Thread-1 (]: 5 of 5 PASS unique_dim_patients_patient_id ..................................... [[32mPASS[0m in 0.03s]
[0m16:27:30.017772 [debug] [Thread-1 (]: Finished running node test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2
[0m16:27:30.020436 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:30.021198 [debug] [MainThread]: On master: BEGIN
[0m16:27:30.021797 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:27:30.028392 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m16:27:30.028950 [debug] [MainThread]: On master: COMMIT
[0m16:27:30.029285 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:30.029820 [debug] [MainThread]: On master: COMMIT
[0m16:27:30.030811 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:27:30.031300 [debug] [MainThread]: On master: Close
[0m16:27:30.031844 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:27:30.032359 [debug] [MainThread]: Connection 'test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2' was properly closed.
[0m16:27:30.033053 [info ] [MainThread]: 
[0m16:27:30.033722 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m16:27:30.035012 [debug] [MainThread]: Command end result
[0m16:27:30.068170 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m16:27:30.070990 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m16:27:30.081864 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m16:27:30.082370 [info ] [MainThread]: 
[0m16:27:30.082846 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:27:30.083272 [info ] [MainThread]: 
[0m16:27:30.083676 [error] [MainThread]: [31mFailure in test test_ages_dim_patients_ (models/marts/schema.yml)[0m
[0m16:27:30.084602 [error] [MainThread]:   Compilation Error in test test_ages_dim_patients_ (models/marts/schema.yml)
  'test_test_ages' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:27:30.085019 [info ] [MainThread]: 
[0m16:27:30.085381 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m16:27:30.085968 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:27:30.087098 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.3453896, "process_in_blocks": "20224", "process_kernel_time": 0.319334, "process_mem_max_rss": "132872", "process_out_blocks": "3008", "process_user_time": 3.172059}
[0m16:27:30.087747 [debug] [MainThread]: Command `dbt test` failed at 16:27:30.087609 after 2.35 seconds
[0m16:27:30.088292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7016bdfae290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7016c0f9c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7016c0f9cdd0>]}
[0m16:27:30.088729 [debug] [MainThread]: Flushing usage events
[0m16:27:31.302742 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:30:09.475232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714beedb7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714beedb7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714beedb7050>]}


============================== 16:30:09.477427 | 17de5ced-3b08-4279-9968-8900822ac3b1 ==============================
[0m16:30:09.477427 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:30:09.477837 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/subhan/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:30:09.478755 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 50, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m16:30:09.479117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '17de5ced-3b08-4279-9968-8900822ac3b1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714beee31110>]}
[0m16:30:09.567066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17de5ced-3b08-4279-9968-8900822ac3b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714beed0bed0>]}
[0m16:30:09.575209 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:30:09.576035 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.14162107, "process_in_blocks": "0", "process_kernel_time": 0.212274, "process_mem_max_rss": "104588", "process_out_blocks": "8", "process_user_time": 1.112318}
[0m16:30:09.576381 [debug] [MainThread]: Command `dbt clean` succeeded at 16:30:09.576318 after 0.14 seconds
[0m16:30:09.576716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714beec9d750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714bf34b8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714bf34b8790>]}
[0m16:30:09.577169 [debug] [MainThread]: Flushing usage events
[0m16:30:10.803170 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:30:12.929508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70493488e110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704934896790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704934c50650>]}


============================== 16:30:12.931755 | 07522c35-c08d-4dec-af50-57b9e5c4410f ==============================
[0m16:30:12.931755 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:30:12.932128 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'profiles_dir': '/home/subhan/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:30:12.967741 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 50, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m16:30:12.968251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '07522c35-c08d-4dec-af50-57b9e5c4410f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7049343679d0>]}
[0m16:30:13.050689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07522c35-c08d-4dec-af50-57b9e5c4410f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704934367a50>]}
[0m16:30:13.094859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07522c35-c08d-4dec-af50-57b9e5c4410f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7049374e1e90>]}
[0m16:30:13.095519 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:30:13.146362 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:30:13.146901 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:30:13.147196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '07522c35-c08d-4dec-af50-57b9e5c4410f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7049348e77d0>]}
[0m16:30:14.269869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07522c35-c08d-4dec-af50-57b9e5c4410f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704932bbbf10>]}
[0m16:30:14.360741 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m16:30:14.362230 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m16:30:14.372812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07522c35-c08d-4dec-af50-57b9e5c4410f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704916064150>]}
[0m16:30:14.373300 [info ] [MainThread]: Found 13 models, 5 data tests, 6 seeds, 5 sources, 435 macros
[0m16:30:14.373622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07522c35-c08d-4dec-af50-57b9e5c4410f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7049359dc450>]}
[0m16:30:14.375591 [info ] [MainThread]: 
[0m16:30:14.375957 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:30:14.376218 [info ] [MainThread]: 
[0m16:30:14.376613 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:30:14.380537 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb'
[0m16:30:14.405272 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m16:30:14.405650 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m16:30:14.405998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:30:14.411235 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.005 seconds
[0m16:30:14.412288 [debug] [ThreadPool]: On list_salesdb: Close
[0m16:30:14.413993 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m16:30:14.414535 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m16:30:14.414830 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:30:14.419841 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.005 seconds
[0m16:30:14.421027 [debug] [ThreadPool]: On list_salesdb: Close
[0m16:30:14.422773 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m16:30:14.423111 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m16:30:14.423428 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:30:14.428246 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.005 seconds
[0m16:30:14.429239 [debug] [ThreadPool]: On list_salesdb: Close
[0m16:30:14.431028 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m16:30:14.431463 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m16:30:14.431751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:30:14.435872 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m16:30:14.436891 [debug] [ThreadPool]: On list_salesdb: Close
[0m16:30:14.439521 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m16:30:14.440104 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m16:30:14.440367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:30:14.444174 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m16:30:14.445112 [debug] [ThreadPool]: On list_salesdb: Close
[0m16:30:14.447008 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb, now list_salesdb_silver)
[0m16:30:14.497062 [debug] [ThreadPool]: Using postgres connection "list_salesdb_silver"
[0m16:30:14.497424 [debug] [ThreadPool]: On list_salesdb_silver: BEGIN
[0m16:30:14.497666 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:30:14.500909 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:30:14.501221 [debug] [ThreadPool]: Using postgres connection "list_salesdb_silver"
[0m16:30:14.501461 [debug] [ThreadPool]: On list_salesdb_silver: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_silver"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m16:30:14.503435 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m16:30:14.504413 [debug] [ThreadPool]: On list_salesdb_silver: ROLLBACK
[0m16:30:14.504922 [debug] [ThreadPool]: On list_salesdb_silver: Close
[0m16:30:14.505411 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_silver, now list_salesdb_bronze)
[0m16:30:14.506792 [debug] [ThreadPool]: Using postgres connection "list_salesdb_bronze"
[0m16:30:14.507528 [debug] [ThreadPool]: On list_salesdb_bronze: BEGIN
[0m16:30:14.507760 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:30:14.511228 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:30:14.511496 [debug] [ThreadPool]: Using postgres connection "list_salesdb_bronze"
[0m16:30:14.511734 [debug] [ThreadPool]: On list_salesdb_bronze: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_bronze"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m16:30:14.513656 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m16:30:14.514528 [debug] [ThreadPool]: On list_salesdb_bronze: ROLLBACK
[0m16:30:14.514994 [debug] [ThreadPool]: On list_salesdb_bronze: Close
[0m16:30:14.515457 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_bronze, now list_salesdb_gold)
[0m16:30:14.517116 [debug] [ThreadPool]: Using postgres connection "list_salesdb_gold"
[0m16:30:14.517367 [debug] [ThreadPool]: On list_salesdb_gold: BEGIN
[0m16:30:14.517565 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:30:14.520547 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:30:14.520818 [debug] [ThreadPool]: Using postgres connection "list_salesdb_gold"
[0m16:30:14.521045 [debug] [ThreadPool]: On list_salesdb_gold: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_gold"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m16:30:14.522889 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m16:30:14.523732 [debug] [ThreadPool]: On list_salesdb_gold: ROLLBACK
[0m16:30:14.524184 [debug] [ThreadPool]: On list_salesdb_gold: Close
[0m16:30:14.524623 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_gold, now list_salesdb_staging)
[0m16:30:14.526941 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m16:30:14.527239 [debug] [ThreadPool]: On list_salesdb_staging: BEGIN
[0m16:30:14.527449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:30:14.530811 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:30:14.531118 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m16:30:14.531343 [debug] [ThreadPool]: On list_salesdb_staging: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_staging"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m16:30:14.533259 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m16:30:14.534777 [debug] [ThreadPool]: On list_salesdb_staging: ROLLBACK
[0m16:30:14.535366 [debug] [ThreadPool]: On list_salesdb_staging: Close
[0m16:30:14.535879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_staging, now list_salesdb_marts)
[0m16:30:14.537853 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m16:30:14.538118 [debug] [ThreadPool]: On list_salesdb_marts: BEGIN
[0m16:30:14.538341 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:30:14.541682 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:30:14.542002 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m16:30:14.542236 [debug] [ThreadPool]: On list_salesdb_marts: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_marts"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m16:30:14.544362 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m16:30:14.545359 [debug] [ThreadPool]: On list_salesdb_marts: ROLLBACK
[0m16:30:14.545943 [debug] [ThreadPool]: On list_salesdb_marts: Close
[0m16:30:14.546511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_marts, now list_salesdb_public_raw_data)
[0m16:30:14.548362 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m16:30:14.548632 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m16:30:14.548852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:30:14.552915 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m16:30:14.553233 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m16:30:14.553466 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m16:30:14.555675 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.002 seconds
[0m16:30:14.556700 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m16:30:14.557229 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m16:30:14.562039 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:14.562337 [debug] [MainThread]: On master: BEGIN
[0m16:30:14.562595 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:30:14.565971 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m16:30:14.566234 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:14.566513 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:30:14.581639 [debug] [MainThread]: SQL status: SELECT 13 in 0.015 seconds
[0m16:30:14.584362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07522c35-c08d-4dec-af50-57b9e5c4410f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7049327aed10>]}
[0m16:30:14.584715 [debug] [MainThread]: On master: ROLLBACK
[0m16:30:14.585339 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:14.585612 [debug] [MainThread]: On master: BEGIN
[0m16:30:14.586519 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:30:14.587079 [debug] [MainThread]: On master: COMMIT
[0m16:30:14.587485 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:14.587708 [debug] [MainThread]: On master: COMMIT
[0m16:30:14.588241 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:30:14.588535 [debug] [MainThread]: On master: Close
[0m16:30:14.590951 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_appointments
[0m16:30:14.591375 [info ] [Thread-1 (]: 1 of 12 START sql view model staging.stg_appointments .......................... [RUN]
[0m16:30:14.591744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now model.modelling_handson.stg_appointments)
[0m16:30:14.592008 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_appointments
[0m16:30:14.597406 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_appointments"
[0m16:30:14.598467 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_appointments
[0m16:30:14.623906 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_appointments"
[0m16:30:14.625005 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_appointments"
[0m16:30:14.625317 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: BEGIN
[0m16:30:14.625555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:14.628765 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m16:30:14.629091 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_appointments"
[0m16:30:14.629353 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_appointments"} */

  create view "salesdb"."staging"."stg_appointments__dbt_tmp"
    
    
  as (
    select
id as appointment_id,
patient_id,
doctor_id,
appointment_date,
status,
department_id
from "salesdb"."public_raw_data"."appointments"
  );
[0m16:30:14.632397 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:30:14.638326 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_appointments"
[0m16:30:14.638732 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_appointments"} */
alter table "salesdb"."staging"."stg_appointments" rename to "stg_appointments__dbt_backup"
[0m16:30:14.639718 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:30:14.641756 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_appointments"
[0m16:30:14.642046 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_appointments"} */
alter table "salesdb"."staging"."stg_appointments__dbt_tmp" rename to "stg_appointments"
[0m16:30:14.642672 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:30:14.654408 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: COMMIT
[0m16:30:14.654794 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_appointments"
[0m16:30:14.655063 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: COMMIT
[0m16:30:14.656946 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:30:14.661331 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_appointments__dbt_backup"
[0m16:30:14.666328 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_appointments"
[0m16:30:14.666771 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_appointments"} */
drop view if exists "salesdb"."staging"."stg_appointments__dbt_backup" cascade
[0m16:30:14.668530 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:30:14.670368 [debug] [Thread-1 (]: On model.modelling_handson.stg_appointments: Close
[0m16:30:14.672134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07522c35-c08d-4dec-af50-57b9e5c4410f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70493276c350>]}
[0m16:30:14.672730 [info ] [Thread-1 (]: 1 of 12 OK created sql view model staging.stg_appointments ..................... [[32mCREATE VIEW[0m in 0.08s]
[0m16:30:14.673194 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_appointments
[0m16:30:14.673504 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_departments
[0m16:30:14.674149 [info ] [Thread-1 (]: 2 of 12 START sql view model staging.stg_departments ........................... [RUN]
[0m16:30:14.674602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_appointments, now model.modelling_handson.stg_departments)
[0m16:30:14.674888 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_departments
[0m16:30:14.677446 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_departments"
[0m16:30:14.677964 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_departments
[0m16:30:14.680433 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_departments"
[0m16:30:14.680935 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m16:30:14.681355 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: BEGIN
[0m16:30:14.681652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:14.687071 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m16:30:14.687698 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m16:30:14.688026 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */

  create view "salesdb"."staging"."stg_departments__dbt_tmp"
    
    
  as (
    select
    id as department_id,
    name as department_name
FROM "salesdb"."public_raw_data"."departments"
  );
[0m16:30:14.689297 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m16:30:14.692584 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m16:30:14.692974 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */
alter table "salesdb"."staging"."stg_departments" rename to "stg_departments__dbt_backup"
[0m16:30:14.693939 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:30:14.696308 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m16:30:14.696789 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */
alter table "salesdb"."staging"."stg_departments__dbt_tmp" rename to "stg_departments"
[0m16:30:14.697575 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:30:14.698723 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: COMMIT
[0m16:30:14.699131 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m16:30:14.699404 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: COMMIT
[0m16:30:14.700513 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:30:14.702452 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_departments__dbt_backup"
[0m16:30:14.703108 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_departments"
[0m16:30:14.703523 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_departments"} */
drop view if exists "salesdb"."staging"."stg_departments__dbt_backup" cascade
[0m16:30:14.705216 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:30:14.706249 [debug] [Thread-1 (]: On model.modelling_handson.stg_departments: Close
[0m16:30:14.706806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07522c35-c08d-4dec-af50-57b9e5c4410f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704932b05010>]}
[0m16:30:14.707327 [info ] [Thread-1 (]: 2 of 12 OK created sql view model staging.stg_departments ...................... [[32mCREATE VIEW[0m in 0.03s]
[0m16:30:14.707765 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_departments
[0m16:30:14.708071 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_doctors
[0m16:30:14.708596 [info ] [Thread-1 (]: 3 of 12 START sql view model staging.stg_doctors ............................... [RUN]
[0m16:30:14.709004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_departments, now model.modelling_handson.stg_doctors)
[0m16:30:14.709286 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_doctors
[0m16:30:14.711494 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_doctors"
[0m16:30:14.711959 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_doctors
[0m16:30:14.714496 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_doctors"
[0m16:30:14.715009 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m16:30:14.715283 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: BEGIN
[0m16:30:14.715537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:14.719752 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:30:14.720394 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m16:30:14.720893 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */

  create view "salesdb"."staging"."stg_doctors__dbt_tmp"
    
    
  as (
    select
    id as doctor_id,
    name,
    specialization,
    department_id
FROM "salesdb"."public_raw_data"."doctors"
  );
[0m16:30:14.723321 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:30:14.727458 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m16:30:14.727860 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */
alter table "salesdb"."staging"."stg_doctors" rename to "stg_doctors__dbt_backup"
[0m16:30:14.728738 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:30:14.731369 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m16:30:14.731702 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */
alter table "salesdb"."staging"."stg_doctors__dbt_tmp" rename to "stg_doctors"
[0m16:30:14.732740 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:30:14.733806 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: COMMIT
[0m16:30:14.734209 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m16:30:14.734516 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: COMMIT
[0m16:30:14.735706 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:30:14.737686 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_doctors__dbt_backup"
[0m16:30:14.738217 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_doctors"
[0m16:30:14.738518 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_doctors"} */
drop view if exists "salesdb"."staging"."stg_doctors__dbt_backup" cascade
[0m16:30:14.740088 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:30:14.741119 [debug] [Thread-1 (]: On model.modelling_handson.stg_doctors: Close
[0m16:30:14.741630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07522c35-c08d-4dec-af50-57b9e5c4410f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704932fbbb90>]}
[0m16:30:14.742126 [info ] [Thread-1 (]: 3 of 12 OK created sql view model staging.stg_doctors .......................... [[32mCREATE VIEW[0m in 0.03s]
[0m16:30:14.742634 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_doctors
[0m16:30:14.742993 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_patients
[0m16:30:14.743354 [info ] [Thread-1 (]: 4 of 12 START sql view model staging.stg_patients .............................. [RUN]
[0m16:30:14.744109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_doctors, now model.modelling_handson.stg_patients)
[0m16:30:14.744481 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_patients
[0m16:30:14.746749 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_patients"
[0m16:30:14.747253 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_patients
[0m16:30:14.749760 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_patients"
[0m16:30:14.750306 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m16:30:14.750620 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: BEGIN
[0m16:30:14.750871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:14.754883 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:30:14.755298 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m16:30:14.755592 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */

  create view "salesdb"."staging"."stg_patients__dbt_tmp"
    
    
  as (
    select
id as patient_id,
name,
gender,
dob,
city
FROM "salesdb"."public_raw_data"."patients"
  );
[0m16:30:14.757506 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:30:14.760393 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m16:30:14.760756 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */
alter table "salesdb"."staging"."stg_patients" rename to "stg_patients__dbt_backup"
[0m16:30:14.761544 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:30:14.764043 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m16:30:14.764535 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */
alter table "salesdb"."staging"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m16:30:14.765580 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:30:14.766843 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: COMMIT
[0m16:30:14.767201 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m16:30:14.767469 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: COMMIT
[0m16:30:14.768523 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:30:14.770284 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_patients__dbt_backup"
[0m16:30:14.770817 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_patients"
[0m16:30:14.771120 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_patients"} */
drop view if exists "salesdb"."staging"."stg_patients__dbt_backup" cascade
[0m16:30:14.772467 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:30:14.773476 [debug] [Thread-1 (]: On model.modelling_handson.stg_patients: Close
[0m16:30:14.773978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07522c35-c08d-4dec-af50-57b9e5c4410f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704932f80950>]}
[0m16:30:14.774485 [info ] [Thread-1 (]: 4 of 12 OK created sql view model staging.stg_patients ......................... [[32mCREATE VIEW[0m in 0.03s]
[0m16:30:14.774980 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_patients
[0m16:30:14.775314 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_treatments
[0m16:30:14.775876 [info ] [Thread-1 (]: 5 of 12 START sql view model staging.stg_treatments ............................ [RUN]
[0m16:30:14.776503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_patients, now model.modelling_handson.stg_treatments)
[0m16:30:14.776942 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_treatments
[0m16:30:14.779072 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_treatments"
[0m16:30:14.779551 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_treatments
[0m16:30:14.781887 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_treatments"
[0m16:30:14.782346 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_treatments"
[0m16:30:14.782688 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: BEGIN
[0m16:30:14.782939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:14.786547 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:30:14.786976 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_treatments"
[0m16:30:14.787260 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_treatments"} */

  create view "salesdb"."staging"."stg_treatments__dbt_tmp"
    
    
  as (
    select
id as treatment_id,
appointment_id,
treatment,
cost
from "salesdb"."public_raw_data"."treatments"
  );
[0m16:30:14.788688 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m16:30:14.791474 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_treatments"
[0m16:30:14.791821 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_treatments"} */
alter table "salesdb"."staging"."stg_treatments" rename to "stg_treatments__dbt_backup"
[0m16:30:14.792723 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:30:14.796493 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_treatments"
[0m16:30:14.796885 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_treatments"} */
alter table "salesdb"."staging"."stg_treatments__dbt_tmp" rename to "stg_treatments"
[0m16:30:14.797773 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:30:14.798872 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: COMMIT
[0m16:30:14.799214 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_treatments"
[0m16:30:14.799506 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: COMMIT
[0m16:30:14.800997 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:30:14.802891 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_treatments__dbt_backup"
[0m16:30:14.803756 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_treatments"
[0m16:30:14.804083 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_treatments"} */
drop view if exists "salesdb"."staging"."stg_treatments__dbt_backup" cascade
[0m16:30:14.805858 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:30:14.807099 [debug] [Thread-1 (]: On model.modelling_handson.stg_treatments: Close
[0m16:30:14.807715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07522c35-c08d-4dec-af50-57b9e5c4410f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7049333a7fd0>]}
[0m16:30:14.808246 [info ] [Thread-1 (]: 5 of 12 OK created sql view model staging.stg_treatments ....................... [[32mCREATE VIEW[0m in 0.03s]
[0m16:30:14.809079 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_treatments
[0m16:30:14.809476 [debug] [Thread-1 (]: Began running node model.modelling_handson.bronze_appointments
[0m16:30:14.809887 [info ] [Thread-1 (]: 6 of 12 START sql view model bronze.bronze_appointments ........................ [RUN]
[0m16:30:14.810922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_treatments, now model.modelling_handson.bronze_appointments)
[0m16:30:14.811575 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.bronze_appointments
[0m16:30:14.815001 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.bronze_appointments"
[0m16:30:14.815749 [debug] [Thread-1 (]: Began executing node model.modelling_handson.bronze_appointments
[0m16:30:14.818342 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.bronze_appointments"
[0m16:30:14.819081 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_appointments"
[0m16:30:14.819386 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: BEGIN
[0m16:30:14.819662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:14.823433 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:30:14.823840 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_appointments"
[0m16:30:14.824151 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.bronze_appointments"} */

  create view "salesdb"."bronze"."bronze_appointments__dbt_tmp"
    
    
  as (
    select * from "salesdb"."staging"."stg_appointments"
  );
[0m16:30:14.825765 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m16:30:14.828879 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_appointments"
[0m16:30:14.829296 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.bronze_appointments"} */
alter table "salesdb"."bronze"."bronze_appointments__dbt_tmp" rename to "bronze_appointments"
[0m16:30:14.830164 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:30:14.831196 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: COMMIT
[0m16:30:14.831715 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_appointments"
[0m16:30:14.832033 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: COMMIT
[0m16:30:14.833509 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:30:14.835546 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."bronze"."bronze_appointments__dbt_backup"
[0m16:30:14.836086 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_appointments"
[0m16:30:14.836403 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.bronze_appointments"} */
drop view if exists "salesdb"."bronze"."bronze_appointments__dbt_backup" cascade
[0m16:30:14.837180 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m16:30:14.838415 [debug] [Thread-1 (]: On model.modelling_handson.bronze_appointments: Close
[0m16:30:14.839005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07522c35-c08d-4dec-af50-57b9e5c4410f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704932bade10>]}
[0m16:30:14.839528 [info ] [Thread-1 (]: 6 of 12 OK created sql view model bronze.bronze_appointments ................... [[32mCREATE VIEW[0m in 0.03s]
[0m16:30:14.839991 [debug] [Thread-1 (]: Finished running node model.modelling_handson.bronze_appointments
[0m16:30:14.840308 [debug] [Thread-1 (]: Began running node model.modelling_handson.dim_doctors
[0m16:30:14.840696 [info ] [Thread-1 (]: 7 of 12 START sql table model marts.dim_doctors ................................ [RUN]
[0m16:30:14.841450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.bronze_appointments, now model.modelling_handson.dim_doctors)
[0m16:30:14.841957 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.dim_doctors
[0m16:30:14.844364 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.dim_doctors"
[0m16:30:14.845620 [debug] [Thread-1 (]: Began executing node model.modelling_handson.dim_doctors
[0m16:30:14.865815 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.dim_doctors"
[0m16:30:14.867790 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m16:30:14.868493 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: BEGIN
[0m16:30:14.869193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:14.877172 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m16:30:14.878097 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m16:30:14.878512 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */

  
    

  create  table "salesdb"."marts"."dim_doctors__dbt_tmp"
  
  
    as
  
  (
    select d.*, dep.department_name
from "salesdb"."staging"."stg_doctors" d
left join "salesdb"."staging"."stg_departments" dep
on d.department_id = dep.department_id
  );
  
[0m16:30:14.885648 [debug] [Thread-1 (]: SQL status: SELECT 50 in 0.007 seconds
[0m16:30:14.895183 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m16:30:14.896021 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */
alter table "salesdb"."marts"."dim_doctors" rename to "dim_doctors__dbt_backup"
[0m16:30:14.897202 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:30:14.900668 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m16:30:14.901264 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */
alter table "salesdb"."marts"."dim_doctors__dbt_tmp" rename to "dim_doctors"
[0m16:30:14.902467 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:30:14.904849 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: COMMIT
[0m16:30:14.905366 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m16:30:14.905685 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: COMMIT
[0m16:30:14.908367 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:30:14.912691 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."marts"."dim_doctors__dbt_backup"
[0m16:30:14.915694 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_doctors"
[0m16:30:14.916133 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_doctors"} */
drop table if exists "salesdb"."marts"."dim_doctors__dbt_backup" cascade
[0m16:30:14.919348 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:30:14.921169 [debug] [Thread-1 (]: On model.modelling_handson.dim_doctors: Close
[0m16:30:14.921910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07522c35-c08d-4dec-af50-57b9e5c4410f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7049348bcad0>]}
[0m16:30:14.922687 [info ] [Thread-1 (]: 7 of 12 OK created sql table model marts.dim_doctors ........................... [[32mSELECT 50[0m in 0.08s]
[0m16:30:14.923222 [debug] [Thread-1 (]: Finished running node model.modelling_handson.dim_doctors
[0m16:30:14.923891 [debug] [Thread-1 (]: Began running node model.modelling_handson.dim_patients
[0m16:30:14.924509 [info ] [Thread-1 (]: 8 of 12 START sql table model marts.dim_patients ............................... [RUN]
[0m16:30:14.925241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.dim_doctors, now model.modelling_handson.dim_patients)
[0m16:30:14.925626 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.dim_patients
[0m16:30:14.928345 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.dim_patients"
[0m16:30:14.929069 [debug] [Thread-1 (]: Began executing node model.modelling_handson.dim_patients
[0m16:30:14.932487 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.dim_patients"
[0m16:30:14.933239 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m16:30:14.933707 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: BEGIN
[0m16:30:14.934137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:14.939431 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m16:30:14.939920 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m16:30:14.940803 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */

  
    

  create  table "salesdb"."marts"."dim_patients__dbt_tmp"
  
  
    as
  
  (
    select patient_id,
name,
gender,
dob,
city,
date_part('year', age(current_date, dob)) as age from "salesdb"."staging"."stg_patients"
  );
  
[0m16:30:14.945251 [debug] [Thread-1 (]: SQL status: SELECT 200 in 0.004 seconds
[0m16:30:14.948176 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m16:30:14.948597 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */
alter table "salesdb"."marts"."dim_patients" rename to "dim_patients__dbt_backup"
[0m16:30:14.949527 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:30:14.952481 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m16:30:14.952903 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */
alter table "salesdb"."marts"."dim_patients__dbt_tmp" rename to "dim_patients"
[0m16:30:14.954035 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:30:14.955688 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: COMMIT
[0m16:30:14.956166 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m16:30:14.956478 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: COMMIT
[0m16:30:14.958254 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:30:14.960530 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."marts"."dim_patients__dbt_backup"
[0m16:30:14.961148 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m16:30:14.961478 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */
drop table if exists "salesdb"."marts"."dim_patients__dbt_backup" cascade
[0m16:30:14.963958 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:30:14.965290 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: Close
[0m16:30:14.965958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07522c35-c08d-4dec-af50-57b9e5c4410f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704933325710>]}
[0m16:30:14.966678 [info ] [Thread-1 (]: 8 of 12 OK created sql table model marts.dim_patients .......................... [[32mSELECT 200[0m in 0.04s]
[0m16:30:14.967246 [debug] [Thread-1 (]: Finished running node model.modelling_handson.dim_patients
[0m16:30:14.967655 [debug] [Thread-1 (]: Began running node model.modelling_handson.bronze_treatments
[0m16:30:14.968379 [info ] [Thread-1 (]: 9 of 12 START sql view model bronze.bronze_treatments .......................... [RUN]
[0m16:30:14.968923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.dim_patients, now model.modelling_handson.bronze_treatments)
[0m16:30:14.969282 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.bronze_treatments
[0m16:30:14.971864 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.bronze_treatments"
[0m16:30:14.972469 [debug] [Thread-1 (]: Began executing node model.modelling_handson.bronze_treatments
[0m16:30:14.975501 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.bronze_treatments"
[0m16:30:14.976199 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_treatments"
[0m16:30:14.976555 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: BEGIN
[0m16:30:14.976845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:14.982223 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m16:30:14.982809 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_treatments"
[0m16:30:14.983260 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.bronze_treatments"} */

  create view "salesdb"."bronze"."bronze_treatments__dbt_tmp"
    
    
  as (
    select * from "salesdb"."staging"."stg_treatments"
  );
[0m16:30:14.986105 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:30:14.989552 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_treatments"
[0m16:30:14.990008 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.bronze_treatments"} */
alter table "salesdb"."bronze"."bronze_treatments__dbt_tmp" rename to "bronze_treatments"
[0m16:30:14.991019 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:30:14.992207 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: COMMIT
[0m16:30:14.992596 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_treatments"
[0m16:30:14.992904 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: COMMIT
[0m16:30:14.994340 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:30:14.996744 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."bronze"."bronze_treatments__dbt_backup"
[0m16:30:14.997553 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.bronze_treatments"
[0m16:30:14.997922 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.bronze_treatments"} */
drop view if exists "salesdb"."bronze"."bronze_treatments__dbt_backup" cascade
[0m16:30:14.998881 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:30:15.000155 [debug] [Thread-1 (]: On model.modelling_handson.bronze_treatments: Close
[0m16:30:15.000736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07522c35-c08d-4dec-af50-57b9e5c4410f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704932fb0950>]}
[0m16:30:15.001309 [info ] [Thread-1 (]: 9 of 12 OK created sql view model bronze.bronze_treatments ..................... [[32mCREATE VIEW[0m in 0.03s]
[0m16:30:15.001862 [debug] [Thread-1 (]: Finished running node model.modelling_handson.bronze_treatments
[0m16:30:15.002237 [debug] [Thread-1 (]: Began running node model.modelling_handson.silver_appointments
[0m16:30:15.002723 [info ] [Thread-1 (]: 10 of 12 START sql table model silver.silver_appointments ...................... [RUN]
[0m16:30:15.003653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.bronze_treatments, now model.modelling_handson.silver_appointments)
[0m16:30:15.004016 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.silver_appointments
[0m16:30:15.006211 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.silver_appointments"
[0m16:30:15.007100 [debug] [Thread-1 (]: Began executing node model.modelling_handson.silver_appointments
[0m16:30:15.012161 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.silver_appointments"
[0m16:30:15.013322 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_appointments"
[0m16:30:15.013717 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: BEGIN
[0m16:30:15.014030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:15.018796 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m16:30:15.019271 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_appointments"
[0m16:30:15.019608 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_appointments"} */

  
    

  create  table "salesdb"."silver"."silver_appointments__dbt_tmp"
  
  
    as
  
  (
    select * from "salesdb"."bronze"."bronze_appointments"
where appointment_date is not null and status != 'cancelled'
  );
  
[0m16:30:15.023611 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.004 seconds
[0m16:30:15.026455 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_appointments"
[0m16:30:15.026887 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_appointments"} */
alter table "salesdb"."silver"."silver_appointments" rename to "silver_appointments__dbt_backup"
[0m16:30:15.027948 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:30:15.030477 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_appointments"
[0m16:30:15.030902 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_appointments"} */
alter table "salesdb"."silver"."silver_appointments__dbt_tmp" rename to "silver_appointments"
[0m16:30:15.031876 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:30:15.032981 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: COMMIT
[0m16:30:15.033352 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_appointments"
[0m16:30:15.033659 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: COMMIT
[0m16:30:15.034959 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:30:15.036899 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."silver"."silver_appointments__dbt_backup"
[0m16:30:15.037402 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_appointments"
[0m16:30:15.037713 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_appointments"} */
drop table if exists "salesdb"."silver"."silver_appointments__dbt_backup" cascade
[0m16:30:15.039446 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m16:30:15.040696 [debug] [Thread-1 (]: On model.modelling_handson.silver_appointments: Close
[0m16:30:15.041242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07522c35-c08d-4dec-af50-57b9e5c4410f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704933faac50>]}
[0m16:30:15.041837 [info ] [Thread-1 (]: 10 of 12 OK created sql table model silver.silver_appointments ................. [[32mSELECT 1000[0m in 0.04s]
[0m16:30:15.042330 [debug] [Thread-1 (]: Finished running node model.modelling_handson.silver_appointments
[0m16:30:15.042784 [debug] [Thread-1 (]: Began running node model.modelling_handson.silver_treatments
[0m16:30:15.043215 [info ] [Thread-1 (]: 11 of 12 START sql table model silver.silver_treatments ........................ [RUN]
[0m16:30:15.043835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.silver_appointments, now model.modelling_handson.silver_treatments)
[0m16:30:15.044224 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.silver_treatments
[0m16:30:15.046648 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.silver_treatments"
[0m16:30:15.047202 [debug] [Thread-1 (]: Began executing node model.modelling_handson.silver_treatments
[0m16:30:15.049958 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.silver_treatments"
[0m16:30:15.050534 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_treatments"
[0m16:30:15.050894 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: BEGIN
[0m16:30:15.051186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:15.055048 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:30:15.055521 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_treatments"
[0m16:30:15.055832 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_treatments"} */

  
    

  create  table "salesdb"."silver"."silver_treatments__dbt_tmp"
  
  
    as
  
  (
    select * from "salesdb"."bronze"."bronze_treatments"
where cost > 0
  );
  
[0m16:30:15.060086 [debug] [Thread-1 (]: SQL status: SELECT 800 in 0.004 seconds
[0m16:30:15.063824 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_treatments"
[0m16:30:15.064351 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_treatments"} */
alter table "salesdb"."silver"."silver_treatments" rename to "silver_treatments__dbt_backup"
[0m16:30:15.065777 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:30:15.068578 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_treatments"
[0m16:30:15.068961 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_treatments"} */
alter table "salesdb"."silver"."silver_treatments__dbt_tmp" rename to "silver_treatments"
[0m16:30:15.069885 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:30:15.071152 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: COMMIT
[0m16:30:15.071544 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_treatments"
[0m16:30:15.071844 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: COMMIT
[0m16:30:15.073142 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:30:15.075204 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."silver"."silver_treatments__dbt_backup"
[0m16:30:15.075865 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.silver_treatments"
[0m16:30:15.076184 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.silver_treatments"} */
drop table if exists "salesdb"."silver"."silver_treatments__dbt_backup" cascade
[0m16:30:15.077984 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m16:30:15.079204 [debug] [Thread-1 (]: On model.modelling_handson.silver_treatments: Close
[0m16:30:15.079739 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07522c35-c08d-4dec-af50-57b9e5c4410f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704933f980d0>]}
[0m16:30:15.080412 [info ] [Thread-1 (]: 11 of 12 OK created sql table model silver.silver_treatments ................... [[32mSELECT 800[0m in 0.04s]
[0m16:30:15.080905 [debug] [Thread-1 (]: Finished running node model.modelling_handson.silver_treatments
[0m16:30:15.081887 [debug] [Thread-1 (]: Began running node model.modelling_handson.gold_daily_metrics
[0m16:30:15.082332 [info ] [Thread-1 (]: 12 of 12 START sql table model gold.gold_daily_metrics ......................... [RUN]
[0m16:30:15.082802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.silver_treatments, now model.modelling_handson.gold_daily_metrics)
[0m16:30:15.083116 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.gold_daily_metrics
[0m16:30:15.085421 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.gold_daily_metrics"
[0m16:30:15.086146 [debug] [Thread-1 (]: Began executing node model.modelling_handson.gold_daily_metrics
[0m16:30:15.090239 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.gold_daily_metrics"
[0m16:30:15.091073 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.gold_daily_metrics"
[0m16:30:15.091426 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: BEGIN
[0m16:30:15.091696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:15.095633 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:30:15.096104 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.gold_daily_metrics"
[0m16:30:15.096578 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.gold_daily_metrics"} */

  
    

  create  table "salesdb"."gold"."gold_daily_metrics__dbt_tmp"
  
  
    as
  
  (
    select
a.appointment_date,
count(distinct a.appointment_id) as total_appointments,
count(distinct t.treatment_id) as total_treatments,
sum(t.cost) as revenue
from "salesdb"."silver"."silver_appointments" a
left join "salesdb"."silver"."silver_treatments" t
on a.appointment_id = t.appointment_id
group by a.appointment_date
  );
  
[0m16:30:15.100378 [debug] [Thread-1 (]: SQL status: SELECT 349 in 0.003 seconds
[0m16:30:15.103744 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.gold_daily_metrics"
[0m16:30:15.104266 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.gold_daily_metrics"} */
alter table "salesdb"."gold"."gold_daily_metrics" rename to "gold_daily_metrics__dbt_backup"
[0m16:30:15.105237 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:30:15.107735 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.gold_daily_metrics"
[0m16:30:15.108107 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.gold_daily_metrics"} */
alter table "salesdb"."gold"."gold_daily_metrics__dbt_tmp" rename to "gold_daily_metrics"
[0m16:30:15.108931 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:30:15.110024 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: COMMIT
[0m16:30:15.110373 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.gold_daily_metrics"
[0m16:30:15.110724 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: COMMIT
[0m16:30:15.112153 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:30:15.114048 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."gold"."gold_daily_metrics__dbt_backup"
[0m16:30:15.114631 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.gold_daily_metrics"
[0m16:30:15.115052 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.gold_daily_metrics"} */
drop table if exists "salesdb"."gold"."gold_daily_metrics__dbt_backup" cascade
[0m16:30:15.117224 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:30:15.118538 [debug] [Thread-1 (]: On model.modelling_handson.gold_daily_metrics: Close
[0m16:30:15.119196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07522c35-c08d-4dec-af50-57b9e5c4410f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704916113d90>]}
[0m16:30:15.119766 [info ] [Thread-1 (]: 12 of 12 OK created sql table model gold.gold_daily_metrics .................... [[32mSELECT 349[0m in 0.04s]
[0m16:30:15.120245 [debug] [Thread-1 (]: Finished running node model.modelling_handson.gold_daily_metrics
[0m16:30:15.122067 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:15.122417 [debug] [MainThread]: On master: BEGIN
[0m16:30:15.122762 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:30:15.127671 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m16:30:15.128551 [debug] [MainThread]: On master: COMMIT
[0m16:30:15.129145 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:15.129667 [debug] [MainThread]: On master: COMMIT
[0m16:30:15.130861 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:30:15.131543 [debug] [MainThread]: On master: Close
[0m16:30:15.132392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:30:15.132912 [debug] [MainThread]: Connection 'model.modelling_handson.gold_daily_metrics' was properly closed.
[0m16:30:15.133643 [info ] [MainThread]: 
[0m16:30:15.134304 [info ] [MainThread]: Finished running 5 table models, 7 view models in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m16:30:15.138161 [debug] [MainThread]: Command end result
[0m16:30:15.161829 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m16:30:15.163582 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m16:30:15.169070 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m16:30:15.169448 [info ] [MainThread]: 
[0m16:30:15.169813 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:30:15.170311 [info ] [MainThread]: 
[0m16:30:15.170680 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m16:30:15.171186 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:30:15.172028 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2816844, "process_in_blocks": "8", "process_kernel_time": 0.247467, "process_mem_max_rss": "133184", "process_out_blocks": "3224", "process_user_time": 3.154162}
[0m16:30:15.172559 [debug] [MainThread]: Command `dbt run` succeeded at 16:30:15.172354 after 2.28 seconds
[0m16:30:15.173093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704938eb8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704938eb8790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70491604fe90>]}
[0m16:30:15.173431 [debug] [MainThread]: Flushing usage events
[0m16:30:16.674539 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:30:21.445505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a80ffb4fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a80ffb4f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a80ffb4de90>]}


============================== 16:30:21.448120 | e9ad5e4f-812d-41ea-80e1-1e3511e42829 ==============================
[0m16:30:21.448120 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:30:21.448637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/subhan/.dbt', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:30:21.490148 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 50, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m16:30:21.490663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e9ad5e4f-812d-41ea-80e1-1e3511e42829', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a80ffbd8bd0>]}
[0m16:30:21.576353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9ad5e4f-812d-41ea-80e1-1e3511e42829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a80ffb7e3d0>]}
[0m16:30:21.626663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9ad5e4f-812d-41ea-80e1-1e3511e42829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a80ff1ef290>]}
[0m16:30:21.627373 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:30:21.677702 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:30:21.781335 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:30:21.781696 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:30:21.826901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9ad5e4f-812d-41ea-80e1-1e3511e42829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a80fe94c710>]}
[0m16:30:21.904837 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m16:30:21.906150 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m16:30:21.922664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9ad5e4f-812d-41ea-80e1-1e3511e42829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a80fd907fd0>]}
[0m16:30:21.923105 [info ] [MainThread]: Found 13 models, 5 data tests, 6 seeds, 5 sources, 435 macros
[0m16:30:21.923382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9ad5e4f-812d-41ea-80e1-1e3511e42829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a80ff5c6910>]}
[0m16:30:21.925008 [info ] [MainThread]: 
[0m16:30:21.925381 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:30:21.925625 [info ] [MainThread]: 
[0m16:30:21.926045 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:30:21.929858 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb_marts'
[0m16:30:21.992152 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m16:30:21.992585 [debug] [ThreadPool]: On list_salesdb_marts: BEGIN
[0m16:30:21.992853 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:30:21.997305 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m16:30:21.997656 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m16:30:21.997902 [debug] [ThreadPool]: On list_salesdb_marts: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_marts"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m16:30:22.000368 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m16:30:22.001436 [debug] [ThreadPool]: On list_salesdb_marts: ROLLBACK
[0m16:30:22.002048 [debug] [ThreadPool]: On list_salesdb_marts: Close
[0m16:30:22.002581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_marts, now list_salesdb_gold)
[0m16:30:22.004549 [debug] [ThreadPool]: Using postgres connection "list_salesdb_gold"
[0m16:30:22.004832 [debug] [ThreadPool]: On list_salesdb_gold: BEGIN
[0m16:30:22.005036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:30:22.008079 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:30:22.008377 [debug] [ThreadPool]: Using postgres connection "list_salesdb_gold"
[0m16:30:22.008642 [debug] [ThreadPool]: On list_salesdb_gold: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_gold"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m16:30:22.010532 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m16:30:22.011440 [debug] [ThreadPool]: On list_salesdb_gold: ROLLBACK
[0m16:30:22.011984 [debug] [ThreadPool]: On list_salesdb_gold: Close
[0m16:30:22.012511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_gold, now list_salesdb_public_raw_data)
[0m16:30:22.014088 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m16:30:22.014365 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m16:30:22.014567 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:30:22.017466 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:30:22.017744 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m16:30:22.017975 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m16:30:22.019968 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.002 seconds
[0m16:30:22.020990 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m16:30:22.021494 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m16:30:22.021976 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now list_salesdb_staging)
[0m16:30:22.023321 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m16:30:22.024607 [debug] [ThreadPool]: On list_salesdb_staging: BEGIN
[0m16:30:22.024847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:30:22.027966 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:30:22.028252 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m16:30:22.028521 [debug] [ThreadPool]: On list_salesdb_staging: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_staging"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m16:30:22.030410 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m16:30:22.031328 [debug] [ThreadPool]: On list_salesdb_staging: ROLLBACK
[0m16:30:22.031864 [debug] [ThreadPool]: On list_salesdb_staging: Close
[0m16:30:22.032341 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_staging, now list_salesdb_bronze)
[0m16:30:22.034282 [debug] [ThreadPool]: Using postgres connection "list_salesdb_bronze"
[0m16:30:22.034556 [debug] [ThreadPool]: On list_salesdb_bronze: BEGIN
[0m16:30:22.034752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:30:22.038335 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m16:30:22.038657 [debug] [ThreadPool]: Using postgres connection "list_salesdb_bronze"
[0m16:30:22.038893 [debug] [ThreadPool]: On list_salesdb_bronze: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_bronze"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m16:30:22.040871 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m16:30:22.041817 [debug] [ThreadPool]: On list_salesdb_bronze: ROLLBACK
[0m16:30:22.042352 [debug] [ThreadPool]: On list_salesdb_bronze: Close
[0m16:30:22.042888 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_bronze, now list_salesdb_silver)
[0m16:30:22.044763 [debug] [ThreadPool]: Using postgres connection "list_salesdb_silver"
[0m16:30:22.045041 [debug] [ThreadPool]: On list_salesdb_silver: BEGIN
[0m16:30:22.045286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:30:22.048784 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:30:22.049083 [debug] [ThreadPool]: Using postgres connection "list_salesdb_silver"
[0m16:30:22.049310 [debug] [ThreadPool]: On list_salesdb_silver: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_silver"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m16:30:22.051207 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m16:30:22.052135 [debug] [ThreadPool]: On list_salesdb_silver: ROLLBACK
[0m16:30:22.052659 [debug] [ThreadPool]: On list_salesdb_silver: Close
[0m16:30:22.057003 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:22.057358 [debug] [MainThread]: On master: BEGIN
[0m16:30:22.057572 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:30:22.060848 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m16:30:22.061176 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:22.061444 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:30:22.078481 [debug] [MainThread]: SQL status: SELECT 13 in 0.017 seconds
[0m16:30:22.081157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9ad5e4f-812d-41ea-80e1-1e3511e42829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a80ff5fb250>]}
[0m16:30:22.081520 [debug] [MainThread]: On master: ROLLBACK
[0m16:30:22.082132 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:22.082405 [debug] [MainThread]: On master: BEGIN
[0m16:30:22.083222 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:30:22.083600 [debug] [MainThread]: On master: COMMIT
[0m16:30:22.083828 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:22.084021 [debug] [MainThread]: On master: COMMIT
[0m16:30:22.084524 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:30:22.084795 [debug] [MainThread]: On master: Close
[0m16:30:22.087019 [debug] [Thread-1 (]: Began running node test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33
[0m16:30:22.087339 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_dim_patients_gender__Male__Female__Other ..... [RUN]
[0m16:30:22.087685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_silver, now test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33)
[0m16:30:22.087940 [debug] [Thread-1 (]: Began compiling node test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33
[0m16:30:22.100069 [debug] [Thread-1 (]: Writing injected SQL for node "test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33"
[0m16:30:22.101367 [debug] [Thread-1 (]: Began executing node test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33
[0m16:30:22.118454 [debug] [Thread-1 (]: Writing runtime sql for node "test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33"
[0m16:30:22.120448 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33"
[0m16:30:22.121073 [debug] [Thread-1 (]: On test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33: BEGIN
[0m16:30:22.121466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:22.125379 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:30:22.125736 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33"
[0m16:30:22.126017 [debug] [Thread-1 (]: On test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        gender as value_field,
        count(*) as n_records

    from "salesdb"."marts"."dim_patients"
    group by gender

)

select *
from all_values
where value_field not in (
    'Male','Female','Other'
)



  
  
      
    ) dbt_internal_test
[0m16:30:22.127272 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:30:22.130437 [debug] [Thread-1 (]: On test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33: ROLLBACK
[0m16:30:22.131157 [debug] [Thread-1 (]: On test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33: Close
[0m16:30:22.131736 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_dim_patients_gender__Male__Female__Other ........... [[32mPASS[0m in 0.04s]
[0m16:30:22.132180 [debug] [Thread-1 (]: Finished running node test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33
[0m16:30:22.132504 [debug] [Thread-1 (]: Began running node test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7
[0m16:30:22.132796 [info ] [Thread-1 (]: 2 of 5 START test not_null_dim_patients_patient_id ............................. [RUN]
[0m16:30:22.133377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33, now test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7)
[0m16:30:22.133709 [debug] [Thread-1 (]: Began compiling node test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7
[0m16:30:22.138475 [debug] [Thread-1 (]: Writing injected SQL for node "test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7"
[0m16:30:22.138949 [debug] [Thread-1 (]: Began executing node test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7
[0m16:30:22.140669 [debug] [Thread-1 (]: Writing runtime sql for node "test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7"
[0m16:30:22.141109 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7"
[0m16:30:22.141382 [debug] [Thread-1 (]: On test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7: BEGIN
[0m16:30:22.141614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:22.145475 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:30:22.145854 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7"
[0m16:30:22.146127 [debug] [Thread-1 (]: On test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "salesdb"."marts"."dim_patients"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m16:30:22.147155 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:30:22.148535 [debug] [Thread-1 (]: On test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7: ROLLBACK
[0m16:30:22.149150 [debug] [Thread-1 (]: On test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7: Close
[0m16:30:22.149674 [info ] [Thread-1 (]: 2 of 5 PASS not_null_dim_patients_patient_id ................................... [[32mPASS[0m in 0.02s]
[0m16:30:22.150111 [debug] [Thread-1 (]: Finished running node test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7
[0m16:30:22.150418 [debug] [Thread-1 (]: Began running node test.modelling_handson.test_ages
[0m16:30:22.150843 [info ] [Thread-1 (]: 3 of 5 START test test_ages .................................................... [RUN]
[0m16:30:22.151267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7, now test.modelling_handson.test_ages)
[0m16:30:22.151547 [debug] [Thread-1 (]: Began compiling node test.modelling_handson.test_ages
[0m16:30:22.153547 [debug] [Thread-1 (]: Writing injected SQL for node "test.modelling_handson.test_ages"
[0m16:30:22.154177 [debug] [Thread-1 (]: Began executing node test.modelling_handson.test_ages
[0m16:30:22.155984 [debug] [Thread-1 (]: Writing runtime sql for node "test.modelling_handson.test_ages"
[0m16:30:22.157051 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.test_ages"
[0m16:30:22.157537 [debug] [Thread-1 (]: On test.modelling_handson.test_ages: BEGIN
[0m16:30:22.157815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:22.163125 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m16:30:22.163823 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.test_ages"
[0m16:30:22.164388 [debug] [Thread-1 (]: On test.modelling_handson.test_ages: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "test.modelling_handson.test_ages"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select *
from "salesdb"."marts"."dim_patients"
where age < 0
  
  
      
    ) dbt_internal_test
[0m16:30:22.166536 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:30:22.168010 [debug] [Thread-1 (]: On test.modelling_handson.test_ages: ROLLBACK
[0m16:30:22.168714 [debug] [Thread-1 (]: On test.modelling_handson.test_ages: Close
[0m16:30:22.169285 [info ] [Thread-1 (]: 3 of 5 PASS test_ages .......................................................... [[32mPASS[0m in 0.02s]
[0m16:30:22.169735 [debug] [Thread-1 (]: Finished running node test.modelling_handson.test_ages
[0m16:30:22.170049 [debug] [Thread-1 (]: Began running node test.modelling_handson.test_ages_dim_patients_.2b960afd7a
[0m16:30:22.170508 [info ] [Thread-1 (]: 4 of 5 START test test_ages_dim_patients_ ...................................... [RUN]
[0m16:30:22.170927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.modelling_handson.test_ages, now test.modelling_handson.test_ages_dim_patients_.2b960afd7a)
[0m16:30:22.171209 [debug] [Thread-1 (]: Began compiling node test.modelling_handson.test_ages_dim_patients_.2b960afd7a
[0m16:30:22.176668 [debug] [Thread-1 (]: Compilation Error in test test_ages_dim_patients_ (models/marts/schema.yml)
  'test_test_ages' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:30:22.177230 [error] [Thread-1 (]: 4 of 5 ERROR test_ages_dim_patients_ ........................................... [[31mERROR[0m in 0.01s]
[0m16:30:22.177780 [debug] [Thread-1 (]: Finished running node test.modelling_handson.test_ages_dim_patients_.2b960afd7a
[0m16:30:22.178118 [debug] [Thread-1 (]: Began running node test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2
[0m16:30:22.178529 [debug] [Thread-4 (]: Marking all children of 'test.modelling_handson.test_ages_dim_patients_.2b960afd7a' to be skipped because of status 'error'.  Reason: Compilation Error in test test_ages_dim_patients_ (models/marts/schema.yml)
  'test_test_ages' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m16:30:22.178899 [info ] [Thread-1 (]: 5 of 5 START test unique_dim_patients_patient_id ............................... [RUN]
[0m16:30:22.179986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.modelling_handson.test_ages_dim_patients_.2b960afd7a, now test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2)
[0m16:30:22.180314 [debug] [Thread-1 (]: Began compiling node test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2
[0m16:30:22.185280 [debug] [Thread-1 (]: Writing injected SQL for node "test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2"
[0m16:30:22.185871 [debug] [Thread-1 (]: Began executing node test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2
[0m16:30:22.187697 [debug] [Thread-1 (]: Writing runtime sql for node "test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2"
[0m16:30:22.188423 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2"
[0m16:30:22.188771 [debug] [Thread-1 (]: On test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2: BEGIN
[0m16:30:22.189021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:22.192423 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m16:30:22.192830 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2"
[0m16:30:22.193115 [debug] [Thread-1 (]: On test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "salesdb"."marts"."dim_patients"
where patient_id is not null
group by patient_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:30:22.194424 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:30:22.195641 [debug] [Thread-1 (]: On test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2: ROLLBACK
[0m16:30:22.196328 [debug] [Thread-1 (]: On test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2: Close
[0m16:30:22.196940 [info ] [Thread-1 (]: 5 of 5 PASS unique_dim_patients_patient_id ..................................... [[32mPASS[0m in 0.02s]
[0m16:30:22.197388 [debug] [Thread-1 (]: Finished running node test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2
[0m16:30:22.198733 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:22.199018 [debug] [MainThread]: On master: BEGIN
[0m16:30:22.199240 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:30:22.202926 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m16:30:22.203256 [debug] [MainThread]: On master: COMMIT
[0m16:30:22.203507 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:22.203721 [debug] [MainThread]: On master: COMMIT
[0m16:30:22.204374 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:30:22.204717 [debug] [MainThread]: On master: Close
[0m16:30:22.205096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:30:22.205357 [debug] [MainThread]: Connection 'test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2' was properly closed.
[0m16:30:22.205645 [info ] [MainThread]: 
[0m16:30:22.205981 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m16:30:22.206806 [debug] [MainThread]: Command end result
[0m16:30:22.225583 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m16:30:22.227149 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m16:30:22.233527 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m16:30:22.233888 [info ] [MainThread]: 
[0m16:30:22.234211 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:30:22.234483 [info ] [MainThread]: 
[0m16:30:22.234822 [error] [MainThread]: [31mFailure in test test_ages_dim_patients_ (models/marts/schema.yml)[0m
[0m16:30:22.235111 [error] [MainThread]:   Compilation Error in test test_ages_dim_patients_ (models/marts/schema.yml)
  'test_test_ages' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:30:22.235356 [info ] [MainThread]: 
[0m16:30:22.235614 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m16:30:22.236017 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:30:22.236870 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.8398956, "process_in_blocks": "0", "process_kernel_time": 0.255592, "process_mem_max_rss": "125248", "process_out_blocks": "2088", "process_user_time": 1.780767}
[0m16:30:22.237306 [debug] [MainThread]: Command `dbt test` failed at 16:30:22.237223 after 0.84 seconds
[0m16:30:22.237614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8100be6490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a81041bcdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8100b1bfd0>]}
[0m16:30:22.237918 [debug] [MainThread]: Flushing usage events
[0m16:30:23.279823 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:31:03.193522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74abf6a54650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74abf6a4d210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74abf6a54090>]}


============================== 16:31:03.195838 | 779869b6-3f91-4c3b-905e-648886b0b009 ==============================
[0m16:31:03.195838 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:31:03.196259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/subhan/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_patients', 'send_anonymous_usage_stats': 'True'}
[0m16:31:03.233820 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 50, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m16:31:03.234313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '779869b6-3f91-4c3b-905e-648886b0b009', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74abf6e0cc50>]}
[0m16:31:03.329512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '779869b6-3f91-4c3b-905e-648886b0b009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74abf61a7790>]}
[0m16:31:03.376070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '779869b6-3f91-4c3b-905e-648886b0b009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74abf96a95d0>]}
[0m16:31:03.376738 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:31:03.424953 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:31:03.536704 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:31:03.537096 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:31:03.588168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '779869b6-3f91-4c3b-905e-648886b0b009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74abf5599950>]}
[0m16:31:03.666617 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m16:31:03.667991 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m16:31:03.676735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '779869b6-3f91-4c3b-905e-648886b0b009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74abf5949d50>]}
[0m16:31:03.677166 [info ] [MainThread]: Found 13 models, 5 data tests, 6 seeds, 5 sources, 435 macros
[0m16:31:03.677438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '779869b6-3f91-4c3b-905e-648886b0b009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74abf592ecd0>]}
[0m16:31:03.678537 [info ] [MainThread]: 
[0m16:31:03.678849 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:31:03.679090 [info ] [MainThread]: 
[0m16:31:03.679459 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:31:03.680270 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb'
[0m16:31:03.706426 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m16:31:03.706887 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m16:31:03.707177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:03.712322 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.005 seconds
[0m16:31:03.713515 [debug] [ThreadPool]: On list_salesdb: Close
[0m16:31:03.717890 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb, now list_salesdb_silver)
[0m16:31:03.722291 [debug] [ThreadPool]: Using postgres connection "list_salesdb_silver"
[0m16:31:03.722664 [debug] [ThreadPool]: On list_salesdb_silver: BEGIN
[0m16:31:03.722901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:03.726196 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:31:03.726510 [debug] [ThreadPool]: Using postgres connection "list_salesdb_silver"
[0m16:31:03.726738 [debug] [ThreadPool]: On list_salesdb_silver: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_silver"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m16:31:03.728746 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m16:31:03.729714 [debug] [ThreadPool]: On list_salesdb_silver: ROLLBACK
[0m16:31:03.730212 [debug] [ThreadPool]: On list_salesdb_silver: Close
[0m16:31:03.730740 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_silver, now list_salesdb_marts)
[0m16:31:03.733267 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m16:31:03.733569 [debug] [ThreadPool]: On list_salesdb_marts: BEGIN
[0m16:31:03.733781 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:03.737052 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:31:03.737348 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m16:31:03.737584 [debug] [ThreadPool]: On list_salesdb_marts: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_marts"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m16:31:03.739620 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m16:31:03.740570 [debug] [ThreadPool]: On list_salesdb_marts: ROLLBACK
[0m16:31:03.741079 [debug] [ThreadPool]: On list_salesdb_marts: Close
[0m16:31:03.741625 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_marts, now list_salesdb_public_raw_data)
[0m16:31:03.784056 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m16:31:03.784435 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m16:31:03.784668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:03.788189 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:31:03.788526 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m16:31:03.788768 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m16:31:03.790761 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.002 seconds
[0m16:31:03.792038 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m16:31:03.792653 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m16:31:03.793238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now list_salesdb_gold)
[0m16:31:03.794730 [debug] [ThreadPool]: Using postgres connection "list_salesdb_gold"
[0m16:31:03.796064 [debug] [ThreadPool]: On list_salesdb_gold: BEGIN
[0m16:31:03.796347 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:03.799554 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:31:03.799888 [debug] [ThreadPool]: Using postgres connection "list_salesdb_gold"
[0m16:31:03.800136 [debug] [ThreadPool]: On list_salesdb_gold: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_gold"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m16:31:03.802036 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m16:31:03.803171 [debug] [ThreadPool]: On list_salesdb_gold: ROLLBACK
[0m16:31:03.803753 [debug] [ThreadPool]: On list_salesdb_gold: Close
[0m16:31:03.804283 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_gold, now list_salesdb_bronze)
[0m16:31:03.805701 [debug] [ThreadPool]: Using postgres connection "list_salesdb_bronze"
[0m16:31:03.806317 [debug] [ThreadPool]: On list_salesdb_bronze: BEGIN
[0m16:31:03.806619 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:03.809984 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:31:03.810300 [debug] [ThreadPool]: Using postgres connection "list_salesdb_bronze"
[0m16:31:03.810550 [debug] [ThreadPool]: On list_salesdb_bronze: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_bronze"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m16:31:03.812548 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m16:31:03.813647 [debug] [ThreadPool]: On list_salesdb_bronze: ROLLBACK
[0m16:31:03.814298 [debug] [ThreadPool]: On list_salesdb_bronze: Close
[0m16:31:03.814832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_bronze, now list_salesdb_staging)
[0m16:31:03.816317 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m16:31:03.817249 [debug] [ThreadPool]: On list_salesdb_staging: BEGIN
[0m16:31:03.817544 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:03.820890 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:31:03.821246 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m16:31:03.821483 [debug] [ThreadPool]: On list_salesdb_staging: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_staging"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m16:31:03.824395 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m16:31:03.825480 [debug] [ThreadPool]: On list_salesdb_staging: ROLLBACK
[0m16:31:03.826154 [debug] [ThreadPool]: On list_salesdb_staging: Close
[0m16:31:03.831503 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:03.831866 [debug] [MainThread]: On master: BEGIN
[0m16:31:03.832116 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:31:03.835788 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m16:31:03.836140 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:03.836416 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:31:03.851978 [debug] [MainThread]: SQL status: SELECT 13 in 0.015 seconds
[0m16:31:03.855228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '779869b6-3f91-4c3b-905e-648886b0b009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74abf3c97950>]}
[0m16:31:03.855702 [debug] [MainThread]: On master: ROLLBACK
[0m16:31:03.856331 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:03.856590 [debug] [MainThread]: On master: BEGIN
[0m16:31:03.857235 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:31:03.857532 [debug] [MainThread]: On master: COMMIT
[0m16:31:03.857754 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:03.857967 [debug] [MainThread]: On master: COMMIT
[0m16:31:03.858445 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:31:03.858715 [debug] [MainThread]: On master: Close
[0m16:31:03.861134 [debug] [Thread-1 (]: Began running node model.modelling_handson.dim_patients
[0m16:31:03.861611 [info ] [Thread-1 (]: 1 of 1 START sql table model marts.dim_patients ................................ [RUN]
[0m16:31:03.862025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_staging, now model.modelling_handson.dim_patients)
[0m16:31:03.862328 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.dim_patients
[0m16:31:03.867862 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.dim_patients"
[0m16:31:03.868411 [debug] [Thread-1 (]: Began executing node model.modelling_handson.dim_patients
[0m16:31:03.896337 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.dim_patients"
[0m16:31:03.897045 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m16:31:03.897431 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: BEGIN
[0m16:31:03.897691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:03.901957 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:31:03.902404 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m16:31:03.902681 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */

  
    

  create  table "salesdb"."marts"."dim_patients__dbt_tmp"
  
  
    as
  
  (
    select patient_id,
name,
gender,
dob,
city,
date_part('year', age(current_date, dob)) as age from "salesdb"."staging"."stg_patients"
  );
  
[0m16:31:03.906007 [debug] [Thread-1 (]: SQL status: SELECT 200 in 0.003 seconds
[0m16:31:03.913443 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m16:31:03.913840 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */
alter table "salesdb"."marts"."dim_patients" rename to "dim_patients__dbt_backup"
[0m16:31:03.914690 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:31:03.918086 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m16:31:03.918450 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */
alter table "salesdb"."marts"."dim_patients__dbt_tmp" rename to "dim_patients"
[0m16:31:03.919234 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:31:03.931070 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: COMMIT
[0m16:31:03.931619 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m16:31:03.931917 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: COMMIT
[0m16:31:03.933196 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:31:03.938120 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."marts"."dim_patients__dbt_backup"
[0m16:31:03.943292 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.dim_patients"
[0m16:31:03.943778 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.dim_patients"} */
drop table if exists "salesdb"."marts"."dim_patients__dbt_backup" cascade
[0m16:31:03.945602 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m16:31:03.947797 [debug] [Thread-1 (]: On model.modelling_handson.dim_patients: Close
[0m16:31:03.949321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '779869b6-3f91-4c3b-905e-648886b0b009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74abf3c09590>]}
[0m16:31:03.949859 [info ] [Thread-1 (]: 1 of 1 OK created sql table model marts.dim_patients ........................... [[32mSELECT 200[0m in 0.09s]
[0m16:31:03.950314 [debug] [Thread-1 (]: Finished running node model.modelling_handson.dim_patients
[0m16:31:03.952074 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:03.952496 [debug] [MainThread]: On master: BEGIN
[0m16:31:03.952779 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:31:03.957156 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m16:31:03.957551 [debug] [MainThread]: On master: COMMIT
[0m16:31:03.957811 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:03.958017 [debug] [MainThread]: On master: COMMIT
[0m16:31:03.958525 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:31:03.958880 [debug] [MainThread]: On master: Close
[0m16:31:03.959462 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:03.959746 [debug] [MainThread]: Connection 'model.modelling_handson.dim_patients' was properly closed.
[0m16:31:03.960014 [info ] [MainThread]: 
[0m16:31:03.960319 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m16:31:03.960916 [debug] [MainThread]: Command end result
[0m16:31:03.981534 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m16:31:03.983224 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m16:31:03.988078 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m16:31:03.988381 [info ] [MainThread]: 
[0m16:31:03.988729 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:31:03.988989 [info ] [MainThread]: 
[0m16:31:03.989249 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:31:03.989688 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:31:03.990491 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.838987, "process_in_blocks": "0", "process_kernel_time": 0.218811, "process_mem_max_rss": "122772", "process_out_blocks": "2016", "process_user_time": 1.767651}
[0m16:31:03.990861 [debug] [MainThread]: Command `dbt run` succeeded at 16:31:03.990790 after 0.84 seconds
[0m16:31:03.991206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74abfb0b9150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74abfb0b9290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74abfb0b9610>]}
[0m16:31:03.991490 [debug] [MainThread]: Flushing usage events
[0m16:31:05.010151 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:31:17.935948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788d2caf96d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788d2cc64610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788d2cd6f490>]}


============================== 16:31:17.940085 | 8d94ea32-2141-425f-a60d-fd40687f0adc ==============================
[0m16:31:17.940085 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:31:17.940538 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/subhan/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select test_ages', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:31:17.999910 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 50, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m16:31:18.000371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8d94ea32-2141-425f-a60d-fd40687f0adc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788d2cb2df10>]}
[0m16:31:18.090910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d94ea32-2141-425f-a60d-fd40687f0adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788d2c5e3890>]}
[0m16:31:18.137602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d94ea32-2141-425f-a60d-fd40687f0adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788d2f739ed0>]}
[0m16:31:18.138577 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:31:18.195131 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:31:18.340792 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:31:18.341146 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:31:18.390077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d94ea32-2141-425f-a60d-fd40687f0adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788d2b5a8690>]}
[0m16:31:18.472804 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m16:31:18.474710 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m16:31:18.507105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d94ea32-2141-425f-a60d-fd40687f0adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788d2a912d10>]}
[0m16:31:18.507604 [info ] [MainThread]: Found 13 models, 5 data tests, 6 seeds, 5 sources, 435 macros
[0m16:31:18.507895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d94ea32-2141-425f-a60d-fd40687f0adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788d2cafb0d0>]}
[0m16:31:18.509252 [info ] [MainThread]: 
[0m16:31:18.509655 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:31:18.509905 [info ] [MainThread]: 
[0m16:31:18.510301 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:31:18.514451 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb_public_raw_data'
[0m16:31:18.587601 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m16:31:18.587989 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m16:31:18.588219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:18.600300 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m16:31:18.600694 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m16:31:18.600980 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m16:31:18.603292 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.002 seconds
[0m16:31:18.604554 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m16:31:18.605301 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m16:31:18.605948 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now list_salesdb_bronze)
[0m16:31:18.608990 [debug] [ThreadPool]: Using postgres connection "list_salesdb_bronze"
[0m16:31:18.609315 [debug] [ThreadPool]: On list_salesdb_bronze: BEGIN
[0m16:31:18.609531 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:18.613199 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m16:31:18.613548 [debug] [ThreadPool]: Using postgres connection "list_salesdb_bronze"
[0m16:31:18.613800 [debug] [ThreadPool]: On list_salesdb_bronze: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_bronze"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m16:31:18.616618 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m16:31:18.617811 [debug] [ThreadPool]: On list_salesdb_bronze: ROLLBACK
[0m16:31:18.618499 [debug] [ThreadPool]: On list_salesdb_bronze: Close
[0m16:31:18.619124 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_bronze, now list_salesdb_staging)
[0m16:31:18.621170 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m16:31:18.621493 [debug] [ThreadPool]: On list_salesdb_staging: BEGIN
[0m16:31:18.621732 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:18.625481 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m16:31:18.625906 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m16:31:18.626202 [debug] [ThreadPool]: On list_salesdb_staging: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_staging"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m16:31:18.628712 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m16:31:18.629893 [debug] [ThreadPool]: On list_salesdb_staging: ROLLBACK
[0m16:31:18.630610 [debug] [ThreadPool]: On list_salesdb_staging: Close
[0m16:31:18.631243 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_staging, now list_salesdb_gold)
[0m16:31:18.632798 [debug] [ThreadPool]: Using postgres connection "list_salesdb_gold"
[0m16:31:18.633851 [debug] [ThreadPool]: On list_salesdb_gold: BEGIN
[0m16:31:18.634130 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:18.638334 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m16:31:18.638764 [debug] [ThreadPool]: Using postgres connection "list_salesdb_gold"
[0m16:31:18.639212 [debug] [ThreadPool]: On list_salesdb_gold: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_gold"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m16:31:18.641532 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m16:31:18.642660 [debug] [ThreadPool]: On list_salesdb_gold: ROLLBACK
[0m16:31:18.643491 [debug] [ThreadPool]: On list_salesdb_gold: Close
[0m16:31:18.644166 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_gold, now list_salesdb_silver)
[0m16:31:18.645797 [debug] [ThreadPool]: Using postgres connection "list_salesdb_silver"
[0m16:31:18.646588 [debug] [ThreadPool]: On list_salesdb_silver: BEGIN
[0m16:31:18.646943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:18.650450 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:31:18.650791 [debug] [ThreadPool]: Using postgres connection "list_salesdb_silver"
[0m16:31:18.651103 [debug] [ThreadPool]: On list_salesdb_silver: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_silver"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m16:31:18.653250 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m16:31:18.654344 [debug] [ThreadPool]: On list_salesdb_silver: ROLLBACK
[0m16:31:18.654984 [debug] [ThreadPool]: On list_salesdb_silver: Close
[0m16:31:18.655565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_silver, now list_salesdb_marts)
[0m16:31:18.657233 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m16:31:18.657550 [debug] [ThreadPool]: On list_salesdb_marts: BEGIN
[0m16:31:18.657790 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:18.662714 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m16:31:18.663143 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m16:31:18.663398 [debug] [ThreadPool]: On list_salesdb_marts: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_marts"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m16:31:18.665763 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m16:31:18.667162 [debug] [ThreadPool]: On list_salesdb_marts: ROLLBACK
[0m16:31:18.668323 [debug] [ThreadPool]: On list_salesdb_marts: Close
[0m16:31:18.673999 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:18.674390 [debug] [MainThread]: On master: BEGIN
[0m16:31:18.674631 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:31:18.679434 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m16:31:18.680128 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:18.680643 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:31:18.698778 [debug] [MainThread]: SQL status: SELECT 13 in 0.017 seconds
[0m16:31:18.702155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d94ea32-2141-425f-a60d-fd40687f0adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788d2a931a50>]}
[0m16:31:18.702768 [debug] [MainThread]: On master: ROLLBACK
[0m16:31:18.703715 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:18.704092 [debug] [MainThread]: On master: BEGIN
[0m16:31:18.704792 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:31:18.705149 [debug] [MainThread]: On master: COMMIT
[0m16:31:18.705449 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:18.705694 [debug] [MainThread]: On master: COMMIT
[0m16:31:18.706377 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:31:18.706682 [debug] [MainThread]: On master: Close
[0m16:31:18.710356 [debug] [Thread-1 (]: Began running node test.modelling_handson.test_ages
[0m16:31:18.710761 [info ] [Thread-1 (]: 1 of 1 START test test_ages .................................................... [RUN]
[0m16:31:18.711236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_marts, now test.modelling_handson.test_ages)
[0m16:31:18.711524 [debug] [Thread-1 (]: Began compiling node test.modelling_handson.test_ages
[0m16:31:18.717378 [debug] [Thread-1 (]: Writing injected SQL for node "test.modelling_handson.test_ages"
[0m16:31:18.718217 [debug] [Thread-1 (]: Began executing node test.modelling_handson.test_ages
[0m16:31:18.736162 [debug] [Thread-1 (]: Writing runtime sql for node "test.modelling_handson.test_ages"
[0m16:31:18.737219 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.test_ages"
[0m16:31:18.737602 [debug] [Thread-1 (]: On test.modelling_handson.test_ages: BEGIN
[0m16:31:18.737883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:18.741982 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:31:18.742470 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.test_ages"
[0m16:31:18.742769 [debug] [Thread-1 (]: On test.modelling_handson.test_ages: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "test.modelling_handson.test_ages"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select *
from "salesdb"."marts"."dim_patients"
where age < 0
  
  
      
    ) dbt_internal_test
[0m16:31:18.744214 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:31:18.748173 [debug] [Thread-1 (]: On test.modelling_handson.test_ages: ROLLBACK
[0m16:31:18.749361 [debug] [Thread-1 (]: On test.modelling_handson.test_ages: Close
[0m16:31:18.750113 [info ] [Thread-1 (]: 1 of 1 PASS test_ages .......................................................... [[32mPASS[0m in 0.04s]
[0m16:31:18.751020 [debug] [Thread-1 (]: Finished running node test.modelling_handson.test_ages
[0m16:31:18.752893 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:18.753222 [debug] [MainThread]: On master: BEGIN
[0m16:31:18.753483 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:31:18.757300 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m16:31:18.757709 [debug] [MainThread]: On master: COMMIT
[0m16:31:18.758034 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:18.758277 [debug] [MainThread]: On master: COMMIT
[0m16:31:18.758927 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:31:18.759435 [debug] [MainThread]: On master: Close
[0m16:31:18.759831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:18.760085 [debug] [MainThread]: Connection 'test.modelling_handson.test_ages' was properly closed.
[0m16:31:18.760355 [info ] [MainThread]: 
[0m16:31:18.760733 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m16:31:18.761375 [debug] [MainThread]: Command end result
[0m16:31:18.782263 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m16:31:18.784093 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m16:31:18.790722 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m16:31:18.791180 [info ] [MainThread]: 
[0m16:31:18.791558 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:31:18.791852 [info ] [MainThread]: 
[0m16:31:18.792124 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:31:18.792572 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:31:18.794059 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.8995402, "process_in_blocks": "109544", "process_kernel_time": 0.219353, "process_mem_max_rss": "124416", "process_out_blocks": "2008", "process_user_time": 1.826543}
[0m16:31:18.794512 [debug] [MainThread]: Command `dbt test` succeeded at 16:31:18.794426 after 0.90 seconds
[0m16:31:18.794819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788d2ce51390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788d311bd0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788d311bd210>]}
[0m16:31:18.795163 [debug] [MainThread]: Flushing usage events
[0m16:31:19.996604 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:32:56.545090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b53e2a2110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b53e2fbd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b53e56f290>]}


============================== 16:32:56.547958 | 85609154-39bd-49e5-a130-d91acc1360ea ==============================
[0m16:32:56.547958 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:32:56.548389 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/subhan/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:32:56.592509 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 50, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m16:32:56.593069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '85609154-39bd-49e5-a130-d91acc1360ea', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b53e32f5d0>]}
[0m16:32:56.686237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85609154-39bd-49e5-a130-d91acc1360ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b53e33cc10>]}
[0m16:32:56.743453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85609154-39bd-49e5-a130-d91acc1360ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b540f39910>]}
[0m16:32:56.744238 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:32:56.800397 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:32:56.907374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:32:56.908022 [debug] [MainThread]: Partial parsing: updated file: modelling_handson://models/marts/schema.yml
[0m16:32:58.028651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85609154-39bd-49e5-a130-d91acc1360ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b53c198fd0>]}
[0m16:32:58.116715 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m16:32:58.118828 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m16:32:58.138992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85609154-39bd-49e5-a130-d91acc1360ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b53c181290>]}
[0m16:32:58.139471 [info ] [MainThread]: Found 13 models, 4 data tests, 6 seeds, 5 sources, 435 macros
[0m16:32:58.139794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85609154-39bd-49e5-a130-d91acc1360ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b53c550f50>]}
[0m16:32:58.141387 [info ] [MainThread]: 
[0m16:32:58.141732 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:32:58.141988 [info ] [MainThread]: 
[0m16:32:58.142456 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:32:58.146594 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb_gold'
[0m16:32:58.172477 [debug] [ThreadPool]: Using postgres connection "list_salesdb_gold"
[0m16:32:58.172905 [debug] [ThreadPool]: On list_salesdb_gold: BEGIN
[0m16:32:58.173181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:58.177787 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m16:32:58.178210 [debug] [ThreadPool]: Using postgres connection "list_salesdb_gold"
[0m16:32:58.178468 [debug] [ThreadPool]: On list_salesdb_gold: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_gold"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m16:32:58.181219 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m16:32:58.182584 [debug] [ThreadPool]: On list_salesdb_gold: ROLLBACK
[0m16:32:58.183515 [debug] [ThreadPool]: On list_salesdb_gold: Close
[0m16:32:58.184091 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_gold, now list_salesdb_public_raw_data)
[0m16:32:58.186068 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m16:32:58.186596 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m16:32:58.186838 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:32:58.191635 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m16:32:58.192135 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m16:32:58.192467 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m16:32:58.195089 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.002 seconds
[0m16:32:58.196261 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m16:32:58.196933 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m16:32:58.197524 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now list_salesdb_silver)
[0m16:32:58.199553 [debug] [ThreadPool]: Using postgres connection "list_salesdb_silver"
[0m16:32:58.201523 [debug] [ThreadPool]: On list_salesdb_silver: BEGIN
[0m16:32:58.201916 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:32:58.206013 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m16:32:58.206476 [debug] [ThreadPool]: Using postgres connection "list_salesdb_silver"
[0m16:32:58.206763 [debug] [ThreadPool]: On list_salesdb_silver: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_silver"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m16:32:58.209344 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m16:32:58.210582 [debug] [ThreadPool]: On list_salesdb_silver: ROLLBACK
[0m16:32:58.211386 [debug] [ThreadPool]: On list_salesdb_silver: Close
[0m16:32:58.211990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_silver, now list_salesdb_staging)
[0m16:32:58.214223 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m16:32:58.215000 [debug] [ThreadPool]: On list_salesdb_staging: BEGIN
[0m16:32:58.215311 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:32:58.218783 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:32:58.219205 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m16:32:58.219488 [debug] [ThreadPool]: On list_salesdb_staging: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_staging"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m16:32:58.221732 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m16:32:58.222858 [debug] [ThreadPool]: On list_salesdb_staging: ROLLBACK
[0m16:32:58.223441 [debug] [ThreadPool]: On list_salesdb_staging: Close
[0m16:32:58.223996 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_staging, now list_salesdb_marts)
[0m16:32:58.226282 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m16:32:58.226584 [debug] [ThreadPool]: On list_salesdb_marts: BEGIN
[0m16:32:58.227033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:32:58.230727 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m16:32:58.231107 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m16:32:58.231392 [debug] [ThreadPool]: On list_salesdb_marts: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_marts"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m16:32:59.433418 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m16:32:59.434600 [debug] [ThreadPool]: On list_salesdb_marts: ROLLBACK
[0m16:32:59.435222 [debug] [ThreadPool]: On list_salesdb_marts: Close
[0m16:32:59.435778 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_marts, now list_salesdb_bronze)
[0m16:32:59.437896 [debug] [ThreadPool]: Using postgres connection "list_salesdb_bronze"
[0m16:32:59.438235 [debug] [ThreadPool]: On list_salesdb_bronze: BEGIN
[0m16:32:59.438478 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:32:59.442525 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m16:32:59.442979 [debug] [ThreadPool]: Using postgres connection "list_salesdb_bronze"
[0m16:32:59.443251 [debug] [ThreadPool]: On list_salesdb_bronze: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_bronze"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m16:32:59.445461 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m16:32:59.446622 [debug] [ThreadPool]: On list_salesdb_bronze: ROLLBACK
[0m16:32:59.447292 [debug] [ThreadPool]: On list_salesdb_bronze: Close
[0m16:32:59.452429 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:59.452817 [debug] [MainThread]: On master: BEGIN
[0m16:32:59.453102 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:32:59.457172 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m16:32:59.457631 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:59.457962 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:32:59.475343 [debug] [MainThread]: SQL status: SELECT 13 in 0.017 seconds
[0m16:32:59.478475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85609154-39bd-49e5-a130-d91acc1360ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b53c942cd0>]}
[0m16:32:59.478949 [debug] [MainThread]: On master: ROLLBACK
[0m16:32:59.479608 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:59.479938 [debug] [MainThread]: On master: BEGIN
[0m16:32:59.480890 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:32:59.481192 [debug] [MainThread]: On master: COMMIT
[0m16:32:59.481466 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:59.481684 [debug] [MainThread]: On master: COMMIT
[0m16:32:59.482198 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:32:59.482581 [debug] [MainThread]: On master: Close
[0m16:32:59.485317 [debug] [Thread-1 (]: Began running node test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33
[0m16:32:59.485927 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_dim_patients_gender__Male__Female__Other ..... [RUN]
[0m16:32:59.486374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_bronze, now test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33)
[0m16:32:59.486695 [debug] [Thread-1 (]: Began compiling node test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33
[0m16:32:59.493355 [debug] [Thread-1 (]: Writing injected SQL for node "test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33"
[0m16:32:59.495082 [debug] [Thread-1 (]: Began executing node test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33
[0m16:32:59.513889 [debug] [Thread-1 (]: Writing runtime sql for node "test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33"
[0m16:32:59.514581 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33"
[0m16:32:59.514911 [debug] [Thread-1 (]: On test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33: BEGIN
[0m16:32:59.515175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:59.519705 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:32:59.520128 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33"
[0m16:32:59.520441 [debug] [Thread-1 (]: On test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        gender as value_field,
        count(*) as n_records

    from "salesdb"."marts"."dim_patients"
    group by gender

)

select *
from all_values
where value_field not in (
    'Male','Female','Other'
)



  
  
      
    ) dbt_internal_test
[0m16:32:59.521969 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:32:59.525683 [debug] [Thread-1 (]: On test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33: ROLLBACK
[0m16:32:59.526472 [debug] [Thread-1 (]: On test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33: Close
[0m16:32:59.527130 [info ] [Thread-1 (]: 1 of 4 PASS accepted_values_dim_patients_gender__Male__Female__Other ........... [[32mPASS[0m in 0.04s]
[0m16:32:59.527629 [debug] [Thread-1 (]: Finished running node test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33
[0m16:32:59.527993 [debug] [Thread-1 (]: Began running node test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7
[0m16:32:59.528320 [info ] [Thread-1 (]: 2 of 4 START test not_null_dim_patients_patient_id ............................. [RUN]
[0m16:32:59.528797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.modelling_handson.accepted_values_dim_patients_gender__Male__Female__Other.acf008ef33, now test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7)
[0m16:32:59.529073 [debug] [Thread-1 (]: Began compiling node test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7
[0m16:32:59.534821 [debug] [Thread-1 (]: Writing injected SQL for node "test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7"
[0m16:32:59.535410 [debug] [Thread-1 (]: Began executing node test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7
[0m16:32:59.537374 [debug] [Thread-1 (]: Writing runtime sql for node "test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7"
[0m16:32:59.537960 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7"
[0m16:32:59.538248 [debug] [Thread-1 (]: On test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7: BEGIN
[0m16:32:59.538503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:59.542410 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:32:59.542799 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7"
[0m16:32:59.543132 [debug] [Thread-1 (]: On test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "salesdb"."marts"."dim_patients"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m16:32:59.544085 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:32:59.545424 [debug] [Thread-1 (]: On test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7: ROLLBACK
[0m16:32:59.546080 [debug] [Thread-1 (]: On test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7: Close
[0m16:32:59.546632 [info ] [Thread-1 (]: 2 of 4 PASS not_null_dim_patients_patient_id ................................... [[32mPASS[0m in 0.02s]
[0m16:32:59.547080 [debug] [Thread-1 (]: Finished running node test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7
[0m16:32:59.547417 [debug] [Thread-1 (]: Began running node test.modelling_handson.test_ages
[0m16:32:59.547894 [info ] [Thread-1 (]: 3 of 4 START test test_ages .................................................... [RUN]
[0m16:32:59.548321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.modelling_handson.not_null_dim_patients_patient_id.594c5a5cb7, now test.modelling_handson.test_ages)
[0m16:32:59.548615 [debug] [Thread-1 (]: Began compiling node test.modelling_handson.test_ages
[0m16:32:59.550900 [debug] [Thread-1 (]: Writing injected SQL for node "test.modelling_handson.test_ages"
[0m16:32:59.551453 [debug] [Thread-1 (]: Began executing node test.modelling_handson.test_ages
[0m16:32:59.553233 [debug] [Thread-1 (]: Writing runtime sql for node "test.modelling_handson.test_ages"
[0m16:32:59.553757 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.test_ages"
[0m16:32:59.554090 [debug] [Thread-1 (]: On test.modelling_handson.test_ages: BEGIN
[0m16:32:59.554328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:59.557944 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m16:32:59.558346 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.test_ages"
[0m16:32:59.558617 [debug] [Thread-1 (]: On test.modelling_handson.test_ages: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "test.modelling_handson.test_ages"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select *
from "salesdb"."marts"."dim_patients"
where age < 0
  
  
      
    ) dbt_internal_test
[0m16:32:59.560462 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:32:59.563257 [debug] [Thread-1 (]: On test.modelling_handson.test_ages: ROLLBACK
[0m16:32:59.564050 [debug] [Thread-1 (]: On test.modelling_handson.test_ages: Close
[0m16:32:59.564669 [info ] [Thread-1 (]: 3 of 4 PASS test_ages .......................................................... [[32mPASS[0m in 0.02s]
[0m16:32:59.565126 [debug] [Thread-1 (]: Finished running node test.modelling_handson.test_ages
[0m16:32:59.565460 [debug] [Thread-1 (]: Began running node test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2
[0m16:32:59.565936 [info ] [Thread-1 (]: 4 of 4 START test unique_dim_patients_patient_id ............................... [RUN]
[0m16:32:59.566322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.modelling_handson.test_ages, now test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2)
[0m16:32:59.566640 [debug] [Thread-1 (]: Began compiling node test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2
[0m16:32:59.572218 [debug] [Thread-1 (]: Writing injected SQL for node "test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2"
[0m16:32:59.572856 [debug] [Thread-1 (]: Began executing node test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2
[0m16:32:59.574965 [debug] [Thread-1 (]: Writing runtime sql for node "test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2"
[0m16:32:59.575578 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2"
[0m16:32:59.575880 [debug] [Thread-1 (]: On test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2: BEGIN
[0m16:32:59.576176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:59.580723 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:32:59.581162 [debug] [Thread-1 (]: Using postgres connection "test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2"
[0m16:32:59.581448 [debug] [Thread-1 (]: On test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "salesdb"."marts"."dim_patients"
where patient_id is not null
group by patient_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:32:59.582888 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:32:59.585117 [debug] [Thread-1 (]: On test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2: ROLLBACK
[0m16:32:59.585896 [debug] [Thread-1 (]: On test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2: Close
[0m16:32:59.586533 [info ] [Thread-1 (]: 4 of 4 PASS unique_dim_patients_patient_id ..................................... [[32mPASS[0m in 0.02s]
[0m16:32:59.587025 [debug] [Thread-1 (]: Finished running node test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2
[0m16:32:59.588548 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:59.589034 [debug] [MainThread]: On master: BEGIN
[0m16:32:59.589306 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:32:59.593154 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m16:32:59.593547 [debug] [MainThread]: On master: COMMIT
[0m16:32:59.593824 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:59.594049 [debug] [MainThread]: On master: COMMIT
[0m16:32:59.594552 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:32:59.594892 [debug] [MainThread]: On master: Close
[0m16:32:59.595273 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:32:59.595509 [debug] [MainThread]: Connection 'test.modelling_handson.unique_dim_patients_patient_id.77ebce32b2' was properly closed.
[0m16:32:59.595793 [info ] [MainThread]: 
[0m16:32:59.596092 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 1.45 seconds (1.45s).
[0m16:32:59.596944 [debug] [MainThread]: Command end result
[0m16:32:59.616636 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m16:32:59.618498 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m16:32:59.625077 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m16:32:59.625454 [info ] [MainThread]: 
[0m16:32:59.625931 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:32:59.626302 [info ] [MainThread]: 
[0m16:32:59.626585 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m16:32:59.627019 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:32:59.627885 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.2134657, "process_in_blocks": "848", "process_kernel_time": 0.180796, "process_mem_max_rss": "129932", "process_out_blocks": "3008", "process_user_time": 2.165351}
[0m16:32:59.628291 [debug] [MainThread]: Command `dbt test` succeeded at 16:32:59.628209 after 1.21 seconds
[0m16:32:59.628617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b53e464590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b53e306210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b5429bd050>]}
[0m16:32:59.628929 [debug] [MainThread]: Flushing usage events
[0m16:33:00.672657 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:55:48.785751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6da7393290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6da76553d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6da739b190>]}


============================== 14:55:48.789729 | 4bc51334-7baf-43c2-a77f-99df023576a4 ==============================
[0m14:55:48.789729 [info ] [MainThread]: Running with dbt=1.10.7
[0m14:55:48.790144 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/subhan/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:55:48.834508 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m14:55:48.834914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4bc51334-7baf-43c2-a77f-99df023576a4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6da7399cd0>]}
[0m14:55:48.929163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bc51334-7baf-43c2-a77f-99df023576a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6da729a450>]}
[0m14:55:48.977209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bc51334-7baf-43c2-a77f-99df023576a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6da9fbd850>]}
[0m14:55:48.977840 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:55:49.029691 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m14:55:49.106950 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m14:55:49.107325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4bc51334-7baf-43c2-a77f-99df023576a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6da7cca790>]}
[0m14:55:49.707654 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.modelling_handson.staging
- models.modelling_handson.marts
[0m14:55:49.714499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bc51334-7baf-43c2-a77f-99df023576a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6da69aec50>]}
[0m14:55:49.760084 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m14:55:49.761451 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m14:55:49.770703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bc51334-7baf-43c2-a77f-99df023576a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6da61e7c10>]}
[0m14:55:49.771071 [info ] [MainThread]: Found 3 seeds, 5 sources, 435 macros
[0m14:55:49.771306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bc51334-7baf-43c2-a77f-99df023576a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6da63b03d0>]}
[0m14:55:49.772439 [info ] [MainThread]: 
[0m14:55:49.772716 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:55:49.772904 [info ] [MainThread]: 
[0m14:55:49.773201 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:55:49.775994 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb'
[0m14:55:49.803619 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m14:55:49.803927 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m14:55:49.804177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:49.821813 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.018 seconds
[0m14:55:49.822719 [debug] [ThreadPool]: On list_salesdb: Close
[0m14:55:49.823913 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb, now list_salesdb_public_raw_data)
[0m14:55:49.827363 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m14:55:49.827632 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m14:55:49.827808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:49.830525 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m14:55:49.830796 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m14:55:49.830987 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m14:55:49.838447 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.007 seconds
[0m14:55:49.839416 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m14:55:49.840022 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m14:55:49.843608 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:49.843848 [debug] [MainThread]: On master: BEGIN
[0m14:55:49.844021 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:55:49.846650 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m14:55:49.846877 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:49.847087 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:55:49.863772 [debug] [MainThread]: SQL status: SELECT 13 in 0.016 seconds
[0m14:55:49.866320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bc51334-7baf-43c2-a77f-99df023576a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6da682a810>]}
[0m14:55:49.866633 [debug] [MainThread]: On master: ROLLBACK
[0m14:55:49.867207 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:49.867435 [debug] [MainThread]: On master: BEGIN
[0m14:55:49.868301 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:55:49.868581 [debug] [MainThread]: On master: COMMIT
[0m14:55:49.868784 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:49.868947 [debug] [MainThread]: On master: COMMIT
[0m14:55:49.869267 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:55:49.869462 [debug] [MainThread]: On master: Close
[0m14:55:49.872804 [debug] [Thread-1 (]: Began running node seed.modelling_handson.customers_day1
[0m14:55:49.873203 [info ] [Thread-1 (]: 1 of 3 START seed file public_raw_data.customers_day1 .......................... [RUN]
[0m14:55:49.873548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now seed.modelling_handson.customers_day1)
[0m14:55:49.873770 [debug] [Thread-1 (]: Began compiling node seed.modelling_handson.customers_day1
[0m14:55:49.873973 [debug] [Thread-1 (]: Began executing node seed.modelling_handson.customers_day1
[0m14:55:49.893234 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_day1"
[0m14:55:49.893629 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day1: BEGIN
[0m14:55:49.893840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:49.897198 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m14:55:49.897627 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_day1"
[0m14:55:49.897854 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day1: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "seed.modelling_handson.customers_day1"} */

    create table "salesdb"."public_raw_data"."customers_day1" (customer_nk text,first_name text,last_name text,email text,city text,country text,signup_ts timestamp without time zone,change_ts timestamp without time zone)
  
[0m14:55:49.911136 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.013 seconds
[0m14:55:49.921109 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_day1"
[0m14:55:49.921485 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day1: 
          insert into "salesdb"."public_raw_data"."customers_day1" (customer_nk, first_name, last_name, email, city, country, signup_ts, change_ts) values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m14:55:49.922730 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.001 seconds
[0m14:55:49.925845 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.modelling_handson.customers_day1"
[0m14:55:49.936368 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day1: COMMIT
[0m14:55:49.936760 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_day1"
[0m14:55:49.936976 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day1: COMMIT
[0m14:55:49.938122 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:55:49.939204 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day1: Close
[0m14:55:49.940320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bc51334-7baf-43c2-a77f-99df023576a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6da82bdb10>]}
[0m14:55:49.940706 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file public_raw_data.customers_day1 ...................... [[32mINSERT 3[0m in 0.07s]
[0m14:55:49.941043 [debug] [Thread-1 (]: Finished running node seed.modelling_handson.customers_day1
[0m14:55:49.941272 [debug] [Thread-1 (]: Began running node seed.modelling_handson.customers_day2
[0m14:55:49.941643 [info ] [Thread-1 (]: 2 of 3 START seed file public_raw_data.customers_day2 .......................... [RUN]
[0m14:55:49.941939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.modelling_handson.customers_day1, now seed.modelling_handson.customers_day2)
[0m14:55:49.942141 [debug] [Thread-1 (]: Began compiling node seed.modelling_handson.customers_day2
[0m14:55:49.942346 [debug] [Thread-1 (]: Began executing node seed.modelling_handson.customers_day2
[0m14:55:49.944698 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_day2"
[0m14:55:49.944939 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day2: BEGIN
[0m14:55:49.945124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:49.948234 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m14:55:49.948636 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_day2"
[0m14:55:49.948873 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day2: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "seed.modelling_handson.customers_day2"} */

    create table "salesdb"."public_raw_data"."customers_day2" (customer_nk text,first_name text,last_name text,email text,city text,country text,signup_ts timestamp without time zone,change_ts timestamp without time zone)
  
[0m14:55:49.952088 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.003 seconds
[0m14:55:49.954387 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_day2"
[0m14:55:49.954776 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day2: 
          insert into "salesdb"."public_raw_data"."customers_day2" (customer_nk, first_name, last_name, email, city, country, signup_ts, change_ts) values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m14:55:49.955867 [debug] [Thread-1 (]: SQL status: INSERT 0 4 in 0.001 seconds
[0m14:55:49.956609 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.modelling_handson.customers_day2"
[0m14:55:49.957886 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day2: COMMIT
[0m14:55:49.958174 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_day2"
[0m14:55:49.958380 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day2: COMMIT
[0m14:55:49.959585 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:55:49.960109 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day2: Close
[0m14:55:49.960561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bc51334-7baf-43c2-a77f-99df023576a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6da64fce50>]}
[0m14:55:49.960895 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file public_raw_data.customers_day2 ...................... [[32mINSERT 4[0m in 0.02s]
[0m14:55:49.961223 [debug] [Thread-1 (]: Finished running node seed.modelling_handson.customers_day2
[0m14:55:49.961467 [debug] [Thread-1 (]: Began running node seed.modelling_handson.customers_initial
[0m14:55:49.961879 [info ] [Thread-1 (]: 3 of 3 START seed file public_raw_data.customers_initial ....................... [RUN]
[0m14:55:49.962250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.modelling_handson.customers_day2, now seed.modelling_handson.customers_initial)
[0m14:55:49.962482 [debug] [Thread-1 (]: Began compiling node seed.modelling_handson.customers_initial
[0m14:55:49.962690 [debug] [Thread-1 (]: Began executing node seed.modelling_handson.customers_initial
[0m14:55:49.965836 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_initial"
[0m14:55:49.966112 [debug] [Thread-1 (]: On seed.modelling_handson.customers_initial: BEGIN
[0m14:55:49.966307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:49.969109 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m14:55:49.969399 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_initial"
[0m14:55:49.969598 [debug] [Thread-1 (]: On seed.modelling_handson.customers_initial: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "seed.modelling_handson.customers_initial"} */

    create table "salesdb"."public_raw_data"."customers_initial" (customer_nk text,first_name text,last_name text,email text,city text,country text,signup_ts timestamp without time zone)
  
[0m14:55:49.972739 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.003 seconds
[0m14:55:49.974627 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_initial"
[0m14:55:49.974886 [debug] [Thread-1 (]: On seed.modelling_handson.customers_initial: 
          insert into "salesdb"."public_raw_data"."customers_initial" (customer_nk, first_name, last_name, email, city, country, signup_ts) values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s)
      ...
[0m14:55:49.975621 [debug] [Thread-1 (]: SQL status: INSERT 0 4 in 0.000 seconds
[0m14:55:49.976039 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.modelling_handson.customers_initial"
[0m14:55:49.977266 [debug] [Thread-1 (]: On seed.modelling_handson.customers_initial: COMMIT
[0m14:55:49.977540 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_initial"
[0m14:55:49.977737 [debug] [Thread-1 (]: On seed.modelling_handson.customers_initial: COMMIT
[0m14:55:49.978581 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:55:49.979065 [debug] [Thread-1 (]: On seed.modelling_handson.customers_initial: Close
[0m14:55:49.979458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bc51334-7baf-43c2-a77f-99df023576a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6da5679f90>]}
[0m14:55:49.979771 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file public_raw_data.customers_initial ................... [[32mINSERT 4[0m in 0.02s]
[0m14:55:49.980089 [debug] [Thread-1 (]: Finished running node seed.modelling_handson.customers_initial
[0m14:55:49.981152 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:49.981372 [debug] [MainThread]: On master: BEGIN
[0m14:55:49.981541 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:55:49.984414 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m14:55:49.984671 [debug] [MainThread]: On master: COMMIT
[0m14:55:49.984847 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:49.985002 [debug] [MainThread]: On master: COMMIT
[0m14:55:49.985428 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:55:49.985657 [debug] [MainThread]: On master: Close
[0m14:55:49.985926 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:49.986102 [debug] [MainThread]: Connection 'seed.modelling_handson.customers_initial' was properly closed.
[0m14:55:49.986302 [info ] [MainThread]: 
[0m14:55:49.986516 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m14:55:49.987000 [debug] [MainThread]: Command end result
[0m14:55:49.999575 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m14:55:50.001043 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m14:55:50.005055 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m14:55:50.005321 [info ] [MainThread]: 
[0m14:55:50.005837 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:55:50.006137 [info ] [MainThread]: 
[0m14:55:50.006372 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m14:55:50.006715 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:55:50.007348 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.2565728, "process_in_blocks": "10000", "process_kernel_time": 0.142047, "process_mem_max_rss": "126144", "process_out_blocks": "2656", "process_user_time": 1.922493}
[0m14:55:50.007640 [debug] [MainThread]: Command `dbt seed` succeeded at 14:55:50.007581 after 1.26 seconds
[0m14:55:50.007895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6da73e3150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6da73f3950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6dab903c50>]}
[0m14:55:50.008318 [debug] [MainThread]: Flushing usage events
[0m14:55:51.680888 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:03:54.861674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7122564cbbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7122564cb210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7122564cbb10>]}


============================== 15:03:54.863643 | 7dc821ac-8930-40f5-8724-aaa1a57bd488 ==============================
[0m15:03:54.863643 [info ] [MainThread]: Running with dbt=1.10.7
[0m15:03:54.863973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/subhan/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'send_anonymous_usage_stats': 'True'}
[0m15:03:54.896687 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:03:54.897093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7dc821ac-8930-40f5-8724-aaa1a57bd488', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712256374050>]}
[0m15:03:54.970577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7dc821ac-8930-40f5-8724-aaa1a57bd488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712255b11490>]}
[0m15:03:55.010025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7dc821ac-8930-40f5-8724-aaa1a57bd488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7122590eb450>]}
[0m15:03:55.010616 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:03:55.055531 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m15:03:55.111599 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m15:03:55.111984 [debug] [MainThread]: Partial parsing: added file: modelling_handson://models/staging/stg_customers_initial.sql
[0m15:03:55.112197 [debug] [MainThread]: Partial parsing: added file: modelling_handson://models/staging/stg_customers_day2.sql
[0m15:03:55.112376 [debug] [MainThread]: Partial parsing: added file: modelling_handson://models/staging/stg_customers_day1.sql
[0m15:03:55.112648 [debug] [MainThread]: Partial parsing: updated file: modelling_handson://models/staging/schema.yml
[0m15:03:55.366029 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.modelling_handson.marts
[0m15:03:55.371663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7dc821ac-8930-40f5-8724-aaa1a57bd488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7122554d9690>]}
[0m15:03:55.457346 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:03:55.458652 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:03:55.465351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7dc821ac-8930-40f5-8724-aaa1a57bd488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712255644f10>]}
[0m15:03:55.465719 [info ] [MainThread]: Found 3 seeds, 3 models, 3 sources, 435 macros
[0m15:03:55.465972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dc821ac-8930-40f5-8724-aaa1a57bd488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712241302390>]}
[0m15:03:55.466890 [info ] [MainThread]: 
[0m15:03:55.467161 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:03:55.467358 [info ] [MainThread]: 
[0m15:03:55.467695 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:03:55.470233 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb'
[0m15:03:55.489691 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m15:03:55.490033 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m15:03:55.490227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:55.493805 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m15:03:55.494590 [debug] [ThreadPool]: On list_salesdb: Close
[0m15:03:55.495932 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb, now list_salesdb_staging)
[0m15:03:55.499717 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m15:03:55.499998 [debug] [ThreadPool]: On list_salesdb_staging: BEGIN
[0m15:03:55.500194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:03:55.503389 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:03:55.503764 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m15:03:55.503970 [debug] [ThreadPool]: On list_salesdb_staging: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_staging"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m15:03:55.505666 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m15:03:55.506448 [debug] [ThreadPool]: On list_salesdb_staging: ROLLBACK
[0m15:03:55.506828 [debug] [ThreadPool]: On list_salesdb_staging: Close
[0m15:03:55.507323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_staging, now list_salesdb_public_raw_data)
[0m15:03:55.508649 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:03:55.508856 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m15:03:55.509024 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:03:55.511702 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:03:55.511923 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:03:55.512139 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m15:03:55.513860 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m15:03:55.514609 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m15:03:55.514981 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m15:03:55.518032 [debug] [MainThread]: Using postgres connection "master"
[0m15:03:55.518261 [debug] [MainThread]: On master: BEGIN
[0m15:03:55.518435 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:03:55.520901 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:03:55.521115 [debug] [MainThread]: Using postgres connection "master"
[0m15:03:55.521322 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:03:55.526904 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m15:03:55.527687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dc821ac-8930-40f5-8724-aaa1a57bd488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7122556fc3d0>]}
[0m15:03:55.528005 [debug] [MainThread]: On master: ROLLBACK
[0m15:03:55.528486 [debug] [MainThread]: Using postgres connection "master"
[0m15:03:55.528700 [debug] [MainThread]: On master: BEGIN
[0m15:03:55.529256 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:03:55.529462 [debug] [MainThread]: On master: COMMIT
[0m15:03:55.529629 [debug] [MainThread]: Using postgres connection "master"
[0m15:03:55.529851 [debug] [MainThread]: On master: COMMIT
[0m15:03:55.530190 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:03:55.530392 [debug] [MainThread]: On master: Close
[0m15:03:55.532111 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_customers_day2
[0m15:03:55.532541 [info ] [Thread-1 (]: 1 of 2 START sql view model staging.stg_customers_day2 ......................... [RUN]
[0m15:03:55.532913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now model.modelling_handson.stg_customers_day2)
[0m15:03:55.533238 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_customers_day2
[0m15:03:55.537601 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_customers_day2"
[0m15:03:55.539233 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_customers_day2
[0m15:03:55.559747 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_customers_day2"
[0m15:03:55.560608 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_day2"
[0m15:03:55.560884 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_day2: BEGIN
[0m15:03:55.561091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:55.564829 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:03:55.565168 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_day2"
[0m15:03:55.565639 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_day2: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_customers_day2"} */

  create view "salesdb"."staging"."stg_customers_day2__dbt_tmp"
    
    
  as (
    select
    customer_nk,first_name,last_name,email,city,country,
    signup_ts::timestamp as signup_ts,
    change_ts::timestamp as change_ts,
from "salesdb"."public_raw_data"."customers_day2"
  );
[0m15:03:55.566226 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 11: from "salesdb"."public_raw_data"."customers_day2"
         ^

[0m15:03:55.566517 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_day2: ROLLBACK
[0m15:03:55.567037 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_day2: Close
[0m15:03:55.570499 [debug] [Thread-1 (]: Database Error in model stg_customers_day2 (models/staging/stg_customers_day2.sql)
  syntax error at or near "from"
  LINE 11: from "salesdb"."public_raw_data"."customers_day2"
           ^
  compiled code at target/run/modelling_handson/models/staging/stg_customers_day2.sql
[0m15:03:55.571602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dc821ac-8930-40f5-8724-aaa1a57bd488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7122407f7850>]}
[0m15:03:55.572045 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model staging.stg_customers_day2 ................ [[31mERROR[0m in 0.04s]
[0m15:03:55.572407 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_customers_day2
[0m15:03:55.572646 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_customers_initial
[0m15:03:55.572989 [debug] [Thread-4 (]: Marking all children of 'model.modelling_handson.stg_customers_day2' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers_day2 (models/staging/stg_customers_day2.sql)
  syntax error at or near "from"
  LINE 11: from "salesdb"."public_raw_data"."customers_day2"
           ^
  compiled code at target/run/modelling_handson/models/staging/stg_customers_day2.sql.
[0m15:03:55.573328 [info ] [Thread-1 (]: 2 of 2 START sql view model staging.stg_customers_initial ...................... [RUN]
[0m15:03:55.574309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_customers_day2, now model.modelling_handson.stg_customers_initial)
[0m15:03:55.574548 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_customers_initial
[0m15:03:55.577337 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_customers_initial"
[0m15:03:55.577714 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_customers_initial
[0m15:03:55.579685 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_customers_initial"
[0m15:03:55.580106 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_initial"
[0m15:03:55.580339 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_initial: BEGIN
[0m15:03:55.580533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:55.583563 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m15:03:55.583862 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_initial"
[0m15:03:55.584094 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_initial: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_customers_initial"} */

  create view "salesdb"."staging"."stg_customers_initial__dbt_tmp"
    
    
  as (
    select
    customer_nk,first_name,last_name,email,city,country,
    signup_ts::timestamp as signup_ts
from "salesdb"."public_raw_data"."customers_initial"
  );
[0m15:03:55.585896 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:03:55.589765 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_initial"
[0m15:03:55.590078 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_initial: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_customers_initial"} */
alter table "salesdb"."staging"."stg_customers_initial__dbt_tmp" rename to "stg_customers_initial"
[0m15:03:55.590698 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:03:55.600113 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_initial: COMMIT
[0m15:03:55.600517 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_initial"
[0m15:03:55.600738 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_initial: COMMIT
[0m15:03:55.601742 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:03:55.605639 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_customers_initial__dbt_backup"
[0m15:03:55.609663 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_initial"
[0m15:03:55.610276 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_initial: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_customers_initial"} */
drop view if exists "salesdb"."staging"."stg_customers_initial__dbt_backup" cascade
[0m15:03:55.610950 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:03:55.612477 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_initial: Close
[0m15:03:55.612894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dc821ac-8930-40f5-8724-aaa1a57bd488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7122407f3210>]}
[0m15:03:55.613291 [info ] [Thread-1 (]: 2 of 2 OK created sql view model staging.stg_customers_initial ................. [[32mCREATE VIEW[0m in 0.04s]
[0m15:03:55.613622 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_customers_initial
[0m15:03:55.614650 [debug] [MainThread]: Using postgres connection "master"
[0m15:03:55.614860 [debug] [MainThread]: On master: BEGIN
[0m15:03:55.615025 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:03:55.617903 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:03:55.618124 [debug] [MainThread]: On master: COMMIT
[0m15:03:55.618305 [debug] [MainThread]: Using postgres connection "master"
[0m15:03:55.618462 [debug] [MainThread]: On master: COMMIT
[0m15:03:55.618820 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:03:55.619046 [debug] [MainThread]: On master: Close
[0m15:03:55.619330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:03:55.619520 [debug] [MainThread]: Connection 'model.modelling_handson.stg_customers_initial' was properly closed.
[0m15:03:55.619727 [info ] [MainThread]: 
[0m15:03:55.619926 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m15:03:55.620343 [debug] [MainThread]: Command end result
[0m15:03:55.633657 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:03:55.634847 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:03:55.638495 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m15:03:55.638779 [info ] [MainThread]: 
[0m15:03:55.639013 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:03:55.639193 [info ] [MainThread]: 
[0m15:03:55.639454 [error] [MainThread]: [31mFailure in model stg_customers_day2 (models/staging/stg_customers_day2.sql)[0m
[0m15:03:55.639679 [error] [MainThread]:   Database Error in model stg_customers_day2 (models/staging/stg_customers_day2.sql)
  syntax error at or near "from"
  LINE 11: from "salesdb"."public_raw_data"."customers_day2"
           ^
  compiled code at target/run/modelling_handson/models/staging/stg_customers_day2.sql
[0m15:03:55.639850 [info ] [MainThread]: 
[0m15:03:55.640043 [info ] [MainThread]:   compiled code at target/compiled/modelling_handson/models/staging/stg_customers_day2.sql
[0m15:03:55.640214 [info ] [MainThread]: 
[0m15:03:55.640408 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m15:03:55.640770 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:03:55.641443 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.814442, "process_in_blocks": "176", "process_kernel_time": 0.193015, "process_mem_max_rss": "126920", "process_out_blocks": "2680", "process_user_time": 1.540104}
[0m15:03:55.641726 [debug] [MainThread]: Command `dbt run` failed at 15:03:55.641672 after 0.81 seconds
[0m15:03:55.641949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7122564d21d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7122564d3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71225a9f6bd0>]}
[0m15:03:55.642170 [debug] [MainThread]: Flushing usage events
[0m15:03:56.789263 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:04:26.664178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc8bcc890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc8bce550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc8bcff90>]}


============================== 15:04:26.666175 | dce3e8fc-eb1e-4e6a-8165-d5f0c86ff637 ==============================
[0m15:04:26.666175 [info ] [MainThread]: Running with dbt=1.10.7
[0m15:04:26.666514 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'profiles_dir': '/home/subhan/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select staging', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:04:26.699330 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:04:26.699733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dce3e8fc-eb1e-4e6a-8165-d5f0c86ff637', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc8af72d0>]}
[0m15:04:26.774627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dce3e8fc-eb1e-4e6a-8165-d5f0c86ff637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc8a70710>]}
[0m15:04:26.814128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dce3e8fc-eb1e-4e6a-8165-d5f0c86ff637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efcb7f5710>]}
[0m15:04:26.814752 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:04:26.859623 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m15:04:26.931001 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:04:26.931435 [debug] [MainThread]: Partial parsing: updated file: modelling_handson://models/staging/stg_customers_day2.sql
[0m15:04:26.931707 [debug] [MainThread]: Partial parsing: updated file: modelling_handson://models/staging/stg_customers_day1.sql
[0m15:04:27.111051 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.modelling_handson.marts
[0m15:04:27.121214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dce3e8fc-eb1e-4e6a-8165-d5f0c86ff637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc7e1ac50>]}
[0m15:04:27.177206 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:04:27.178465 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:04:27.186099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dce3e8fc-eb1e-4e6a-8165-d5f0c86ff637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ef73a02690>]}
[0m15:04:27.186485 [info ] [MainThread]: Found 3 seeds, 3 models, 3 sources, 435 macros
[0m15:04:27.186765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dce3e8fc-eb1e-4e6a-8165-d5f0c86ff637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ef73b77c50>]}
[0m15:04:27.187812 [info ] [MainThread]: 
[0m15:04:27.188121 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:04:27.188337 [info ] [MainThread]: 
[0m15:04:27.188694 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:04:27.191814 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb'
[0m15:04:27.253695 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m15:04:27.254035 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m15:04:27.254250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:27.258451 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m15:04:27.259399 [debug] [ThreadPool]: On list_salesdb: Close
[0m15:04:27.260702 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb, now list_salesdb_public_raw_data)
[0m15:04:27.264645 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:04:27.265047 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m15:04:27.265257 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:27.268400 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:04:27.268695 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:04:27.268916 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m15:04:27.270701 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m15:04:27.271689 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m15:04:27.272220 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m15:04:27.272709 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now list_salesdb_staging)
[0m15:04:27.275265 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m15:04:27.275553 [debug] [ThreadPool]: On list_salesdb_staging: BEGIN
[0m15:04:27.275832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:27.279224 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:04:27.279510 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m15:04:27.279736 [debug] [ThreadPool]: On list_salesdb_staging: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_staging"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m15:04:27.281737 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m15:04:27.282655 [debug] [ThreadPool]: On list_salesdb_staging: ROLLBACK
[0m15:04:27.283186 [debug] [ThreadPool]: On list_salesdb_staging: Close
[0m15:04:27.286554 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:27.286838 [debug] [MainThread]: On master: BEGIN
[0m15:04:27.287047 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:04:27.290016 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:04:27.290288 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:27.290572 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:04:27.297787 [debug] [MainThread]: SQL status: SELECT 1 in 0.007 seconds
[0m15:04:27.298952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dce3e8fc-eb1e-4e6a-8165-d5f0c86ff637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ef730b24d0>]}
[0m15:04:27.299322 [debug] [MainThread]: On master: ROLLBACK
[0m15:04:27.299835 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:27.300065 [debug] [MainThread]: On master: BEGIN
[0m15:04:27.300747 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:04:27.301019 [debug] [MainThread]: On master: COMMIT
[0m15:04:27.301250 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:27.301454 [debug] [MainThread]: On master: COMMIT
[0m15:04:27.301989 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:04:27.302359 [debug] [MainThread]: On master: Close
[0m15:04:27.304447 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_customers_day1
[0m15:04:27.304853 [info ] [Thread-1 (]: 1 of 3 START sql view model staging.stg_customers_day1 ......................... [RUN]
[0m15:04:27.305354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_staging, now model.modelling_handson.stg_customers_day1)
[0m15:04:27.305652 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_customers_day1
[0m15:04:27.310573 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_customers_day1"
[0m15:04:27.311120 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_customers_day1
[0m15:04:27.337380 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_customers_day1"
[0m15:04:27.337974 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_day1"
[0m15:04:27.338260 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_day1: BEGIN
[0m15:04:27.338496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:27.342126 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:04:27.342484 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_day1"
[0m15:04:27.342757 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_day1: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_customers_day1"} */

  create view "salesdb"."staging"."stg_customers_day1__dbt_tmp"
    
    
  as (
    select
    customer_nk,first_name,last_name,email,city,country,
    signup_ts::timestamp as signup_ts,
    change_ts::timestamp as change_ts
from "salesdb"."public_raw_data"."customers_day1"
  );
[0m15:04:27.344098 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:04:27.348500 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_day1"
[0m15:04:27.348825 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_day1: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_customers_day1"} */
alter table "salesdb"."staging"."stg_customers_day1__dbt_tmp" rename to "stg_customers_day1"
[0m15:04:27.349466 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:04:27.359048 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_day1: COMMIT
[0m15:04:27.359550 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_day1"
[0m15:04:27.359912 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_day1: COMMIT
[0m15:04:27.361745 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:04:27.366237 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_customers_day1__dbt_backup"
[0m15:04:27.371228 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_day1"
[0m15:04:27.371556 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_day1: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_customers_day1"} */
drop view if exists "salesdb"."staging"."stg_customers_day1__dbt_backup" cascade
[0m15:04:27.372188 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:04:27.373845 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_day1: Close
[0m15:04:27.375126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dce3e8fc-eb1e-4e6a-8165-d5f0c86ff637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ef72f60890>]}
[0m15:04:27.375638 [info ] [Thread-1 (]: 1 of 3 OK created sql view model staging.stg_customers_day1 .................... [[32mCREATE VIEW[0m in 0.07s]
[0m15:04:27.376071 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_customers_day1
[0m15:04:27.376357 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_customers_day2
[0m15:04:27.376802 [info ] [Thread-1 (]: 2 of 3 START sql view model staging.stg_customers_day2 ......................... [RUN]
[0m15:04:27.377240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_customers_day1, now model.modelling_handson.stg_customers_day2)
[0m15:04:27.377533 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_customers_day2
[0m15:04:27.379566 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_customers_day2"
[0m15:04:27.380029 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_customers_day2
[0m15:04:27.382089 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_customers_day2"
[0m15:04:27.382550 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_day2"
[0m15:04:27.382924 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_day2: BEGIN
[0m15:04:27.383200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:27.386718 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m15:04:27.387127 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_day2"
[0m15:04:27.387384 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_day2: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_customers_day2"} */

  create view "salesdb"."staging"."stg_customers_day2__dbt_tmp"
    
    
  as (
    select
    customer_nk,first_name,last_name,email,city,country,
    signup_ts::timestamp as signup_ts,
    change_ts::timestamp as change_ts
from "salesdb"."public_raw_data"."customers_day2"
  );
[0m15:04:27.388811 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:04:27.391101 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_day2"
[0m15:04:27.391453 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_day2: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_customers_day2"} */
alter table "salesdb"."staging"."stg_customers_day2__dbt_tmp" rename to "stg_customers_day2"
[0m15:04:27.392293 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:04:27.393308 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_day2: COMMIT
[0m15:04:27.393630 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_day2"
[0m15:04:27.393870 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_day2: COMMIT
[0m15:04:27.394882 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:04:27.396596 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_customers_day2__dbt_backup"
[0m15:04:27.397033 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_day2"
[0m15:04:27.397283 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_day2: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_customers_day2"} */
drop view if exists "salesdb"."staging"."stg_customers_day2__dbt_backup" cascade
[0m15:04:27.397836 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:04:27.398767 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_day2: Close
[0m15:04:27.399264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dce3e8fc-eb1e-4e6a-8165-d5f0c86ff637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ef72f83c10>]}
[0m15:04:27.399854 [info ] [Thread-1 (]: 2 of 3 OK created sql view model staging.stg_customers_day2 .................... [[32mCREATE VIEW[0m in 0.02s]
[0m15:04:27.400597 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_customers_day2
[0m15:04:27.401050 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_customers_initial
[0m15:04:27.401616 [info ] [Thread-1 (]: 3 of 3 START sql view model staging.stg_customers_initial ...................... [RUN]
[0m15:04:27.402021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.modelling_handson.stg_customers_day2, now model.modelling_handson.stg_customers_initial)
[0m15:04:27.402291 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_customers_initial
[0m15:04:27.405656 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_customers_initial"
[0m15:04:27.406222 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_customers_initial
[0m15:04:27.408840 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_customers_initial"
[0m15:04:27.409507 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_initial"
[0m15:04:27.409783 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_initial: BEGIN
[0m15:04:27.410026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:27.413729 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:04:27.414110 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_initial"
[0m15:04:27.414374 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_initial: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_customers_initial"} */

  create view "salesdb"."staging"."stg_customers_initial__dbt_tmp"
    
    
  as (
    select
    customer_nk,first_name,last_name,email,city,country,
    signup_ts::timestamp as signup_ts
from "salesdb"."public_raw_data"."customers_initial"
  );
[0m15:04:27.416093 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:04:27.418672 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_initial"
[0m15:04:27.419266 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_initial: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_customers_initial"} */
alter table "salesdb"."staging"."stg_customers_initial" rename to "stg_customers_initial__dbt_backup"
[0m15:04:27.420223 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:04:27.423078 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_initial"
[0m15:04:27.423502 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_initial: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_customers_initial"} */
alter table "salesdb"."staging"."stg_customers_initial__dbt_tmp" rename to "stg_customers_initial"
[0m15:04:27.424451 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:04:27.427292 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_initial: COMMIT
[0m15:04:27.427660 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_initial"
[0m15:04:27.427914 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_initial: COMMIT
[0m15:04:27.428982 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:04:27.430585 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_customers_initial__dbt_backup"
[0m15:04:27.431150 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_initial"
[0m15:04:27.431440 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_initial: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_customers_initial"} */
drop view if exists "salesdb"."staging"."stg_customers_initial__dbt_backup" cascade
[0m15:04:27.432747 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:04:27.434059 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_initial: Close
[0m15:04:27.435333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dce3e8fc-eb1e-4e6a-8165-d5f0c86ff637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ef7303e0d0>]}
[0m15:04:27.436050 [info ] [Thread-1 (]: 3 of 3 OK created sql view model staging.stg_customers_initial ................. [[32mCREATE VIEW[0m in 0.03s]
[0m15:04:27.436736 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_customers_initial
[0m15:04:27.438342 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:27.438600 [debug] [MainThread]: On master: BEGIN
[0m15:04:27.438828 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:04:27.442066 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:04:27.442368 [debug] [MainThread]: On master: COMMIT
[0m15:04:27.442618 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:27.442878 [debug] [MainThread]: On master: COMMIT
[0m15:04:27.443331 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:04:27.443625 [debug] [MainThread]: On master: Close
[0m15:04:27.443970 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:04:27.444185 [debug] [MainThread]: Connection 'model.modelling_handson.stg_customers_initial' was properly closed.
[0m15:04:27.444462 [info ] [MainThread]: 
[0m15:04:27.444737 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m15:04:27.445391 [debug] [MainThread]: Command end result
[0m15:04:27.462920 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:04:27.464601 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:04:27.470188 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m15:04:27.470544 [info ] [MainThread]: 
[0m15:04:27.471127 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:04:27.471405 [info ] [MainThread]: 
[0m15:04:27.471659 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:04:27.472054 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:04:27.472934 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.84339225, "process_in_blocks": "0", "process_kernel_time": 0.163905, "process_mem_max_rss": "125116", "process_out_blocks": "2712", "process_user_time": 1.651052}
[0m15:04:27.473292 [debug] [MainThread]: Command `dbt run` succeeded at 15:04:27.473218 after 0.84 seconds
[0m15:04:27.473561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc9a75510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc8c2d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efcd5ffb10>]}
[0m15:04:27.473824 [debug] [MainThread]: Flushing usage events
[0m15:04:28.619206 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:26:54.455604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e4d0fe3ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e4d11969d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e4d0fe0750>]}


============================== 15:26:54.457708 | 555d7fd7-5ef3-4640-b31a-43a4fb04d1ff ==============================
[0m15:26:54.457708 [info ] [MainThread]: Running with dbt=1.10.7
[0m15:26:54.458066 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/subhan/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select type1_customers', 'send_anonymous_usage_stats': 'True'}
[0m15:26:54.493777 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:26:54.494317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '555d7fd7-5ef3-4640-b31a-43a4fb04d1ff', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e4d0f06e90>]}
[0m15:26:54.580369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '555d7fd7-5ef3-4640-b31a-43a4fb04d1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e4d06bc790>]}
[0m15:26:54.621815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '555d7fd7-5ef3-4640-b31a-43a4fb04d1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e4d3c9bd90>]}
[0m15:26:54.622524 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:26:54.669443 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m15:26:54.742105 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:26:54.742527 [debug] [MainThread]: Partial parsing: added file: modelling_handson://models/marts/type1_customers.sql
[0m15:26:54.933688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '555d7fd7-5ef3-4640-b31a-43a4fb04d1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e4d1042090>]}
[0m15:26:54.987230 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:26:54.988780 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:26:54.997838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '555d7fd7-5ef3-4640-b31a-43a4fb04d1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e4cfef6610>]}
[0m15:26:54.998395 [info ] [MainThread]: Found 3 seeds, 4 models, 3 sources, 435 macros
[0m15:26:54.998705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '555d7fd7-5ef3-4640-b31a-43a4fb04d1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e4d06a6510>]}
[0m15:26:54.999692 [info ] [MainThread]: 
[0m15:26:55.000111 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:26:55.000478 [info ] [MainThread]: 
[0m15:26:55.000878 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:26:55.001688 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb'
[0m15:26:55.073692 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m15:26:55.074033 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m15:26:55.074240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:55.078490 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m15:26:55.079435 [debug] [ThreadPool]: On list_salesdb: Close
[0m15:26:55.082924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb, now list_salesdb_public_raw_data)
[0m15:26:55.087341 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:26:55.088134 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m15:26:55.088317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:55.091268 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:26:55.091536 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:26:55.091735 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m15:26:55.093606 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m15:26:55.094466 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m15:26:55.094949 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m15:26:55.095409 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now list_salesdb_marts)
[0m15:26:55.096936 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m15:26:55.097171 [debug] [ThreadPool]: On list_salesdb_marts: BEGIN
[0m15:26:55.097346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:55.100095 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:26:55.100314 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m15:26:55.100495 [debug] [ThreadPool]: On list_salesdb_marts: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_marts"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m15:26:55.102128 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m15:26:55.102862 [debug] [ThreadPool]: On list_salesdb_marts: ROLLBACK
[0m15:26:55.103306 [debug] [ThreadPool]: On list_salesdb_marts: Close
[0m15:26:55.103711 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_marts, now list_salesdb_staging)
[0m15:26:55.105093 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m15:26:55.105297 [debug] [ThreadPool]: On list_salesdb_staging: BEGIN
[0m15:26:55.105516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:55.108075 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:26:55.108308 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m15:26:55.108482 [debug] [ThreadPool]: On list_salesdb_staging: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_staging"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m15:26:55.110093 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.001 seconds
[0m15:26:55.110897 [debug] [ThreadPool]: On list_salesdb_staging: ROLLBACK
[0m15:26:55.111289 [debug] [ThreadPool]: On list_salesdb_staging: Close
[0m15:26:55.114506 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:55.114789 [debug] [MainThread]: On master: BEGIN
[0m15:26:55.114955 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:26:55.117852 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:26:55.118118 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:55.118332 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:26:55.125536 [debug] [MainThread]: SQL status: SELECT 3 in 0.007 seconds
[0m15:26:55.126911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '555d7fd7-5ef3-4640-b31a-43a4fb04d1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e4d0514bd0>]}
[0m15:26:55.127284 [debug] [MainThread]: On master: ROLLBACK
[0m15:26:55.127765 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:55.127966 [debug] [MainThread]: On master: BEGIN
[0m15:26:55.128597 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:26:55.128850 [debug] [MainThread]: On master: COMMIT
[0m15:26:55.129050 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:55.129225 [debug] [MainThread]: On master: COMMIT
[0m15:26:55.129619 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:26:55.129864 [debug] [MainThread]: On master: Close
[0m15:26:55.131690 [debug] [Thread-1 (]: Began running node model.modelling_handson.type1_customers
[0m15:26:55.132043 [info ] [Thread-1 (]: 1 of 1 START sql table model marts.type1_customers ............................. [RUN]
[0m15:26:55.132357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_staging, now model.modelling_handson.type1_customers)
[0m15:26:55.132581 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.type1_customers
[0m15:26:55.137934 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.type1_customers"
[0m15:26:55.139431 [debug] [Thread-1 (]: Began executing node model.modelling_handson.type1_customers
[0m15:26:55.165483 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.type1_customers"
[0m15:26:55.166374 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.type1_customers"
[0m15:26:55.166671 [debug] [Thread-1 (]: On model.modelling_handson.type1_customers: BEGIN
[0m15:26:55.166903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:55.170124 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m15:26:55.170422 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.type1_customers"
[0m15:26:55.170676 [debug] [Thread-1 (]: On model.modelling_handson.type1_customers: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.type1_customers"} */

  
    

  create  table "salesdb"."marts"."type1_customers__dbt_tmp"
  
  
    as
  
  (
    

with base as (
    select * from "salesdb"."staging"."stg_customers_initial"
    union all
    select customer_nk,first_name,last_name,email,city,country,signup_ts
     from "salesdb"."staging"."stg_customers_day1"
    union all
    select customer_nk,first_name,last_name,email,city,country,signup_ts
     from "salesdb"."staging"."stg_customers_day2"
),
latest as (
    select customer_nk,first_name,last_name,email,city,country,signup_ts,
        coalesce(nullif('1900-01-01','1900-01-01')::timestamp, signup_ts) as change_ts
    from "salesdb"."staging"."stg_customers_initial"
    union all
    select customer_nk,first_name,last_name,email,city,country,signup_ts, change_ts
    from "salesdb"."staging"."stg_customers_day1"
    union all
    select customer_nk,first_name,last_name,email,city,country,signup_ts, change_ts
    from "salesdb"."staging"."stg_customers_day2"
),
ranked as (
    select *,
        row_number() over partition by customer_nk order by coalesce(change_ts, signup_ts) desc as rn
    from latest
)

select customer_nk, first_name, last_name, email, city, country, signup_ts
from ranked where rn =1


  );
  
[0m15:26:55.171315 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "by"
LINE 36:         row_number() over partition by customer_nk order by ...
                                             ^

[0m15:26:55.171599 [debug] [Thread-1 (]: On model.modelling_handson.type1_customers: ROLLBACK
[0m15:26:55.172118 [debug] [Thread-1 (]: On model.modelling_handson.type1_customers: Close
[0m15:26:55.174445 [debug] [Thread-1 (]: Database Error in model type1_customers (models/marts/type1_customers.sql)
  syntax error at or near "by"
  LINE 36:         row_number() over partition by customer_nk order by ...
                                               ^
  compiled code at target/run/modelling_handson/models/marts/type1_customers.sql
[0m15:26:55.175585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '555d7fd7-5ef3-4640-b31a-43a4fb04d1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e4d01c17d0>]}
[0m15:26:55.176071 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model marts.type1_customers .................... [[31mERROR[0m in 0.04s]
[0m15:26:55.176494 [debug] [Thread-1 (]: Finished running node model.modelling_handson.type1_customers
[0m15:26:55.176898 [debug] [Thread-4 (]: Marking all children of 'model.modelling_handson.type1_customers' to be skipped because of status 'error'.  Reason: Database Error in model type1_customers (models/marts/type1_customers.sql)
  syntax error at or near "by"
  LINE 36:         row_number() over partition by customer_nk order by ...
                                               ^
  compiled code at target/run/modelling_handson/models/marts/type1_customers.sql.
[0m15:26:55.178370 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:55.178613 [debug] [MainThread]: On master: BEGIN
[0m15:26:55.178796 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:26:55.181890 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:26:55.182170 [debug] [MainThread]: On master: COMMIT
[0m15:26:55.182365 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:55.182534 [debug] [MainThread]: On master: COMMIT
[0m15:26:55.182928 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:26:55.183203 [debug] [MainThread]: On master: Close
[0m15:26:55.183507 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:26:55.183685 [debug] [MainThread]: Connection 'model.modelling_handson.type1_customers' was properly closed.
[0m15:26:55.183869 [info ] [MainThread]: 
[0m15:26:55.184087 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m15:26:55.184719 [debug] [MainThread]: Command end result
[0m15:26:55.197944 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:26:55.199438 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:26:55.203781 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m15:26:55.204050 [info ] [MainThread]: 
[0m15:26:55.204311 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:26:55.204521 [info ] [MainThread]: 
[0m15:26:55.204760 [error] [MainThread]: [31mFailure in model type1_customers (models/marts/type1_customers.sql)[0m
[0m15:26:55.205008 [error] [MainThread]:   Database Error in model type1_customers (models/marts/type1_customers.sql)
  syntax error at or near "by"
  LINE 36:         row_number() over partition by customer_nk order by ...
                                               ^
  compiled code at target/run/modelling_handson/models/marts/type1_customers.sql
[0m15:26:55.205210 [info ] [MainThread]: 
[0m15:26:55.205494 [info ] [MainThread]:   compiled code at target/compiled/modelling_handson/models/marts/type1_customers.sql
[0m15:26:55.205691 [info ] [MainThread]: 
[0m15:26:55.205896 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:26:55.206300 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:26:55.207010 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.78925765, "process_in_blocks": "24", "process_kernel_time": 0.217885, "process_mem_max_rss": "125672", "process_out_blocks": "2704", "process_user_time": 1.613963}
[0m15:26:55.207346 [debug] [MainThread]: Command `dbt run` failed at 15:26:55.207267 after 0.79 seconds
[0m15:26:55.207594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e4d554ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e4d1040c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e4d5617e90>]}
[0m15:26:55.207825 [debug] [MainThread]: Flushing usage events
[0m15:26:56.855716 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:27:35.383834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd213495b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd213487750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd21348f3d0>]}


============================== 15:27:35.386410 | ea6fe061-14ab-4738-b7a7-f30cdd8b32fb ==============================
[0m15:27:35.386410 [info ] [MainThread]: Running with dbt=1.10.7
[0m15:27:35.386873 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'profiles_dir': '/home/subhan/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select type1_customers', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:27:35.426776 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:27:35.427274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ea6fe061-14ab-4738-b7a7-f30cdd8b32fb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd2134ec910>]}
[0m15:27:35.516805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea6fe061-14ab-4738-b7a7-f30cdd8b32fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd212ac14d0>]}
[0m15:27:35.564352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea6fe061-14ab-4738-b7a7-f30cdd8b32fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd212906f90>]}
[0m15:27:35.565111 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:27:35.618912 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m15:27:35.706016 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:27:35.706885 [debug] [MainThread]: Partial parsing: updated file: modelling_handson://models/marts/type1_customers.sql
[0m15:27:35.906308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea6fe061-14ab-4738-b7a7-f30cdd8b32fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd212568610>]}
[0m15:27:35.957145 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:27:35.958781 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:27:35.967213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea6fe061-14ab-4738-b7a7-f30cdd8b32fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd21243bb10>]}
[0m15:27:35.967686 [info ] [MainThread]: Found 3 seeds, 4 models, 3 sources, 435 macros
[0m15:27:35.967964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea6fe061-14ab-4738-b7a7-f30cdd8b32fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd212457450>]}
[0m15:27:35.969001 [info ] [MainThread]: 
[0m15:27:35.969378 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:27:35.969749 [info ] [MainThread]: 
[0m15:27:35.970213 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:27:35.971298 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb'
[0m15:27:36.045450 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m15:27:36.045795 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m15:27:36.046027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:36.050401 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m15:27:36.051488 [debug] [ThreadPool]: On list_salesdb: Close
[0m15:27:36.055186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb, now list_salesdb_staging)
[0m15:27:36.058970 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m15:27:36.059450 [debug] [ThreadPool]: On list_salesdb_staging: BEGIN
[0m15:27:36.059689 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:36.062901 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:27:36.063201 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m15:27:36.063419 [debug] [ThreadPool]: On list_salesdb_staging: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_staging"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m15:27:36.065281 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m15:27:36.066225 [debug] [ThreadPool]: On list_salesdb_staging: ROLLBACK
[0m15:27:36.066761 [debug] [ThreadPool]: On list_salesdb_staging: Close
[0m15:27:36.067243 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_staging, now list_salesdb_marts)
[0m15:27:36.069024 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m15:27:36.069260 [debug] [ThreadPool]: On list_salesdb_marts: BEGIN
[0m15:27:36.069444 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:36.072395 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:27:36.072709 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m15:27:36.072931 [debug] [ThreadPool]: On list_salesdb_marts: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_marts"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m15:27:36.074689 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m15:27:36.075578 [debug] [ThreadPool]: On list_salesdb_marts: ROLLBACK
[0m15:27:36.076061 [debug] [ThreadPool]: On list_salesdb_marts: Close
[0m15:27:36.076527 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_marts, now list_salesdb_public_raw_data)
[0m15:27:36.078169 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:27:36.078431 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m15:27:36.078620 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:36.081461 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:27:36.081718 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:27:36.081921 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m15:27:36.083593 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.001 seconds
[0m15:27:36.084413 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m15:27:36.084990 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m15:27:36.088455 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:36.088718 [debug] [MainThread]: On master: BEGIN
[0m15:27:36.089078 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:27:36.092292 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:27:36.092590 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:36.092835 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:27:36.101389 [debug] [MainThread]: SQL status: SELECT 3 in 0.008 seconds
[0m15:27:36.102744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea6fe061-14ab-4738-b7a7-f30cdd8b32fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd212439850>]}
[0m15:27:36.103113 [debug] [MainThread]: On master: ROLLBACK
[0m15:27:36.103718 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:36.103993 [debug] [MainThread]: On master: BEGIN
[0m15:27:36.104654 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:27:36.104918 [debug] [MainThread]: On master: COMMIT
[0m15:27:36.105162 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:36.105367 [debug] [MainThread]: On master: COMMIT
[0m15:27:36.105787 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:27:36.106065 [debug] [MainThread]: On master: Close
[0m15:27:36.108185 [debug] [Thread-1 (]: Began running node model.modelling_handson.type1_customers
[0m15:27:36.108699 [info ] [Thread-1 (]: 1 of 1 START sql table model marts.type1_customers ............................. [RUN]
[0m15:27:36.109183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now model.modelling_handson.type1_customers)
[0m15:27:36.109494 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.type1_customers
[0m15:27:36.115428 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.type1_customers"
[0m15:27:36.115963 [debug] [Thread-1 (]: Began executing node model.modelling_handson.type1_customers
[0m15:27:36.147219 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.type1_customers"
[0m15:27:36.147939 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.type1_customers"
[0m15:27:36.148261 [debug] [Thread-1 (]: On model.modelling_handson.type1_customers: BEGIN
[0m15:27:36.148528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:36.152396 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:27:36.152760 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.type1_customers"
[0m15:27:36.153083 [debug] [Thread-1 (]: On model.modelling_handson.type1_customers: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.type1_customers"} */

  
    

  create  table "salesdb"."marts"."type1_customers__dbt_tmp"
  
  
    as
  
  (
    

with base as (
    select * from "salesdb"."staging"."stg_customers_initial"
    union all
    select customer_nk,first_name,last_name,email,city,country,signup_ts
     from "salesdb"."staging"."stg_customers_day1"
    union all
    select customer_nk,first_name,last_name,email,city,country,signup_ts
     from "salesdb"."staging"."stg_customers_day2"
),
latest as (
    select customer_nk,first_name,last_name,email,city,country,signup_ts,
        coalesce(nullif('1900-01-01','1900-01-01')::timestamp, signup_ts) as change_ts
    from "salesdb"."staging"."stg_customers_initial"
    union all
    select customer_nk,first_name,last_name,email,city,country,signup_ts, change_ts
    from "salesdb"."staging"."stg_customers_day1"
    union all
    select customer_nk,first_name,last_name,email,city,country,signup_ts, change_ts
    from "salesdb"."staging"."stg_customers_day2"
),
ranked as (
    select *,
        row_number() over (partition by customer_nk order by coalesce(change_ts, signup_ts) desc) as rn
    from latest
)

select customer_nk, first_name, last_name, email, city, country, signup_ts
from ranked where rn =1


  );
  
[0m15:27:36.157483 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.004 seconds
[0m15:27:36.164866 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.type1_customers"
[0m15:27:36.165282 [debug] [Thread-1 (]: On model.modelling_handson.type1_customers: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.type1_customers"} */
alter table "salesdb"."marts"."type1_customers__dbt_tmp" rename to "type1_customers"
[0m15:27:36.166212 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:27:36.175964 [debug] [Thread-1 (]: On model.modelling_handson.type1_customers: COMMIT
[0m15:27:36.176371 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.type1_customers"
[0m15:27:36.176627 [debug] [Thread-1 (]: On model.modelling_handson.type1_customers: COMMIT
[0m15:27:36.177931 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:27:36.183156 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."marts"."type1_customers__dbt_backup"
[0m15:27:36.187615 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.type1_customers"
[0m15:27:36.187986 [debug] [Thread-1 (]: On model.modelling_handson.type1_customers: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.type1_customers"} */
drop table if exists "salesdb"."marts"."type1_customers__dbt_backup" cascade
[0m15:27:36.188804 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m15:27:36.190923 [debug] [Thread-1 (]: On model.modelling_handson.type1_customers: Close
[0m15:27:36.192381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea6fe061-14ab-4738-b7a7-f30cdd8b32fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd211909550>]}
[0m15:27:36.193068 [info ] [Thread-1 (]: 1 of 1 OK created sql table model marts.type1_customers ........................ [[32mSELECT 6[0m in 0.08s]
[0m15:27:36.193594 [debug] [Thread-1 (]: Finished running node model.modelling_handson.type1_customers
[0m15:27:36.194892 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:36.195166 [debug] [MainThread]: On master: BEGIN
[0m15:27:36.195382 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:27:36.199193 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:27:36.199507 [debug] [MainThread]: On master: COMMIT
[0m15:27:36.199784 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:36.199976 [debug] [MainThread]: On master: COMMIT
[0m15:27:36.200459 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:27:36.200761 [debug] [MainThread]: On master: Close
[0m15:27:36.201302 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:27:36.201578 [debug] [MainThread]: Connection 'model.modelling_handson.type1_customers' was properly closed.
[0m15:27:36.201826 [info ] [MainThread]: 
[0m15:27:36.202071 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m15:27:36.202668 [debug] [MainThread]: Command end result
[0m15:27:36.220953 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:27:36.222659 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:27:36.228314 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m15:27:36.228614 [info ] [MainThread]: 
[0m15:27:36.229294 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:27:36.229645 [info ] [MainThread]: 
[0m15:27:36.229936 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:27:36.230416 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:27:36.231218 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8966646, "process_in_blocks": "0", "process_kernel_time": 0.137984, "process_mem_max_rss": "124780", "process_out_blocks": "2696", "process_user_time": 1.77756}
[0m15:27:36.231591 [debug] [MainThread]: Command `dbt run` succeeded at 15:27:36.231501 after 0.90 seconds
[0m15:27:36.231897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd2135b6d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd2134e7710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd21794ec50>]}
[0m15:27:36.232184 [debug] [MainThread]: Flushing usage events
[0m15:27:37.800166 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:43:48.465418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730700ddfe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730700f9aed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730700e177d0>]}


============================== 15:43:48.467985 | 410deb8e-69ab-42e7-a7e8-513846aa5a6e ==============================
[0m15:43:48.467985 [info ] [MainThread]: Running with dbt=1.10.7
[0m15:43:48.468438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'profiles_dir': '/home/subhan/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:43:48.507410 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:43:48.507834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '410deb8e-69ab-42e7-a7e8-513846aa5a6e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730700e44110>]}
[0m15:43:48.588833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '410deb8e-69ab-42e7-a7e8-513846aa5a6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730700416a90>]}
[0m15:43:48.629411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '410deb8e-69ab-42e7-a7e8-513846aa5a6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730703aa7590>]}
[0m15:43:48.630021 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:43:48.676612 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m15:43:48.748251 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m15:43:48.748710 [debug] [MainThread]: Partial parsing: added file: modelling_handson://snapshots/customers_scd2.sql
[0m15:43:48.748935 [debug] [MainThread]: Partial parsing: added file: modelling_handson://models/staging/stg_customers_latest.sql
[0m15:43:48.999674 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.modelling_handson.customers_scd2' (snapshots/customers_scd2.sql) depends on a node named 'stg_customers_latest.sql' which was not found
[0m15:43:49.000237 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:43:49.000889 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.5756804, "process_in_blocks": "0", "process_kernel_time": 0.158775, "process_mem_max_rss": "121280", "process_out_blocks": "16", "process_user_time": 1.441193}
[0m15:43:49.001197 [debug] [MainThread]: Command `dbt seed` failed at 15:43:49.001132 after 0.58 seconds
[0m15:43:49.001428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730700e44c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73070534eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730700ddef90>]}
[0m15:43:49.001668 [debug] [MainThread]: Flushing usage events
[0m15:43:50.632137 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:44:19.015363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7032ba0c7d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7032ba1f2f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7032bb0cbe90>]}


============================== 15:44:19.017658 | aebfa374-acd2-4ba0-aef4-2bd6ff75382a ==============================
[0m15:44:19.017658 [info ] [MainThread]: Running with dbt=1.10.7
[0m15:44:19.018057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/subhan/.dbt', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m15:44:19.053085 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:44:19.053609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'aebfa374-acd2-4ba0-aef4-2bd6ff75382a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7032ba11fd90>]}
[0m15:44:19.133703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aebfa374-acd2-4ba0-aef4-2bd6ff75382a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7032b9712d10>]}
[0m15:44:19.176074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aebfa374-acd2-4ba0-aef4-2bd6ff75382a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7032bcd31910>]}
[0m15:44:19.176839 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:44:19.228701 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m15:44:19.300046 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m15:44:19.300484 [debug] [MainThread]: Partial parsing: added file: modelling_handson://models/staging/stg_customers_latest.sql
[0m15:44:19.300717 [debug] [MainThread]: Partial parsing: added file: modelling_handson://snapshots/customers_scd2.sql
[0m15:44:19.572160 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.modelling_handson.customers_scd2' (snapshots/customers_scd2.sql) depends on a node named 'stg_customers_latest.sql' which was not found
[0m15:44:19.573146 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:44:19.574141 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.5981846, "process_in_blocks": "0", "process_kernel_time": 0.149918, "process_mem_max_rss": "121292", "process_out_blocks": "16", "process_user_time": 1.478927}
[0m15:44:19.574659 [debug] [MainThread]: Command `dbt snapshot` failed at 15:44:19.574551 after 0.60 seconds
[0m15:44:19.575027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7032be652b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7032ba1258d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7032b9ff7910>]}
[0m15:44:19.575373 [debug] [MainThread]: Flushing usage events
[0m15:44:21.356246 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:44:42.202687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2a48e1b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2a48cf750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2a4b9d0d0>]}


============================== 15:44:42.204830 | b936b23c-b377-4316-a9a4-bde45fa54d45 ==============================
[0m15:44:42.204830 [info ] [MainThread]: Running with dbt=1.10.7
[0m15:44:42.205222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/subhan/.dbt', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_customers_latest', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:44:42.239439 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:44:42.239859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b936b23c-b377-4316-a9a4-bde45fa54d45', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2a492f750>]}
[0m15:44:42.323974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b936b23c-b377-4316-a9a4-bde45fa54d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2a4907810>]}
[0m15:44:42.362932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b936b23c-b377-4316-a9a4-bde45fa54d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2a4916f90>]}
[0m15:44:42.363646 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:44:42.413274 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m15:44:42.482097 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m15:44:42.482542 [debug] [MainThread]: Partial parsing: added file: modelling_handson://models/staging/stg_customers_latest.sql
[0m15:44:42.482823 [debug] [MainThread]: Partial parsing: added file: modelling_handson://snapshots/customers_scd2.sql
[0m15:44:42.740730 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.modelling_handson.customers_scd2' (snapshots/customers_scd2.sql) depends on a node named 'stg_customers_latest.sql' which was not found
[0m15:44:42.741383 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:44:42.742354 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.57777494, "process_in_blocks": "0", "process_kernel_time": 0.186416, "process_mem_max_rss": "121328", "process_out_blocks": "8", "process_user_time": 1.385964}
[0m15:44:42.742695 [debug] [MainThread]: Command `dbt run` failed at 15:44:42.742632 after 0.58 seconds
[0m15:44:42.743001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2a8e52b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2a4906ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2a390e390>]}
[0m15:44:42.743294 [debug] [MainThread]: Flushing usage events
[0m15:44:44.255799 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:46:36.892397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3566032310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3566033b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b356618ef10>]}


============================== 15:46:36.894465 | d09d501f-9509-4d84-90f7-bbff2f61f351 ==============================
[0m15:46:36.894465 [info ] [MainThread]: Running with dbt=1.10.7
[0m15:46:36.894867 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/subhan/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:46:36.895673 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:46:36.896004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd09d501f-9509-4d84-90f7-bbff2f61f351', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b356618eed0>]}
[0m15:46:36.974008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd09d501f-9509-4d84-90f7-bbff2f61f351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3565f03fd0>]}
[0m15:46:36.986130 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:46:36.986810 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.12964502, "process_in_blocks": "136", "process_kernel_time": 0.175863, "process_mem_max_rss": "104968", "process_out_blocks": "16", "process_user_time": 0.935273}
[0m15:46:36.987164 [debug] [MainThread]: Command `dbt clean` succeeded at 15:46:36.987093 after 0.13 seconds
[0m15:46:36.987397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3565fdad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b356a44eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b356a517f90>]}
[0m15:46:36.987714 [debug] [MainThread]: Flushing usage events
[0m15:46:38.519719 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:46:42.283794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ab9f885b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ab9cf453d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ab9cc83b10>]}


============================== 15:46:42.285852 | 57baa67c-4b07-4e39-8231-7be25186c25b ==============================
[0m15:46:42.285852 [info ] [MainThread]: Running with dbt=1.10.7
[0m15:46:42.286208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'profiles_dir': '/home/subhan/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:46:42.287101 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:46:42.287415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '57baa67c-4b07-4e39-8231-7be25186c25b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ab9cce2b90>]}
[0m15:46:42.364113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57baa67c-4b07-4e39-8231-7be25186c25b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ab9cce3950>]}
[0m15:46:42.371809 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:46:42.372543 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:46:42.373075 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:46:42.373785 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.12693627, "process_in_blocks": "0", "process_kernel_time": 0.149689, "process_mem_max_rss": "104988", "process_out_blocks": "8", "process_user_time": 0.938591}
[0m15:46:42.374086 [debug] [MainThread]: Command `dbt deps` succeeded at 15:46:42.374024 after 0.13 seconds
[0m15:46:42.374310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ab9cce3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72aba114eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72aba1217f90>]}
[0m15:46:42.374565 [debug] [MainThread]: Flushing usage events
[0m15:46:43.866379 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:46:47.626821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794b7bd98790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794b7bdc7310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794b7bdf2dd0>]}


============================== 15:46:47.628912 | 66d9aaf4-23ac-4c7d-adea-a01fe003bd68 ==============================
[0m15:46:47.628912 [info ] [MainThread]: Running with dbt=1.10.7
[0m15:46:47.629265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/subhan/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt parse', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:46:47.667526 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:46:47.667977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '66d9aaf4-23ac-4c7d-adea-a01fe003bd68', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794b7bdf2e50>]}
[0m15:46:47.748891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66d9aaf4-23ac-4c7d-adea-a01fe003bd68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794b7bdc7410>]}
[0m15:46:47.791386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66d9aaf4-23ac-4c7d-adea-a01fe003bd68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794b7e9bb890>]}
[0m15:46:47.791996 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:46:47.843372 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m15:46:47.843824 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:46:47.844087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '66d9aaf4-23ac-4c7d-adea-a01fe003bd68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794b7bc433d0>]}
[0m15:46:48.730568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66d9aaf4-23ac-4c7d-adea-a01fe003bd68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794b1ebd29d0>]}
[0m15:46:48.733214 [info ] [MainThread]: Performance info: /home/subhan/dbt/modelling_handson/target/perf_info.json
[0m15:46:48.791927 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:46:48.793178 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:46:48.793559 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:46:48.794273 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 1.2043574, "process_in_blocks": "0", "process_kernel_time": 0.138486, "process_mem_max_rss": "124048", "process_out_blocks": "1768", "process_user_time": 2.10174}
[0m15:46:48.794622 [debug] [MainThread]: Command `dbt parse` succeeded at 15:46:48.794557 after 1.20 seconds
[0m15:46:48.794869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794b80303a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794b7b3efed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794b80325090>]}
[0m15:46:48.795124 [debug] [MainThread]: Flushing usage events
[0m15:46:50.305621 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:47:03.790608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a142bed0410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a142bec45d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a142bec7190>]}


============================== 15:47:03.792839 | 556224c4-779b-45a1-bfaf-3f7539632781 ==============================
[0m15:47:03.792839 [info ] [MainThread]: Running with dbt=1.10.7
[0m15:47:03.793286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'debug': 'False', 'profiles_dir': '/home/subhan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_customers_latest', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:47:03.825314 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:47:03.825710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '556224c4-779b-45a1-bfaf-3f7539632781', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a142bdfa890>]}
[0m15:47:03.924260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '556224c4-779b-45a1-bfaf-3f7539632781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a142b58eb10>]}
[0m15:47:03.965023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '556224c4-779b-45a1-bfaf-3f7539632781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a142eb3b110>]}
[0m15:47:03.965599 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:47:04.015400 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m15:47:04.093718 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:47:04.093995 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:47:04.146068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '556224c4-779b-45a1-bfaf-3f7539632781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a142b25b450>]}
[0m15:47:04.212574 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:47:04.213644 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:47:04.221095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '556224c4-779b-45a1-bfaf-3f7539632781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a142b550d50>]}
[0m15:47:04.221527 [info ] [MainThread]: Found 5 models, 1 snapshot, 3 seeds, 3 sources, 435 macros
[0m15:47:04.221954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '556224c4-779b-45a1-bfaf-3f7539632781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a142b364390>]}
[0m15:47:04.223087 [info ] [MainThread]: 
[0m15:47:04.223520 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:47:04.223903 [info ] [MainThread]: 
[0m15:47:04.224228 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:47:04.225080 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb'
[0m15:47:04.249083 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m15:47:04.249432 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m15:47:04.249630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:04.253879 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m15:47:04.254863 [debug] [ThreadPool]: On list_salesdb: Close
[0m15:47:04.258601 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb, now list_salesdb_marts)
[0m15:47:04.262651 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m15:47:04.262897 [debug] [ThreadPool]: On list_salesdb_marts: BEGIN
[0m15:47:04.263068 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:04.266479 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:47:04.266711 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m15:47:04.266894 [debug] [ThreadPool]: On list_salesdb_marts: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_marts"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m15:47:04.268646 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m15:47:04.269573 [debug] [ThreadPool]: On list_salesdb_marts: ROLLBACK
[0m15:47:04.270345 [debug] [ThreadPool]: On list_salesdb_marts: Close
[0m15:47:04.270767 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_marts, now list_salesdb_public_raw_data)
[0m15:47:04.271988 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:47:04.272725 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m15:47:04.272970 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:04.275692 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:47:04.275907 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:47:04.276084 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m15:47:04.277779 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.001 seconds
[0m15:47:04.278529 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m15:47:04.278948 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m15:47:04.279351 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now list_salesdb_staging)
[0m15:47:04.280790 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m15:47:04.281023 [debug] [ThreadPool]: On list_salesdb_staging: BEGIN
[0m15:47:04.281181 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:04.283689 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m15:47:04.283961 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m15:47:04.284141 [debug] [ThreadPool]: On list_salesdb_staging: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_staging"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m15:47:04.285599 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.001 seconds
[0m15:47:04.286345 [debug] [ThreadPool]: On list_salesdb_staging: ROLLBACK
[0m15:47:04.286739 [debug] [ThreadPool]: On list_salesdb_staging: Close
[0m15:47:04.287107 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_staging, now list_salesdb_snapshots)
[0m15:47:04.288550 [debug] [ThreadPool]: Using postgres connection "list_salesdb_snapshots"
[0m15:47:04.288759 [debug] [ThreadPool]: On list_salesdb_snapshots: BEGIN
[0m15:47:04.288938 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:04.291350 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m15:47:04.291581 [debug] [ThreadPool]: Using postgres connection "list_salesdb_snapshots"
[0m15:47:04.291761 [debug] [ThreadPool]: On list_salesdb_snapshots: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_snapshots"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:47:04.293214 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m15:47:04.293960 [debug] [ThreadPool]: On list_salesdb_snapshots: ROLLBACK
[0m15:47:04.294368 [debug] [ThreadPool]: On list_salesdb_snapshots: Close
[0m15:47:04.297077 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:04.297290 [debug] [MainThread]: On master: BEGIN
[0m15:47:04.297451 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:47:04.300237 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:47:04.300480 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:04.300701 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:47:04.308122 [debug] [MainThread]: SQL status: SELECT 3 in 0.007 seconds
[0m15:47:04.309774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '556224c4-779b-45a1-bfaf-3f7539632781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a142a624a50>]}
[0m15:47:04.310154 [debug] [MainThread]: On master: ROLLBACK
[0m15:47:04.310743 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:04.311001 [debug] [MainThread]: On master: BEGIN
[0m15:47:04.311592 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:47:04.311841 [debug] [MainThread]: On master: COMMIT
[0m15:47:04.312028 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:04.312195 [debug] [MainThread]: On master: COMMIT
[0m15:47:04.312864 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:47:04.313185 [debug] [MainThread]: On master: Close
[0m15:47:04.315444 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_customers_latest
[0m15:47:04.315840 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_customers_latest ....................... [RUN]
[0m15:47:04.316185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_snapshots, now model.modelling_handson.stg_customers_latest)
[0m15:47:04.316398 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_customers_latest
[0m15:47:04.321317 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_customers_latest"
[0m15:47:04.322484 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_customers_latest
[0m15:47:04.378060 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_customers_latest"
[0m15:47:04.379042 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_latest"
[0m15:47:04.379295 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_latest: BEGIN
[0m15:47:04.379495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:04.382521 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m15:47:04.382809 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_latest"
[0m15:47:04.383044 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_latest: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_customers_latest"} */

  create view "salesdb"."staging"."stg_customers_latest__dbt_tmp"
    
    
  as (
    with unioned as (
    customer_nk,first_name,last_name,email,city,country,signup_ts, null::timestamp as change_ts
    from "salesdb"."staging"."stg_customers_initial"
    union all
    select customer_nk,first_name,last_name,email,city,country,signup_ts, change_ts
    from "salesdb"."staging"."stg_customers_day1"
    union all
    select customer_nk,first_name,last_name,email,city,country,signup_ts, change_ts
    from "salesdb"."staging"."stg_customers_day2"
),
ranked as (
    select *,
        row_number() over (partition by customer_nk order by coalesce(change_ts, signup_ts) desc) as rn
    from unioned
)
select customer_nk, first_name, last_name, email, city, country, signup_ts
from ranked where rn = 1
  );
[0m15:47:04.383627 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "customer_nk"
LINE 8:     customer_nk,first_name,last_name,email,city,country,sign...
            ^

[0m15:47:04.383859 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_latest: ROLLBACK
[0m15:47:04.384328 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_latest: Close
[0m15:47:04.386758 [debug] [Thread-1 (]: Database Error in model stg_customers_latest (models/staging/stg_customers_latest.sql)
  syntax error at or near "customer_nk"
  LINE 8:     customer_nk,first_name,last_name,email,city,country,sign...
              ^
  compiled code at target/run/modelling_handson/models/staging/stg_customers_latest.sql
[0m15:47:04.388600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '556224c4-779b-45a1-bfaf-3f7539632781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a142a4e5d10>]}
[0m15:47:04.389202 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model staging.stg_customers_latest .............. [[31mERROR[0m in 0.07s]
[0m15:47:04.389670 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_customers_latest
[0m15:47:04.390122 [debug] [Thread-4 (]: Marking all children of 'model.modelling_handson.stg_customers_latest' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers_latest (models/staging/stg_customers_latest.sql)
  syntax error at or near "customer_nk"
  LINE 8:     customer_nk,first_name,last_name,email,city,country,sign...
              ^
  compiled code at target/run/modelling_handson/models/staging/stg_customers_latest.sql.
[0m15:47:04.391628 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:04.391849 [debug] [MainThread]: On master: BEGIN
[0m15:47:04.392013 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:47:04.396049 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:47:04.396395 [debug] [MainThread]: On master: COMMIT
[0m15:47:04.396735 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:04.396958 [debug] [MainThread]: On master: COMMIT
[0m15:47:04.397386 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:47:04.397628 [debug] [MainThread]: On master: Close
[0m15:47:04.398015 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:04.398191 [debug] [MainThread]: Connection 'model.modelling_handson.stg_customers_latest' was properly closed.
[0m15:47:04.398445 [info ] [MainThread]: 
[0m15:47:04.398828 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m15:47:04.399295 [debug] [MainThread]: Command end result
[0m15:47:04.415332 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:47:04.416741 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:47:04.420838 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m15:47:04.421515 [info ] [MainThread]: 
[0m15:47:04.421827 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:47:04.422032 [info ] [MainThread]: 
[0m15:47:04.422290 [error] [MainThread]: [31mFailure in model stg_customers_latest (models/staging/stg_customers_latest.sql)[0m
[0m15:47:04.422656 [error] [MainThread]:   Database Error in model stg_customers_latest (models/staging/stg_customers_latest.sql)
  syntax error at or near "customer_nk"
  LINE 8:     customer_nk,first_name,last_name,email,city,country,sign...
              ^
  compiled code at target/run/modelling_handson/models/staging/stg_customers_latest.sql
[0m15:47:04.422967 [info ] [MainThread]: 
[0m15:47:04.423252 [info ] [MainThread]:   compiled code at target/compiled/modelling_handson/models/staging/stg_customers_latest.sql
[0m15:47:04.423456 [info ] [MainThread]: 
[0m15:47:04.423656 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:47:04.423955 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:47:04.424522 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6737337, "process_in_blocks": "0", "process_kernel_time": 0.167844, "process_mem_max_rss": "122260", "process_out_blocks": "1864", "process_user_time": 1.454654}
[0m15:47:04.424798 [debug] [MainThread]: Command `dbt run` failed at 15:47:04.424745 after 0.67 seconds
[0m15:47:04.425020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a142dc1f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1430452b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1430452b10>]}
[0m15:47:04.425240 [debug] [MainThread]: Flushing usage events
[0m15:47:05.959917 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:48:27.581687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6cf9ddbad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6cf9f8ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6cf9e32b50>]}


============================== 15:48:27.585015 | 5711cfb7-f6e9-4258-84d0-09f4f58245ca ==============================
[0m15:48:27.585015 [info ] [MainThread]: Running with dbt=1.10.7
[0m15:48:27.585418 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/subhan/.dbt', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_customers_latest', 'send_anonymous_usage_stats': 'True'}
[0m15:48:27.653701 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:48:27.654141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5711cfb7-f6e9-4258-84d0-09f4f58245ca', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6cf9c7c510>]}
[0m15:48:27.761334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5711cfb7-f6e9-4258-84d0-09f4f58245ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6cf944d890>]}
[0m15:48:27.809401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5711cfb7-f6e9-4258-84d0-09f4f58245ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6cfca5fa90>]}
[0m15:48:27.810235 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:48:27.857360 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m15:48:27.971133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:48:27.971588 [debug] [MainThread]: Partial parsing: updated file: modelling_handson://snapshots/customers_scd2.sql
[0m15:48:27.971923 [debug] [MainThread]: Partial parsing: updated file: modelling_handson://models/staging/stg_customers_latest.sql
[0m15:48:28.225857 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot customers_scd2 (snapshots/customers_scd2.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m15:48:28.226374 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:48:28.228890 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6859338, "process_in_blocks": "103528", "process_kernel_time": 0.223591, "process_mem_max_rss": "119668", "process_out_blocks": "16", "process_user_time": 1.53928}
[0m15:48:28.229257 [debug] [MainThread]: Command `dbt run` failed at 15:48:28.229188 after 0.69 seconds
[0m15:48:28.229521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6cfe24ec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6cf9f05b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6cf9f8e610>]}
[0m15:48:28.229795 [debug] [MainThread]: Flushing usage events
[0m15:48:29.839717 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:50:05.554024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd2547dbe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd25498ef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd2547db990>]}


============================== 15:50:05.556112 | 5bb6e251-ca4e-486d-8148-cd13cee38d45 ==============================
[0m15:50:05.556112 [info ] [MainThread]: Running with dbt=1.10.7
[0m15:50:05.556489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/subhan/.dbt', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m15:50:05.593281 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:50:05.593731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5bb6e251-ca4e-486d-8148-cd13cee38d45', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd25467c890>]}
[0m15:50:05.670187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bb6e251-ca4e-486d-8148-cd13cee38d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd253db9890>]}
[0m15:50:05.710316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bb6e251-ca4e-486d-8148-cd13cee38d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd2573fd610>]}
[0m15:50:05.710913 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:50:05.756453 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m15:50:05.865493 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:50:05.866109 [debug] [MainThread]: Partial parsing: updated file: modelling_handson://snapshots/customers_scd2.sql
[0m15:50:05.866498 [debug] [MainThread]: Partial parsing: updated file: modelling_handson://models/staging/stg_customers_latest.sql
[0m15:50:06.119409 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.modelling_handson.stg_customers_latest' (models/staging/stg_customers_latest.sql) depends on a node named 'stg_customers_changes_day1' which was not found
[0m15:50:06.119946 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:50:06.120616 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.6018625, "process_in_blocks": "0", "process_kernel_time": 0.145058, "process_mem_max_rss": "120564", "process_out_blocks": "16", "process_user_time": 1.42641}
[0m15:50:06.120940 [debug] [MainThread]: Command `dbt snapshot` failed at 15:50:06.120875 after 0.60 seconds
[0m15:50:06.121194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd258c4eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd254814d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd25498e610>]}
[0m15:50:06.121452 [debug] [MainThread]: Flushing usage events
[0m15:50:07.610975 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:51:01.107830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b5d2ac7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b5d2b07b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b5d2af7390>]}


============================== 15:51:01.110096 | 93061005-09cb-4b7a-8c3a-01394c6eb0c8 ==============================
[0m15:51:01.110096 [info ] [MainThread]: Running with dbt=1.10.7
[0m15:51:01.110479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/subhan/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m15:51:01.147171 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:51:01.147607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '93061005-09cb-4b7a-8c3a-01394c6eb0c8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b5d2b1fdd0>]}
[0m15:51:01.226110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93061005-09cb-4b7a-8c3a-01394c6eb0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b5d296ab10>]}
[0m15:51:01.269219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93061005-09cb-4b7a-8c3a-01394c6eb0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b5d5733290>]}
[0m15:51:01.269849 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:51:01.316646 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m15:51:01.401032 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:51:01.401522 [debug] [MainThread]: Partial parsing: updated file: modelling_handson://models/staging/stg_customers_latest.sql
[0m15:51:01.401859 [debug] [MainThread]: Partial parsing: updated file: modelling_handson://snapshots/customers_scd2.sql
[0m15:51:01.709934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93061005-09cb-4b7a-8c3a-01394c6eb0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b5d1dac810>]}
[0m15:51:01.818687 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:51:01.821438 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:51:01.845278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93061005-09cb-4b7a-8c3a-01394c6eb0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b5d1dbb710>]}
[0m15:51:01.845708 [info ] [MainThread]: Found 5 models, 3 seeds, 1 snapshot, 3 sources, 435 macros
[0m15:51:01.845984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93061005-09cb-4b7a-8c3a-01394c6eb0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b5d01448d0>]}
[0m15:51:01.847259 [info ] [MainThread]: 
[0m15:51:01.847623 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:51:01.847871 [info ] [MainThread]: 
[0m15:51:01.848204 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:51:01.848868 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb'
[0m15:51:01.875638 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m15:51:01.875972 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m15:51:01.876154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:01.881233 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.005 seconds
[0m15:51:01.882159 [debug] [ThreadPool]: On list_salesdb: Close
[0m15:51:01.882935 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb, now create_salesdb_snapshots)
[0m15:51:01.883318 [debug] [ThreadPool]: Creating schema "database: "salesdb"
schema: "snapshots"
"
[0m15:51:01.886816 [debug] [ThreadPool]: Using postgres connection "create_salesdb_snapshots"
[0m15:51:01.887151 [debug] [ThreadPool]: On create_salesdb_snapshots: BEGIN
[0m15:51:01.887357 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:01.891752 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:51:01.892038 [debug] [ThreadPool]: Using postgres connection "create_salesdb_snapshots"
[0m15:51:01.892246 [debug] [ThreadPool]: On create_salesdb_snapshots: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "create_salesdb_snapshots"} */
create schema if not exists "snapshots"
[0m15:51:01.893656 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m15:51:01.894283 [debug] [ThreadPool]: On create_salesdb_snapshots: COMMIT
[0m15:51:01.894534 [debug] [ThreadPool]: Using postgres connection "create_salesdb_snapshots"
[0m15:51:01.894777 [debug] [ThreadPool]: On create_salesdb_snapshots: COMMIT
[0m15:51:01.895890 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m15:51:01.896132 [debug] [ThreadPool]: On create_salesdb_snapshots: Close
[0m15:51:01.899719 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_salesdb_snapshots, now list_salesdb_public_raw_data)
[0m15:51:01.903640 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:51:01.903902 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m15:51:01.904080 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:01.907650 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:51:01.908015 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:51:01.908260 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m15:51:01.910108 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m15:51:01.911208 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m15:51:01.912044 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m15:51:01.912830 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now list_salesdb_snapshots)
[0m15:51:01.914172 [debug] [ThreadPool]: Using postgres connection "list_salesdb_snapshots"
[0m15:51:01.914918 [debug] [ThreadPool]: On list_salesdb_snapshots: BEGIN
[0m15:51:01.915181 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:01.918792 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:51:01.919107 [debug] [ThreadPool]: Using postgres connection "list_salesdb_snapshots"
[0m15:51:01.919316 [debug] [ThreadPool]: On list_salesdb_snapshots: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_snapshots"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:51:01.921543 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m15:51:01.922372 [debug] [ThreadPool]: On list_salesdb_snapshots: ROLLBACK
[0m15:51:01.922813 [debug] [ThreadPool]: On list_salesdb_snapshots: Close
[0m15:51:01.923248 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_snapshots, now list_salesdb_marts)
[0m15:51:01.924632 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m15:51:01.924888 [debug] [ThreadPool]: On list_salesdb_marts: BEGIN
[0m15:51:01.925129 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:01.927929 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:51:01.928212 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m15:51:01.928419 [debug] [ThreadPool]: On list_salesdb_marts: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_marts"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m15:51:01.929986 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.001 seconds
[0m15:51:01.930772 [debug] [ThreadPool]: On list_salesdb_marts: ROLLBACK
[0m15:51:01.931158 [debug] [ThreadPool]: On list_salesdb_marts: Close
[0m15:51:01.931582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_marts, now list_salesdb_staging)
[0m15:51:01.932925 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m15:51:01.933547 [debug] [ThreadPool]: On list_salesdb_staging: BEGIN
[0m15:51:01.933851 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:01.936464 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:51:01.936785 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m15:51:01.937090 [debug] [ThreadPool]: On list_salesdb_staging: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_staging"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m15:51:01.938735 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.001 seconds
[0m15:51:01.939536 [debug] [ThreadPool]: On list_salesdb_staging: ROLLBACK
[0m15:51:01.939960 [debug] [ThreadPool]: On list_salesdb_staging: Close
[0m15:51:01.943490 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:01.943705 [debug] [MainThread]: On master: BEGIN
[0m15:51:01.943887 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:51:01.946682 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:51:01.946944 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:01.947185 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:51:01.954503 [debug] [MainThread]: SQL status: SELECT 3 in 0.007 seconds
[0m15:51:01.956296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93061005-09cb-4b7a-8c3a-01394c6eb0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b5a0f5fbd0>]}
[0m15:51:01.956651 [debug] [MainThread]: On master: ROLLBACK
[0m15:51:01.957183 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:01.957401 [debug] [MainThread]: On master: BEGIN
[0m15:51:01.957995 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:51:01.958290 [debug] [MainThread]: On master: COMMIT
[0m15:51:01.958521 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:01.958736 [debug] [MainThread]: On master: COMMIT
[0m15:51:01.959255 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:51:01.959551 [debug] [MainThread]: On master: Close
[0m15:51:01.962989 [debug] [Thread-1 (]: Began running node snapshot.modelling_handson.customers_scd2
[0m15:51:01.963431 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customers_scd2 ................................. [RUN]
[0m15:51:01.963856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_staging, now snapshot.modelling_handson.customers_scd2)
[0m15:51:01.964086 [debug] [Thread-1 (]: Began compiling node snapshot.modelling_handson.customers_scd2
[0m15:51:01.970421 [debug] [Thread-1 (]: Began executing node snapshot.modelling_handson.customers_scd2
[0m15:51:02.023924 [debug] [Thread-1 (]: Using postgres connection "snapshot.modelling_handson.customers_scd2"
[0m15:51:02.024482 [debug] [Thread-1 (]: On snapshot.modelling_handson.customers_scd2: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "snapshot.modelling_handson.customers_scd2"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(customer_nk as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        


select
    customer_nk,
    first_name,
    last_name,
    email,
    city,
    country,
    signup_ts
    from "salesdb"."staging"."stg_customers_latest"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m15:51:02.024727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:02.027810 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging.stg_customers_latest" does not exist
LINE 28:     from "salesdb"."staging"."stg_customers_latest"
                  ^

[0m15:51:02.028203 [debug] [Thread-1 (]: On snapshot.modelling_handson.customers_scd2: Close
[0m15:51:02.034174 [debug] [Thread-1 (]: Database Error in snapshot customers_scd2 (snapshots/customers_scd2.sql)
  relation "staging.stg_customers_latest" does not exist
  LINE 28:     from "salesdb"."staging"."stg_customers_latest"
                    ^
[0m15:51:02.035453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93061005-09cb-4b7a-8c3a-01394c6eb0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b5a0e037d0>]}
[0m15:51:02.036195 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshots.customers_scd2 ............................. [[31mERROR[0m in 0.07s]
[0m15:51:02.036633 [debug] [Thread-1 (]: Finished running node snapshot.modelling_handson.customers_scd2
[0m15:51:02.037047 [debug] [Thread-4 (]: Marking all children of 'snapshot.modelling_handson.customers_scd2' to be skipped because of status 'error'.  Reason: Database Error in snapshot customers_scd2 (snapshots/customers_scd2.sql)
  relation "staging.stg_customers_latest" does not exist
  LINE 28:     from "salesdb"."staging"."stg_customers_latest"
                    ^.
[0m15:51:02.038400 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:02.038610 [debug] [MainThread]: On master: BEGIN
[0m15:51:02.038791 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:51:02.041492 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:51:02.041746 [debug] [MainThread]: On master: COMMIT
[0m15:51:02.041925 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:02.042086 [debug] [MainThread]: On master: COMMIT
[0m15:51:02.042464 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:51:02.042737 [debug] [MainThread]: On master: Close
[0m15:51:02.043008 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:02.043185 [debug] [MainThread]: Connection 'snapshot.modelling_handson.customers_scd2' was properly closed.
[0m15:51:02.043374 [info ] [MainThread]: 
[0m15:51:02.043661 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m15:51:02.044033 [debug] [MainThread]: Command end result
[0m15:51:02.059660 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:51:02.061653 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:51:02.065809 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m15:51:02.066100 [info ] [MainThread]: 
[0m15:51:02.066388 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:51:02.066605 [info ] [MainThread]: 
[0m15:51:02.066904 [error] [MainThread]: [31mFailure in snapshot customers_scd2 (snapshots/customers_scd2.sql)[0m
[0m15:51:02.067120 [error] [MainThread]:   Database Error in snapshot customers_scd2 (snapshots/customers_scd2.sql)
  relation "staging.stg_customers_latest" does not exist
  LINE 28:     from "salesdb"."staging"."stg_customers_latest"
                    ^
[0m15:51:02.067317 [info ] [MainThread]: 
[0m15:51:02.067520 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:51:02.067975 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:51:02.068696 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.99988335, "process_in_blocks": "3920", "process_kernel_time": 0.194407, "process_mem_max_rss": "128404", "process_out_blocks": "2728", "process_user_time": 1.717927}
[0m15:51:02.069202 [debug] [MainThread]: Command `dbt snapshot` failed at 15:51:02.069141 after 1.00 seconds
[0m15:51:02.069497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b5d2b1ec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b5d2b1ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b5d2c7ac10>]}
[0m15:51:02.069761 [debug] [MainThread]: Flushing usage events
[0m15:51:03.782503 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:51:21.105759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0b93be5dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0b93bddfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0b93bdf3d0>]}


============================== 15:51:21.109008 | b43815e2-3db9-46f5-9f5d-c3e53dfc2727 ==============================
[0m15:51:21.109008 [info ] [MainThread]: Running with dbt=1.10.7
[0m15:51:21.109744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'version_check': 'True', 'profiles_dir': '/home/subhan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_customers_latest', 'send_anonymous_usage_stats': 'True'}
[0m15:51:21.143678 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:51:21.144109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b43815e2-3db9-46f5-9f5d-c3e53dfc2727', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0b93b0cf50>]}
[0m15:51:21.230556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b43815e2-3db9-46f5-9f5d-c3e53dfc2727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0b93a832d0>]}
[0m15:51:21.269854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b43815e2-3db9-46f5-9f5d-c3e53dfc2727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0b9307ef90>]}
[0m15:51:21.270480 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:51:21.312200 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m15:51:21.396140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:51:21.396448 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:51:21.433277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b43815e2-3db9-46f5-9f5d-c3e53dfc2727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0b92ee3850>]}
[0m15:51:21.490125 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:51:21.491449 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:51:21.498633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b43815e2-3db9-46f5-9f5d-c3e53dfc2727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0b93184c50>]}
[0m15:51:21.499052 [info ] [MainThread]: Found 5 models, 3 seeds, 1 snapshot, 3 sources, 435 macros
[0m15:51:21.499289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b43815e2-3db9-46f5-9f5d-c3e53dfc2727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0b92fb7950>]}
[0m15:51:21.500111 [info ] [MainThread]: 
[0m15:51:21.500354 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:51:21.500577 [info ] [MainThread]: 
[0m15:51:21.500879 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:51:21.501538 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb'
[0m15:51:21.522237 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m15:51:21.522618 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m15:51:21.522843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:21.526552 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.004 seconds
[0m15:51:21.527403 [debug] [ThreadPool]: On list_salesdb: Close
[0m15:51:21.530584 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb, now list_salesdb_staging)
[0m15:51:21.534022 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m15:51:21.534296 [debug] [ThreadPool]: On list_salesdb_staging: BEGIN
[0m15:51:21.534498 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:21.537533 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:51:21.537816 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m15:51:21.538005 [debug] [ThreadPool]: On list_salesdb_staging: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_staging"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m15:51:21.539757 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m15:51:21.540581 [debug] [ThreadPool]: On list_salesdb_staging: ROLLBACK
[0m15:51:21.540991 [debug] [ThreadPool]: On list_salesdb_staging: Close
[0m15:51:21.541424 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_staging, now list_salesdb_public_raw_data)
[0m15:51:21.543069 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:51:21.543308 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m15:51:21.543480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:21.546135 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:51:21.546366 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:51:21.546548 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m15:51:21.548094 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.001 seconds
[0m15:51:21.548895 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m15:51:21.549280 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m15:51:21.549688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now list_salesdb_marts)
[0m15:51:21.551290 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m15:51:21.551498 [debug] [ThreadPool]: On list_salesdb_marts: BEGIN
[0m15:51:21.551657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:21.554048 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m15:51:21.554262 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m15:51:21.554441 [debug] [ThreadPool]: On list_salesdb_marts: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_marts"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m15:51:21.556025 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.001 seconds
[0m15:51:21.556752 [debug] [ThreadPool]: On list_salesdb_marts: ROLLBACK
[0m15:51:21.557217 [debug] [ThreadPool]: On list_salesdb_marts: Close
[0m15:51:21.557603 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_marts, now list_salesdb_snapshots)
[0m15:51:21.559062 [debug] [ThreadPool]: Using postgres connection "list_salesdb_snapshots"
[0m15:51:21.559273 [debug] [ThreadPool]: On list_salesdb_snapshots: BEGIN
[0m15:51:21.559433 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:21.561917 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m15:51:21.562151 [debug] [ThreadPool]: Using postgres connection "list_salesdb_snapshots"
[0m15:51:21.562344 [debug] [ThreadPool]: On list_salesdb_snapshots: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_snapshots"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:51:21.563854 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m15:51:21.564515 [debug] [ThreadPool]: On list_salesdb_snapshots: ROLLBACK
[0m15:51:21.564895 [debug] [ThreadPool]: On list_salesdb_snapshots: Close
[0m15:51:21.567786 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:21.568015 [debug] [MainThread]: On master: BEGIN
[0m15:51:21.568179 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:51:21.570584 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:51:21.570847 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:21.571062 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:51:21.577960 [debug] [MainThread]: SQL status: SELECT 3 in 0.007 seconds
[0m15:51:21.579368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b43815e2-3db9-46f5-9f5d-c3e53dfc2727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0b92cabb50>]}
[0m15:51:21.579730 [debug] [MainThread]: On master: ROLLBACK
[0m15:51:21.580131 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:21.580332 [debug] [MainThread]: On master: BEGIN
[0m15:51:21.580813 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:51:21.581003 [debug] [MainThread]: On master: COMMIT
[0m15:51:21.581168 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:21.581322 [debug] [MainThread]: On master: COMMIT
[0m15:51:21.581680 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:51:21.581875 [debug] [MainThread]: On master: Close
[0m15:51:21.583553 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_customers_latest
[0m15:51:21.583951 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_customers_latest ....................... [RUN]
[0m15:51:21.584258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_snapshots, now model.modelling_handson.stg_customers_latest)
[0m15:51:21.584476 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_customers_latest
[0m15:51:21.588972 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_customers_latest"
[0m15:51:21.590393 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_customers_latest
[0m15:51:21.646523 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_customers_latest"
[0m15:51:21.647055 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_latest"
[0m15:51:21.647292 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_latest: BEGIN
[0m15:51:21.647477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:21.650555 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m15:51:21.650851 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_latest"
[0m15:51:21.651066 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_latest: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_customers_latest"} */

  create view "salesdb"."staging"."stg_customers_latest__dbt_tmp"
    
    
  as (
    with unioned as (
  select customer_nk, first_name, last_name, email, city, country, signup_ts, null::timestamp as change_ts
  from "salesdb"."staging"."stg_customers_initial"
  union all
  select customer_nk, first_name, last_name, email, city, country, signup_ts, change_ts
  from "salesdb"."staging"."stg_customers_day1"
  union all
  select customer_nk, first_name, last_name, email, city, country, signup_ts, change_ts
  from "salesdb"."staging"."stg_customers_day2"
),
ranked as (
  select *,
         row_number() over (partition by customer_nk order by coalesce(change_ts, signup_ts) desc) as rn
  from unioned
)
select
  customer_nk,
  first_name,
  last_name,
  email,
  city,
  country,
  signup_ts
from ranked
where rn = 1
  );
[0m15:51:21.655475 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m15:51:21.659464 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_latest"
[0m15:51:21.659783 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_latest: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_customers_latest"} */
alter table "salesdb"."staging"."stg_customers_latest__dbt_tmp" rename to "stg_customers_latest"
[0m15:51:21.660525 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:51:21.669466 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_latest: COMMIT
[0m15:51:21.669850 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_latest"
[0m15:51:21.670067 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_latest: COMMIT
[0m15:51:21.671101 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:51:21.674769 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_customers_latest__dbt_backup"
[0m15:51:21.677970 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_latest"
[0m15:51:21.678229 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_latest: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_customers_latest"} */
drop view if exists "salesdb"."staging"."stg_customers_latest__dbt_backup" cascade
[0m15:51:21.678722 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:51:21.680046 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_latest: Close
[0m15:51:21.681051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b43815e2-3db9-46f5-9f5d-c3e53dfc2727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0b93aefb50>]}
[0m15:51:21.681994 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging.stg_customers_latest .................. [[32mCREATE VIEW[0m in 0.10s]
[0m15:51:21.682357 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_customers_latest
[0m15:51:21.683510 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:21.683727 [debug] [MainThread]: On master: BEGIN
[0m15:51:21.683895 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:51:21.686473 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:51:21.686746 [debug] [MainThread]: On master: COMMIT
[0m15:51:21.686937 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:21.687102 [debug] [MainThread]: On master: COMMIT
[0m15:51:21.687728 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:51:21.687965 [debug] [MainThread]: On master: Close
[0m15:51:21.688249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:21.688422 [debug] [MainThread]: Connection 'model.modelling_handson.stg_customers_latest' was properly closed.
[0m15:51:21.688597 [info ] [MainThread]: 
[0m15:51:21.688797 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m15:51:21.689164 [debug] [MainThread]: Command end result
[0m15:51:21.702753 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:51:21.704083 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:51:21.708737 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m15:51:21.709038 [info ] [MainThread]: 
[0m15:51:21.709325 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:51:21.709538 [info ] [MainThread]: 
[0m15:51:21.709829 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:51:21.710586 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:51:21.711548 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6642148, "process_in_blocks": "16", "process_kernel_time": 0.201859, "process_mem_max_rss": "122144", "process_out_blocks": "1864", "process_user_time": 1.469534}
[0m15:51:21.711888 [debug] [MainThread]: Command `dbt run` succeeded at 15:51:21.711793 after 0.66 seconds
[0m15:51:21.712178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0b981211d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0b985ffbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0b98117a90>]}
[0m15:51:21.712415 [debug] [MainThread]: Flushing usage events
[0m15:51:23.417150 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:51:48.016907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6c100d3dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6c10286e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6c10286f10>]}


============================== 15:51:48.019305 | d780af93-ddf0-4343-9691-d5ef97b77bac ==============================
[0m15:51:48.019305 [info ] [MainThread]: Running with dbt=1.10.7
[0m15:51:48.019701 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/subhan/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:51:48.056423 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:51:48.056844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd780af93-ddf0-4343-9691-d5ef97b77bac', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6c10112410>]}
[0m15:51:48.132336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd780af93-ddf0-4343-9691-d5ef97b77bac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6c0f713690>]}
[0m15:51:48.174771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd780af93-ddf0-4343-9691-d5ef97b77bac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6c12ceb190>]}
[0m15:51:48.175315 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:51:48.218547 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m15:51:48.302470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:51:48.302812 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:51:48.341606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd780af93-ddf0-4343-9691-d5ef97b77bac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6c1012ae50>]}
[0m15:51:48.402445 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:51:48.404133 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:51:48.411596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd780af93-ddf0-4343-9691-d5ef97b77bac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6c0f4c6f50>]}
[0m15:51:48.411938 [info ] [MainThread]: Found 5 models, 3 seeds, 1 snapshot, 3 sources, 435 macros
[0m15:51:48.412170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd780af93-ddf0-4343-9691-d5ef97b77bac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6c0f48bd10>]}
[0m15:51:48.413304 [info ] [MainThread]: 
[0m15:51:48.413556 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:51:48.413799 [info ] [MainThread]: 
[0m15:51:48.414174 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:51:48.414873 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb'
[0m15:51:48.436710 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m15:51:48.437070 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m15:51:48.437240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:48.441074 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.004 seconds
[0m15:51:48.441929 [debug] [ThreadPool]: On list_salesdb: Close
[0m15:51:48.445072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb, now list_salesdb_marts)
[0m15:51:48.448544 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m15:51:48.448806 [debug] [ThreadPool]: On list_salesdb_marts: BEGIN
[0m15:51:48.448984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:48.451676 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:51:48.451914 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m15:51:48.452098 [debug] [ThreadPool]: On list_salesdb_marts: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_marts"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m15:51:48.453763 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.001 seconds
[0m15:51:48.454565 [debug] [ThreadPool]: On list_salesdb_marts: ROLLBACK
[0m15:51:48.454954 [debug] [ThreadPool]: On list_salesdb_marts: Close
[0m15:51:48.455362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_marts, now list_salesdb_snapshots)
[0m15:51:48.456830 [debug] [ThreadPool]: Using postgres connection "list_salesdb_snapshots"
[0m15:51:48.457032 [debug] [ThreadPool]: On list_salesdb_snapshots: BEGIN
[0m15:51:48.457198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:48.460772 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:51:48.461058 [debug] [ThreadPool]: Using postgres connection "list_salesdb_snapshots"
[0m15:51:48.461247 [debug] [ThreadPool]: On list_salesdb_snapshots: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_snapshots"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:51:48.463137 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m15:51:48.463879 [debug] [ThreadPool]: On list_salesdb_snapshots: ROLLBACK
[0m15:51:48.464251 [debug] [ThreadPool]: On list_salesdb_snapshots: Close
[0m15:51:48.464659 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_snapshots, now list_salesdb_staging)
[0m15:51:48.465916 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m15:51:48.466173 [debug] [ThreadPool]: On list_salesdb_staging: BEGIN
[0m15:51:48.466337 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:48.468998 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:51:48.469275 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m15:51:48.469493 [debug] [ThreadPool]: On list_salesdb_staging: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_staging"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m15:51:48.471483 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m15:51:48.472292 [debug] [ThreadPool]: On list_salesdb_staging: ROLLBACK
[0m15:51:48.472667 [debug] [ThreadPool]: On list_salesdb_staging: Close
[0m15:51:48.473119 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_staging, now list_salesdb_public_raw_data)
[0m15:51:48.474782 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:51:48.474992 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m15:51:48.475154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:48.477686 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m15:51:48.477910 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:51:48.478214 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m15:51:48.479705 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.001 seconds
[0m15:51:48.480444 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m15:51:48.480893 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m15:51:48.484261 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:48.484500 [debug] [MainThread]: On master: BEGIN
[0m15:51:48.484700 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:51:48.487421 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:51:48.487656 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:48.487880 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:51:48.496567 [debug] [MainThread]: SQL status: SELECT 6 in 0.008 seconds
[0m15:51:48.498268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd780af93-ddf0-4343-9691-d5ef97b77bac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6c0f4df290>]}
[0m15:51:48.498655 [debug] [MainThread]: On master: ROLLBACK
[0m15:51:48.499244 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:48.499504 [debug] [MainThread]: On master: BEGIN
[0m15:51:48.500189 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:51:48.500428 [debug] [MainThread]: On master: COMMIT
[0m15:51:48.500610 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:48.500797 [debug] [MainThread]: On master: COMMIT
[0m15:51:48.501177 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:51:48.501438 [debug] [MainThread]: On master: Close
[0m15:51:48.503680 [debug] [Thread-1 (]: Began running node snapshot.modelling_handson.customers_scd2
[0m15:51:48.504086 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customers_scd2 ................................. [RUN]
[0m15:51:48.504411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now snapshot.modelling_handson.customers_scd2)
[0m15:51:48.504645 [debug] [Thread-1 (]: Began compiling node snapshot.modelling_handson.customers_scd2
[0m15:51:48.509573 [debug] [Thread-1 (]: Began executing node snapshot.modelling_handson.customers_scd2
[0m15:51:48.594661 [debug] [Thread-1 (]: Using postgres connection "snapshot.modelling_handson.customers_scd2"
[0m15:51:48.595011 [debug] [Thread-1 (]: On snapshot.modelling_handson.customers_scd2: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "snapshot.modelling_handson.customers_scd2"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(customer_nk as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        


select
    customer_nk,
    first_name,
    last_name,
    email,
    city,
    country,
    signup_ts
    from "salesdb"."staging"."stg_customers_latest"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m15:51:48.595254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:48.599094 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m15:51:48.601030 [debug] [Thread-1 (]: Using postgres connection "snapshot.modelling_handson.customers_scd2"
[0m15:51:48.601291 [debug] [Thread-1 (]: On snapshot.modelling_handson.customers_scd2: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "snapshot.modelling_handson.customers_scd2"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:51:48.601766 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:51:48.602106 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.modelling_handson.customers_scd2"
[0m15:51:48.603818 [debug] [Thread-1 (]: Using postgres connection "snapshot.modelling_handson.customers_scd2"
[0m15:51:48.604059 [debug] [Thread-1 (]: On snapshot.modelling_handson.customers_scd2: BEGIN
[0m15:51:48.604607 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m15:51:48.604842 [debug] [Thread-1 (]: Using postgres connection "snapshot.modelling_handson.customers_scd2"
[0m15:51:48.605045 [debug] [Thread-1 (]: On snapshot.modelling_handson.customers_scd2: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "snapshot.modelling_handson.customers_scd2"} */

      
  
    

  create  table "salesdb"."snapshots"."customers_scd2"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(customer_nk as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        


select
    customer_nk,
    first_name,
    last_name,
    email,
    city,
    country,
    signup_ts
    from "salesdb"."staging"."stg_customers_latest"

    ) sbq



  );
  
  
[0m15:51:48.608749 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m15:51:48.619001 [debug] [Thread-1 (]: On snapshot.modelling_handson.customers_scd2: COMMIT
[0m15:51:48.619380 [debug] [Thread-1 (]: Using postgres connection "snapshot.modelling_handson.customers_scd2"
[0m15:51:48.619591 [debug] [Thread-1 (]: On snapshot.modelling_handson.customers_scd2: COMMIT
[0m15:51:48.620660 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:51:48.621823 [debug] [Thread-1 (]: On snapshot.modelling_handson.customers_scd2: Close
[0m15:51:48.623119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd780af93-ddf0-4343-9691-d5ef97b77bac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6c0f717c90>]}
[0m15:51:48.623660 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.customers_scd2 ................................. [[32mSELECT 6[0m in 0.12s]
[0m15:51:48.624026 [debug] [Thread-1 (]: Finished running node snapshot.modelling_handson.customers_scd2
[0m15:51:48.625105 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:48.625316 [debug] [MainThread]: On master: BEGIN
[0m15:51:48.625479 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:51:48.628379 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:51:48.628661 [debug] [MainThread]: On master: COMMIT
[0m15:51:48.628958 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:48.629152 [debug] [MainThread]: On master: COMMIT
[0m15:51:48.629564 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:51:48.629796 [debug] [MainThread]: On master: Close
[0m15:51:48.630127 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:48.630301 [debug] [MainThread]: Connection 'snapshot.modelling_handson.customers_scd2' was properly closed.
[0m15:51:48.630479 [info ] [MainThread]: 
[0m15:51:48.630675 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m15:51:48.631048 [debug] [MainThread]: Command end result
[0m15:51:48.644170 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:51:48.645793 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:51:48.649600 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m15:51:48.649856 [info ] [MainThread]: 
[0m15:51:48.650141 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:51:48.650325 [info ] [MainThread]: 
[0m15:51:48.650526 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:51:48.650827 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:51:48.651516 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.66800517, "process_in_blocks": "32", "process_kernel_time": 0.162183, "process_mem_max_rss": "122504", "process_out_blocks": "1848", "process_user_time": 1.402887}
[0m15:51:48.651822 [debug] [MainThread]: Command `dbt snapshot` succeeded at 15:51:48.651760 after 0.67 seconds
[0m15:51:48.652072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6c146a3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6c10130a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6c146c5210>]}
[0m15:51:48.652293 [debug] [MainThread]: Flushing usage events
[0m15:51:50.261681 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:54:44.585970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af9047d0710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af906cb5c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af904a21990>]}


============================== 15:54:44.588130 | 6a30c2d4-6392-4071-9ed1-63bb06ae47e8 ==============================
[0m15:54:44.588130 [info ] [MainThread]: Running with dbt=1.10.7
[0m15:54:44.588538 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'debug': 'False', 'profiles_dir': '/home/subhan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:54:44.623745 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:54:44.624198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6a30c2d4-6392-4071-9ed1-63bb06ae47e8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af9046740d0>]}
[0m15:54:44.698316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a30c2d4-6392-4071-9ed1-63bb06ae47e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af904704f10>]}
[0m15:54:44.738237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a30c2d4-6392-4071-9ed1-63bb06ae47e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af90748f650>]}
[0m15:54:44.738890 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:54:44.785300 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m15:54:44.870852 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:54:44.871294 [debug] [MainThread]: Partial parsing: updated file: modelling_handson://data/seeds/customers_day2.csv
[0m15:54:45.021800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a30c2d4-6392-4071-9ed1-63bb06ae47e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af9038c2250>]}
[0m15:54:45.079835 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:54:45.081012 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:54:45.088841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a30c2d4-6392-4071-9ed1-63bb06ae47e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af903a9b510>]}
[0m15:54:45.089184 [info ] [MainThread]: Found 5 models, 3 seeds, 1 snapshot, 3 sources, 435 macros
[0m15:54:45.089409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a30c2d4-6392-4071-9ed1-63bb06ae47e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af903b4a450>]}
[0m15:54:45.090628 [info ] [MainThread]: 
[0m15:54:45.090936 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:54:45.091148 [info ] [MainThread]: 
[0m15:54:45.091457 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:54:45.094191 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb'
[0m15:54:45.151265 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m15:54:45.151665 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m15:54:45.151862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:54:45.156108 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.004 seconds
[0m15:54:45.156990 [debug] [ThreadPool]: On list_salesdb: Close
[0m15:54:45.158424 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb, now list_salesdb_marts)
[0m15:54:45.161977 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m15:54:45.162257 [debug] [ThreadPool]: On list_salesdb_marts: BEGIN
[0m15:54:45.162432 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:54:45.165649 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:54:45.165925 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m15:54:45.166113 [debug] [ThreadPool]: On list_salesdb_marts: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_marts"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m15:54:45.168034 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m15:54:45.168859 [debug] [ThreadPool]: On list_salesdb_marts: ROLLBACK
[0m15:54:45.169296 [debug] [ThreadPool]: On list_salesdb_marts: Close
[0m15:54:45.169736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_marts, now list_salesdb_public_raw_data)
[0m15:54:45.171607 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:54:45.171863 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m15:54:45.172030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:54:45.174764 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:54:45.175001 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:54:45.175184 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m15:54:45.176853 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.001 seconds
[0m15:54:45.177620 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m15:54:45.178079 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m15:54:45.178489 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now list_salesdb_staging)
[0m15:54:45.180113 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m15:54:45.180326 [debug] [ThreadPool]: On list_salesdb_staging: BEGIN
[0m15:54:45.180489 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:54:45.183175 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:54:45.183407 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m15:54:45.183594 [debug] [ThreadPool]: On list_salesdb_staging: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_staging"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m15:54:45.185183 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.001 seconds
[0m15:54:45.185989 [debug] [ThreadPool]: On list_salesdb_staging: ROLLBACK
[0m15:54:45.186443 [debug] [ThreadPool]: On list_salesdb_staging: Close
[0m15:54:45.186887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_staging, now list_salesdb_snapshots)
[0m15:54:45.188499 [debug] [ThreadPool]: Using postgres connection "list_salesdb_snapshots"
[0m15:54:45.189198 [debug] [ThreadPool]: On list_salesdb_snapshots: BEGIN
[0m15:54:45.189390 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:54:45.191887 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m15:54:45.192097 [debug] [ThreadPool]: Using postgres connection "list_salesdb_snapshots"
[0m15:54:45.192268 [debug] [ThreadPool]: On list_salesdb_snapshots: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_snapshots"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:54:45.193792 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m15:54:45.194560 [debug] [ThreadPool]: On list_salesdb_snapshots: ROLLBACK
[0m15:54:45.195025 [debug] [ThreadPool]: On list_salesdb_snapshots: Close
[0m15:54:45.198281 [debug] [MainThread]: Using postgres connection "master"
[0m15:54:45.198518 [debug] [MainThread]: On master: BEGIN
[0m15:54:45.198735 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:54:45.201560 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:54:45.201811 [debug] [MainThread]: Using postgres connection "master"
[0m15:54:45.202024 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:54:45.210060 [debug] [MainThread]: SQL status: SELECT 6 in 0.008 seconds
[0m15:54:45.211584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a30c2d4-6392-4071-9ed1-63bb06ae47e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af902d07ed0>]}
[0m15:54:45.211930 [debug] [MainThread]: On master: ROLLBACK
[0m15:54:45.212395 [debug] [MainThread]: Using postgres connection "master"
[0m15:54:45.212636 [debug] [MainThread]: On master: BEGIN
[0m15:54:45.213436 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:54:45.213649 [debug] [MainThread]: On master: COMMIT
[0m15:54:45.213822 [debug] [MainThread]: Using postgres connection "master"
[0m15:54:45.213978 [debug] [MainThread]: On master: COMMIT
[0m15:54:45.214390 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:54:45.214679 [debug] [MainThread]: On master: Close
[0m15:54:45.216826 [debug] [Thread-1 (]: Began running node seed.modelling_handson.customers_day1
[0m15:54:45.217204 [info ] [Thread-1 (]: 1 of 3 START seed file public_raw_data.customers_day1 .......................... [RUN]
[0m15:54:45.217533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_snapshots, now seed.modelling_handson.customers_day1)
[0m15:54:45.217768 [debug] [Thread-1 (]: Began compiling node seed.modelling_handson.customers_day1
[0m15:54:45.217979 [debug] [Thread-1 (]: Began executing node seed.modelling_handson.customers_day1
[0m15:54:45.239161 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_day1"
[0m15:54:45.239578 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day1: BEGIN
[0m15:54:45.239822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:54:45.243310 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m15:54:45.243656 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_day1"
[0m15:54:45.243918 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day1: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "seed.modelling_handson.customers_day1"} */
truncate table "salesdb"."public_raw_data"."customers_day1"
[0m15:54:45.246574 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.002 seconds
[0m15:54:45.256534 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_day1"
[0m15:54:45.256887 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day1: 
          insert into "salesdb"."public_raw_data"."customers_day1" (customer_nk, first_name, last_name, email, city, country, signup_ts, change_ts) values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m15:54:45.257810 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.001 seconds
[0m15:54:45.260851 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.modelling_handson.customers_day1"
[0m15:54:45.269271 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day1: COMMIT
[0m15:54:45.269601 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_day1"
[0m15:54:45.269812 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day1: COMMIT
[0m15:54:45.271282 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:54:45.272360 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day1: Close
[0m15:54:45.273378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a30c2d4-6392-4071-9ed1-63bb06ae47e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af903de6290>]}
[0m15:54:45.273719 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file public_raw_data.customers_day1 ...................... [[32mINSERT 3[0m in 0.06s]
[0m15:54:45.274074 [debug] [Thread-1 (]: Finished running node seed.modelling_handson.customers_day1
[0m15:54:45.274313 [debug] [Thread-1 (]: Began running node seed.modelling_handson.customers_day2
[0m15:54:45.274695 [info ] [Thread-1 (]: 2 of 3 START seed file public_raw_data.customers_day2 .......................... [RUN]
[0m15:54:45.274984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.modelling_handson.customers_day1, now seed.modelling_handson.customers_day2)
[0m15:54:45.275188 [debug] [Thread-1 (]: Began compiling node seed.modelling_handson.customers_day2
[0m15:54:45.275377 [debug] [Thread-1 (]: Began executing node seed.modelling_handson.customers_day2
[0m15:54:45.278179 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_day2"
[0m15:54:45.278434 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day2: BEGIN
[0m15:54:45.278629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:54:45.281269 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m15:54:45.281545 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_day2"
[0m15:54:45.281746 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day2: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "seed.modelling_handson.customers_day2"} */
truncate table "salesdb"."public_raw_data"."customers_day2"
[0m15:54:45.283656 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.002 seconds
[0m15:54:45.285659 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_day2"
[0m15:54:45.285916 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day2: 
          insert into "salesdb"."public_raw_data"."customers_day2" (customer_nk, first_name, last_name, email, city, country, signup_ts, change_ts) values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m15:54:45.286710 [debug] [Thread-1 (]: SQL status: INSERT 0 4 in 0.000 seconds
[0m15:54:45.287167 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.modelling_handson.customers_day2"
[0m15:54:45.288132 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day2: COMMIT
[0m15:54:45.288402 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_day2"
[0m15:54:45.288603 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day2: COMMIT
[0m15:54:45.289683 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:54:45.290280 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day2: Close
[0m15:54:45.290962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a30c2d4-6392-4071-9ed1-63bb06ae47e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af902daefd0>]}
[0m15:54:45.291331 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file public_raw_data.customers_day2 ...................... [[32mINSERT 4[0m in 0.02s]
[0m15:54:45.292956 [debug] [Thread-1 (]: Finished running node seed.modelling_handson.customers_day2
[0m15:54:45.293262 [debug] [Thread-1 (]: Began running node seed.modelling_handson.customers_initial
[0m15:54:45.293671 [info ] [Thread-1 (]: 3 of 3 START seed file public_raw_data.customers_initial ....................... [RUN]
[0m15:54:45.294009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.modelling_handson.customers_day2, now seed.modelling_handson.customers_initial)
[0m15:54:45.294215 [debug] [Thread-1 (]: Began compiling node seed.modelling_handson.customers_initial
[0m15:54:45.294405 [debug] [Thread-1 (]: Began executing node seed.modelling_handson.customers_initial
[0m15:54:45.297156 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_initial"
[0m15:54:45.297444 [debug] [Thread-1 (]: On seed.modelling_handson.customers_initial: BEGIN
[0m15:54:45.297675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:54:45.301024 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m15:54:45.301373 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_initial"
[0m15:54:45.301598 [debug] [Thread-1 (]: On seed.modelling_handson.customers_initial: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "seed.modelling_handson.customers_initial"} */
truncate table "salesdb"."public_raw_data"."customers_initial"
[0m15:54:45.303521 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.002 seconds
[0m15:54:45.305378 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_initial"
[0m15:54:45.305641 [debug] [Thread-1 (]: On seed.modelling_handson.customers_initial: 
          insert into "salesdb"."public_raw_data"."customers_initial" (customer_nk, first_name, last_name, email, city, country, signup_ts) values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s)
      ...
[0m15:54:45.306330 [debug] [Thread-1 (]: SQL status: INSERT 0 4 in 0.000 seconds
[0m15:54:45.307050 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.modelling_handson.customers_initial"
[0m15:54:45.307931 [debug] [Thread-1 (]: On seed.modelling_handson.customers_initial: COMMIT
[0m15:54:45.308165 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_initial"
[0m15:54:45.308352 [debug] [Thread-1 (]: On seed.modelling_handson.customers_initial: COMMIT
[0m15:54:45.309544 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:54:45.310075 [debug] [Thread-1 (]: On seed.modelling_handson.customers_initial: Close
[0m15:54:45.310443 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a30c2d4-6392-4071-9ed1-63bb06ae47e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af9013c4850>]}
[0m15:54:45.310779 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file public_raw_data.customers_initial ................... [[32mINSERT 4[0m in 0.02s]
[0m15:54:45.311308 [debug] [Thread-1 (]: Finished running node seed.modelling_handson.customers_initial
[0m15:54:45.312456 [debug] [MainThread]: Using postgres connection "master"
[0m15:54:45.312667 [debug] [MainThread]: On master: BEGIN
[0m15:54:45.312943 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:54:45.315563 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:54:45.315792 [debug] [MainThread]: On master: COMMIT
[0m15:54:45.315967 [debug] [MainThread]: Using postgres connection "master"
[0m15:54:45.316119 [debug] [MainThread]: On master: COMMIT
[0m15:54:45.316716 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:54:45.316943 [debug] [MainThread]: On master: Close
[0m15:54:45.317214 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:54:45.317397 [debug] [MainThread]: Connection 'seed.modelling_handson.customers_initial' was properly closed.
[0m15:54:45.317596 [info ] [MainThread]: 
[0m15:54:45.317806 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m15:54:45.318340 [debug] [MainThread]: Command end result
[0m15:54:45.331064 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:54:45.332227 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:54:45.336303 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m15:54:45.336556 [info ] [MainThread]: 
[0m15:54:45.336843 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:54:45.337047 [info ] [MainThread]: 
[0m15:54:45.337252 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:54:45.337616 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:54:45.338285 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.7877276, "process_in_blocks": "16", "process_kernel_time": 0.173713, "process_mem_max_rss": "124224", "process_out_blocks": "2760", "process_user_time": 1.523027}
[0m15:54:45.338598 [debug] [MainThread]: Command `dbt seed` succeeded at 15:54:45.338538 after 0.79 seconds
[0m15:54:45.338851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af904909750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af9013ce390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af908fffbd0>]}
[0m15:54:45.339070 [debug] [MainThread]: Flushing usage events
[0m15:54:46.865731 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:55:09.215541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baf2abb9d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baf2abb9bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baf2ac07850>]}


============================== 15:55:09.217745 | 55099807-6d22-4b25-8b84-25638b1db619 ==============================
[0m15:55:09.217745 [info ] [MainThread]: Running with dbt=1.10.7
[0m15:55:09.218169 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'fail_fast': 'False', 'profiles_dir': '/home/subhan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_customers_latest', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:55:09.249443 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:55:09.249855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '55099807-6d22-4b25-8b84-25638b1db619', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baf2ac27710>]}
[0m15:55:09.326294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55099807-6d22-4b25-8b84-25638b1db619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baf2ac0c890>]}
[0m15:55:09.370709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55099807-6d22-4b25-8b84-25638b1db619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baf2ac0da90>]}
[0m15:55:09.371309 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:55:09.417953 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m15:55:09.501132 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:55:09.501544 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:55:09.542163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55099807-6d22-4b25-8b84-25638b1db619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baf2aae1950>]}
[0m15:55:09.604414 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:55:09.606115 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:55:09.616717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55099807-6d22-4b25-8b84-25638b1db619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baf2a1f12d0>]}
[0m15:55:09.617159 [info ] [MainThread]: Found 5 models, 3 seeds, 1 snapshot, 3 sources, 435 macros
[0m15:55:09.617432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55099807-6d22-4b25-8b84-25638b1db619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baf29fb9750>]}
[0m15:55:09.618562 [info ] [MainThread]: 
[0m15:55:09.619047 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:55:09.619442 [info ] [MainThread]: 
[0m15:55:09.619835 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:55:09.620573 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb'
[0m15:55:09.644331 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m15:55:09.644637 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m15:55:09.644826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:09.648289 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.003 seconds
[0m15:55:09.649139 [debug] [ThreadPool]: On list_salesdb: Close
[0m15:55:09.652330 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb, now list_salesdb_public_raw_data)
[0m15:55:09.655899 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:55:09.656139 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m15:55:09.656324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:09.659174 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:55:09.659426 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:55:09.659612 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m15:55:09.661351 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m15:55:09.662178 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m15:55:09.662628 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m15:55:09.663106 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now list_salesdb_staging)
[0m15:55:09.664662 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m15:55:09.664880 [debug] [ThreadPool]: On list_salesdb_staging: BEGIN
[0m15:55:09.665054 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:09.667921 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:55:09.668183 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m15:55:09.668370 [debug] [ThreadPool]: On list_salesdb_staging: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_staging"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m15:55:09.670055 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.001 seconds
[0m15:55:09.671259 [debug] [ThreadPool]: On list_salesdb_staging: ROLLBACK
[0m15:55:09.671718 [debug] [ThreadPool]: On list_salesdb_staging: Close
[0m15:55:09.672156 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_staging, now list_salesdb_snapshots)
[0m15:55:09.673807 [debug] [ThreadPool]: Using postgres connection "list_salesdb_snapshots"
[0m15:55:09.674023 [debug] [ThreadPool]: On list_salesdb_snapshots: BEGIN
[0m15:55:09.674217 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:09.677538 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:55:09.677821 [debug] [ThreadPool]: Using postgres connection "list_salesdb_snapshots"
[0m15:55:09.678043 [debug] [ThreadPool]: On list_salesdb_snapshots: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_snapshots"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:55:09.679764 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m15:55:09.680651 [debug] [ThreadPool]: On list_salesdb_snapshots: ROLLBACK
[0m15:55:09.681096 [debug] [ThreadPool]: On list_salesdb_snapshots: Close
[0m15:55:09.681540 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_snapshots, now list_salesdb_marts)
[0m15:55:09.682847 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m15:55:09.683307 [debug] [ThreadPool]: On list_salesdb_marts: BEGIN
[0m15:55:09.683529 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:09.686355 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:55:09.686644 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m15:55:09.686842 [debug] [ThreadPool]: On list_salesdb_marts: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_marts"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m15:55:09.688530 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.001 seconds
[0m15:55:09.689338 [debug] [ThreadPool]: On list_salesdb_marts: ROLLBACK
[0m15:55:09.689736 [debug] [ThreadPool]: On list_salesdb_marts: Close
[0m15:55:09.692984 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:09.693228 [debug] [MainThread]: On master: BEGIN
[0m15:55:09.693398 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:55:09.696321 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:55:09.696553 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:09.696759 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:55:09.704562 [debug] [MainThread]: SQL status: SELECT 6 in 0.008 seconds
[0m15:55:09.706237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55099807-6d22-4b25-8b84-25638b1db619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baf29e41e90>]}
[0m15:55:09.706550 [debug] [MainThread]: On master: ROLLBACK
[0m15:55:09.707021 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:09.707266 [debug] [MainThread]: On master: BEGIN
[0m15:55:09.707923 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:55:09.708154 [debug] [MainThread]: On master: COMMIT
[0m15:55:09.708345 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:09.708512 [debug] [MainThread]: On master: COMMIT
[0m15:55:09.708901 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:55:09.709157 [debug] [MainThread]: On master: Close
[0m15:55:09.711076 [debug] [Thread-1 (]: Began running node model.modelling_handson.stg_customers_latest
[0m15:55:09.711484 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_customers_latest ....................... [RUN]
[0m15:55:09.711936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_marts, now model.modelling_handson.stg_customers_latest)
[0m15:55:09.712190 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.stg_customers_latest
[0m15:55:09.716975 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.stg_customers_latest"
[0m15:55:09.717432 [debug] [Thread-1 (]: Began executing node model.modelling_handson.stg_customers_latest
[0m15:55:09.775275 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.stg_customers_latest"
[0m15:55:09.775793 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_latest"
[0m15:55:09.776030 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_latest: BEGIN
[0m15:55:09.776239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:09.779139 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m15:55:09.779409 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_latest"
[0m15:55:09.779624 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_latest: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_customers_latest"} */

  create view "salesdb"."staging"."stg_customers_latest__dbt_tmp"
    
    
  as (
    with unioned as (
  select customer_nk, first_name, last_name, email, city, country, signup_ts, null::timestamp as change_ts
  from "salesdb"."staging"."stg_customers_initial"
  union all
  select customer_nk, first_name, last_name, email, city, country, signup_ts, change_ts
  from "salesdb"."staging"."stg_customers_day1"
  union all
  select customer_nk, first_name, last_name, email, city, country, signup_ts, change_ts
  from "salesdb"."staging"."stg_customers_day2"
),
ranked as (
  select *,
         row_number() over (partition by customer_nk order by coalesce(change_ts, signup_ts) desc) as rn
  from unioned
)
select
  customer_nk,
  first_name,
  last_name,
  email,
  city,
  country,
  signup_ts
from ranked
where rn = 1
  );
[0m15:55:09.781710 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:55:09.785714 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_latest"
[0m15:55:09.785987 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_latest: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_customers_latest"} */
alter table "salesdb"."staging"."stg_customers_latest" rename to "stg_customers_latest__dbt_backup"
[0m15:55:09.786755 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:55:09.788466 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_latest"
[0m15:55:09.788694 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_latest: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_customers_latest"} */
alter table "salesdb"."staging"."stg_customers_latest__dbt_tmp" rename to "stg_customers_latest"
[0m15:55:09.789371 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:55:09.798723 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_latest: COMMIT
[0m15:55:09.799060 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_latest"
[0m15:55:09.799264 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_latest: COMMIT
[0m15:55:09.800585 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:55:09.804489 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."staging"."stg_customers_latest__dbt_backup"
[0m15:55:09.807634 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.stg_customers_latest"
[0m15:55:09.807930 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_latest: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.stg_customers_latest"} */
drop view if exists "salesdb"."staging"."stg_customers_latest__dbt_backup" cascade
[0m15:55:09.809412 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:55:09.811154 [debug] [Thread-1 (]: On model.modelling_handson.stg_customers_latest: Close
[0m15:55:09.812471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55099807-6d22-4b25-8b84-25638b1db619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baf2ba86bd0>]}
[0m15:55:09.812972 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging.stg_customers_latest .................. [[32mCREATE VIEW[0m in 0.10s]
[0m15:55:09.813328 [debug] [Thread-1 (]: Finished running node model.modelling_handson.stg_customers_latest
[0m15:55:09.814349 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:09.814552 [debug] [MainThread]: On master: BEGIN
[0m15:55:09.814769 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:55:09.817592 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:55:09.817841 [debug] [MainThread]: On master: COMMIT
[0m15:55:09.818027 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:09.818190 [debug] [MainThread]: On master: COMMIT
[0m15:55:09.818594 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:55:09.818875 [debug] [MainThread]: On master: Close
[0m15:55:09.819283 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:55:09.819461 [debug] [MainThread]: Connection 'model.modelling_handson.stg_customers_latest' was properly closed.
[0m15:55:09.819645 [info ] [MainThread]: 
[0m15:55:09.819856 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m15:55:09.820405 [debug] [MainThread]: Command end result
[0m15:55:09.835431 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:55:09.837290 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:55:09.841172 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m15:55:09.841472 [info ] [MainThread]: 
[0m15:55:09.841798 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:55:09.842032 [info ] [MainThread]: 
[0m15:55:09.842291 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:55:09.842791 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:55:09.843591 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6693755, "process_in_blocks": "0", "process_kernel_time": 0.244729, "process_mem_max_rss": "121672", "process_out_blocks": "1864", "process_user_time": 1.505085}
[0m15:55:09.843961 [debug] [MainThread]: Command `dbt run` succeeded at 15:55:09.843868 after 0.67 seconds
[0m15:55:09.844236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baf2ac06cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baf2f1211d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baf2f065c10>]}
[0m15:55:09.844532 [debug] [MainThread]: Flushing usage events
[0m15:55:11.308578 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:55:18.897794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d276a283d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d276a2834d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d276a436ed0>]}


============================== 15:55:18.899748 | eef12060-f37c-48bf-b05b-37899b7d1c95 ==============================
[0m15:55:18.899748 [info ] [MainThread]: Running with dbt=1.10.7
[0m15:55:18.900257 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/subhan/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:55:18.932612 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m15:55:18.933018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'eef12060-f37c-48bf-b05b-37899b7d1c95', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d276a1bcf90>]}
[0m15:55:19.006127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eef12060-f37c-48bf-b05b-37899b7d1c95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2769889050>]}
[0m15:55:19.047150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eef12060-f37c-48bf-b05b-37899b7d1c95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d276cec5650>]}
[0m15:55:19.047866 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:55:19.096317 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m15:55:19.176573 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:55:19.176893 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:55:19.214810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eef12060-f37c-48bf-b05b-37899b7d1c95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2769564710>]}
[0m15:55:19.271267 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:55:19.272387 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:55:19.279732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eef12060-f37c-48bf-b05b-37899b7d1c95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2769837210>]}
[0m15:55:19.280109 [info ] [MainThread]: Found 5 models, 3 seeds, 1 snapshot, 3 sources, 435 macros
[0m15:55:19.280348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eef12060-f37c-48bf-b05b-37899b7d1c95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2769524550>]}
[0m15:55:19.281327 [info ] [MainThread]: 
[0m15:55:19.281576 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:55:19.281759 [info ] [MainThread]: 
[0m15:55:19.282163 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:55:19.282921 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb'
[0m15:55:19.305441 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m15:55:19.305771 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m15:55:19.305958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:19.309709 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.004 seconds
[0m15:55:19.311181 [debug] [ThreadPool]: On list_salesdb: Close
[0m15:55:19.317942 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb, now list_salesdb_marts)
[0m15:55:19.321353 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m15:55:19.321694 [debug] [ThreadPool]: On list_salesdb_marts: BEGIN
[0m15:55:19.321976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:19.324779 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:55:19.325072 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m15:55:19.325309 [debug] [ThreadPool]: On list_salesdb_marts: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_marts"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m15:55:19.326896 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.001 seconds
[0m15:55:19.327706 [debug] [ThreadPool]: On list_salesdb_marts: ROLLBACK
[0m15:55:19.328400 [debug] [ThreadPool]: On list_salesdb_marts: Close
[0m15:55:19.328810 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_marts, now list_salesdb_staging)
[0m15:55:19.330303 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m15:55:19.330509 [debug] [ThreadPool]: On list_salesdb_staging: BEGIN
[0m15:55:19.330728 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:19.333666 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:55:19.333884 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m15:55:19.334061 [debug] [ThreadPool]: On list_salesdb_staging: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_staging"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m15:55:19.335743 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.001 seconds
[0m15:55:19.336559 [debug] [ThreadPool]: On list_salesdb_staging: ROLLBACK
[0m15:55:19.336943 [debug] [ThreadPool]: On list_salesdb_staging: Close
[0m15:55:19.337339 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_staging, now list_salesdb_snapshots)
[0m15:55:19.338928 [debug] [ThreadPool]: Using postgres connection "list_salesdb_snapshots"
[0m15:55:19.339138 [debug] [ThreadPool]: On list_salesdb_snapshots: BEGIN
[0m15:55:19.339301 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:19.342175 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:55:19.342401 [debug] [ThreadPool]: Using postgres connection "list_salesdb_snapshots"
[0m15:55:19.342605 [debug] [ThreadPool]: On list_salesdb_snapshots: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_snapshots"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:55:19.344453 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m15:55:19.345222 [debug] [ThreadPool]: On list_salesdb_snapshots: ROLLBACK
[0m15:55:19.345686 [debug] [ThreadPool]: On list_salesdb_snapshots: Close
[0m15:55:19.346149 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_snapshots, now list_salesdb_public_raw_data)
[0m15:55:19.347502 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:55:19.347709 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m15:55:19.347863 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:19.350487 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:55:19.350740 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m15:55:19.351090 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m15:55:19.352518 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.001 seconds
[0m15:55:19.353228 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m15:55:19.353571 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m15:55:19.356684 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:19.356908 [debug] [MainThread]: On master: BEGIN
[0m15:55:19.357074 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:55:19.359658 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:55:19.359917 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:19.360132 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:55:19.368277 [debug] [MainThread]: SQL status: SELECT 6 in 0.008 seconds
[0m15:55:19.369761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eef12060-f37c-48bf-b05b-37899b7d1c95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d276933fb10>]}
[0m15:55:19.370097 [debug] [MainThread]: On master: ROLLBACK
[0m15:55:19.370533 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:19.370787 [debug] [MainThread]: On master: BEGIN
[0m15:55:19.371392 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:55:19.371613 [debug] [MainThread]: On master: COMMIT
[0m15:55:19.371786 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:19.371942 [debug] [MainThread]: On master: COMMIT
[0m15:55:19.372287 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:55:19.372524 [debug] [MainThread]: On master: Close
[0m15:55:19.374439 [debug] [Thread-1 (]: Began running node snapshot.modelling_handson.customers_scd2
[0m15:55:19.374854 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customers_scd2 ................................. [RUN]
[0m15:55:19.375284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now snapshot.modelling_handson.customers_scd2)
[0m15:55:19.375505 [debug] [Thread-1 (]: Began compiling node snapshot.modelling_handson.customers_scd2
[0m15:55:19.380009 [debug] [Thread-1 (]: Began executing node snapshot.modelling_handson.customers_scd2
[0m15:55:19.451733 [debug] [Thread-1 (]: Using postgres connection "snapshot.modelling_handson.customers_scd2"
[0m15:55:19.452100 [debug] [Thread-1 (]: On snapshot.modelling_handson.customers_scd2: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "snapshot.modelling_handson.customers_scd2"} */
select * from (
        select first_name, last_name, email, city, country, signup_ts from (
                


select
    customer_nk,
    first_name,
    last_name,
    email,
    city,
    country,
    signup_ts
    from "salesdb"."staging"."stg_customers_latest"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:55:19.452334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:19.456297 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m15:55:19.464493 [debug] [Thread-1 (]: Using postgres connection "snapshot.modelling_handson.customers_scd2"
[0m15:55:19.464809 [debug] [Thread-1 (]: On snapshot.modelling_handson.customers_scd2: BEGIN
[0m15:55:19.465493 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m15:55:19.465772 [debug] [Thread-1 (]: Using postgres connection "snapshot.modelling_handson.customers_scd2"
[0m15:55:19.465975 [debug] [Thread-1 (]: On snapshot.modelling_handson.customers_scd2: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "snapshot.modelling_handson.customers_scd2"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "salesdb".INFORMATION_SCHEMA.columns
      where table_name = 'customers_scd2'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m15:55:19.473852 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.008 seconds
[0m15:55:19.478310 [debug] [Thread-1 (]: Using postgres connection "snapshot.modelling_handson.customers_scd2"
[0m15:55:19.478597 [debug] [Thread-1 (]: On snapshot.modelling_handson.customers_scd2: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "snapshot.modelling_handson.customers_scd2"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "salesdb".INFORMATION_SCHEMA.columns
      where table_name = 'customers_scd2'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m15:55:19.480637 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.002 seconds
[0m15:55:19.511439 [debug] [Thread-1 (]: Using postgres connection "snapshot.modelling_handson.customers_scd2"
[0m15:55:19.511945 [debug] [Thread-1 (]: On snapshot.modelling_handson.customers_scd2: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "snapshot.modelling_handson.customers_scd2"} */

        
  
    

  create temporary table "customers_scd2__dbt_tmp155519506446"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        


select
    customer_nk,
    first_name,
    last_name,
    email,
    city,
    country,
    signup_ts
    from "salesdb"."staging"."stg_customers_latest"


    ),

    snapshotted_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    

        from "salesdb"."snapshots"."customers_scd2"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_nk as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."first_name" != source_data."first_name"
        or
        (
            ((snapshotted_data."first_name" is null) and not (source_data."first_name" is null))
            or
            ((not snapshotted_data."first_name" is null) and (source_data."first_name" is null))
        ) or snapshotted_data."last_name" != source_data."last_name"
        or
        (
            ((snapshotted_data."last_name" is null) and not (source_data."last_name" is null))
            or
            ((not snapshotted_data."last_name" is null) and (source_data."last_name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."city" != source_data."city"
        or
        (
            ((snapshotted_data."city" is null) and not (source_data."city" is null))
            or
            ((not snapshotted_data."city" is null) and (source_data."city" is null))
        ) or snapshotted_data."country" != source_data."country"
        or
        (
            ((snapshotted_data."country" is null) and not (source_data."country" is null))
            or
            ((not snapshotted_data."country" is null) and (source_data."country" is null))
        ) or snapshotted_data."signup_ts" != source_data."signup_ts"
        or
        (
            ((snapshotted_data."signup_ts" is null) and not (source_data."signup_ts" is null))
            or
            ((not snapshotted_data."signup_ts" is null) and (source_data."signup_ts" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."first_name" != source_data."first_name"
        or
        (
            ((snapshotted_data."first_name" is null) and not (source_data."first_name" is null))
            or
            ((not snapshotted_data."first_name" is null) and (source_data."first_name" is null))
        ) or snapshotted_data."last_name" != source_data."last_name"
        or
        (
            ((snapshotted_data."last_name" is null) and not (source_data."last_name" is null))
            or
            ((not snapshotted_data."last_name" is null) and (source_data."last_name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."city" != source_data."city"
        or
        (
            ((snapshotted_data."city" is null) and not (source_data."city" is null))
            or
            ((not snapshotted_data."city" is null) and (source_data."city" is null))
        ) or snapshotted_data."country" != source_data."country"
        or
        (
            ((snapshotted_data."country" is null) and not (source_data."country" is null))
            or
            ((not snapshotted_data."country" is null) and (source_data."country" is null))
        ) or snapshotted_data."signup_ts" != source_data."signup_ts"
        or
        (
            ((snapshotted_data."signup_ts" is null) and not (source_data."signup_ts" is null))
            or
            ((not snapshotted_data."signup_ts" is null) and (source_data."signup_ts" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:55:19.514636 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m15:55:19.516263 [debug] [Thread-1 (]: Using postgres connection "snapshot.modelling_handson.customers_scd2"
[0m15:55:19.516516 [debug] [Thread-1 (]: On snapshot.modelling_handson.customers_scd2: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "snapshot.modelling_handson.customers_scd2"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_scd2__dbt_tmp155519506446'
        
      order by ordinal_position

  
[0m15:55:19.518063 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.001 seconds
[0m15:55:19.520052 [debug] [Thread-1 (]: Using postgres connection "snapshot.modelling_handson.customers_scd2"
[0m15:55:19.520304 [debug] [Thread-1 (]: On snapshot.modelling_handson.customers_scd2: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "snapshot.modelling_handson.customers_scd2"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "salesdb".INFORMATION_SCHEMA.columns
      where table_name = 'customers_scd2'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m15:55:19.521737 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.001 seconds
[0m15:55:19.523520 [debug] [Thread-1 (]: Using postgres connection "snapshot.modelling_handson.customers_scd2"
[0m15:55:19.523765 [debug] [Thread-1 (]: On snapshot.modelling_handson.customers_scd2: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "snapshot.modelling_handson.customers_scd2"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_scd2__dbt_tmp155519506446'
        
      order by ordinal_position

  
[0m15:55:19.525379 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.001 seconds
[0m15:55:19.527300 [debug] [Thread-1 (]: Using postgres connection "snapshot.modelling_handson.customers_scd2"
[0m15:55:19.527539 [debug] [Thread-1 (]: On snapshot.modelling_handson.customers_scd2: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "snapshot.modelling_handson.customers_scd2"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "salesdb".INFORMATION_SCHEMA.columns
      where table_name = 'customers_scd2'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m15:55:19.529033 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.001 seconds
[0m15:55:19.533540 [debug] [Thread-1 (]: Using postgres connection "snapshot.modelling_handson.customers_scd2"
[0m15:55:19.533787 [debug] [Thread-1 (]: On snapshot.modelling_handson.customers_scd2: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "snapshot.modelling_handson.customers_scd2"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_scd2__dbt_tmp155519506446'
        
      order by ordinal_position

  
[0m15:55:19.535461 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.001 seconds
[0m15:55:19.543894 [debug] [Thread-1 (]: Using postgres connection "snapshot.modelling_handson.customers_scd2"
[0m15:55:19.544409 [debug] [Thread-1 (]: On snapshot.modelling_handson.customers_scd2: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "snapshot.modelling_handson.customers_scd2"} */
select * from (
        
    
    with snapshot_query as (

        


select
    customer_nk,
    first_name,
    last_name,
    email,
    city,
    country,
    signup_ts
    from "salesdb"."staging"."stg_customers_latest"


    ),

    snapshotted_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    

        from "salesdb"."snapshots"."customers_scd2"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_nk as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        customer_nk as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."first_name" != source_data."first_name"
        or
        (
            ((snapshotted_data."first_name" is null) and not (source_data."first_name" is null))
            or
            ((not snapshotted_data."first_name" is null) and (source_data."first_name" is null))
        ) or snapshotted_data."last_name" != source_data."last_name"
        or
        (
            ((snapshotted_data."last_name" is null) and not (source_data."last_name" is null))
            or
            ((not snapshotted_data."last_name" is null) and (source_data."last_name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."city" != source_data."city"
        or
        (
            ((snapshotted_data."city" is null) and not (source_data."city" is null))
            or
            ((not snapshotted_data."city" is null) and (source_data."city" is null))
        ) or snapshotted_data."country" != source_data."country"
        or
        (
            ((snapshotted_data."country" is null) and not (source_data."country" is null))
            or
            ((not snapshotted_data."country" is null) and (source_data."country" is null))
        ) or snapshotted_data."signup_ts" != source_data."signup_ts"
        or
        (
            ((snapshotted_data."signup_ts" is null) and not (source_data."signup_ts" is null))
            or
            ((not snapshotted_data."signup_ts" is null) and (source_data."signup_ts" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."first_name" != source_data."first_name"
        or
        (
            ((snapshotted_data."first_name" is null) and not (source_data."first_name" is null))
            or
            ((not snapshotted_data."first_name" is null) and (source_data."first_name" is null))
        ) or snapshotted_data."last_name" != source_data."last_name"
        or
        (
            ((snapshotted_data."last_name" is null) and not (source_data."last_name" is null))
            or
            ((not snapshotted_data."last_name" is null) and (source_data."last_name" is null))
        ) or snapshotted_data."email" != source_data."email"
        or
        (
            ((snapshotted_data."email" is null) and not (source_data."email" is null))
            or
            ((not snapshotted_data."email" is null) and (source_data."email" is null))
        ) or snapshotted_data."city" != source_data."city"
        or
        (
            ((snapshotted_data."city" is null) and not (source_data."city" is null))
            or
            ((not snapshotted_data."city" is null) and (source_data."city" is null))
        ) or snapshotted_data."country" != source_data."country"
        or
        (
            ((snapshotted_data."country" is null) and not (source_data."country" is null))
            or
            ((not snapshotted_data."country" is null) and (source_data."country" is null))
        ) or snapshotted_data."signup_ts" != source_data."signup_ts"
        or
        (
            ((snapshotted_data."signup_ts" is null) and not (source_data."signup_ts" is null))
            or
            ((not snapshotted_data."signup_ts" is null) and (source_data."signup_ts" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m15:55:19.551454 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.006 seconds
[0m15:55:19.553621 [debug] [Thread-1 (]: Using postgres connection "snapshot.modelling_handson.customers_scd2"
[0m15:55:19.553912 [debug] [Thread-1 (]: On snapshot.modelling_handson.customers_scd2: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "snapshot.modelling_handson.customers_scd2"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:55:19.554517 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m15:55:19.554916 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.modelling_handson.customers_scd2"
[0m15:55:19.555303 [debug] [Thread-1 (]: Using postgres connection "snapshot.modelling_handson.customers_scd2"
[0m15:55:19.555543 [debug] [Thread-1 (]: On snapshot.modelling_handson.customers_scd2: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "snapshot.modelling_handson.customers_scd2"} */

      update "salesdb"."snapshots"."customers_scd2"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "customers_scd2__dbt_tmp155519506446" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "salesdb"."snapshots"."customers_scd2".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "salesdb"."snapshots"."customers_scd2".dbt_valid_to is null;
      


    insert into "salesdb"."snapshots"."customers_scd2" ("customer_nk", "first_name", "last_name", "email", "city", "country", "signup_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."customer_nk",DBT_INTERNAL_SOURCE."first_name",DBT_INTERNAL_SOURCE."last_name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."city",DBT_INTERNAL_SOURCE."country",DBT_INTERNAL_SOURCE."signup_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "customers_scd2__dbt_tmp155519506446" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:55:19.556457 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m15:55:19.564734 [debug] [Thread-1 (]: On snapshot.modelling_handson.customers_scd2: COMMIT
[0m15:55:19.565228 [debug] [Thread-1 (]: Using postgres connection "snapshot.modelling_handson.customers_scd2"
[0m15:55:19.565603 [debug] [Thread-1 (]: On snapshot.modelling_handson.customers_scd2: COMMIT
[0m15:55:19.567861 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:55:19.572678 [debug] [Thread-1 (]: On snapshot.modelling_handson.customers_scd2: Close
[0m15:55:19.573890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eef12060-f37c-48bf-b05b-37899b7d1c95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d276b161b10>]}
[0m15:55:19.574412 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.customers_scd2 ................................. [[32mINSERT 0 1[0m in 0.20s]
[0m15:55:19.574832 [debug] [Thread-1 (]: Finished running node snapshot.modelling_handson.customers_scd2
[0m15:55:19.575826 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:19.576028 [debug] [MainThread]: On master: BEGIN
[0m15:55:19.576185 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:55:19.580715 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:55:19.581082 [debug] [MainThread]: On master: COMMIT
[0m15:55:19.581277 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:19.581455 [debug] [MainThread]: On master: COMMIT
[0m15:55:19.582155 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:55:19.582504 [debug] [MainThread]: On master: Close
[0m15:55:19.582859 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:55:19.583031 [debug] [MainThread]: Connection 'snapshot.modelling_handson.customers_scd2' was properly closed.
[0m15:55:19.583270 [info ] [MainThread]: 
[0m15:55:19.583496 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m15:55:19.583891 [debug] [MainThread]: Command end result
[0m15:55:19.597132 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m15:55:19.598479 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m15:55:19.602726 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m15:55:19.603009 [info ] [MainThread]: 
[0m15:55:19.603278 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:55:19.603466 [info ] [MainThread]: 
[0m15:55:19.603776 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:55:19.604109 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:55:19.604824 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.74143004, "process_in_blocks": "0", "process_kernel_time": 0.15422, "process_mem_max_rss": "123020", "process_out_blocks": "1880", "process_user_time": 1.473212}
[0m15:55:19.605116 [debug] [MainThread]: Command `dbt snapshot` succeeded at 15:55:19.605051 after 0.74 seconds
[0m15:55:19.605333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d276e821190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d276e9ffbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d276a2d4b90>]}
[0m15:55:19.605554 [debug] [MainThread]: Flushing usage events
[0m15:55:21.072715 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:05:51.356016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36d9f92850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36d9feb650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36da0c9490>]}


============================== 16:05:51.358069 | 98c61ddd-41ba-46a5-8acd-03edf01c9177 ==============================
[0m16:05:51.358069 [info ] [MainThread]: Running with dbt=1.10.7
[0m16:05:51.358409 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/subhan/.dbt', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m16:05:51.392134 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m16:05:51.392688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '98c61ddd-41ba-46a5-8acd-03edf01c9177', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36d9eca850>]}
[0m16:05:51.469017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98c61ddd-41ba-46a5-8acd-03edf01c9177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36d9501f90>]}
[0m16:05:51.511075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98c61ddd-41ba-46a5-8acd-03edf01c9177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36dcbbf290>]}
[0m16:05:51.511680 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:05:51.565354 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m16:05:51.648406 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:05:51.648863 [debug] [MainThread]: Partial parsing: added file: modelling_handson://models/marts/type3_customers.sql
[0m16:05:51.649209 [debug] [MainThread]: Partial parsing: updated file: modelling_handson://data/seeds/customers_day2.csv
[0m16:05:51.920764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98c61ddd-41ba-46a5-8acd-03edf01c9177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36d8f3a990>]}
[0m16:05:52.022238 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m16:05:52.023503 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m16:05:52.031740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98c61ddd-41ba-46a5-8acd-03edf01c9177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36d9026b50>]}
[0m16:05:52.032139 [info ] [MainThread]: Found 6 models, 3 seeds, 1 snapshot, 3 sources, 435 macros
[0m16:05:52.032385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98c61ddd-41ba-46a5-8acd-03edf01c9177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36d907a890>]}
[0m16:05:52.033563 [info ] [MainThread]: 
[0m16:05:52.033983 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:05:52.034195 [info ] [MainThread]: 
[0m16:05:52.034581 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:05:52.037443 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb'
[0m16:05:52.058665 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m16:05:52.059029 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m16:05:52.059216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:52.063075 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.004 seconds
[0m16:05:52.063954 [debug] [ThreadPool]: On list_salesdb: Close
[0m16:05:52.065318 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb, now list_salesdb_public_raw_data)
[0m16:05:52.068768 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m16:05:52.069004 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m16:05:52.069176 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:05:52.071709 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m16:05:52.071924 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m16:05:52.072109 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m16:05:52.073832 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m16:05:52.074679 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m16:05:52.075124 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m16:05:52.075521 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now list_salesdb_staging)
[0m16:05:52.077037 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m16:05:52.077266 [debug] [ThreadPool]: On list_salesdb_staging: BEGIN
[0m16:05:52.077514 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:05:52.080474 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:05:52.080693 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m16:05:52.080973 [debug] [ThreadPool]: On list_salesdb_staging: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_staging"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m16:05:52.082499 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.001 seconds
[0m16:05:52.083238 [debug] [ThreadPool]: On list_salesdb_staging: ROLLBACK
[0m16:05:52.083903 [debug] [ThreadPool]: On list_salesdb_staging: Close
[0m16:05:52.084376 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_staging, now list_salesdb_snapshots)
[0m16:05:52.085959 [debug] [ThreadPool]: Using postgres connection "list_salesdb_snapshots"
[0m16:05:52.086185 [debug] [ThreadPool]: On list_salesdb_snapshots: BEGIN
[0m16:05:52.086339 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:05:52.088988 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:05:52.089221 [debug] [ThreadPool]: Using postgres connection "list_salesdb_snapshots"
[0m16:05:52.089429 [debug] [ThreadPool]: On list_salesdb_snapshots: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_snapshots"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:05:52.090963 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m16:05:52.091710 [debug] [ThreadPool]: On list_salesdb_snapshots: ROLLBACK
[0m16:05:52.092147 [debug] [ThreadPool]: On list_salesdb_snapshots: Close
[0m16:05:52.092549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_snapshots, now list_salesdb_marts)
[0m16:05:52.094069 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m16:05:52.094327 [debug] [ThreadPool]: On list_salesdb_marts: BEGIN
[0m16:05:52.094493 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:05:52.097062 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:05:52.097313 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m16:05:52.097494 [debug] [ThreadPool]: On list_salesdb_marts: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_marts"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m16:05:52.099108 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.001 seconds
[0m16:05:52.099893 [debug] [ThreadPool]: On list_salesdb_marts: ROLLBACK
[0m16:05:52.100403 [debug] [ThreadPool]: On list_salesdb_marts: Close
[0m16:05:52.103674 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:52.103958 [debug] [MainThread]: On master: BEGIN
[0m16:05:52.104130 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:05:52.107245 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m16:05:52.107486 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:52.107769 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:05:52.115742 [debug] [MainThread]: SQL status: SELECT 6 in 0.008 seconds
[0m16:05:52.117456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98c61ddd-41ba-46a5-8acd-03edf01c9177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36d8dff090>]}
[0m16:05:52.117759 [debug] [MainThread]: On master: ROLLBACK
[0m16:05:52.118248 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:52.118468 [debug] [MainThread]: On master: BEGIN
[0m16:05:52.119382 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:05:52.119612 [debug] [MainThread]: On master: COMMIT
[0m16:05:52.119786 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:52.119938 [debug] [MainThread]: On master: COMMIT
[0m16:05:52.120423 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:05:52.120657 [debug] [MainThread]: On master: Close
[0m16:05:52.122715 [debug] [Thread-1 (]: Began running node seed.modelling_handson.customers_day1
[0m16:05:52.123046 [info ] [Thread-1 (]: 1 of 3 START seed file public_raw_data.customers_day1 .......................... [RUN]
[0m16:05:52.123338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_marts, now seed.modelling_handson.customers_day1)
[0m16:05:52.123534 [debug] [Thread-1 (]: Began compiling node seed.modelling_handson.customers_day1
[0m16:05:52.123720 [debug] [Thread-1 (]: Began executing node seed.modelling_handson.customers_day1
[0m16:05:52.141888 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_day1"
[0m16:05:52.142251 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day1: BEGIN
[0m16:05:52.142453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:52.145482 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m16:05:52.145831 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_day1"
[0m16:05:52.146030 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day1: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "seed.modelling_handson.customers_day1"} */
truncate table "salesdb"."public_raw_data"."customers_day1"
[0m16:05:52.148811 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.003 seconds
[0m16:05:52.158920 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_day1"
[0m16:05:52.159274 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day1: 
          insert into "salesdb"."public_raw_data"."customers_day1" (customer_nk, first_name, last_name, email, city, country, signup_ts, change_ts) values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m16:05:52.160113 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.001 seconds
[0m16:05:52.163380 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.modelling_handson.customers_day1"
[0m16:05:52.172406 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day1: COMMIT
[0m16:05:52.172792 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_day1"
[0m16:05:52.173029 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day1: COMMIT
[0m16:05:52.175258 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:05:52.176613 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day1: Close
[0m16:05:52.177701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98c61ddd-41ba-46a5-8acd-03edf01c9177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36d843f490>]}
[0m16:05:52.178084 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file public_raw_data.customers_day1 ...................... [[32mINSERT 3[0m in 0.05s]
[0m16:05:52.178696 [debug] [Thread-1 (]: Finished running node seed.modelling_handson.customers_day1
[0m16:05:52.179049 [debug] [Thread-1 (]: Began running node seed.modelling_handson.customers_day2
[0m16:05:52.179503 [info ] [Thread-1 (]: 2 of 3 START seed file public_raw_data.customers_day2 .......................... [RUN]
[0m16:05:52.179819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.modelling_handson.customers_day1, now seed.modelling_handson.customers_day2)
[0m16:05:52.180024 [debug] [Thread-1 (]: Began compiling node seed.modelling_handson.customers_day2
[0m16:05:52.180230 [debug] [Thread-1 (]: Began executing node seed.modelling_handson.customers_day2
[0m16:05:52.183373 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_day2"
[0m16:05:52.183677 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day2: BEGIN
[0m16:05:52.183885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:52.187074 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m16:05:52.187462 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_day2"
[0m16:05:52.187816 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day2: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "seed.modelling_handson.customers_day2"} */
truncate table "salesdb"."public_raw_data"."customers_day2"
[0m16:05:52.190094 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.002 seconds
[0m16:05:52.192324 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_day2"
[0m16:05:52.192584 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day2: 
          insert into "salesdb"."public_raw_data"."customers_day2" (customer_nk, first_name, last_name, email, city, country, signup_ts, change_ts) values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m16:05:52.193300 [debug] [Thread-1 (]: SQL status: INSERT 0 4 in 0.000 seconds
[0m16:05:52.193756 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.modelling_handson.customers_day2"
[0m16:05:52.194691 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day2: COMMIT
[0m16:05:52.194942 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_day2"
[0m16:05:52.195147 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day2: COMMIT
[0m16:05:52.196073 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:05:52.196613 [debug] [Thread-1 (]: On seed.modelling_handson.customers_day2: Close
[0m16:05:52.197031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98c61ddd-41ba-46a5-8acd-03edf01c9177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36d82ed7d0>]}
[0m16:05:52.197356 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file public_raw_data.customers_day2 ...................... [[32mINSERT 4[0m in 0.02s]
[0m16:05:52.197727 [debug] [Thread-1 (]: Finished running node seed.modelling_handson.customers_day2
[0m16:05:52.197976 [debug] [Thread-1 (]: Began running node seed.modelling_handson.customers_initial
[0m16:05:52.198256 [info ] [Thread-1 (]: 3 of 3 START seed file public_raw_data.customers_initial ....................... [RUN]
[0m16:05:52.198684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.modelling_handson.customers_day2, now seed.modelling_handson.customers_initial)
[0m16:05:52.198953 [debug] [Thread-1 (]: Began compiling node seed.modelling_handson.customers_initial
[0m16:05:52.199177 [debug] [Thread-1 (]: Began executing node seed.modelling_handson.customers_initial
[0m16:05:52.202202 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_initial"
[0m16:05:52.202482 [debug] [Thread-1 (]: On seed.modelling_handson.customers_initial: BEGIN
[0m16:05:52.202757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:52.205798 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m16:05:52.206222 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_initial"
[0m16:05:52.206847 [debug] [Thread-1 (]: On seed.modelling_handson.customers_initial: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "seed.modelling_handson.customers_initial"} */
truncate table "salesdb"."public_raw_data"."customers_initial"
[0m16:05:52.209213 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.002 seconds
[0m16:05:52.211560 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_initial"
[0m16:05:52.211837 [debug] [Thread-1 (]: On seed.modelling_handson.customers_initial: 
          insert into "salesdb"."public_raw_data"."customers_initial" (customer_nk, first_name, last_name, email, city, country, signup_ts) values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s)
      ...
[0m16:05:52.212509 [debug] [Thread-1 (]: SQL status: INSERT 0 4 in 0.000 seconds
[0m16:05:52.212903 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.modelling_handson.customers_initial"
[0m16:05:52.213874 [debug] [Thread-1 (]: On seed.modelling_handson.customers_initial: COMMIT
[0m16:05:52.214118 [debug] [Thread-1 (]: Using postgres connection "seed.modelling_handson.customers_initial"
[0m16:05:52.214311 [debug] [Thread-1 (]: On seed.modelling_handson.customers_initial: COMMIT
[0m16:05:52.215691 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:05:52.216277 [debug] [Thread-1 (]: On seed.modelling_handson.customers_initial: Close
[0m16:05:52.216757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98c61ddd-41ba-46a5-8acd-03edf01c9177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36d8ff65d0>]}
[0m16:05:52.217140 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file public_raw_data.customers_initial ................... [[32mINSERT 4[0m in 0.02s]
[0m16:05:52.217542 [debug] [Thread-1 (]: Finished running node seed.modelling_handson.customers_initial
[0m16:05:52.218998 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:52.219220 [debug] [MainThread]: On master: BEGIN
[0m16:05:52.219410 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:05:52.222398 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m16:05:52.222680 [debug] [MainThread]: On master: COMMIT
[0m16:05:52.222862 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:52.223024 [debug] [MainThread]: On master: COMMIT
[0m16:05:52.223443 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:05:52.223638 [debug] [MainThread]: On master: Close
[0m16:05:52.223906 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:05:52.224065 [debug] [MainThread]: Connection 'seed.modelling_handson.customers_initial' was properly closed.
[0m16:05:52.224262 [info ] [MainThread]: 
[0m16:05:52.224482 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m16:05:52.225051 [debug] [MainThread]: Command end result
[0m16:05:52.240683 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m16:05:52.242781 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m16:05:52.247477 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m16:05:52.247770 [info ] [MainThread]: 
[0m16:05:52.248168 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:05:52.248381 [info ] [MainThread]: 
[0m16:05:52.248685 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m16:05:52.249111 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:05:52.249875 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.92991304, "process_in_blocks": "0", "process_kernel_time": 0.165853, "process_mem_max_rss": "126864", "process_out_blocks": "2768", "process_user_time": 1.646403}
[0m16:05:52.250798 [debug] [MainThread]: Command `dbt seed` succeeded at 16:05:52.250304 after 0.93 seconds
[0m16:05:52.251204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36da13e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36da133550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36de525210>]}
[0m16:05:52.251568 [debug] [MainThread]: Flushing usage events
[0m16:05:53.807818 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:06:19.477653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d2c0e98310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d2c0e99fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d2c0e98690>]}


============================== 16:06:19.479658 | 0adaba26-e669-4184-a550-8e3b3c28e53a ==============================
[0m16:06:19.479658 [info ] [MainThread]: Running with dbt=1.10.7
[0m16:06:19.480034 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/subhan/.dbt', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select type3_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:06:19.512663 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m16:06:19.513084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0adaba26-e669-4184-a550-8e3b3c28e53a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d2c0d40c90>]}
[0m16:06:19.589779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0adaba26-e669-4184-a550-8e3b3c28e53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d2c1046cd0>]}
[0m16:06:19.633889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0adaba26-e669-4184-a550-8e3b3c28e53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d2c3aabad0>]}
[0m16:06:19.634469 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:06:19.682069 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m16:06:19.766633 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:06:19.766923 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:06:19.806311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0adaba26-e669-4184-a550-8e3b3c28e53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d2c0290dd0>]}
[0m16:06:19.865803 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m16:06:19.867104 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m16:06:19.874732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0adaba26-e669-4184-a550-8e3b3c28e53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d2c00d3910>]}
[0m16:06:19.875082 [info ] [MainThread]: Found 6 models, 3 seeds, 1 snapshot, 3 sources, 435 macros
[0m16:06:19.875459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0adaba26-e669-4184-a550-8e3b3c28e53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d2c023b050>]}
[0m16:06:19.876724 [info ] [MainThread]: 
[0m16:06:19.877073 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:06:19.877492 [info ] [MainThread]: 
[0m16:06:19.877848 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:06:19.878542 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb'
[0m16:06:19.898460 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m16:06:19.898836 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m16:06:19.899037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:19.902908 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.004 seconds
[0m16:06:19.904073 [debug] [ThreadPool]: On list_salesdb: Close
[0m16:06:19.908971 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb, now list_salesdb_staging)
[0m16:06:19.912647 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m16:06:19.912929 [debug] [ThreadPool]: On list_salesdb_staging: BEGIN
[0m16:06:19.913110 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:19.916252 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:06:19.916539 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m16:06:19.916735 [debug] [ThreadPool]: On list_salesdb_staging: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_staging"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m16:06:19.918314 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.001 seconds
[0m16:06:19.919099 [debug] [ThreadPool]: On list_salesdb_staging: ROLLBACK
[0m16:06:19.919517 [debug] [ThreadPool]: On list_salesdb_staging: Close
[0m16:06:19.919957 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_staging, now list_salesdb_public_raw_data)
[0m16:06:19.921574 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m16:06:19.921781 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m16:06:19.921937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:19.924492 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:06:19.924758 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m16:06:19.925028 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m16:06:19.927011 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m16:06:19.927898 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m16:06:19.928323 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m16:06:19.928742 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now list_salesdb_marts)
[0m16:06:19.930280 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m16:06:19.931141 [debug] [ThreadPool]: On list_salesdb_marts: BEGIN
[0m16:06:19.931415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:19.935764 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m16:06:19.936215 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m16:06:19.936536 [debug] [ThreadPool]: On list_salesdb_marts: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_marts"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m16:06:19.938354 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m16:06:19.939255 [debug] [ThreadPool]: On list_salesdb_marts: ROLLBACK
[0m16:06:19.939759 [debug] [ThreadPool]: On list_salesdb_marts: Close
[0m16:06:19.940235 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_marts, now list_salesdb_snapshots)
[0m16:06:19.941962 [debug] [ThreadPool]: Using postgres connection "list_salesdb_snapshots"
[0m16:06:19.942239 [debug] [ThreadPool]: On list_salesdb_snapshots: BEGIN
[0m16:06:19.942416 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:19.945535 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:06:19.945797 [debug] [ThreadPool]: Using postgres connection "list_salesdb_snapshots"
[0m16:06:19.946034 [debug] [ThreadPool]: On list_salesdb_snapshots: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_snapshots"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:06:19.947612 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m16:06:19.948469 [debug] [ThreadPool]: On list_salesdb_snapshots: ROLLBACK
[0m16:06:19.948951 [debug] [ThreadPool]: On list_salesdb_snapshots: Close
[0m16:06:19.952384 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:19.952637 [debug] [MainThread]: On master: BEGIN
[0m16:06:19.952822 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:06:19.955406 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m16:06:19.955634 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:19.955873 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:06:19.964630 [debug] [MainThread]: SQL status: SELECT 6 in 0.008 seconds
[0m16:06:19.966707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0adaba26-e669-4184-a550-8e3b3c28e53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d2c17bc810>]}
[0m16:06:19.967047 [debug] [MainThread]: On master: ROLLBACK
[0m16:06:19.967575 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:19.967891 [debug] [MainThread]: On master: BEGIN
[0m16:06:19.968500 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:06:19.968742 [debug] [MainThread]: On master: COMMIT
[0m16:06:19.968945 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:19.969143 [debug] [MainThread]: On master: COMMIT
[0m16:06:19.969526 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:06:19.969746 [debug] [MainThread]: On master: Close
[0m16:06:19.971789 [debug] [Thread-1 (]: Began running node model.modelling_handson.type3_customers
[0m16:06:19.972269 [info ] [Thread-1 (]: 1 of 1 START sql table model marts.type3_customers ............................. [RUN]
[0m16:06:19.972775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_snapshots, now model.modelling_handson.type3_customers)
[0m16:06:19.973032 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.type3_customers
[0m16:06:19.980555 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.type3_customers"
[0m16:06:19.982440 [debug] [Thread-1 (]: Began executing node model.modelling_handson.type3_customers
[0m16:06:20.045902 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.type3_customers"
[0m16:06:20.047799 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.type3_customers"
[0m16:06:20.048204 [debug] [Thread-1 (]: On model.modelling_handson.type3_customers: BEGIN
[0m16:06:20.048431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:20.051464 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m16:06:20.051726 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.type3_customers"
[0m16:06:20.052064 [debug] [Thread-1 (]: On model.modelling_handson.type3_customers: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.type3_customers"} */

  
    

  create  table "salesdb"."marts"."type3_customers__dbt_tmp"
  
  
    as
  
  (
    

with unioned as (
  select customer_nk, first_name, last_name, email, city, country, signup_ts, coalesce(null::timestamp. signup_ts) as change_ts
  from "salesdb"."staging"."stg_customers_initial"
  union all
  select customer_nk, first_name, last_name, email, city, country, change_ts
  from "salesdb"."staging"."stg_customers_day1"
  union all
  select customer_nk, first_name, last_name, email, city, country, change_ts
  from "salesdb"."staging"."stg_customers_day2"
),
ordered as (
  select *,
         row_number() over (partition by customer_nk order by coalesce(change_ts, '1900-01-01') desc) as rn
         lead(city) over (partition by customer_nk order by coalesce(change_ts, '1900-01-01') desc) as prev_city
  from unioned
)
select 
  customer_nk,
  first_name,
  last_name,
  email,
  city as current_city,
  prev_city
from ordered
where rn = 1



  );
  
[0m16:06:20.052612 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "."
LINE 15: ...city, country, signup_ts, coalesce(null::timestamp. signup_t...
                                                              ^

[0m16:06:20.052842 [debug] [Thread-1 (]: On model.modelling_handson.type3_customers: ROLLBACK
[0m16:06:20.053266 [debug] [Thread-1 (]: On model.modelling_handson.type3_customers: Close
[0m16:06:20.055411 [debug] [Thread-1 (]: Database Error in model type3_customers (models/marts/type3_customers.sql)
  syntax error at or near "."
  LINE 15: ...city, country, signup_ts, coalesce(null::timestamp. signup_t...
                                                                ^
  compiled code at target/run/modelling_handson/models/marts/type3_customers.sql
[0m16:06:20.056503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0adaba26-e669-4184-a550-8e3b3c28e53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d2c00c96d0>]}
[0m16:06:20.056954 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model marts.type3_customers .................... [[31mERROR[0m in 0.08s]
[0m16:06:20.057344 [debug] [Thread-1 (]: Finished running node model.modelling_handson.type3_customers
[0m16:06:20.057751 [debug] [Thread-4 (]: Marking all children of 'model.modelling_handson.type3_customers' to be skipped because of status 'error'.  Reason: Database Error in model type3_customers (models/marts/type3_customers.sql)
  syntax error at or near "."
  LINE 15: ...city, country, signup_ts, coalesce(null::timestamp. signup_t...
                                                                ^
  compiled code at target/run/modelling_handson/models/marts/type3_customers.sql.
[0m16:06:20.059228 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:20.059441 [debug] [MainThread]: On master: BEGIN
[0m16:06:20.059607 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:06:20.062883 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m16:06:20.063233 [debug] [MainThread]: On master: COMMIT
[0m16:06:20.063423 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:20.063587 [debug] [MainThread]: On master: COMMIT
[0m16:06:20.064045 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:06:20.064300 [debug] [MainThread]: On master: Close
[0m16:06:20.064592 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:06:20.064775 [debug] [MainThread]: Connection 'model.modelling_handson.type3_customers' was properly closed.
[0m16:06:20.064965 [info ] [MainThread]: 
[0m16:06:20.065178 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m16:06:20.065614 [debug] [MainThread]: Command end result
[0m16:06:20.079417 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m16:06:20.080752 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m16:06:20.084382 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m16:06:20.084666 [info ] [MainThread]: 
[0m16:06:20.084957 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:06:20.085182 [info ] [MainThread]: 
[0m16:06:20.085512 [error] [MainThread]: [31mFailure in model type3_customers (models/marts/type3_customers.sql)[0m
[0m16:06:20.085841 [error] [MainThread]:   Database Error in model type3_customers (models/marts/type3_customers.sql)
  syntax error at or near "."
  LINE 15: ...city, country, signup_ts, coalesce(null::timestamp. signup_t...
                                                                ^
  compiled code at target/run/modelling_handson/models/marts/type3_customers.sql
[0m16:06:20.086057 [info ] [MainThread]: 
[0m16:06:20.086287 [info ] [MainThread]:   compiled code at target/compiled/modelling_handson/models/marts/type3_customers.sql
[0m16:06:20.086463 [info ] [MainThread]: 
[0m16:06:20.086676 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:06:20.087027 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:06:20.087664 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.646797, "process_in_blocks": "24", "process_kernel_time": 0.165655, "process_mem_max_rss": "122248", "process_out_blocks": "1872", "process_user_time": 1.365648}
[0m16:06:20.088099 [debug] [MainThread]: Command `dbt run` failed at 16:06:20.088015 after 0.65 seconds
[0m16:06:20.088381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d2c534ecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d2c02f6c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d2c0e92dd0>]}
[0m16:06:20.088624 [debug] [MainThread]: Flushing usage events
[0m16:06:21.483781 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:06:50.380366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74591fcd58d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745920bea250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74591fe7e750>]}


============================== 16:06:50.382457 | 6b604449-4954-4dff-8138-9f78d784eb03 ==============================
[0m16:06:50.382457 [info ] [MainThread]: Running with dbt=1.10.7
[0m16:06:50.382821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'version_check': 'True', 'profiles_dir': '/home/subhan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select type3_customers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:06:50.415140 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m16:06:50.415556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6b604449-4954-4dff-8138-9f78d784eb03', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74591fcc9cd0>]}
[0m16:06:50.491513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b604449-4954-4dff-8138-9f78d784eb03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74591f2d00d0>]}
[0m16:06:50.533893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b604449-4954-4dff-8138-9f78d784eb03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745922937c90>]}
[0m16:06:50.534607 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:06:50.583434 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m16:06:50.668654 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:06:50.669144 [debug] [MainThread]: Partial parsing: updated file: modelling_handson://models/marts/type3_customers.sql
[0m16:06:50.874184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b604449-4954-4dff-8138-9f78d784eb03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74591efa3a90>]}
[0m16:06:50.941570 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m16:06:50.943850 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m16:06:50.954438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b604449-4954-4dff-8138-9f78d784eb03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74591eea5250>]}
[0m16:06:50.954944 [info ] [MainThread]: Found 6 models, 3 seeds, 1 snapshot, 3 sources, 435 macros
[0m16:06:50.955280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b604449-4954-4dff-8138-9f78d784eb03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74591ee615d0>]}
[0m16:06:50.957550 [info ] [MainThread]: 
[0m16:06:50.958186 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:06:50.958780 [info ] [MainThread]: 
[0m16:06:50.959233 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:06:50.960119 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb'
[0m16:06:51.039983 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m16:06:51.040356 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m16:06:51.040567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:51.044609 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.004 seconds
[0m16:06:51.045618 [debug] [ThreadPool]: On list_salesdb: Close
[0m16:06:51.049677 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb, now list_salesdb_public_raw_data)
[0m16:06:51.053260 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m16:06:51.053530 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m16:06:51.053757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:51.056665 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:06:51.056936 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m16:06:51.057128 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m16:06:51.059062 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m16:06:51.059953 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m16:06:51.060331 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m16:06:51.060755 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now list_salesdb_marts)
[0m16:06:51.062436 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m16:06:51.062661 [debug] [ThreadPool]: On list_salesdb_marts: BEGIN
[0m16:06:51.062826 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:51.066349 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:06:51.066641 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m16:06:51.066936 [debug] [ThreadPool]: On list_salesdb_marts: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_marts"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m16:06:51.068701 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m16:06:51.069691 [debug] [ThreadPool]: On list_salesdb_marts: ROLLBACK
[0m16:06:51.070121 [debug] [ThreadPool]: On list_salesdb_marts: Close
[0m16:06:51.070708 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_marts, now list_salesdb_snapshots)
[0m16:06:51.072471 [debug] [ThreadPool]: Using postgres connection "list_salesdb_snapshots"
[0m16:06:51.072688 [debug] [ThreadPool]: On list_salesdb_snapshots: BEGIN
[0m16:06:51.072860 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:51.075829 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:06:51.076111 [debug] [ThreadPool]: Using postgres connection "list_salesdb_snapshots"
[0m16:06:51.076300 [debug] [ThreadPool]: On list_salesdb_snapshots: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_snapshots"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:06:51.078018 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m16:06:51.079486 [debug] [ThreadPool]: On list_salesdb_snapshots: ROLLBACK
[0m16:06:51.080015 [debug] [ThreadPool]: On list_salesdb_snapshots: Close
[0m16:06:51.080444 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_snapshots, now list_salesdb_staging)
[0m16:06:51.081929 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m16:06:51.082154 [debug] [ThreadPool]: On list_salesdb_staging: BEGIN
[0m16:06:51.082325 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:51.085161 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:06:51.085442 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m16:06:51.085679 [debug] [ThreadPool]: On list_salesdb_staging: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_staging"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m16:06:51.087318 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.001 seconds
[0m16:06:51.088315 [debug] [ThreadPool]: On list_salesdb_staging: ROLLBACK
[0m16:06:51.088741 [debug] [ThreadPool]: On list_salesdb_staging: Close
[0m16:06:51.092570 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:51.092846 [debug] [MainThread]: On master: BEGIN
[0m16:06:51.093033 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:06:51.096020 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m16:06:51.096272 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:51.096488 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:06:51.104747 [debug] [MainThread]: SQL status: SELECT 6 in 0.008 seconds
[0m16:06:51.106557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b604449-4954-4dff-8138-9f78d784eb03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74591ed8bc90>]}
[0m16:06:51.106899 [debug] [MainThread]: On master: ROLLBACK
[0m16:06:51.107398 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:51.107623 [debug] [MainThread]: On master: BEGIN
[0m16:06:51.108190 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:06:51.108417 [debug] [MainThread]: On master: COMMIT
[0m16:06:51.108614 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:51.108790 [debug] [MainThread]: On master: COMMIT
[0m16:06:51.109123 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:06:51.109401 [debug] [MainThread]: On master: Close
[0m16:06:51.111363 [debug] [Thread-1 (]: Began running node model.modelling_handson.type3_customers
[0m16:06:51.111754 [info ] [Thread-1 (]: 1 of 1 START sql table model marts.type3_customers ............................. [RUN]
[0m16:06:51.112072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_staging, now model.modelling_handson.type3_customers)
[0m16:06:51.112305 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.type3_customers
[0m16:06:51.117881 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.type3_customers"
[0m16:06:51.118414 [debug] [Thread-1 (]: Began executing node model.modelling_handson.type3_customers
[0m16:06:51.144721 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.type3_customers"
[0m16:06:51.145437 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.type3_customers"
[0m16:06:51.145963 [debug] [Thread-1 (]: On model.modelling_handson.type3_customers: BEGIN
[0m16:06:51.146281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:51.149441 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m16:06:51.150057 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.type3_customers"
[0m16:06:51.150376 [debug] [Thread-1 (]: On model.modelling_handson.type3_customers: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.type3_customers"} */

  
    

  create  table "salesdb"."marts"."type3_customers__dbt_tmp"
  
  
    as
  
  (
    

with unioned as (
  select customer_nk, first_name, last_name, email, city, country, signup_ts, coalesce(null::timestamp, signup_ts) as change_ts
  from "salesdb"."staging"."stg_customers_initial"
  union all
  select customer_nk, first_name, last_name, email, city, country, change_ts
  from "salesdb"."staging"."stg_customers_day1"
  union all
  select customer_nk, first_name, last_name, email, city, country, change_ts
  from "salesdb"."staging"."stg_customers_day2"
),
ordered as (
  select *,
         row_number() over (partition by customer_nk order by coalesce(change_ts, '1900-01-01') desc) as rn
         lead(city) over (partition by customer_nk order by coalesce(change_ts, '1900-01-01') desc) as prev_city
  from unioned
)
select 
  customer_nk,
  first_name,
  last_name,
  email,
  city as current_city,
  prev_city
from ordered
where rn = 1



  );
  
[0m16:06:51.150949 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "lead"
LINE 27:          lead(city) over (partition by customer_nk order by ...
                  ^

[0m16:06:51.151202 [debug] [Thread-1 (]: On model.modelling_handson.type3_customers: ROLLBACK
[0m16:06:51.151693 [debug] [Thread-1 (]: On model.modelling_handson.type3_customers: Close
[0m16:06:51.154015 [debug] [Thread-1 (]: Database Error in model type3_customers (models/marts/type3_customers.sql)
  syntax error at or near "lead"
  LINE 27:          lead(city) over (partition by customer_nk order by ...
                    ^
  compiled code at target/run/modelling_handson/models/marts/type3_customers.sql
[0m16:06:51.155270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b604449-4954-4dff-8138-9f78d784eb03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74591f1ba190>]}
[0m16:06:51.155694 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model marts.type3_customers .................... [[31mERROR[0m in 0.04s]
[0m16:06:51.156050 [debug] [Thread-1 (]: Finished running node model.modelling_handson.type3_customers
[0m16:06:51.156473 [debug] [Thread-4 (]: Marking all children of 'model.modelling_handson.type3_customers' to be skipped because of status 'error'.  Reason: Database Error in model type3_customers (models/marts/type3_customers.sql)
  syntax error at or near "lead"
  LINE 27:          lead(city) over (partition by customer_nk order by ...
                    ^
  compiled code at target/run/modelling_handson/models/marts/type3_customers.sql.
[0m16:06:51.158136 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:51.158372 [debug] [MainThread]: On master: BEGIN
[0m16:06:51.158557 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:06:51.161382 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m16:06:51.161708 [debug] [MainThread]: On master: COMMIT
[0m16:06:51.161887 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:51.162056 [debug] [MainThread]: On master: COMMIT
[0m16:06:51.162409 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:06:51.162605 [debug] [MainThread]: On master: Close
[0m16:06:51.162981 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:06:51.163188 [debug] [MainThread]: Connection 'model.modelling_handson.type3_customers' was properly closed.
[0m16:06:51.163429 [info ] [MainThread]: 
[0m16:06:51.163684 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m16:06:51.164259 [debug] [MainThread]: Command end result
[0m16:06:51.179986 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m16:06:51.181629 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m16:06:51.186165 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m16:06:51.186445 [info ] [MainThread]: 
[0m16:06:51.187227 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:06:51.187514 [info ] [MainThread]: 
[0m16:06:51.187794 [error] [MainThread]: [31mFailure in model type3_customers (models/marts/type3_customers.sql)[0m
[0m16:06:51.188054 [error] [MainThread]:   Database Error in model type3_customers (models/marts/type3_customers.sql)
  syntax error at or near "lead"
  LINE 27:          lead(city) over (partition by customer_nk order by ...
                    ^
  compiled code at target/run/modelling_handson/models/marts/type3_customers.sql
[0m16:06:51.188246 [info ] [MainThread]: 
[0m16:06:51.188456 [info ] [MainThread]:   compiled code at target/compiled/modelling_handson/models/marts/type3_customers.sql
[0m16:06:51.188648 [info ] [MainThread]: 
[0m16:06:51.188889 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:06:51.189302 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:06:51.190140 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8472996, "process_in_blocks": "0", "process_kernel_time": 0.146308, "process_mem_max_rss": "125156", "process_out_blocks": "2768", "process_user_time": 1.650036}
[0m16:06:51.190484 [debug] [MainThread]: Command `dbt run` failed at 16:06:51.190422 after 0.85 seconds
[0m16:06:51.190751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745924252c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74592431bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74591fe7e610>]}
[0m16:06:51.191002 [debug] [MainThread]: Flushing usage events
[0m16:06:52.692745 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:07:09.935134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7507f0fc5810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7507f1013d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7507f1012cd0>]}


============================== 16:07:09.937072 | 99e690c6-660b-471a-b859-3d5e04934c60 ==============================
[0m16:07:09.937072 [info ] [MainThread]: Running with dbt=1.10.7
[0m16:07:09.937409 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'profiles_dir': '/home/subhan/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select type3_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:07:09.972571 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m16:07:09.973136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '99e690c6-660b-471a-b859-3d5e04934c60', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7507f0edfb90>]}
[0m16:07:10.047313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99e690c6-660b-471a-b859-3d5e04934c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7507f10191d0>]}
[0m16:07:10.089516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99e690c6-660b-471a-b859-3d5e04934c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7507f0426f90>]}
[0m16:07:10.090162 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:07:10.137190 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m16:07:10.217899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:07:10.218354 [debug] [MainThread]: Partial parsing: updated file: modelling_handson://models/marts/type3_customers.sql
[0m16:07:10.413219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99e690c6-660b-471a-b859-3d5e04934c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7507f01b0ed0>]}
[0m16:07:10.473199 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m16:07:10.474775 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m16:07:10.482154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99e690c6-660b-471a-b859-3d5e04934c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7507f00a63d0>]}
[0m16:07:10.482539 [info ] [MainThread]: Found 6 models, 3 seeds, 1 snapshot, 3 sources, 435 macros
[0m16:07:10.482795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99e690c6-660b-471a-b859-3d5e04934c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7507f007eed0>]}
[0m16:07:10.483693 [info ] [MainThread]: 
[0m16:07:10.483985 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:07:10.484186 [info ] [MainThread]: 
[0m16:07:10.484497 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:07:10.485250 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb'
[0m16:07:10.543137 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m16:07:10.543666 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m16:07:10.543903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:10.547915 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.004 seconds
[0m16:07:10.548816 [debug] [ThreadPool]: On list_salesdb: Close
[0m16:07:10.552289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb, now list_salesdb_public_raw_data)
[0m16:07:10.555906 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m16:07:10.556193 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m16:07:10.556377 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:07:10.559336 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:07:10.559604 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m16:07:10.559797 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m16:07:10.561694 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m16:07:10.562610 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m16:07:10.563052 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m16:07:10.563479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now list_salesdb_snapshots)
[0m16:07:10.565098 [debug] [ThreadPool]: Using postgres connection "list_salesdb_snapshots"
[0m16:07:10.565312 [debug] [ThreadPool]: On list_salesdb_snapshots: BEGIN
[0m16:07:10.565476 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:07:10.568232 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:07:10.568470 [debug] [ThreadPool]: Using postgres connection "list_salesdb_snapshots"
[0m16:07:10.568649 [debug] [ThreadPool]: On list_salesdb_snapshots: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_snapshots"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:07:10.570389 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m16:07:10.571136 [debug] [ThreadPool]: On list_salesdb_snapshots: ROLLBACK
[0m16:07:10.571475 [debug] [ThreadPool]: On list_salesdb_snapshots: Close
[0m16:07:10.571845 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_snapshots, now list_salesdb_marts)
[0m16:07:10.573674 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m16:07:10.573998 [debug] [ThreadPool]: On list_salesdb_marts: BEGIN
[0m16:07:10.574157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:07:10.577209 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:07:10.577432 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m16:07:10.577615 [debug] [ThreadPool]: On list_salesdb_marts: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_marts"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m16:07:10.579198 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.001 seconds
[0m16:07:10.579927 [debug] [ThreadPool]: On list_salesdb_marts: ROLLBACK
[0m16:07:10.580445 [debug] [ThreadPool]: On list_salesdb_marts: Close
[0m16:07:10.580847 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_marts, now list_salesdb_staging)
[0m16:07:10.582302 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m16:07:10.582518 [debug] [ThreadPool]: On list_salesdb_staging: BEGIN
[0m16:07:10.582702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:07:10.585179 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m16:07:10.585397 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m16:07:10.585574 [debug] [ThreadPool]: On list_salesdb_staging: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_staging"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m16:07:10.587046 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.001 seconds
[0m16:07:10.587876 [debug] [ThreadPool]: On list_salesdb_staging: ROLLBACK
[0m16:07:10.588271 [debug] [ThreadPool]: On list_salesdb_staging: Close
[0m16:07:10.591548 [debug] [MainThread]: Using postgres connection "master"
[0m16:07:10.591840 [debug] [MainThread]: On master: BEGIN
[0m16:07:10.592025 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:07:10.595169 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m16:07:10.595453 [debug] [MainThread]: Using postgres connection "master"
[0m16:07:10.595667 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:07:10.605101 [debug] [MainThread]: SQL status: SELECT 6 in 0.009 seconds
[0m16:07:10.607124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99e690c6-660b-471a-b859-3d5e04934c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7507eff536d0>]}
[0m16:07:10.607518 [debug] [MainThread]: On master: ROLLBACK
[0m16:07:10.608112 [debug] [MainThread]: Using postgres connection "master"
[0m16:07:10.608423 [debug] [MainThread]: On master: BEGIN
[0m16:07:10.609298 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:07:10.609599 [debug] [MainThread]: On master: COMMIT
[0m16:07:10.609822 [debug] [MainThread]: Using postgres connection "master"
[0m16:07:10.610022 [debug] [MainThread]: On master: COMMIT
[0m16:07:10.610577 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:07:10.610873 [debug] [MainThread]: On master: Close
[0m16:07:10.613245 [debug] [Thread-1 (]: Began running node model.modelling_handson.type3_customers
[0m16:07:10.613728 [info ] [Thread-1 (]: 1 of 1 START sql table model marts.type3_customers ............................. [RUN]
[0m16:07:10.614249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_staging, now model.modelling_handson.type3_customers)
[0m16:07:10.614596 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.type3_customers
[0m16:07:10.620226 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.type3_customers"
[0m16:07:10.620801 [debug] [Thread-1 (]: Began executing node model.modelling_handson.type3_customers
[0m16:07:10.644954 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.type3_customers"
[0m16:07:10.645655 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.type3_customers"
[0m16:07:10.646033 [debug] [Thread-1 (]: On model.modelling_handson.type3_customers: BEGIN
[0m16:07:10.646250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:10.649338 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m16:07:10.649742 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.type3_customers"
[0m16:07:10.650030 [debug] [Thread-1 (]: On model.modelling_handson.type3_customers: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.type3_customers"} */

  
    

  create  table "salesdb"."marts"."type3_customers__dbt_tmp"
  
  
    as
  
  (
    

with unioned as (
  select customer_nk, first_name, last_name, email, city, country, signup_ts, coalesce(null::timestamp, signup_ts) as change_ts
  from "salesdb"."staging"."stg_customers_initial"
  union all
  select customer_nk, first_name, last_name, email, city, country, change_ts
  from "salesdb"."staging"."stg_customers_day1"
  union all
  select customer_nk, first_name, last_name, email, city, country, change_ts
  from "salesdb"."staging"."stg_customers_day2"
),
ordered as (
  select *,
         row_number() over (partition by customer_nk order by coalesce(change_ts, '1900-01-01') desc) as rn,
         lead(city) over (partition by customer_nk order by coalesce(change_ts, '1900-01-01') desc) as prev_city
  from unioned
)
select 
  customer_nk,
  first_name,
  last_name,
  email,
  city as current_city,
  prev_city
from ordered
where rn = 1



  );
  
[0m16:07:10.650811 [debug] [Thread-1 (]: Postgres adapter: Postgres error: each UNION query must have the same number of columns
LINE 18:   select customer_nk, first_name, last_name, email, city, co...
                  ^

[0m16:07:10.651050 [debug] [Thread-1 (]: On model.modelling_handson.type3_customers: ROLLBACK
[0m16:07:10.651552 [debug] [Thread-1 (]: On model.modelling_handson.type3_customers: Close
[0m16:07:10.653689 [debug] [Thread-1 (]: Database Error in model type3_customers (models/marts/type3_customers.sql)
  each UNION query must have the same number of columns
  LINE 18:   select customer_nk, first_name, last_name, email, city, co...
                    ^
  compiled code at target/run/modelling_handson/models/marts/type3_customers.sql
[0m16:07:10.654796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99e690c6-660b-471a-b859-3d5e04934c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7507ef48b250>]}
[0m16:07:10.655210 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model marts.type3_customers .................... [[31mERROR[0m in 0.04s]
[0m16:07:10.655558 [debug] [Thread-1 (]: Finished running node model.modelling_handson.type3_customers
[0m16:07:10.655902 [debug] [Thread-4 (]: Marking all children of 'model.modelling_handson.type3_customers' to be skipped because of status 'error'.  Reason: Database Error in model type3_customers (models/marts/type3_customers.sql)
  each UNION query must have the same number of columns
  LINE 18:   select customer_nk, first_name, last_name, email, city, co...
                    ^
  compiled code at target/run/modelling_handson/models/marts/type3_customers.sql.
[0m16:07:10.657178 [debug] [MainThread]: Using postgres connection "master"
[0m16:07:10.657391 [debug] [MainThread]: On master: BEGIN
[0m16:07:10.657555 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:07:10.660065 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m16:07:10.660295 [debug] [MainThread]: On master: COMMIT
[0m16:07:10.660500 [debug] [MainThread]: Using postgres connection "master"
[0m16:07:10.660658 [debug] [MainThread]: On master: COMMIT
[0m16:07:10.660989 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:07:10.661210 [debug] [MainThread]: On master: Close
[0m16:07:10.661623 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:07:10.661804 [debug] [MainThread]: Connection 'model.modelling_handson.type3_customers' was properly closed.
[0m16:07:10.661974 [info ] [MainThread]: 
[0m16:07:10.662300 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m16:07:10.662737 [debug] [MainThread]: Command end result
[0m16:07:10.678692 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m16:07:10.680071 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m16:07:10.684048 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m16:07:10.684554 [info ] [MainThread]: 
[0m16:07:10.684814 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:07:10.685021 [info ] [MainThread]: 
[0m16:07:10.685250 [error] [MainThread]: [31mFailure in model type3_customers (models/marts/type3_customers.sql)[0m
[0m16:07:10.685473 [error] [MainThread]:   Database Error in model type3_customers (models/marts/type3_customers.sql)
  each UNION query must have the same number of columns
  LINE 18:   select customer_nk, first_name, last_name, email, city, co...
                    ^
  compiled code at target/run/modelling_handson/models/marts/type3_customers.sql
[0m16:07:10.685791 [info ] [MainThread]: 
[0m16:07:10.686022 [info ] [MainThread]:   compiled code at target/compiled/modelling_handson/models/marts/type3_customers.sql
[0m16:07:10.686458 [info ] [MainThread]: 
[0m16:07:10.686686 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:07:10.687202 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:07:10.687898 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8061262, "process_in_blocks": "0", "process_kernel_time": 0.201281, "process_mem_max_rss": "124964", "process_out_blocks": "2752", "process_user_time": 1.622573}
[0m16:07:10.688196 [debug] [MainThread]: Command `dbt run` failed at 16:07:10.688137 after 0.81 seconds
[0m16:07:10.688452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7507f544ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7507f1019510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7507f5517e90>]}
[0m16:07:10.688671 [debug] [MainThread]: Flushing usage events
[0m16:07:12.192035 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:07:31.707848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b47d04bb4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b47d3115890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b47d04bbc90>]}


============================== 16:07:31.710139 | 24581bbb-a401-4f30-9199-86fcb4f1d064 ==============================
[0m16:07:31.710139 [info ] [MainThread]: Running with dbt=1.10.7
[0m16:07:31.710532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/subhan/dbt/modelling_handson/logs', 'version_check': 'True', 'profiles_dir': '/home/subhan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select type3_customers', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:07:31.742832 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seed-paths' in "<unicode string>", line 41, column 1 in file
`/home/subhan/dbt/modelling_handson/dbt_project.yml`
[0m16:07:31.743311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '24581bbb-a401-4f30-9199-86fcb4f1d064', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b47d04b3810>]}
[0m16:07:31.822709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24581bbb-a401-4f30-9199-86fcb4f1d064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b47cfb2e490>]}
[0m16:07:31.865476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24581bbb-a401-4f30-9199-86fcb4f1d064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b47d3139f50>]}
[0m16:07:31.866072 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:07:31.912945 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m16:07:31.995738 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:07:31.996170 [debug] [MainThread]: Partial parsing: updated file: modelling_handson://models/marts/type3_customers.sql
[0m16:07:32.183397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24581bbb-a401-4f30-9199-86fcb4f1d064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b47cf5f3350>]}
[0m16:07:32.241297 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m16:07:32.242930 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m16:07:32.251592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24581bbb-a401-4f30-9199-86fcb4f1d064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b47cf4a02d0>]}
[0m16:07:32.251963 [info ] [MainThread]: Found 6 models, 3 seeds, 1 snapshot, 3 sources, 435 macros
[0m16:07:32.252209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24581bbb-a401-4f30-9199-86fcb4f1d064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b47cf740990>]}
[0m16:07:32.253079 [info ] [MainThread]: 
[0m16:07:32.253363 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:07:32.253566 [info ] [MainThread]: 
[0m16:07:32.253890 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:07:32.254741 [debug] [ThreadPool]: Acquiring new postgres connection 'list_salesdb'
[0m16:07:32.316914 [debug] [ThreadPool]: Using postgres connection "list_salesdb"
[0m16:07:32.317270 [debug] [ThreadPool]: On list_salesdb: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb"} */

    select distinct nspname from pg_namespace
  
[0m16:07:32.317443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:32.322417 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.005 seconds
[0m16:07:32.323323 [debug] [ThreadPool]: On list_salesdb: Close
[0m16:07:32.326755 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb, now list_salesdb_snapshots)
[0m16:07:32.330318 [debug] [ThreadPool]: Using postgres connection "list_salesdb_snapshots"
[0m16:07:32.330698 [debug] [ThreadPool]: On list_salesdb_snapshots: BEGIN
[0m16:07:32.331147 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:07:32.334362 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:07:32.334604 [debug] [ThreadPool]: Using postgres connection "list_salesdb_snapshots"
[0m16:07:32.334789 [debug] [ThreadPool]: On list_salesdb_snapshots: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_snapshots"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:07:32.336554 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m16:07:32.337334 [debug] [ThreadPool]: On list_salesdb_snapshots: ROLLBACK
[0m16:07:32.337758 [debug] [ThreadPool]: On list_salesdb_snapshots: Close
[0m16:07:32.338174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_snapshots, now list_salesdb_public_raw_data)
[0m16:07:32.339586 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m16:07:32.339803 [debug] [ThreadPool]: On list_salesdb_public_raw_data: BEGIN
[0m16:07:32.339968 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:07:32.342535 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:07:32.342760 [debug] [ThreadPool]: Using postgres connection "list_salesdb_public_raw_data"
[0m16:07:32.342944 [debug] [ThreadPool]: On list_salesdb_public_raw_data: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_public_raw_data"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw_data'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw_data'
  
[0m16:07:32.344635 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.001 seconds
[0m16:07:32.345388 [debug] [ThreadPool]: On list_salesdb_public_raw_data: ROLLBACK
[0m16:07:32.345801 [debug] [ThreadPool]: On list_salesdb_public_raw_data: Close
[0m16:07:32.346178 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_public_raw_data, now list_salesdb_marts)
[0m16:07:32.347704 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m16:07:32.347920 [debug] [ThreadPool]: On list_salesdb_marts: BEGIN
[0m16:07:32.348086 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:07:32.350557 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m16:07:32.350805 [debug] [ThreadPool]: Using postgres connection "list_salesdb_marts"
[0m16:07:32.350990 [debug] [ThreadPool]: On list_salesdb_marts: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_marts"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m16:07:32.352540 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.001 seconds
[0m16:07:32.353340 [debug] [ThreadPool]: On list_salesdb_marts: ROLLBACK
[0m16:07:32.353804 [debug] [ThreadPool]: On list_salesdb_marts: Close
[0m16:07:32.354245 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_salesdb_marts, now list_salesdb_staging)
[0m16:07:32.355682 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m16:07:32.355883 [debug] [ThreadPool]: On list_salesdb_staging: BEGIN
[0m16:07:32.356044 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:07:32.358734 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:07:32.358957 [debug] [ThreadPool]: Using postgres connection "list_salesdb_staging"
[0m16:07:32.359139 [debug] [ThreadPool]: On list_salesdb_staging: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "list_salesdb_staging"} */
select
      'salesdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'salesdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m16:07:32.360743 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.001 seconds
[0m16:07:32.361661 [debug] [ThreadPool]: On list_salesdb_staging: ROLLBACK
[0m16:07:32.362061 [debug] [ThreadPool]: On list_salesdb_staging: Close
[0m16:07:32.365260 [debug] [MainThread]: Using postgres connection "master"
[0m16:07:32.365494 [debug] [MainThread]: On master: BEGIN
[0m16:07:32.365685 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:07:32.368370 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m16:07:32.368659 [debug] [MainThread]: Using postgres connection "master"
[0m16:07:32.368885 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:07:32.376713 [debug] [MainThread]: SQL status: SELECT 6 in 0.008 seconds
[0m16:07:32.378194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24581bbb-a401-4f30-9199-86fcb4f1d064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b47ce9cab10>]}
[0m16:07:32.378543 [debug] [MainThread]: On master: ROLLBACK
[0m16:07:32.379157 [debug] [MainThread]: Using postgres connection "master"
[0m16:07:32.379422 [debug] [MainThread]: On master: BEGIN
[0m16:07:32.380009 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:07:32.380226 [debug] [MainThread]: On master: COMMIT
[0m16:07:32.380415 [debug] [MainThread]: Using postgres connection "master"
[0m16:07:32.380711 [debug] [MainThread]: On master: COMMIT
[0m16:07:32.381061 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:07:32.381264 [debug] [MainThread]: On master: Close
[0m16:07:32.383158 [debug] [Thread-1 (]: Began running node model.modelling_handson.type3_customers
[0m16:07:32.383521 [info ] [Thread-1 (]: 1 of 1 START sql table model marts.type3_customers ............................. [RUN]
[0m16:07:32.383822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_salesdb_staging, now model.modelling_handson.type3_customers)
[0m16:07:32.384029 [debug] [Thread-1 (]: Began compiling node model.modelling_handson.type3_customers
[0m16:07:32.388978 [debug] [Thread-1 (]: Writing injected SQL for node "model.modelling_handson.type3_customers"
[0m16:07:32.389432 [debug] [Thread-1 (]: Began executing node model.modelling_handson.type3_customers
[0m16:07:32.414936 [debug] [Thread-1 (]: Writing runtime sql for node "model.modelling_handson.type3_customers"
[0m16:07:32.415491 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.type3_customers"
[0m16:07:32.415747 [debug] [Thread-1 (]: On model.modelling_handson.type3_customers: BEGIN
[0m16:07:32.416083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:32.419352 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m16:07:32.419619 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.type3_customers"
[0m16:07:32.419842 [debug] [Thread-1 (]: On model.modelling_handson.type3_customers: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.type3_customers"} */

  
    

  create  table "salesdb"."marts"."type3_customers__dbt_tmp"
  
  
    as
  
  (
    

with unioned as (
  select customer_nk, first_name, last_name, email, city, country, coalesce(null::timestamp, signup_ts) as change_ts
  from "salesdb"."staging"."stg_customers_initial"
  union all
  select customer_nk, first_name, last_name, email, city, country, change_ts
  from "salesdb"."staging"."stg_customers_day1"
  union all
  select customer_nk, first_name, last_name, email, city, country, change_ts
  from "salesdb"."staging"."stg_customers_day2"
),
ordered as (
  select *,
         row_number() over (partition by customer_nk order by coalesce(change_ts, '1900-01-01') desc) as rn,
         lead(city) over (partition by customer_nk order by coalesce(change_ts, '1900-01-01') desc) as prev_city
  from unioned
)
select 
  customer_nk,
  first_name,
  last_name,
  email,
  city as current_city,
  prev_city
from ordered
where rn = 1



  );
  
[0m16:07:32.423598 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m16:07:32.430022 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.type3_customers"
[0m16:07:32.430308 [debug] [Thread-1 (]: On model.modelling_handson.type3_customers: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.type3_customers"} */
alter table "salesdb"."marts"."type3_customers__dbt_tmp" rename to "type3_customers"
[0m16:07:32.430887 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:07:32.439092 [debug] [Thread-1 (]: On model.modelling_handson.type3_customers: COMMIT
[0m16:07:32.439393 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.type3_customers"
[0m16:07:32.439598 [debug] [Thread-1 (]: On model.modelling_handson.type3_customers: COMMIT
[0m16:07:32.440651 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:07:32.444481 [debug] [Thread-1 (]: Applying DROP to: "salesdb"."marts"."type3_customers__dbt_backup"
[0m16:07:32.448010 [debug] [Thread-1 (]: Using postgres connection "model.modelling_handson.type3_customers"
[0m16:07:32.448302 [debug] [Thread-1 (]: On model.modelling_handson.type3_customers: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "modelling_handson", "target_name": "dev", "node_id": "model.modelling_handson.type3_customers"} */
drop table if exists "salesdb"."marts"."type3_customers__dbt_backup" cascade
[0m16:07:32.448989 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m16:07:32.450505 [debug] [Thread-1 (]: On model.modelling_handson.type3_customers: Close
[0m16:07:32.451602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24581bbb-a401-4f30-9199-86fcb4f1d064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b47cfb5f2d0>]}
[0m16:07:32.452048 [info ] [Thread-1 (]: 1 of 1 OK created sql table model marts.type3_customers ........................ [[32mSELECT 6[0m in 0.07s]
[0m16:07:32.452425 [debug] [Thread-1 (]: Finished running node model.modelling_handson.type3_customers
[0m16:07:32.453602 [debug] [MainThread]: Using postgres connection "master"
[0m16:07:32.453883 [debug] [MainThread]: On master: BEGIN
[0m16:07:32.454097 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:07:32.457066 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m16:07:32.457330 [debug] [MainThread]: On master: COMMIT
[0m16:07:32.457534 [debug] [MainThread]: Using postgres connection "master"
[0m16:07:32.457705 [debug] [MainThread]: On master: COMMIT
[0m16:07:32.458164 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:07:32.458777 [debug] [MainThread]: On master: Close
[0m16:07:32.459086 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:07:32.459276 [debug] [MainThread]: Connection 'model.modelling_handson.type3_customers' was properly closed.
[0m16:07:32.459469 [info ] [MainThread]: 
[0m16:07:32.459700 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m16:07:32.460104 [debug] [MainThread]: Command end result
[0m16:07:32.473655 [debug] [MainThread]: Wrote artifact WritableManifest to /home/subhan/dbt/modelling_handson/target/manifest.json
[0m16:07:32.474950 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/subhan/dbt/modelling_handson/target/semantic_manifest.json
[0m16:07:32.479622 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/subhan/dbt/modelling_handson/target/run_results.json
[0m16:07:32.479896 [info ] [MainThread]: 
[0m16:07:32.480176 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:07:32.480378 [info ] [MainThread]: 
[0m16:07:32.480592 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:07:32.480944 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:07:32.481549 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.80927724, "process_in_blocks": "8", "process_kernel_time": 0.17842, "process_mem_max_rss": "125424", "process_out_blocks": "2760", "process_user_time": 1.516574}
[0m16:07:32.481852 [debug] [MainThread]: Command `dbt run` succeeded at 16:07:32.481791 after 0.81 seconds
[0m16:07:32.482081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b47d04f4710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b47d13de050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b47d4b03b90>]}
[0m16:07:32.482297 [debug] [MainThread]: Flushing usage events
[0m16:07:34.031584 [debug] [MainThread]: An error was encountered while trying to flush usage events
